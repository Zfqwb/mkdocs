{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-\\.]+"},"docs":[{"location":"","text":"Java Docs nitto \u57fa\u7840\u9762\u8bd5\u9898 \u00b6 1-map\u96c6\u5408\u7684\u904d\u5386\u65b9\u5f0f \u00b6 2-1-HasMap\u7684\u7279\u6027 \u00b6 2-2-HasMap\u96c6\u5408\u7684\u6269\u5c55 \u00b6 3-1-Java\u865a\u62df\u673a\u4e2d\u7684\u5185\u5b58\u6a21\u578b \u00b6 3-2-\u7ebf\u7a0b\u5185\u5b58\u7a7a\u95f4\uff08\u6269\u5c55\uff09 \u00b6 4-\u7b80\u5355\u8bf4\u8bf4Java\u4e2d\u7684\u5f02\u5e38\u5904\u7406\u673a\u5236\u7684\u7b80\u5355\u539f\u7406\u548c\u5e94\u7528\u3002 \u00b6 5-\u521b\u5efa\u7ebf\u7a0b\u7684\u51e0\u79cd\u65b9\u5f0f\uff1f \u00b6 6-\u8c08\u8c08\u4f60\u5bf9\u5783\u573e\u56de\u6536\u673a\u5236\u7684\u4e86\u89e3\uff1f \u00b6 7-\u8bf4\u8bf4HashCode\uff08\uff09\u3001equals\uff08\uff09\u7684\u533a\u522b\uff1f \u00b6 8-String.StirngBuilder\uff0cStringBuffer\u4e09\u8005\u7684\u533a\u522b \u00b6 9-\u662f\u5426\u53ef\u4ee5\u4ece\u4e00\u4e2astatic\u65b9\u6cd5\u5185\u90e8\u53d1\u51fa\u5bf9\u975estatio\u65b9\u6cd5\u7684\u8c03\u7528 \u00b6 10-wait\u65b9\u6cd5\u548csleep\u65b9\u6cd5\u7684\u533a\u522b \u00b6 11-\u95ee\u9898\u6269\u5c55\u5e94\u7528\u573a\u666f \u00b6 12-Strings=new String\uff08xyz\uff09\uff1a\u521b\u5efa\u4e86\u51e0\u4e2aStringobject\uff1f\u662f\u5426\u53ef\u4ee5\u7ee7\u627fString\u7c7b\uff1f \u00b6 13-\u591a\u7ebf\u7a0b\u4e2d\u89e3\u51b3\u540c\u6b65\u95ee\u9898\u7684\u65b9\u5f0f \u00b6 14-Strings=Hello\uff1bs=s+world.\uff1a\u8fd9\u4e24\u884c\u4ee3\u7801\u6267\u884c\u540e\uff0c\u539f\u59cb\u7684String\u5bf9\u8c61\u4e2d\u7684\u5185\u5bb9\u5230\u5e95\u53d8\u4e86\u6ca1\u6709\uff1f \u00b6 15-HaslMap\u548cHashtable\u7684\u533a\u522b \u00b6 16-\u5355\u4f8b\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u61d2\u6c49\u5f0f\u548c\u997f\u6c49\u5f0f\u7684\u533a\u522b \u00b6 17-\u7c7b\u52a0\u8f7d\u673a\u5236\u6709\u4e86\u89e3\u5417 \u00b6 JavaWeb\u9762\u8bd5\u9898 \u00b6 git clone https://github.com/peaceiris/mkdocs-material-boilerplate.git cd mkdocs-material-boilerplate pipenv sync --dev pipenv shell inv serve --config-file mkdocs-sample.yml \u6846\u67b6\u9762\u8bd5\u9898 \u00b6 mkdocs/mkdocs: Project documentation with Markdown - GitHub squidfunk/mkdocs-material: A Material Design theme for MkDocs \u9879\u76ee\u9762\u8bd5\u9898 \u00b6 MIT License The graduate cap icon made by Freepik from www.flaticon.com is licensed by CC 3.0 BY","title":"Home"},{"location":"#_1","text":"","title":"\u57fa\u7840\u9762\u8bd5\u9898"},{"location":"#1-map","text":"","title":"1-map\u96c6\u5408\u7684\u904d\u5386\u65b9\u5f0f"},{"location":"#2-1-hasmap","text":"","title":"2-1-HasMap\u7684\u7279\u6027"},{"location":"#2-2-hasmap","text":"","title":"2-2-HasMap\u96c6\u5408\u7684\u6269\u5c55"},{"location":"#3-1-java","text":"","title":"3-1-Java\u865a\u62df\u673a\u4e2d\u7684\u5185\u5b58\u6a21\u578b"},{"location":"#3-2-","text":"","title":"3-2-\u7ebf\u7a0b\u5185\u5b58\u7a7a\u95f4\uff08\u6269\u5c55\uff09"},{"location":"#4-java","text":"","title":"4-\u7b80\u5355\u8bf4\u8bf4Java\u4e2d\u7684\u5f02\u5e38\u5904\u7406\u673a\u5236\u7684\u7b80\u5355\u539f\u7406\u548c\u5e94\u7528\u3002"},{"location":"#5-","text":"","title":"5-\u521b\u5efa\u7ebf\u7a0b\u7684\u51e0\u79cd\u65b9\u5f0f\uff1f"},{"location":"#6-","text":"","title":"6-\u8c08\u8c08\u4f60\u5bf9\u5783\u573e\u56de\u6536\u673a\u5236\u7684\u4e86\u89e3\uff1f"},{"location":"#7-hashcodeequals","text":"","title":"7-\u8bf4\u8bf4HashCode\uff08\uff09\u3001equals\uff08\uff09\u7684\u533a\u522b\uff1f"},{"location":"#8-stringstirngbuilderstringbuffer","text":"","title":"8-String.StirngBuilder\uff0cStringBuffer\u4e09\u8005\u7684\u533a\u522b"},{"location":"#9-staticstatio","text":"","title":"9-\u662f\u5426\u53ef\u4ee5\u4ece\u4e00\u4e2astatic\u65b9\u6cd5\u5185\u90e8\u53d1\u51fa\u5bf9\u975estatio\u65b9\u6cd5\u7684\u8c03\u7528"},{"location":"#10-waitsleep","text":"","title":"10-wait\u65b9\u6cd5\u548csleep\u65b9\u6cd5\u7684\u533a\u522b"},{"location":"#11-","text":"","title":"11-\u95ee\u9898\u6269\u5c55\u5e94\u7528\u573a\u666f"},{"location":"#12-stringsnew_stringxyzstringobjectstring","text":"","title":"12-Strings=new String\uff08xyz\uff09\uff1a\u521b\u5efa\u4e86\u51e0\u4e2aStringobject\uff1f\u662f\u5426\u53ef\u4ee5\u7ee7\u627fString\u7c7b\uff1f"},{"location":"#13-","text":"","title":"13-\u591a\u7ebf\u7a0b\u4e2d\u89e3\u51b3\u540c\u6b65\u95ee\u9898\u7684\u65b9\u5f0f"},{"location":"#14-stringshellossworldstring","text":"","title":"14-Strings=Hello\uff1bs=s+world.\uff1a\u8fd9\u4e24\u884c\u4ee3\u7801\u6267\u884c\u540e\uff0c\u539f\u59cb\u7684String\u5bf9\u8c61\u4e2d\u7684\u5185\u5bb9\u5230\u5e95\u53d8\u4e86\u6ca1\u6709\uff1f"},{"location":"#15-haslmaphashtable","text":"","title":"15-HaslMap\u548cHashtable\u7684\u533a\u522b"},{"location":"#16-","text":"","title":"16-\u5355\u4f8b\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u61d2\u6c49\u5f0f\u548c\u997f\u6c49\u5f0f\u7684\u533a\u522b"},{"location":"#17-","text":"","title":"17-\u7c7b\u52a0\u8f7d\u673a\u5236\u6709\u4e86\u89e3\u5417"},{"location":"#javaweb","text":"git clone https://github.com/peaceiris/mkdocs-material-boilerplate.git cd mkdocs-material-boilerplate pipenv sync --dev pipenv shell inv serve --config-file mkdocs-sample.yml","title":"JavaWeb\u9762\u8bd5\u9898"},{"location":"#_2","text":"mkdocs/mkdocs: Project documentation with Markdown - GitHub squidfunk/mkdocs-material: A Material Design theme for MkDocs","title":"\u6846\u67b6\u9762\u8bd5\u9898"},{"location":"#_3","text":"MIT License The graduate cap icon made by Freepik from www.flaticon.com is licensed by CC 3.0 BY","title":"\u9879\u76ee\u9762\u8bd5\u9898"},{"location":"M/","text":"Material for MkDocs \u00b6 MkDocs \u00b6 mkdocs/mkdocs: Project documentation with Markdown - GitHub Material for MkDocs \u00b6 squidfunk/mkdocs-material: A Material Design theme for MkDocs","title":"Material for MkDocs"},{"location":"M/#material_for_mkdocs","text":"","title":"Material for MkDocs"},{"location":"M/#mkdocs","text":"mkdocs/mkdocs: Project documentation with Markdown - GitHub","title":"MkDocs"},{"location":"M/#material_for_mkdocs_1","text":"squidfunk/mkdocs-material: A Material Design theme for MkDocs","title":"Material for MkDocs"},{"location":"MySQL/","text":"MySQL \u53c2\u8003\u624b\u518c \u00b6 Reference Manual day01 \u00b6 01\u64cd\u4f5c\u6570\u636e\u5e93\u548c\u6570\u636e\u8868 \u00b6 \u67e5\u8be2\u6240\u6709\u6570\u636e\u5e93 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW DATABASES; */ \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u7684\u521b\u5efa\u8bed\u53e5 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0; */ \u521b\u5efa\u6570\u636e\u5e93 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0; */ \u521b\u5efa\u6570\u636e\u5e93\uff0c\u5224\u65ad\u3001\u5982\u679c\u4e0d\u5b58\u5728\u5219\u521b\u5efa \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE DATABASE IF NOT EXISTS \u6570\u636e\u5e93\u540d\u79f0; */ \u521b\u5efa\u6570\u636e\u5e93\u3001\u5e76\u6307\u5b9a\u5b57\u7b26\u96c6 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0 CHARACTER SET \u5b57\u7b26\u96c6\u540d\u79f0; */ \u67e5\u770b\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6 \u00b6 SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0 ; \u4fee\u6539\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER DATABASE \u6570\u636e\u5e93\u540d\u79f0 CHARACTER SET \u5b57\u7b26\u96c6\u540d\u79f0; */ \u5220\u9664\u6570\u636e\u5e93 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a DROP DATABASE \u6570\u636e\u5e93\u540d\u79f0; */ \u5220\u9664\u6570\u636e\u5e93\uff0c\u5224\u65ad\u3001\u5982\u679c\u5b58\u5728\u5219\u5220\u9664 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a DROP DATABASE IF EXISTS \u6570\u636e\u5e93\u540d\u79f0; */ \u4f7f\u7528\u6570\u636e\u5e93 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a USE \u6570\u636e\u5e93\u540d\u79f0; */ \u67e5\u8be2\u5f53\u524d\u4f7f\u7528\u7684\u6570\u636e\u5e93 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT DATABASE(); */ \u67e5\u8be2\u6240\u6709\u6570\u636e\u8868 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW TABLES; */ \u67e5\u8be2\u8868\u7ed3\u6784 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a DESC \u8868\u540d; */ \u67e5\u8be2\u6570\u636e\u8868\u7684\u5b57\u7b26\u96c6 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW TABLE STATUS FROM \u6570\u636e\u5e93\u540d\u79f0 LIKE '\u8868\u540d'; */ \u521b\u5efa\u6570\u636e\u8868 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE TABLE \u8868\u540d( \u5217\u540d \u6570\u636e\u7c7b\u578b \u7ea6\u675f, \u5217\u540d \u6570\u636e\u7c7b\u578b \u7ea6\u675f, ... \u5217\u540d \u6570\u636e\u7c7b\u578b \u7ea6\u675f ); */ \u4fee\u6539\u8868\u540d \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u65e7\u8868\u540d RENAME TO \u65b0\u8868\u540d; */ \u4fee\u6539\u8868\u7684\u5b57\u7b26\u96c6 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d CHARACTER SET \u5b57\u7b26\u96c6\u540d\u79f0; */ \u7ed9\u8868\u6dfb\u52a0\u5217 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD \u5217\u540d \u6570\u636e\u7c7b\u578b; */ \u4fee\u6539\u8868\u4e2d\u5217\u7684\u6570\u636e\u7c7b\u578b \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d MODIFY \u5217\u540d \u6570\u636e\u7c7b\u578b; */ \u4fee\u6539\u8868\u4e2d\u5217\u7684\u540d\u79f0\u548c\u6570\u636e\u7c7b\u578b \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d CHANGE \u65e7\u5217\u540d \u65b0\u5217\u540d \u6570\u636e\u7c7b\u578b; */ \u5220\u9664\u8868\u4e2d\u7684\u5217 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d DROP \u5217\u540d; */ \u5220\u9664\u8868 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a DROP TABLE \u8868\u540d; */ \u5220\u9664\u8868\uff0c\u5224\u65ad\u3001\u5982\u679c\u5b58\u5728\u5219\u5220\u9664 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a DROP TABLE IF EXISTS \u8868\u540d; */ 02\u8868\u6570\u636e\u7684\u589e\u5220\u6539 \u00b6 \u7ed9\u6307\u5b9a\u5217\u6dfb\u52a0\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a INSERT INTO \u8868\u540d(\u5217\u540d1,\u5217\u540d2,...) VALUES (\u503c1,\u503c2,...); */ \u7ed9\u5168\u90e8\u5217\u6dfb\u52a0\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a INSERT INTO \u8868\u540d VALUES (\u503c1,\u503c2,\u503c3,...); */ \u6279\u91cf\u6dfb\u52a0\u6240\u6709\u5217\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a INSERT INTO \u8868\u540d VALUES (\u503c1,\u503c2,\u503c3,...),(\u503c1,\u503c2,\u503c3,...),(\u503c1,\u503c2,\u503c3,...); */ \u4fee\u6539\u8868\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a UPDATE \u8868\u540d SET \u5217\u540d1 = \u503c1,\u5217\u540d2 = \u503c2,... [where \u6761\u4ef6]; */ \u5220\u9664\u8868\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a DELETE FROM \u8868\u540d [WHERE \u6761\u4ef6]; */ 03\u8868\u6570\u636e\u7684\u67e5\u8be2 \u00b6 \u67e5\u8be2\u5168\u90e8\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT * FROM \u8868\u540d; */ \u67e5\u8be2\u6307\u5b9a\u5217 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d1,\u5217\u540d2,... FROM \u8868\u540d; */ \u53bb\u9664\u91cd\u590d\u67e5\u8be2 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT DISTINCT \u5217\u540d1,\u5217\u540d2,... FROM \u8868\u540d; */ \u8ba1\u7b97\u5217\u7684\u503c \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d1 \u8fd0\u7b97\u7b26(+ - * /) \u5217\u540d2 FROM \u8868\u540d; \u5982\u679c\u67d0\u4e00\u5217\u4e3anull\uff0c\u53ef\u4ee5\u8fdb\u884c\u66ff\u6362 ifnull(\u8868\u8fbe\u5f0f1,\u8868\u8fbe\u5f0f2) \u8868\u8fbe\u5f0f1\uff1a\u60f3\u66ff\u6362\u7684\u5217 \u8868\u8fbe\u5f0f2\uff1a\u60f3\u66ff\u6362\u7684\u503c */ example -- \u67e5\u8be2\u5546\u54c1\u540d\u79f0\u548c\u5e93\u5b58\uff0c\u5e93\u5b58\u6570\u91cf\u5728\u539f\u6709\u57fa\u7840\u4e0a\u52a010 SELECT NAME,stock+10 FROM product; -- \u67e5\u8be2\u5546\u54c1\u540d\u79f0\u548c\u5e93\u5b58\uff0c\u5e93\u5b58\u6570\u91cf\u5728\u539f\u6709\u57fa\u7840\u4e0a\u52a010\u3002\u8fdb\u884cnull\u503c\u5224\u65ad SELECT NAME,IFNULL(stock,0)+10 FROM product; \u8d77\u522b\u540d \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d1,\u5217\u540d2,... AS \u522b\u540d FROM \u8868\u540d; */ as\u53ef\u4ee5\u7701\u7565 \u6761\u4ef6\u67e5\u8be2 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d\u5217\u8868 FROM \u8868\u540d WHERE \u6761\u4ef6; */ example -- \u67e5\u8be2\u5e93\u5b58\u5927\u4e8e20\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock > 20; -- \u67e5\u8be2\u54c1\u724c\u4e3a\u534e\u4e3a\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE brand='\u534e\u4e3a'; -- \u67e5\u8be2\u91d1\u989d\u57284000 ~ 6000\u4e4b\u95f4\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE price >= 4000 AND price <= 6000; SELECT * FROM product WHERE price BETWEEN 4000 AND 6000; -- \u67e5\u8be2\u5e93\u5b58\u4e3a14\u300130\u300123\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock=14 OR stock=30 OR stock=23; SELECT * FROM product WHERE stock IN(14,30,23); -- \u67e5\u8be2\u5e93\u5b58\u4e3anull\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock IS NULL; -- \u67e5\u8be2\u5e93\u5b58\u4e0d\u4e3anull\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock IS NOT NULL; -- \u67e5\u8be2\u540d\u79f0\u4ee5\u5c0f\u7c73\u4e3a\u5f00\u5934\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '\u5c0f\u7c73%'; -- \u67e5\u8be2\u540d\u79f0\u7b2c\u4e8c\u4e2a\u5b57\u662f\u4e3a\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '_\u4e3a%'; -- \u67e5\u8be2\u540d\u79f0\u4e3a\u56db\u4e2a\u5b57\u7b26\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '____'; -- \u67e5\u8be2\u540d\u79f0\u4e2d\u5305\u542b\u7535\u8111\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '%\u7535\u8111%'; \u805a\u5408\u51fd\u6570 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u51fd\u6570\u540d(\u5217\u540d) FROM \u8868\u540d [WHERE \u6761\u4ef6]; */ example -- \u8ba1\u7b97product\u8868\u4e2d\u603b\u8bb0\u5f55\u6761\u6570 SELECT COUNT(*) FROM product; -- \u83b7\u53d6\u6700\u9ad8\u4ef7\u683c SELECT MAX(price) FROM product; -- \u83b7\u53d6\u6700\u4f4e\u5e93\u5b58 SELECT MIN(stock) FROM product; -- \u83b7\u53d6\u603b\u5e93\u5b58\u6570\u91cf SELECT SUM(stock) FROM product; -- \u83b7\u53d6\u54c1\u724c\u4e3a\u82f9\u679c\u7684\u603b\u5e93\u5b58\u6570\u91cf SELECT SUM(stock) FROM product WHERE brand='\u82f9\u679c'; -- \u83b7\u53d6\u54c1\u724c\u4e3a\u5c0f\u7c73\u7684\u5e73\u5747\u5546\u54c1\u4ef7\u683c SELECT AVG(price) FROM product WHERE brand='\u5c0f\u7c73'; \u6392\u5e8f\u67e5\u8be2 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6] ORDER BY \u5217\u540d1 \u6392\u5e8f\u65b9\u5f0f1,\u5217\u540d2 \u6392\u5e8f\u65b9\u5f0f2; */ example -- \u6309\u7167\u5e93\u5b58\u5347\u5e8f\u6392\u5e8f SELECT * FROM product ORDER BY stock ASC; -- \u67e5\u8be2\u540d\u79f0\u4e2d\u5305\u542b\u624b\u673a\u7684\u5546\u54c1\u4fe1\u606f\u3002\u6309\u7167\u91d1\u989d\u964d\u5e8f\u6392\u5e8f SELECT * FROM product WHERE NAME LIKE '%\u624b\u673a%' ORDER BY price DESC; -- \u6309\u7167\u91d1\u989d\u5347\u5e8f\u6392\u5e8f\uff0c\u5982\u679c\u91d1\u989d\u76f8\u540c\uff0c\u6309\u7167\u5e93\u5b58\u964d\u5e8f\u6392\u5217 SELECT * FROM product ORDER BY price ASC,stock DESC; \u5206\u7ec4\u67e5\u8be2 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6] GROUP BY \u5206\u7ec4\u5217\u540d [HAVING \u5206\u7ec4\u540e\u6761\u4ef6\u8fc7\u6ee4] [ORDER BY \u6392\u5e8f\u5217\u540d \u6392\u5e8f\u65b9\u5f0f]; */ \u5206\u9875\u67e5\u8be2 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6] [GROUP BY \u5206\u7ec4\u5217\u540d] [HAVING \u5206\u7ec4\u540e\u6761\u4ef6\u8fc7\u6ee4] [ORDER BY \u6392\u5e8f\u5217\u540d \u6392\u5e8f\u65b9\u5f0f] LIMIT \u5f53\u524d\u9875\u6570,\u6bcf\u9875\u663e\u793a\u7684\u6761\u6570; LIMIT \u5f53\u524d\u9875\u6570,\u6bcf\u9875\u663e\u793a\u7684\u6761\u6570; \u516c\u5f0f\uff1a\u5f53\u524d\u9875\u6570 = (\u5f53\u524d\u9875\u6570-1) * \u6bcf\u9875\u663e\u793a\u7684\u6761\u6570 */ example -- \u6bcf\u9875\u663e\u793a3\u6761\u6570\u636e -- \u7b2c1\u9875 \u5f53\u524d\u9875\u6570=(1-1) * 3 SELECT * FROM product LIMIT 0,3; -- \u7b2c2\u9875 \u5f53\u524d\u9875\u6570=(2-1) * 3 SELECT * FROM product LIMIT 3,3; -- \u7b2c3\u9875 \u5f53\u524d\u9875\u6570=(3-1) * 3 SELECT * FROM product LIMIT 6,3; 04\u7ea6\u675f \u00b6 \u4e3b\u952e\u7ea6\u675f \u00b6 -- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e CREATE TABLE student( id INT PRIMARY KEY, NAME VARCHAR(30), age INT ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (1,'\u5f20\u4e09',23); INSERT INTO student VALUES (2,'\u674e\u56db',24); -- \u5220\u9664\u4e3b\u952e ALTER TABLE student DROP PRIMARY KEY; -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u4e3b\u952e\u7ea6\u675f ALTER TABLE student MODIFY id INT PRIMARY KEY; \u4e3b\u952e\u81ea\u589e\u7ea6\u675f \u00b6 -- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e\u81ea\u589e CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(30), age INT ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23),(NULL,'\u674e\u56db',24); -- \u5220\u9664\u81ea\u589e\u7ea6\u675f ALTER TABLE student MODIFY id INT; INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23); -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u81ea\u589e\u7ea6\u675f ALTER TABLE student MODIFY id INT AUTO_INCREMENT; \u552f\u4e00\u7ea6\u675f \u00b6 -- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e\u81ea\u589e\uff0c\u5e74\u9f84\u8bbe\u4e3a\u552f\u4e00 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(30), age INT UNIQUE ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23); INSERT INTO student VALUES (NULL,'\u674e\u56db',23); -- \u5220\u9664\u552f\u4e00\u7ea6\u675f ALTER TABLE student DROP INDEX age; -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u552f\u4e00\u7ea6\u675f ALTER TABLE student MODIFY age INT UNIQUE; \u975e\u7a7a\u7ea6\u675f \u00b6 -- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e\u81ea\u589e\uff0c\u59d3\u540d\u8bbe\u4e3a\u975e\u7a7a\uff0c\u5e74\u9f84\u8bbe\u4e3a\u552f\u4e00 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(30) NOT NULL, age INT UNIQUE ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23); -- \u5220\u9664\u975e\u7a7a\u7ea6\u675f ALTER TABLE student MODIFY NAME VARCHAR(30); INSERT INTO student VALUES (NULL,NULL,25); -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u975e\u7a7a\u7ea6\u675f ALTER TABLE student MODIFY NAME VARCHAR(30) NOT NULL; day02 \u00b6 01\u7ea6\u675f \u00b6 \u5916\u952e\u7ea6\u675f \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u8868\u4e3b\u952e\u5217\u540d) */ \u5220\u9664\u5916\u952e\u7ea6\u675f \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d DROP FOREIGN KEY \u5916\u952e\u540d; */ \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u5916\u952e\u7ea6\u675f \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d); */ \u5916\u952e\u7ea6\u675fexample -- \u521b\u5efadb2\u6570\u636e\u5e93 CREATE DATABASE db2; -- \u4f7f\u7528db2\u6570\u636e\u5e93 USE db2; /* \u5916\u952e\u7ea6\u675f \u6807\u51c6\u8bed\u6cd5\uff1a CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u8868\u4e3b\u952e\u5217\u540d) */ -- \u5efa\u8868\u65f6\u6dfb\u52a0\u5916\u952e\u7ea6\u675f -- \u521b\u5efauser\u7528\u6237\u8868 CREATE TABLE USER( id INT PRIMARY KEY AUTO_INCREMENT, -- id NAME VARCHAR(20) NOT NULL -- \u59d3\u540d ); -- \u6dfb\u52a0\u7528\u6237\u6570\u636e INSERT INTO USER VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efaorderlist\u8ba2\u5355\u8868 CREATE TABLE orderlist( id INT PRIMARY KEY AUTO_INCREMENT, -- id number VARCHAR(20) NOT NULL, -- \u8ba2\u5355\u7f16\u53f7 uid INT, -- \u5916\u952e\u5217 CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ); -- \u6dfb\u52a0\u8ba2\u5355\u6570\u636e INSERT INTO orderlist VALUES (NULL,'hm001',1),(NULL,'hm002',1), (NULL,'hm003',2),(NULL,'hm004',2); -- \u6dfb\u52a0\u4e00\u4e2a\u8ba2\u5355\uff0c\u4f46\u662f\u6ca1\u6709\u771f\u5b9e\u7528\u6237\u3002\u6dfb\u52a0\u5931\u8d25 INSERT INTO orderlist VALUES (NULL,'hm005',3); -- \u5220\u9664\u674e\u56db\u7528\u6237\u3002\u5220\u9664\u5931\u8d25 DELETE FROM USER WHERE NAME='\u674e\u56db'; /* \u5220\u9664\u5916\u952e\u7ea6\u675f \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d DROP FOREIGN KEY \u5916\u952e\u540d; */ -- \u5220\u9664\u5916\u952e\u7ea6\u675f ALTER TABLE orderlist DROP FOREIGN KEY ou_fk1; /* \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u5916\u952e\u7ea6\u675f \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d); */ -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ALTER TABLE orderlist ADD CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id); \u5916\u952e\u7ea7\u8054\u64cd\u4f5c \u00b6 /* \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u66f4\u65b0 \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d) ON UPDATE CASCADE; \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u5220\u9664 \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d) ON DELETE CASCADE; \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u66f4\u65b0\u548c\u7ea7\u8054\u5220\u9664 \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d) ON UPDATE CASCADE ON DELETE CASCADE; */ \u5916\u952e\u7ea7\u8054\u64cd\u4f5cexample -- \u5220\u9664\u5916\u952e\u7ea6\u675f ALTER TABLE orderlist DROP FOREIGN KEY ou_fk1; -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u66f4\u65b0\u548c\u7ea7\u8054\u5220\u9664 ALTER TABLE orderlist ADD CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ON UPDATE CASCADE ON DELETE CASCADE; -- \u5c06\u674e\u56db\u8fd9\u4e2a\u7528\u6237\u7684id\u4fee\u6539\u4e3a3,\u8ba2\u5355\u8868\u4e2d\u7684uid\u4e5f\u81ea\u52a8\u4fee\u6539 UPDATE USER SET id=3 WHERE id=2; -- \u5c06\u674e\u56db\u8fd9\u4e2a\u7528\u6237\u5220\u9664,\u8ba2\u5355\u8868\u4e2d\u7684\u8be5\u7528\u6237\u6240\u5c5e\u7684\u8ba2\u5355\u4e5f\u81ea\u52a8\u5220\u9664 DELETE FROM USER WHERE id=3; 02\u591a\u8868\u64cd\u4f5c \u00b6 \u8868\u5173\u7cfb\u4e00\u5bf9\u4e00 \u00b6 -- \u521b\u5efadb3\u6570\u636e\u5e93 CREATE DATABASE db3; -- \u4f7f\u7528db3\u6570\u636e\u5e93 USE db3; -- \u521b\u5efaperson\u8868 CREATE TABLE person( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(20) -- \u59d3\u540d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO person VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efacard\u8868 CREATE TABLE card( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid number VARCHAR(20) UNIQUE NOT NULL, -- \u8eab\u4efd\u8bc1\u53f7 pid INT UNIQUE, -- \u5916\u952e\u5217 CONSTRAINT cp_fk1 FOREIGN KEY (pid) REFERENCES person(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO card VALUES (NULL,'12345',1),(NULL,'56789',2); \u8868\u5173\u7cfb\u4e00\u5bf9\u591a \u00b6 -- \u521b\u5efauser\u8868 CREATE TABLE USER( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(20) -- \u59d3\u540d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO USER VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efaorderlist\u8868 CREATE TABLE orderlist( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid number VARCHAR(20), -- \u8ba2\u5355\u7f16\u53f7 uid INT, -- \u5916\u952e\u5217 CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO orderlist VALUES (NULL,'hm001',1),(NULL,'hm002',1),(NULL,'hm003',2),(NULL,'hm004',2); /* \u5546\u54c1\u5206\u7c7b\u548c\u5546\u54c1 */ -- \u521b\u5efacategory\u8868 CREATE TABLE category( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(10) -- \u5206\u7c7b\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO category VALUES (NULL,'\u624b\u673a\u6570\u7801'),(NULL,'\u7535\u8111\u529e\u516c'); -- \u521b\u5efaproduct\u8868 CREATE TABLE product( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(30), -- \u5546\u54c1\u540d\u79f0 cid INT, -- \u5916\u952e\u5217 CONSTRAINT pc_fk1 FOREIGN KEY (cid) REFERENCES category(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO product VALUES (NULL,'\u534e\u4e3aP30',1),(NULL,'\u5c0f\u7c73note3',1), (NULL,'\u8054\u60f3\u7535\u8111',2),(NULL,'\u82f9\u679c\u7535\u8111',2); \u8868\u5173\u7cfb\u591a\u5bf9\u591a \u00b6 -- \u521b\u5efastudent\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(20) -- \u5b66\u751f\u59d3\u540d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efacourse\u8868 CREATE TABLE course( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(10) -- \u8bfe\u7a0b\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO course VALUES (NULL,'\u8bed\u6587'),(NULL,'\u6570\u5b66'); -- \u521b\u5efa\u4e2d\u95f4\u8868 CREATE TABLE stu_course( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid sid INT, -- \u7528\u4e8e\u548cstudent\u8868\u4e2d\u7684id\u8fdb\u884c\u5916\u952e\u5173\u8054 cid INT, -- \u7528\u4e8e\u548ccourse\u8868\u4e2d\u7684id\u8fdb\u884c\u5916\u952e\u5173\u8054 CONSTRAINT sc_fk1 FOREIGN KEY (sid) REFERENCES student(id), -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f CONSTRAINT sc_fk2 FOREIGN KEY (cid) REFERENCES course(id) -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO stu_course VALUES (NULL,1,1),(NULL,1,2),(NULL,2,1),(NULL,2,2); \u591a\u8868\u67e5\u8be2\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb4\u6570\u636e\u5e93 CREATE DATABASE db4; -- \u4f7f\u7528db4\u6570\u636e\u5e93 USE db4; -- \u521b\u5efauser\u8868 CREATE TABLE USER( id INT PRIMARY KEY AUTO_INCREMENT, -- \u7528\u6237id NAME VARCHAR(20), -- \u7528\u6237\u59d3\u540d age INT -- \u7528\u6237\u5e74\u9f84 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO USER VALUES (1,'\u5f20\u4e09',23); INSERT INTO USER VALUES (2,'\u674e\u56db',24); INSERT INTO USER VALUES (3,'\u738b\u4e94',25); INSERT INTO USER VALUES (4,'\u8d75\u516d',26); -- \u8ba2\u5355\u8868 CREATE TABLE orderlist( id INT PRIMARY KEY AUTO_INCREMENT, -- \u8ba2\u5355id number VARCHAR(30), -- \u8ba2\u5355\u7f16\u53f7 uid INT, -- \u5916\u952e\u5b57\u6bb5 CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO orderlist VALUES (1,'hm001',1); INSERT INTO orderlist VALUES (2,'hm002',1); INSERT INTO orderlist VALUES (3,'hm003',2); INSERT INTO orderlist VALUES (4,'hm004',2); INSERT INTO orderlist VALUES (5,'hm005',3); INSERT INTO orderlist VALUES (6,'hm006',3); INSERT INTO orderlist VALUES (7,'hm007',NULL); -- \u5546\u54c1\u5206\u7c7b\u8868 CREATE TABLE category( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5546\u54c1\u5206\u7c7bid NAME VARCHAR(10) -- \u5546\u54c1\u5206\u7c7b\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO category VALUES (1,'\u624b\u673a\u6570\u7801'); INSERT INTO category VALUES (2,'\u7535\u8111\u529e\u516c'); INSERT INTO category VALUES (3,'\u70df\u9152\u8336\u7cd6'); INSERT INTO category VALUES (4,'\u978b\u9774\u7bb1\u5305'); -- \u5546\u54c1\u8868 CREATE TABLE product( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5546\u54c1id NAME VARCHAR(30), -- \u5546\u54c1\u540d\u79f0 cid INT, -- \u5916\u952e\u5b57\u6bb5 CONSTRAINT cp_fk1 FOREIGN KEY (cid) REFERENCES category(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO product VALUES (1,'\u534e\u4e3a\u624b\u673a',1); INSERT INTO product VALUES (2,'\u5c0f\u7c73\u624b\u673a',1); INSERT INTO product VALUES (3,'\u8054\u60f3\u7535\u8111',2); INSERT INTO product VALUES (4,'\u82f9\u679c\u7535\u8111',2); INSERT INTO product VALUES (5,'\u4e2d\u534e\u9999\u70df',3); INSERT INTO product VALUES (6,'\u7389\u6eaa\u9999\u70df',3); INSERT INTO product VALUES (7,'\u8ba1\u751f\u7528\u54c1',NULL); -- \u4e2d\u95f4\u8868 CREATE TABLE us_pro( upid INT PRIMARY KEY AUTO_INCREMENT, -- \u4e2d\u95f4\u8868id uid INT, -- \u5916\u952e\u5b57\u6bb5\u3002\u9700\u8981\u548c\u7528\u6237\u8868\u7684\u4e3b\u952e\u4ea7\u751f\u5173\u8054 pid INT, -- \u5916\u952e\u5b57\u6bb5\u3002\u9700\u8981\u548c\u5546\u54c1\u8868\u7684\u4e3b\u952e\u4ea7\u751f\u5173\u8054 CONSTRAINT up_fk1 FOREIGN KEY (uid) REFERENCES USER(id), CONSTRAINT up_fk2 FOREIGN KEY (pid) REFERENCES product(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO us_pro VALUES (NULL,1,1); INSERT INTO us_pro VALUES (NULL,1,2); INSERT INTO us_pro VALUES (NULL,1,3); INSERT INTO us_pro VALUES (NULL,1,4); INSERT INTO us_pro VALUES (NULL,1,5); INSERT INTO us_pro VALUES (NULL,1,6); INSERT INTO us_pro VALUES (NULL,1,7); INSERT INTO us_pro VALUES (NULL,2,1); INSERT INTO us_pro VALUES (NULL,2,2); INSERT INTO us_pro VALUES (NULL,2,3); INSERT INTO us_pro VALUES (NULL,2,4); INSERT INTO us_pro VALUES (NULL,2,5); INSERT INTO us_pro VALUES (NULL,2,6); INSERT INTO us_pro VALUES (NULL,2,7); INSERT INTO us_pro VALUES (NULL,3,1); INSERT INTO us_pro VALUES (NULL,3,2); INSERT INTO us_pro VALUES (NULL,3,3); INSERT INTO us_pro VALUES (NULL,3,4); INSERT INTO us_pro VALUES (NULL,3,5); INSERT INTO us_pro VALUES (NULL,3,6); INSERT INTO us_pro VALUES (NULL,3,7); INSERT INTO us_pro VALUES (NULL,4,1); INSERT INTO us_pro VALUES (NULL,4,2); INSERT INTO us_pro VALUES (NULL,4,3); INSERT INTO us_pro VALUES (NULL,4,4); INSERT INTO us_pro VALUES (NULL,4,5); INSERT INTO us_pro VALUES (NULL,4,6); INSERT INTO us_pro VALUES (NULL,4,7); \u5185\u8fde\u63a5\u67e5\u8be2 \u00b6 \u663e\u793a\u5185\u8fde\u63a5 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1 [INNER] JOIN \u8868\u540d2 ON \u5173\u8054\u6761\u4ef6; */ \u9690\u5f0f\u5185\u8fde\u63a5 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1,\u8868\u540d2 WHERE \u5173\u8054\u6761\u4ef6; */ \u5916\u8fde\u63a5\u67e5\u8be2 \u00b6 \u5de6\u5916\u8fde\u63a5 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1 LEFT [OUTER] JOIN \u8868\u540d2 ON \u6761\u4ef6; */ \u53f3\u5916\u8fde\u63a5 \u00b6 /* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1 RIGHT [OUTER] JOIN \u8868\u540d2 ON \u6761\u4ef6; */ \u5b50\u67e5\u8be2 \u00b6 /* \u7ed3\u679c\u662f\u5355\u884c\u5355\u5217\u7684 \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d WHERE \u5217\u540d=(SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]); */ -- \u67e5\u8be2\u5e74\u9f84\u6700\u9ad8\u7684\u7528\u6237\u59d3\u540d SELECT MAX(age) FROM USER; SELECT NAME,age FROM USER WHERE age=(SELECT MAX(age) FROM USER); /* \u7ed3\u679c\u662f\u591a\u884c\u5355\u5217\u7684 \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d WHERE \u5217\u540d [NOT] IN (SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]); */ -- \u67e5\u8be2\u5f20\u4e09\u548c\u674e\u56db\u7684\u8ba2\u5355\u4fe1\u606f SELECT * FROM orderlist WHERE uid IN (1,2); SELECT id FROM USER WHERE NAME IN ('\u5f20\u4e09','\u674e\u56db'); SELECT * FROM orderlist WHERE uid IN (SELECT id FROM USER WHERE NAME IN ('\u5f20\u4e09','\u674e\u56db')); /* \u7ed3\u679c\u662f\u591a\u884c\u591a\u5217\u7684 \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [\u522b\u540d],(SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]) [\u522b\u540d] [WHERE \u6761\u4ef6]; */ -- \u67e5\u8be2\u8ba2\u5355\u8868\u4e2did\u5927\u4e8e4\u7684\u8ba2\u5355\u4fe1\u606f\u548c\u6240\u5c5e\u7528\u6237\u4fe1\u606f SELECT * FROM orderlist WHERE id > 4; SELECT u.name, o.number FROM USER u, (SELECT * FROM orderlist WHERE id > 4) o WHERE o.uid=u.id; \u81ea\u5173\u8054\u67e5\u8be2 \u00b6 -- \u521b\u5efa\u5458\u5de5\u8868 CREATE TABLE employee( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5458\u5de5\u7f16\u53f7 NAME VARCHAR(20), -- \u5458\u5de5\u59d3\u540d mgr INT, -- \u4e0a\u7ea7\u7f16\u53f7 salary DOUBLE -- \u5458\u5de5\u5de5\u8d44 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO employee VALUES (1001,'\u5b59\u609f\u7a7a',1005,9000.00), (1002,'\u732a\u516b\u6212',1005,8000.00), (1003,'\u6c99\u548c\u5c1a',1005,8500.00), (1004,'\u5c0f\u767d\u9f99',1005,7900.00), (1005,'\u5510\u50e7',NULL,15000.00), (1006,'\u6b66\u677e',1009,7600.00), (1007,'\u674e\u9035',1009,7400.00), (1008,'\u6797\u51b2',1009,8100.00), (1009,'\u5b8b\u6c5f',NULL,16000.00); -- \u67e5\u8be2\u6240\u6709\u5458\u5de5\u7684\u59d3\u540d\u53ca\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u59d3\u540d\uff0c\u6ca1\u6709\u4e0a\u7ea7\u7684\u5458\u5de5\u4e5f\u9700\u8981\u67e5\u8be2 /* \u5206\u6790 \u5458\u5de5\u4fe1\u606f employee\u8868 \u6761\u4ef6\uff1aemployee.mgr = employee.id \u67e5\u8be2\u5de6\u8868\u7684\u5168\u90e8\u6570\u636e\uff0c\u548c\u5de6\u53f3\u4e24\u5f20\u8868\u6709\u4ea4\u96c6\u90e8\u5206\u6570\u636e\uff0c\u5de6\u5916\u8fde\u63a5 */ SELECT e1.id, e1.name, e1.mgr, e2.id, e2.name FROM employee e1 LEFT OUTER JOIN employee e2 ON e1.mgr = e2.id; \u591a\u8868\u67e5\u8be2\u7ec3\u4e60 \u00b6 -- 1.\u67e5\u8be2\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid */ SELECT u.id, u.name, u.age, o.number FROM USER u, orderlist o WHERE u.id=o.uid; -- 2.\u67e5\u8be2\u6240\u6709\u7684\u7528\u6237\u3002\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid \u67e5\u8be2\u6240\u6709\u7684\u7528\u6237\uff0c\u5de6\u5916\u8fde\u63a5 */ SELECT u.id, u.name, u.age, o.number FROM USER u LEFT OUTER JOIN orderlist o ON u.id=o.uid; -- 3.\u67e5\u8be2\u6240\u6709\u7684\u8ba2\u5355\u3002\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid \u67e5\u8be2\u6240\u6709\u7684\u8ba2\u5355\uff0c\u53f3\u5916\u8fde\u63a5 */ SELECT u.id, u.name, u.age, o.number FROM USER u RIGHT OUTER JOIN orderlist o ON u.id=o.uid; -- 4.\u67e5\u8be2\u7528\u6237\u5e74\u9f84\u5927\u4e8e23\u5c81\u7684\u4fe1\u606f\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid AND user.age > 23 */ SELECT u.id, u.name, u.age, o.number FROM USER u, orderlist o WHERE u.id=o.uid AND u.age > 23; -- 5.\u67e5\u8be2\u5f20\u4e09\u548c\u674e\u56db\u7528\u6237\u7684\u4fe1\u606f\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid AND user.name IN ('\u5f20\u4e09','\u674e\u56db') */ SELECT u.id, u.name, u.age, o.number FROM USER u, orderlist o WHERE u.id=o.uid AND u.name IN ('\u5f20\u4e09','\u674e\u56db'); -- 6.\u67e5\u8be2\u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0\u3002\u5206\u7c7b\u4e0b\u7684\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0 category\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u6761\u4ef6\uff1acategory.id=product.cid */ SELECT c.id, c.name, p.name FROM category c, product p WHERE c.id=p.cid; -- 7.\u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u5206\u7c7b\u3002\u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0\u3002\u5206\u7c7b\u4e0b\u7684\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0 category\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u6761\u4ef6\uff1acategory.id=product.cid \u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u5206\u7c7b\uff0c\u5de6\u5916\u8fde\u63a5 */ SELECT c.id, c.name, p.name FROM category c LEFT OUTER JOIN product p ON c.id=p.cid; -- 8.\u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u4fe1\u606f\u3002\u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0\u3002\u5206\u7c7b\u4e0b\u7684\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0 category\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u6761\u4ef6\uff1acategory.id=product.cid \u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u4fe1\u606f\uff0c\u53f3\u5916\u8fde\u63a5 */ SELECT c.id, c.name, p.name FROM category c RIGHT OUTER JOIN product p ON c.id=p.cid; -- 9.\u67e5\u8be2\u6240\u6709\u7684\u7528\u6237\u548c\u8be5\u7528\u6237\u80fd\u67e5\u770b\u7684\u6240\u6709\u7684\u5546\u54c1\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u4e2d\u95f4\u8868 us_pro \u6761\u4ef6\uff1aus_pro.uid=user.id AND us_pro.pid=product.id */ SELECT u.id, u.name, u.age, p.name FROM USER u, product p, us_pro up WHERE up.uid=u.id AND up.pid=p.id; -- 10.\u67e5\u8be2\u5f20\u4e09\u548c\u674e\u56db\u8fd9\u4e24\u4e2a\u7528\u6237\u53ef\u4ee5\u770b\u5230\u7684\u5546\u54c1\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u4e2d\u95f4\u8868 us_pro \u6761\u4ef6\uff1aus_pro.uid=user.id AND us_pro.pid=product.id AND user.name IN ('\u5f20\u4e09','\u674e\u56db') */ SELECT u.id, u.name, u.age, p.name FROM USER u, product p, us_pro up WHERE up.uid=u.id AND up.pid=p.id AND u.name IN ('\u5f20\u4e09','\u674e\u56db'); 03\u89c6\u56fe \u00b6 \u89c6\u56fe_\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb5\u6570\u636e\u5e93 CREATE DATABASE db5; -- \u4f7f\u7528db5\u6570\u636e\u5e93 USE db5; -- \u521b\u5efacountry\u8868 CREATE TABLE country( id INT PRIMARY KEY AUTO_INCREMENT, -- \u56fd\u5bb6id NAME VARCHAR(30) -- \u56fd\u5bb6\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO country VALUES (NULL,'\u4e2d\u56fd'),(NULL,'\u7f8e\u56fd'),(NULL,'\u4fc4\u7f57\u65af'); -- \u521b\u5efacity\u8868 CREATE TABLE city( id INT PRIMARY KEY AUTO_INCREMENT, -- \u57ce\u5e02id NAME VARCHAR(30), -- \u57ce\u5e02\u540d\u79f0 cid INT, -- \u5916\u952e\u5217\u3002\u5173\u8054country\u8868\u7684\u4e3b\u952e\u5217id CONSTRAINT cc_fk1 FOREIGN KEY (cid) REFERENCES country(id) -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO city VALUES (NULL,'\u5317\u4eac',1),(NULL,'\u4e0a\u6d77',1),(NULL,'\u7ebd\u7ea6',2),(NULL,'\u83ab\u65af\u79d1',3); \u521b\u5efa\u89c6\u56fe \u00b6 /* \u6807\u51c6\u8bed\u6cd5 CREATE VIEW \u89c6\u56fe\u540d\u79f0 [(\u5217\u540d\u5217\u8868)] AS \u67e5\u8be2\u8bed\u53e5; */ example -- \u521b\u5efacity_country\u89c6\u56fe\uff0c\u4fdd\u5b58\u57ce\u5e02\u548c\u56fd\u5bb6\u7684\u4fe1\u606f(\u4f7f\u7528\u6307\u5b9a\u5217\u540d) CREATE VIEW city_country (city_id,city_name,country_name) AS SELECT c1.id, c1.name, c2.name FROM city c1, country c2 WHERE c1.cid=c2.id; \u67e5\u8be2\u89c6\u56fe \u00b6 /* \u6807\u51c6\u8bed\u6cd5 SELECT * FROM \u89c6\u56fe\u540d\u79f0; */ example -- \u67e5\u8be2\u89c6\u56fe SELECT * FROM city_country; day03 \u00b6 01\u89c6\u56fe \u00b6 \u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb7\u6570\u636e\u5e93 CREATE DATABASE db7; -- \u4f7f\u7528db7\u6570\u636e\u5e93 USE db7; -- \u521b\u5efacountry\u8868 CREATE TABLE country( id INT PRIMARY KEY AUTO_INCREMENT, -- \u56fd\u5bb6id country_name VARCHAR(30) -- \u56fd\u5bb6\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO country VALUES (NULL,'\u4e2d\u56fd'),(NULL,'\u7f8e\u56fd'),(NULL,'\u4fc4\u7f57\u65af'); -- \u521b\u5efacity\u8868 CREATE TABLE city( id INT PRIMARY KEY AUTO_INCREMENT, -- \u57ce\u5e02id city_name VARCHAR(30), -- \u57ce\u5e02\u540d\u79f0 cid INT, -- \u5916\u952e\u5217\u3002\u5173\u8054country\u8868\u7684\u4e3b\u952e\u5217id CONSTRAINT cc_fk1 FOREIGN KEY (cid) REFERENCES country(id) -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO city VALUES (NULL,'\u5317\u4eac',1),(NULL,'\u4e0a\u6d77',1),(NULL,'\u7ebd\u7ea6',2),(NULL,'\u83ab\u65af\u79d1',3); \u521b\u5efa\u89c6\u56fe \u00b6 /* \u521b\u5efa\u89c6\u56fe \u6807\u51c6\u8bed\u6cd5 CREATE VIEW \u89c6\u56fe\u540d\u79f0 [(\u5217\u540d\u5217\u8868)] AS \u67e5\u8be2\u8bed\u53e5; */ \u67e5\u8be2\u89c6\u56fe \u00b6 \u67e5\u8be2\u89c6\u56fe \u00b6 /* \u6807\u51c6\u8bed\u6cd5 SELECT * FROM \u89c6\u56fe\u540d\u79f0; */ \u67e5\u8be2\u521b\u5efa\u89c6\u56fe\u7684\u8bed\u53e5 \u00b6 /* \u6807\u51c6\u8bed\u6cd5 SHOW CREATE VIEW \u89c6\u56fe\u540d\u79f0; */ \u4fee\u6539\u89c6\u56fe \u00b6 \u4fee\u6539\u89c6\u56fe\u8868\u6570\u636e \u00b6 /* \u6807\u51c6\u8bed\u6cd5 UPDATE \u89c6\u56fe\u540d\u79f0 SET \u5217\u540d=\u503c WHERE \u6761\u4ef6; */ \u4fee\u6539\u89c6\u56fe\u8868\u7ed3\u6784 \u00b6 /* \u4fee\u6539\u89c6\u56fe\u8868\u7ed3\u6784 \u6807\u51c6\u8bed\u6cd5 ALTER VIEW \u89c6\u56fe\u540d\u79f0 [(\u5217\u540d\u5217\u8868)] AS \u67e5\u8be2\u8bed\u53e5; */ \u5220\u9664\u89c6\u56fe \u00b6 /* \u5220\u9664\u89c6\u56fe \u6807\u51c6\u8bed\u6cd5 DROP VIEW [IF EXISTS] \u89c6\u56fe\u540d\u79f0; */ 02\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570 \u00b6 \u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb8\u6570\u636e\u5e93 CREATE DATABASE db8; -- \u4f7f\u7528db8\u6570\u636e\u5e93 USE db8; -- \u521b\u5efa\u5b66\u751f\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5b66\u751fid NAME VARCHAR(20), -- \u5b66\u751f\u59d3\u540d age INT, -- \u5b66\u751f\u5e74\u9f84 gender VARCHAR(5), -- \u5b66\u751f\u6027\u522b score INT -- \u5b66\u751f\u6210\u7ee9 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,'\u7537',95),(NULL,'\u674e\u56db',24,'\u7537',98), (NULL,'\u738b\u4e94',25,'\u5973',100),(NULL,'\u8d75\u516d',26,'\u5973',90); -- \u6309\u7167\u6027\u522b\u8fdb\u884c\u5206\u7ec4\uff0c\u67e5\u8be2\u6bcf\u7ec4\u5b66\u751f\u7684\u603b\u6210\u7ee9\u3002\u6309\u7167\u603b\u6210\u7ee9\u7684\u5347\u5e8f\u6392\u5e8f SELECT gender,SUM(score) getSum FROM student GROUP BY gender ORDER BY getSum ASC; \u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b \u00b6 /* -- \u4fee\u6539\u5206\u9694\u7b26\u4e3a $ DELIMITER $ -- \u6807\u51c6\u8bed\u6cd5 CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ( \u53c2\u6570 ...) BEGIN sql\u8bed\u53e5 ; END $ -- \u4fee\u6539\u5206\u9694\u7b26\u4e3a\u5206\u53f7 DELIMITER ; */ -- \u521b\u5efastu_group()\u5b58\u50a8\u8fc7\u7a0b\uff0c\u5c01\u88c5 \u5206\u7ec4\u67e5\u8be2\u603b\u6210\u7ee9\uff0c\u5e76\u6309\u7167\u603b\u6210\u7ee9\u5347\u5e8f\u6392\u5e8f\u7684\u529f\u80fd DELIMITER $ CREATE PROCEDURE stu_group () BEGIN SELECT gender , SUM ( score ) getSum FROM student GROUP BY gender ORDER BY getSum ASC ; END $ DELIMITER ; \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b \u00b6 /* \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b \u6807\u51c6\u8bed\u6cd5 CALL \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0(\u5b9e\u9645\u53c2\u6570); */ -- \u8c03\u7528stu_group\u5b58\u50a8\u8fc7\u7a0b CALL stu_group(); \u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b \u00b6 /* \u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b \u6807\u51c6\u8bed\u6cd5 SELECT name FROM mysql.proc WHERE db='\u6570\u636e\u5e93\u540d\u79f0'; */ -- \u67e5\u770bdb8\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b SELECT NAME FROM mysql.proc WHERE db='db8'; \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u72b6\u6001\u4fe1\u606f \u00b6 /* \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u72b6\u6001\u4fe1\u606f \u6807\u51c6\u8bed\u6cd5 SHOW PROCEDURE STATUS ; */ -- \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u72b6\u6001\u4fe1\u606f SHOW PROCEDURE STATUS ; \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u521b\u5efa\u8bed\u53e5 \u00b6 /* \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u521b\u5efa\u8bed\u53e5 \u6807\u51c6\u8bed\u6cd5 SHOW CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ; */ -- \u67e5\u8be2stu_group\u5b58\u50a8\u8fc7\u7a0b\u7684\u521b\u5efa\u8bed\u53e5 SHOW CREATE PROCEDURE stu_group ; \u5220\u9664\u5b58\u50a8\u8fc7\u7a0b \u00b6 /* \u5220\u9664\u5b58\u50a8\u8fc7\u7a0b \u6807\u51c6\u8bed\u6cd5 DROP PROCEDURE [IF EXISTS] \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0; */ -- \u5220\u9664stu_group\u5b58\u50a8\u8fc7\u7a0b DROP PROCEDURE IF EXISTS stu_group ; \u5b58\u50a8\u8fc7\u7a0b-\u53d8\u91cf \u00b6 \u5b9a\u4e49\u53d8\u91cf \u00b6 /* \u5b9a\u4e49\u53d8\u91cf \u6807\u51c6\u8bed\u6cd5 DECLARE \u53d8\u91cf\u540d \u6570\u636e\u7c7b\u578b [DEFAULT \u9ed8\u8ba4\u503c]; */ -- \u5b9a\u4e49\u4e00\u4e2aint\u7c7b\u578b\u53d8\u91cf\uff0c\u5e76\u8d4b\u9ed8\u8ba4\u503c\u4e3a10 DELIMITER $ CREATE PROCEDURE pro_test1 () BEGIN -- \u5b9a\u4e49\u53d8\u91cf DECLARE num INT DEFAULT 10 ; -- \u67e5\u8be2\u53d8\u91cf SELECT num ; END $ DELIMITER ; -- \u8c03\u7528pro_test1\u5b58\u50a8\u8fc7\u7a0b CALL pro_test1(); \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e00 \u00b6 /* \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e00 \u6807\u51c6\u8bed\u6cd5 SET \u53d8\u91cf\u540d = \u53d8\u91cf\u503c; */ -- \u5b9a\u4e49\u4e00\u4e2avarchar\u7c7b\u578b\u53d8\u91cf\u5e76\u8d4b\u503c DELIMITER $ CREATE PROCEDURE pro_test2 () BEGIN -- \u5b9a\u4e49\u53d8\u91cf DECLARE NAME VARCHAR ( 10 ); -- \u4e3a\u53d8\u91cf\u8d4b\u503c SET NAME = '\u5b58\u50a8\u8fc7\u7a0b' ; -- \u67e5\u8be2\u53d8\u91cf SELECT NAME ; END $ DELIMITER ; -- \u8c03\u7528pro_test2\u5b58\u50a8\u8fc7\u7a0b CALL pro_test2(); \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e8c /* \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e8c \u6807\u51c6\u8bed\u6cd5 SELECT \u5217\u540d INTO \u53d8\u91cf\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]; */ -- \u5b9a\u4e49\u4e24\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u7537\u5973\u540c\u5b66\u7684\u603b\u5206\u6570 DELIMITER $ CREATE PROCEDURE pro_test3 () BEGIN -- \u5b9a\u4e49\u53d8\u91cf DECLARE men , women INT ; -- \u67e5\u8be2\u7537\u540c\u5b66\u7684\u603b\u5206\u6570\uff0c\u4e3a men\u53d8\u91cf\u8d4b\u503c SELECT SUM ( score ) INTO men FROM student WHERE gender = '\u7537' ; -- \u67e5\u8be2\u5973\u540c\u5b66\u7684\u603b\u5206\u6570\uff0c\u4e3a women\u53d8\u91cf\u8d4b\u503c SELECT SUM ( score ) INTO women FROM student WHERE gender = '\u5973' ; -- \u67e5\u8be2\u53d8\u91cf SELECT men , women ; END $ DELIMITER ; -- \u8c03\u7528pro_test3\u5b58\u50a8\u8fc7\u7a0b CALL pro_test3(); \u5b58\u50a8\u8fc7\u7a0b-if\u8bed\u53e5 \u00b6 /* \u5b58\u50a8\u8fc7\u7a0b - if\u8bed\u53e5 \u6807\u51c6\u8bed\u6cd5 IF \u5224\u65ad\u6761\u4ef6 1 THEN \u6267\u884c\u7684 sql\u8bed\u53e51 ; [ ELSEIF \u5224\u65ad\u6761\u4ef6 2 THEN \u6267\u884c\u7684 sql\u8bed\u53e52 ;] ... [ ELSE \u6267\u884c\u7684 sql\u8bed\u53e5n ;] END IF ; */ / \u5b9a\u4e49\u4e00\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u73ed\u7ea7\u603b\u6210\u7ee9 \u5b9a\u4e49\u4e00\u4e2avarchar\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u6570\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c / DELIMITER $ CREATE PROCEDURE pro_test4 () BEGIN -- \u5b9a\u4e49\u4fdd\u5b58\u603b\u6210\u7ee9\u7684\u53d8\u91cf DECLARE total INT ; -- \u5b9a\u4e49\u4fdd\u5b58\u5206\u6570\u63cf\u8ff0\u7684\u53d8\u91cf DECLARE description VARCHAR ( 10 ); -- \u4e3a total\u8d4b\u503c SELECT SUM ( score ) INTO total FROM student ; -- \u5224\u65ad\u603b\u6210\u7ee9 IF total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; ELSEIF total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END IF ; -- \u67e5\u8be2\u603b\u6210\u7ee9\u548c\u63cf\u8ff0\u4fe1\u606f SELECT total , description ; END $ DELIMITER ; -- \u8c03\u7528pro_test4\u5b58\u50a8\u8fc7\u7a0b CALL pro_test4(); \u5b58\u50a8\u8fc7\u7a0b_\u8f93\u5165\u53c2\u6570 \u00b6 /* \u8f93\u5165\u53c2\u6570 DELIMITER $ -- \u6807\u51c6\u8bed\u6cd5 CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ( IN \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b ) BEGIN \u6267\u884c\u7684 sql\u8bed\u53e5 ; END $ DELIMITER ; */ / \u8f93\u5165\u603b\u6210\u7ee9\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9 \u5b9a\u4e49\u4e00\u4e2avarchar\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u6570\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c / DELIMITER $ CREATE PROCEDURE pro_test5 ( IN total INT ) BEGIN -- \u5b9a\u4e49\u5206\u6570\u63cf\u8ff0\u53d8\u91cf DECLARE description VARCHAR ( 10 ); -- \u5224\u65ad\u603b\u6210\u7ee9 IF total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; ELSEIF total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END IF ; -- \u67e5\u8be2\u603b\u6210\u7ee9\u548c\u63cf\u8ff0\u4fe1\u606f SELECT total , description ; END $ DELIMITER ; -- \u8c03\u7528pro_test5\u5b58\u50a8\u8fc7\u7a0b CALL pro_test5(310); CALL pro_test5((SELECT SUM(score) FROM student)); \u5b58\u50a8\u8fc7\u7a0b_\u8f93\u51fa\u53c2\u6570 \u00b6 /* \u8f93\u51fa\u53c2\u6570 DELIMITER $ -- \u6807\u51c6\u8bed\u6cd5 CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ( OUT \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b ) BEGIN \u6267\u884c\u7684 sql\u8bed\u53e5 ; END $ DELIMITER ; */ /\u8f93\u5165\u603b\u6210\u7ee9\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9 \u8f93\u51fa\u5206\u6570\u63cf\u8ff0\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9\u7684\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c */ DELIMITER $ CREATE PROCEDURE pro_test6 ( IN total INT , OUT description VARCHAR ( 10 )) BEGIN -- \u5224\u65ad\u603b\u6210\u7ee9 IF total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; ELSEIF total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END IF ; END $ DELIMITER ; -- \u8c03\u7528pro_test6\u5b58\u50a8\u8fc7\u7a0b CALL pro_test6 ( 390 , @description ); -- \u67e5\u8be2\u603b\u6210\u7ee9\u63cf\u8ff0\u4fe1\u606f\u53d8\u91cf SELECT @description ; \u5b58\u50a8\u8fc7\u7a0b_case\u8bed\u53e5 \u00b6 /* case\u8bed\u53e5 \u6807\u51c6\u8bed\u6cd5 CASE WHEN \u5224\u65ad\u6761\u4ef6 1 THEN \u6267\u884c sql\u8bed\u53e51 ; [ WHEN \u5224\u65ad\u6761\u4ef6 2 THEN \u6267\u884c sql\u8bed\u53e52 ;] ... [ ELSE \u6267\u884c sql\u8bed\u53e5n ;] END CASE ; */ / \u8f93\u5165\u603b\u6210\u7ee9\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9 \u5b9a\u4e49\u4e00\u4e2avarchar\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u6570\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c / DELIMITER $ CREATE PROCEDURE pro_test7 ( IN total INT ) BEGIN -- \u5b9a\u4e49\u603b\u6210\u7ee9\u63cf\u8ff0\u4fe1\u606f\u53d8\u91cf DECLARE description VARCHAR ( 10 ); -- \u5224\u65ad\u603b\u6210\u7ee9 CASE WHEN total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; WHEN total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END CASE ; -- \u67e5\u8be2\u603b\u6210\u7ee9\u548c\u63cf\u8ff0\u4fe1\u606f SELECT total , description ; END $ DELIMITER ; -- \u8c03\u7528pro_test7\u5b58\u50a8\u8fc7\u7a0b CALL pro_test7(310); \u5b58\u50a8\u8fc7\u7a0b_while\u5faa\u73af \u00b6 /* while\u5faa\u73af \u6807\u51c6\u8bed\u6cd5 \u521d\u59cb\u5316\u8bed\u53e5 ; WHILE \u6761\u4ef6\u5224\u65ad\u8bed\u53e5 DO \u5faa\u73af\u4f53\u8bed\u53e5 ; \u6761\u4ef6\u63a7\u5236\u8bed\u53e5 ; END WHILE ; */ -- \u8ba1\u7b971~100\u4e4b\u95f4\u7684\u5076\u6570\u548c DELIMITER $ CREATE PROCEDURE pro_test8 () BEGIN -- \u5b9a\u4e49\u6c42\u548c\u53d8\u91cf DECLARE result INT DEFAULT 0 ; -- \u5b9a\u4e49\u521d\u59cb\u5316\u53d8\u91cf DECLARE num INT DEFAULT 1 ; -- while\u5faa\u73af WHILE num <= 100 DO -- \u5224\u65ad num\u662f\u5426\u662f\u5076\u6570 IF num % 2 = 0 THEN -- \u8ba9 num\u548cresult\u8fdb\u884c\u7d2f\u52a0 SET result = result + num ; END IF ; -- \u8ba9 num\u8fdb\u884c\u81ea\u589e SET num = num + 1 ; END WHILE ; -- \u67e5\u8be2\u6c42\u548c\u7ed3\u679c SELECT result ; END $ DELIMITER ; -- \u8c03\u7528pro_test8\u5b58\u50a8\u8fc7\u7a0b CALL pro_test8(); \u5b58\u50a8\u8fc7\u7a0b_repeat\u5faa\u73af \u00b6 /* repeat\u5faa\u73af \u6807\u51c6\u8bed\u6cd5 \u521d\u59cb\u5316\u8bed\u53e5 ; REPEAT \u5faa\u73af\u4f53\u8bed\u53e5 ; \u6761\u4ef6\u63a7\u5236\u8bed\u53e5 ; UNTIL \u6761\u4ef6\u5224\u65ad\u8bed\u53e5 END REPEAT ; */ -- \u8ba1\u7b971~10\u4e4b\u95f4\u7684\u548c DELIMITER $ CREATE PROCEDURE pro_test9 () BEGIN -- \u5b9a\u4e49\u6c42\u548c\u53d8\u91cf DECLARE result INT DEFAULT 0 ; -- \u5b9a\u4e49\u521d\u59cb\u5316\u53d8\u91cf DECLARE num INT DEFAULT 1 ; -- repeat\u5faa\u73af REPEAT -- \u7d2f\u52a0 SET result = result + num ; -- \u8ba9 num + 1 SET num = num + 1 ; -- \u505c\u6b62\u5faa\u73af UNTIL num > 10 END REPEAT ; -- \u67e5\u8be2\u6c42\u548c\u7ed3\u679c SELECT result ; END $ DELIMITER ; -- \u8c03\u7528pro_test9\u5b58\u50a8\u8fc7\u7a0b CALL pro_test9(); \u5b58\u50a8\u8fc7\u7a0b_loop\u5faa\u73af \u00b6 /* loop\u5faa\u73af \u6807\u51c6\u8bed\u6cd5 \u521d\u59cb\u5316\u8bed\u53e5; [ \u5faa\u73af\u540d\u79f0 : ] LOOP \u6761\u4ef6\u5224\u65ad\u8bed\u53e5 [ LEAVE \u5faa\u73af\u540d\u79f0 ; ] \u5faa\u73af\u4f53\u8bed\u53e5; \u6761\u4ef6\u63a7\u5236\u8bed\u53e5; END LOOP \u5faa\u73af\u540d\u79f0; */ -- \u8ba1\u7b971~10\u4e4b\u95f4\u7684\u548c DELIMITER $ CREATE PROCEDURE pro_test10 () BEGIN -- \u5b9a\u4e49\u6c42\u548c\u53d8\u91cf DECLARE result INT DEFAULT 0 ; -- \u5b9a\u4e49\u521d\u59cb\u5316\u53d8\u91cf DECLARE num INT DEFAULT 1 ; -- loop\u5faa\u73af l : LOOP -- \u6761\u4ef6\u5224\u65ad \uff0c \u505c\u6b62\u5faa\u73af IF num > 10 THEN LEAVE l ; END IF ; -- \u7d2f\u52a0 SET result = result + num ; -- \u8ba9num + 1 SET num = num + 1 ; END LOOP l ; -- \u67e5\u8be2\u6c42\u548c\u7ed3\u679c SELECT result ; END $ DELIMITER ; -- \u8c03\u7528pro_test10\u5b58\u50a8\u8fc7\u7a0b CALL pro_test10(); \u5b58\u50a8\u8fc7\u7a0b_\u6e38\u6807 \u00b6 /* \u6e38\u6807 \u6807\u51c6\u8bed\u6cd5 1.\u521b\u5efa\u6e38\u6807\uff1aDECLARE \u6e38\u6807\u540d\u79f0 CURSOR FOR \u67e5\u8be2sql\u8bed\u53e5; 2.\u6253\u5f00\u6e38\u6807\uff1aOPEN \u6e38\u6807\u540d\u79f0; 3.\u4f7f\u7528\u6e38\u6807\uff1aFETCH \u6e38\u6807\u540d\u79f0 INTO \u53d8\u91cf\u540d1,\u53d8\u91cf\u540d2,...; 4.\u5173\u95ed\u6e38\u6807\uff1aCLOSE \u6e38\u6807\u540d\u79f0; */ -- \u521b\u5efastu_score\u8868 CREATE TABLE stu_score( id INT PRIMARY KEY AUTO_INCREMENT, score INT ); -- \u5c06student\u8868\u4e2d\u6240\u6709\u7684\u6210\u7ee9\u4fdd\u5b58\u5230stu_score\u8868\u4e2d DELIMITER $ CREATE PROCEDURE pro_test11 () BEGIN -- \u5b9a\u4e49\u4e00\u4e2a\u4fdd\u5b58\u6210\u7ee9\u7684\u53d8\u91cf DECLARE s_score INT ; -- \u521b\u5efa\u6e38\u6807 DECLARE stu_result CURSOR FOR SELECT score FROM student ; -- \u5f00\u542f\u6e38\u6807 OPEN stu_result ; -- \u4f7f\u7528\u6e38\u6807 -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 1 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 2 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 3 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 4 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u5173\u95ed\u6e38\u6807 CLOSE stu_result ; END $ DELIMITER ; -- \u8c03\u7528pro_test11\u5b58\u50a8\u8fc7\u7a0b CALL pro_test11(); -- \u67e5\u8be2stu_score\u6570\u636e\u8868 SELECT * FROM stu_score; \u5b58\u50a8\u8fc7\u7a0b_\u6e38\u6807\u4f18\u5316 \u00b6 /* \u5f53\u6e38\u6807\u7ed3\u675f\u540e\uff0c\u4f1a\u81ea\u52a8\u7684\u89e6\u53d1\u4e00\u4e2a\u4e8b\u4ef6\u3002\u5c31\u4ee3\u8868\u6e38\u6807\u5df2\u7ecf\u7ed3\u675f\u4e86\uff01 \u52a0\u6807\u8bb0\u7684\u601d\u60f3\uff1a 1.\u5b9a\u4e49\u4e00\u4e2a\u6807\u8bb0\u53d8\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff08\u610f\u5473\u7740\u6709\u6570\u636e\uff09 2.\u5f53\u6e38\u6807\u7ed3\u675f\u540e\uff0c\u5c06\u6807\u8bb0\u53d8\u91cf\u7684\u503c\u4fee\u6539\u4e3a1\uff08\u610f\u5473\u7740\u6ca1\u6709\u6570\u636e\u4e86\uff09 */ DELIMITER $ CREATE PROCEDURE pro_test12 () BEGIN -- \u5b9a\u4e49\u4e00\u4e2a\u4fdd\u5b58\u6210\u7ee9\u7684\u53d8\u91cf DECLARE s_score INT ; -- \u5b9a\u4e49\u4e00\u4e2a\u6807\u8bb0\u53d8\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a 0 \uff08\u610f\u5473\u7740\u6709\u6570\u636e\uff09 DECLARE flag INT DEFAULT 0 ; -- \u521b\u5efa\u6e38\u6807 DECLARE stu_result CURSOR FOR SELECT score FROM student ; -- \u5f53\u6e38\u6807\u7ed3\u675f\u540e\uff0c\u5c06\u6807\u8bb0\u53d8\u91cf\u7684\u503c\u4fee\u6539\u4e3a 1 \uff08\u610f\u5473\u7740\u6ca1\u6709\u6570\u636e\u4e86\uff09 DECLARE EXIT HANDLER FOR NOT FOUND SET flag = 1 ; -- \u5f00\u542f\u6e38\u6807 OPEN stu_result ; -- \u5faa\u73af\u4f7f\u7528\u6e38\u6807 REPEAT -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u5f53 flag\u7684\u503c\u662f1\u7684\u65f6\u5019 \uff0c\u5c31\u505c\u6b62\u5faa\u73af UNTIL flag = 1 END REPEAT ; -- \u5173\u95ed\u6e38\u6807 CLOSE stu_result ; END $ DELIMITER ; -- \u8c03\u7528pro_test12\u5b58\u50a8\u8fc7\u7a0b CALL pro_test12(); -- \u67e5\u8be2stu_score\u8868 SELECT * FROM stu_score; \u5b58\u50a8\u51fd\u6570 \u00b6 \u521b\u5efa\u5b58\u50a8\u51fd\u6570 \u00b6 /* \u521b\u5efa\u5b58\u50a8\u51fd\u6570 \u6807\u51c6\u8bed\u6cd5 CREATE FUNCTION \u51fd\u6570\u540d\u79f0 ([ \u53c2\u6570 \u6570\u636e\u7c7b\u578b ]) RETURNS \u8fd4\u56de\u503c\u7c7b\u578b BEGIN \u6267\u884c\u7684 sql\u8bed\u53e5 ; RETURN \u7ed3\u679c ; END $ */ -- \u5b9a\u4e49\u5b58\u50a8\u51fd\u6570\uff0c\u83b7\u53d6\u5b66\u751f\u8868\u4e2d\u6210\u7ee9\u5927\u4e8e95\u5206\u7684\u5b66\u751f\u6570\u91cf DELIMITER $ CREATE FUNCTION fun_test1 () RETURNS INT BEGIN -- \u5b9a\u4e49\u4e00\u4e2a\u7edf\u8ba1\u53d8\u91cf DECLARE result INT ; -- \u67e5\u8be2\u6210\u7ee9\u5927\u4e8e 95 \u5206\u7684\u6570\u91cf SELECT COUNT ( * ) INTO result FROM student WHERE score > 95 ; -- \u5c06\u7ed3\u679c\u8fd4\u56de RETURN result ; END $ DELIMITER ; \u8c03\u7528\u51fd\u6570 \u00b6 /* \u8c03\u7528\u51fd\u6570 \u6807\u51c6\u8bed\u6cd5 SELECT \u51fd\u6570\u540d\u79f0(\u5b9e\u9645\u53c2\u6570); */ -- \u8c03\u7528\u51fd\u6570 SELECT fun_test1(); \u5220\u9664\u51fd\u6570 \u00b6 /* \u5220\u9664\u51fd\u6570 \u6807\u51c6\u8bed\u6cd5 DROP FUNCTION \u51fd\u6570\u540d\u79f0; */ -- \u5220\u9664\u51fd\u6570 DROP FUNCTION fun_test1; 03\u89e6\u53d1\u5668 \u00b6 \u89e6\u53d1\u5668\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb9\u6570\u636e\u5e93 CREATE DATABASE db9; -- \u4f7f\u7528db9\u6570\u636e\u5e93 USE db9; -- \u521b\u5efa\u8d26\u6237\u8868account CREATE TABLE account( id INT PRIMARY KEY AUTO_INCREMENT, -- \u8d26\u6237id NAME VARCHAR(20), -- \u59d3\u540d money DOUBLE -- \u4f59\u989d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO account VALUES (NULL,'\u5f20\u4e09',1000),(NULL,'\u674e\u56db',2000); -- \u521b\u5efa\u65e5\u5fd7\u8868account_log CREATE TABLE account_log( id INT PRIMARY KEY AUTO_INCREMENT, -- \u65e5\u5fd7id operation VARCHAR(20), -- \u64cd\u4f5c\u7c7b\u578b (insert update delete) operation_time DATETIME, -- \u64cd\u4f5c\u65f6\u95f4 operation_id INT, -- \u64cd\u4f5c\u8868\u7684id operation_params VARCHAR(200) -- \u64cd\u4f5c\u53c2\u6570 ); INSERT\u578b\u89e6\u53d1\u5668 \u00b6 /* \u521b\u5efa\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DELIMITER $ CREATE TRIGGER \u89e6\u53d1\u5668\u540d\u79f0 BEFORE | AFTER INSERT | UPDATE | DELETE ON \u8868\u540d FOR EACH ROW BEGIN \u89e6\u53d1\u5668\u8981\u6267\u884c\u7684\u529f\u80fd ; END $ DELIMITER ; */ -- \u521b\u5efaINSERT\u578b\u89e6\u53d1\u5668\u3002\u7528\u4e8e\u5bf9account\u8868\u65b0\u589e\u6570\u636e\u8fdb\u884c\u65e5\u5fd7\u7684\u8bb0\u5f55 DELIMITER $ CREATE TRIGGER account_insert AFTER INSERT ON account FOR EACH ROW BEGIN INSERT INTO account_log VALUES ( NULL , 'INSERT' , NOW (), new . id , CONCAT ( '\u63d2\u5165\u540e{id=' , new . id , ',name=' , new . name , ',money=' , new . money , '}' )); END $ DELIMITER ; -- \u5411account\u8868\u6765\u6dfb\u52a0\u4e00\u6761\u8bb0\u5f55 INSERT INTO account VALUES (NULL,'\u738b\u4e94',3000); -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u67e5\u8be2account_log\u8868 SELECT * FROM account_log; UPDATE\u578b\u89e6\u53d1\u5668 \u00b6 /* \u521b\u5efa\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DELIMITER $ CREATE TRIGGER \u89e6\u53d1\u5668\u540d\u79f0 BEFORE | AFTER INSERT | UPDATE | DELETE ON \u8868\u540d FOR EACH ROW BEGIN \u89e6\u53d1\u5668\u8981\u6267\u884c\u7684\u529f\u80fd ; END $ DELIMITER ; */ -- \u521b\u5efaUPDATE\u578b\u89e6\u53d1\u5668\u3002\u7528\u4e8e\u5bf9account\u8868\u4fee\u6539\u6570\u636e\u8fdb\u884c\u65e5\u5fd7\u7684\u8bb0\u5f55 DELIMITER $ CREATE TRIGGER account_update AFTER UPDATE ON account FOR EACH ROW BEGIN INSERT INTO account_log VALUES ( NULL , 'UPDATE' , NOW (), new . id , CONCAT ( '\u4fee\u6539\u524d{id=' , old . id , ',name=' , old . name , ',money=' , old . money , '}' , '\u4fee\u6539\u540e{id=' , new . id , ',name=' , new . name , ',money=' , new . money , '}' )); END $ DELIMITER ; -- \u4fee\u6539account\u8868\u4e2d\u674e\u56db\u7684\u91d1\u989d\u4e3a2500 UPDATE account SET money=2500 WHERE NAME='\u674e\u56db'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u67e5\u8be2account_log\u8868 SELECT * FROM account_log; DELETE\u578b\u89e6\u53d1\u5668 \u00b6 /* \u521b\u5efa\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DELIMITER $ CREATE TRIGGER \u89e6\u53d1\u5668\u540d\u79f0 BEFORE | AFTER INSERT | UPDATE | DELETE ON \u8868\u540d FOR EACH ROW BEGIN \u89e6\u53d1\u5668\u8981\u6267\u884c\u7684\u529f\u80fd ; END $ DELIMITER ; */ -- \u521b\u5efaDELETE\u578b\u89e6\u53d1\u5668\u3002\u7528\u4e8e\u5bf9account\u8868\u5220\u9664\u6570\u636e\u8fdb\u884c\u65e5\u5fd7\u7684\u8bb0\u5f55 DELIMITER $ CREATE TRIGGER account_delete AFTER DELETE ON account FOR EACH ROW BEGIN INSERT INTO account_log VALUES ( NULL , 'DELETE' , NOW (), old . id , CONCAT ( '\u5220\u9664\u524d{id=' , old . id , ',name=' , old . name , ',money=' , old . money , '}' )); END $ DELIMITER ; -- \u5220\u9664account\u8868\u4e2d\u738b\u4e94 DELETE FROM account WHERE NAME='\u738b\u4e94'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u67e5\u8be2account_log\u8868 SELECT * FROM account_log; \u67e5\u770b\u89e6\u53d1\u5668 \u00b6 /* \u67e5\u770b\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 SHOW TRIGGERS; */ -- \u67e5\u770b\u89e6\u53d1\u5668 SHOW TRIGGERS ; \u5220\u9664\u89e6\u53d1\u5668 \u00b6 /* \u5220\u9664\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DROP TRIGGER \u89e6\u53d1\u5668\u540d\u79f0; */ -- \u5220\u9664\u89e6\u53d1\u5668 DROP TRIGGER account_delete; 04\u4e8b\u52a1 \u00b6 \u4e8b\u52a1\u7684\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb10\u6570\u636e\u5e93 CREATE DATABASE db10; -- \u4f7f\u7528db10\u6570\u636e\u5e93 USE db10; -- \u521b\u5efa\u8d26\u6237\u8868 CREATE TABLE account( id INT PRIMARY KEY AUTO_INCREMENT, -- \u8d26\u6237id NAME VARCHAR(20), -- \u8d26\u6237\u540d\u79f0 money DOUBLE -- \u8d26\u6237\u4f59\u989d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO account VALUES (NULL,'\u5f20\u4e09',1000),(NULL,'\u674e\u56db',1000); \u672a\u7ba1\u7406\u4e8b\u52a1 \u00b6 -- \u5f20\u4e09\u7ed9\u674e\u56db\u8f6c\u8d26500\u5143 -- 1.\u5f20\u4e09\u8d26\u6237-500 UPDATE account SET money=money-500 WHERE NAME='\u5f20\u4e09'; \u51fa\u9519\u4e86... -- 2.\u674e\u56db\u8d26\u6237+500 UPDATE account SET money=money+500 WHERE NAME='\u674e\u56db'; \u7ba1\u7406\u4e8b\u52a1 \u00b6 /* \u5f00\u542f\u4e8b\u52a1\uff1aSTART TRANSACTION; \u56de\u6eda\u4e8b\u52a1\uff1aROLLBACK; \u63d0\u4ea4\u4e8b\u52a1\uff1aCOMMIT; */ -- \u5f20\u4e09\u7ed9\u674e\u56db\u8f6c\u8d26500\u5143 -- 1.\u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- 2.\u6267\u884c\u8f6c\u8d26\u7684\u64cd\u4f5c UPDATE account SET money=money-500 WHERE NAME='\u5f20\u4e09'; \u51fa\u9519\u4e86... UPDATE account SET money=money+500 WHERE NAME='\u674e\u56db'; -- 3.\u7ed3\u675f\u4e8b\u52a1 -- 3.1\u56de\u6eda\u4e8b\u52a1 ROLLBACK; -- 3.2\u63d0\u4ea4\u4e8b\u52a1 COMMIT; \u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f \u00b6 /* \u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f \u67e5\u8be2\u4e8b\u52a1\u63d0\u4ea4\u65b9\u5f0f\uff1aSELECT @@AUTOCOMMIT; -- 1\u4ee3\u8868\u81ea\u52a8\u63d0\u4ea4 0\u4ee3\u8868\u624b\u52a8\u63d0\u4ea4 \u4fee\u6539\u4e8b\u52a1\u63d0\u4ea4\u65b9\u5f0f\uff1aSET @@AUTOCOMMIT=\u6570\u5b57; */ -- \u67e5\u8be2\u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f SELECT @@autocommit ; UPDATE account SET money = 1000 WHERE NAME = '\u5f20\u4e09' ; COMMIT ; -- \u4fee\u6539\u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f SET @@autocommit = 0 ; \u67e5\u8be2\u548c\u4fee\u6539\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b \u00b6 /* \u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b \u67e5\u8be2\u9694\u79bb\u7ea7\u522b\uff1aSELECT @@TX_ISOLATION; \u4fee\u6539\u9694\u79bb\u7ea7\u522b\uff1aSET GLOBAL TRANSACTION ISOLATION LEVEL \u7ea7\u522b\u5b57\u7b26\u4e32; */ -- \u67e5\u8be2\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u4fee\u6539\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED; \u810f\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e31 \u00b6 /* \u810f\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3 \u810f\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u8bfb\u53d6\u5230\u4e86\u5176\u4ed6\u4e8b\u52a1\u672a\u63d0\u4ea4\u7684\u6570\u636e */ -- \u8bbe\u7f6e\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3aread uncommitted SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED; SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u8f6c\u8d26 UPDATE account SET money = money-500 WHERE NAME='\u5f20\u4e09'; UPDATE account SET money = money+500 WHERE NAME='\u674e\u56db'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u56de\u6eda ROLLBACK; \u810f\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e32 \u00b6 -- \u67e5\u8be2\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2account\u8868 SELECT * FROM account; \u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e31 \u00b6 /* \u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3 \u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u8bfb\u53d6\u5230\u4e86\u5176\u4ed6\u4e8b\u52a1\u5df2\u63d0\u4ea4\u7684\u6570\u636e */ -- \u8bbe\u7f6e\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3aread committed SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED; SET GLOBAL TRANSACTION ISOLATION LEVEL REPEATABLE READ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u8f6c\u8d26 UPDATE account SET money = money-500 WHERE NAME='\u5f20\u4e09'; UPDATE account SET money = money+500 WHERE NAME='\u674e\u56db'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT; \u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e32 \u00b6 -- \u67e5\u8be2\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT; \u5e7b\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e31 \u00b6 /* \u5e7b\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3 \u5e7b\u8bfb\uff1a \u67e5\u8be2\u67d0\u8bb0\u5f55\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u5b58\u5728 \u51c6\u5907\u63d2\u5165\u6b64\u8bb0\u5f55\uff0c\u4f46\u6267\u884c\u63d2\u5165\u65f6\u53d1\u73b0\u6b64\u8bb0\u5f55\u5df2\u5b58\u5728\uff0c\u65e0\u6cd5\u63d2\u5165 \u6216\u67d0\u8bb0\u5f55\u4e0d\u5b58\u5728\u6267\u884c\u5220\u9664\uff0c\u5374\u53d1\u73b0\u5220\u9664\u6210\u529f */ -- \u8bbe\u7f6e\u9694\u79bb\u7ea7\u522b\u4e3arepeatable read SET GLOBAL TRANSACTION ISOLATION LEVEL REPEATABLE READ; SET GLOBAL TRANSACTION ISOLATION LEVEL SERIALIZABLE; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u6dfb\u52a0\u8bb0\u5f55 INSERT INTO account VALUES (4,'\u8d75\u516d',2000); -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT; \u5e7b\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e32 \u00b6 -- \u67e5\u8be2\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u6dfb\u52a0 INSERT INTO account VALUES (3,'\u738b\u4e94',2000); day04 \u00b6 01\u5b58\u50a8\u5f15\u64ce \u00b6 \u67e5\u8be2\u6570\u636e\u5e93\u652f\u6301\u7684\u5b58\u50a8\u5f15\u64ce \u00b6 /* \u67e5\u8be2\u6570\u636e\u5e93\u652f\u6301\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 SHOW ENGINES; */ \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u6240\u6709\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u00b6 /* \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u6240\u6709\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 SHOW TABLE STATUS FROM \u6570\u636e\u5e93\u540d\u79f0; */ \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u67d0\u4e2a\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u00b6 /* \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u67d0\u4e2a\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 SHOW TABLE STATUS FROM \u6570\u636e\u5e93\u540d\u79f0 WHERE NAME = '\u6570\u636e\u8868\u540d\u79f0'; */ \u521b\u5efa\u6570\u636e\u8868\u6307\u5b9a\u5b58\u50a8\u5f15\u64ce \u00b6 /* \u521b\u5efa\u6570\u636e\u8868\u6307\u5b9a\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 CREATE TABLE \u8868\u540d( \u5217\u540d,\u6570\u636e\u7c7b\u578b, ... )ENGINE = \u5f15\u64ce\u540d\u79f0; */ \u4fee\u6539\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u00b6 /* \u4fee\u6539\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 ALTER TABLE \u8868\u540d ENGINE = \u5f15\u64ce\u540d\u79f0; */ -- \u4fee\u6539engine_test\u8868\u7684\u5f15\u64ce\u4e3aInnoDB ALTER TABLE engine_test ENGINE = INNODB; -- \u67e5\u8be2engine_test\u8868\u7684\u5b58\u50a8\u5f15\u64ce SHOW TABLE STATUS FROM db11 WHERE NAME = ' engine_test ' ; 02\u7d22\u5f15 \u00b6 \u7d22\u5f15\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb12\u6570\u636e\u5e93 CREATE DATABASE db12; -- \u4f7f\u7528db12\u6570\u636e\u5e93 USE db12; -- \u521b\u5efastudent\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(10), age INT, score INT ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,98),(NULL,'\u674e\u56db',24,95), (NULL,'\u738b\u4e94',25,96),(NULL,'\u8d75\u516d',26,94),(NULL,'\u5468\u4e03',27,99); \u521b\u5efa\u548c\u67e5\u8be2\u7d22\u5f15 \u00b6 \u521b\u5efa\u7d22\u5f15 \u00b6 /* \u521b\u5efa\u7d22\u5f15 \u6807\u51c6\u8bed\u6cd5 CREATE [UNIQUE|FULLTEXT] INDEX \u7d22\u5f15\u540d\u79f0 [USING \u7d22\u5f15\u7c7b\u578b] -- \u9ed8\u8ba4\u662fB+TREE ON \u8868\u540d(\u5217\u540d...); */ -- \u4e3astudent\u8868\u4e2d\u7684name\u5217\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7d22\u5f15 CREATE INDEX idx_name ON student(NAME); -- \u4e3astudent\u8868\u4e2d\u7684age\u5217\u521b\u5efa\u4e00\u4e2a\u552f\u4e00\u7d22\u5f15 CREATE UNIQUE INDEX idx_age ON student(age); \u67e5\u8be2\u7d22\u5f15 \u00b6 /* \u67e5\u8be2\u7d22\u5f15 \u6807\u51c6\u8bed\u6cd5 SHOW INDEX FROM \u8868\u540d; */ -- \u67e5\u8be2student\u8868\u4e2d\u7684\u7d22\u5f15 SHOW INDEX FROM student ; ALTER\u6dfb\u52a0\u7d22\u5f15 \u00b6 /* ALTER\u6dfb\u52a0\u7d22\u5f15 -- \u666e\u901a\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD INDEX \u7d22\u5f15\u540d\u79f0(\u5217\u540d); -- \u7ec4\u5408\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD INDEX \u7d22\u5f15\u540d\u79f0(\u5217\u540d1,\u5217\u540d2,...); -- \u4e3b\u952e\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD PRIMARY KEY(\u4e3b\u952e\u5217\u540d); -- \u5916\u952e\u7d22\u5f15(\u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u5c31\u662f\u5916\u952e\u7d22\u5f15) ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d); -- \u552f\u4e00\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD UNIQUE \u7d22\u5f15\u540d\u79f0(\u5217\u540d); -- \u5168\u6587\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD FULLTEXT \u7d22\u5f15\u540d\u79f0(\u5217\u540d); */ -- \u4e3astudent\u8868\u4e2dname\u5217\u6dfb\u52a0\u5168\u6587\u7d22\u5f15 ALTER TABLE student ADD FULLTEXT idx_fulltext_name(NAME); -- \u67e5\u8be2student\u8868\u7684\u7d22\u5f15 SHOW INDEX FROM student ; \u5220\u9664\u7d22\u5f15 \u00b6 /* \u5220\u9664\u7d22\u5f15 \u6807\u51c6\u8bed\u6cd5 DROP INDEX \u7d22\u5f15\u540d\u79f0 ON \u8868\u540d; */ -- \u5220\u9664idx_name\u7d22\u5f15 DROP INDEX idx_name ON student; \u7d22\u5f15\u7684\u6548\u7387\u6d4b\u8bd5 \u00b6 -- \u521b\u5efa product\u5546\u54c1\u8868 CREATE TABLE product ( id INT PRIMARY KEY AUTO_INCREMENT , -- \u5546\u54c1 id NAME VARCHAR ( 10 ), -- \u5546\u54c1\u540d\u79f0 price INT -- \u5546\u54c1\u4ef7\u683c ); -- \u5b9a\u4e49\u5b58\u50a8\u51fd\u6570\uff0c\u751f\u6210\u957f\u5ea6\u4e3a 10 \u7684\u968f\u673a\u5b57\u7b26\u4e32\u5e76\u8fd4\u56de DELIMITER $ CREATE FUNCTION rand_string () RETURNS VARCHAR ( 255 ) BEGIN DECLARE big_str VARCHAR ( 100 ) DEFAULT 'abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ' ; DECLARE small_str VARCHAR ( 255 ) DEFAULT '' ; DECLARE i INT DEFAULT 1 ; WHILE i <= 10 DO SET small_str = CONCAT ( small_str , SUBSTRING ( big_str , FLOOR ( 1 + RAND () * 52 ), 1 )); SET i = i + 1 ; END WHILE ; RETURN small_str ; END $ DELIMITER ; -- \u5b9a\u4e49\u5b58\u50a8\u8fc7\u7a0b\uff0c\u6dfb\u52a0 100 \u4e07\u6761\u6570\u636e\u5230 product\u8868\u4e2d DELIMITER $ CREATE PROCEDURE pro_test () BEGIN DECLARE num INT DEFAULT 1 ; WHILE num <= 1000000 DO INSERT INTO product VALUES ( NULL , rand_string (), num ); SET num = num + 1 ; END WHILE ; END $ DELIMITER ; -- \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b CALL pro_test (); -- \u67e5\u8be2\u603b\u8bb0\u5f55\u6761\u6570 SELECT COUNT ( * ) FROM product ; -- \u67e5\u8be2 product\u8868\u7684\u7d22\u5f15 SHOW INDEX FROM product ; -- \u67e5\u8be2 name\u4e3aOkIKDLVwtG\u7684\u6570\u636e ( 0.049 ) SELECT * FROM product WHERE NAME = 'OkIKDLVwtG' ; -- \u901a\u8fc7 id\u5217\u67e5\u8be2OkIKDLVwtG\u7684\u6570\u636e ( 1 \u6beb\u79d2 ) SELECT * FROM product WHERE id = 999998 ; -- \u4e3a name\u5217\u6dfb\u52a0\u7d22\u5f15 ALTER TABLE product ADD INDEX idx_name ( NAME ); -- \u67e5\u8be2 name\u4e3aOkIKDLVwtG\u7684\u6570\u636e ( 0.001 ) SELECT * FROM product WHERE NAME = 'OkIKDLVwtG' ; /* \u8303\u56f4\u67e5\u8be2 */ -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e ( 0.052 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ; /* \u6392\u5e8f\u67e5\u8be2 */ -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e , \u964d\u5e8f\u6392\u5217 ( 0.083 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ORDER BY price DESC ; -- \u4e3a price\u5217\u6dfb\u52a0\u7d22\u5f15 ALTER TABLE product ADD INDEX idx_price ( price ); -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e ( 0.011 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ; -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e , \u964d\u5e8f\u6392\u5217 ( 0.001 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ORDER BY price DESC ; 03\u9501 \u00b6 InnoDB\u9501\u7684\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efadb13\u6570\u636e\u5e93 CREATE DATABASE db13; -- \u4f7f\u7528db13\u6570\u636e\u5e93 USE db13; -- \u521b\u5efastudent\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(10), age INT, score INT ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,99),(NULL,'\u674e\u56db',24,95), (NULL,'\u738b\u4e94',25,98),(NULL,'\u8d75\u516d',26,97); InnoDB\u5171\u4eab\u9501_\u7a97\u53e31 \u00b6 -- \u7a97\u53e31 /* \u5171\u4eab\u9501\uff1a\u6570\u636e\u53ef\u4ee5\u88ab\u591a\u4e2a\u4e8b\u52a1\u67e5\u8be2\uff0c\u4f46\u662f\u4e0d\u80fd\u4fee\u6539 \u521b\u5efa\u9501\u7684\u683c\u5f0f SELECT\u8bed\u53e5 LOCK IN SHARE MODE; */ -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2id\u4e3a1\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501 SELECT * FROM student WHERE id=1 LOCK IN SHARE MODE; -- \u67e5\u8be2\u5206\u6570\u4e3a99\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501 SELECT * FROM student WHERE score=99 LOCK IN SHARE MODE; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT; InnoDB\u5171\u4eab\u9501_\u7a97\u53e32 \u00b6 -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2id\u4e3a1\u7684\u6570\u636e\u8bb0\u5f55\u3002(\u666e\u901a\u67e5\u8be2\u6ca1\u95ee\u9898) SELECT * FROM student WHERE id=1; -- \u67e5\u8be2id\u4e3a1\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501(\u5171\u4eab\u9501\u548c\u5171\u4eab\u9501\u662f\u517c\u5bb9\u7684) SELECT * FROM student WHERE id=1 LOCK IN SHARE MODE; -- \u4fee\u6539id\u4e3a1\u7684\u6570\u636e\u3002\u4fee\u6539\u59d3\u540d\u4e3a\u5f20\u4e09\u4e09(\u4fee\u6539\u5931\u8d25\uff0c\u4f1a\u51fa\u73b0\u9501\u7684\u60c5\u51b5\u3002\u53ea\u6709\u7a97\u53e31\u63d0\u4ea4\u4e8b\u52a1\u540e\uff0c\u624d\u80fd\u4fee\u6539\u6210\u529f) UPDATE student SET NAME='\u5f20\u4e09\u4e09' WHERE id=1; -- \u4fee\u6539id\u4e3a2\u7684\u6570\u636e\u3002\u4fee\u6539\u59d3\u540d\u4e3a\u674e\u56db\u56db(\u4fee\u6539\u6210\u529f\u3002InnoDB\u5f15\u64ce\u9ed8\u8ba4\u662f\u884c\u9501) UPDATE student SET NAME='\u674e\u56db\u56db' WHERE id=2; -- \u4fee\u6539id\u4e3a3\u7684\u6570\u636e\u3002\u4fee\u6539\u59d3\u540d\u4e3a\u738b\u4e94\u4e94(\u6ce8\u610f\uff1aInnoDB\u5f15\u64ce\u5982\u679c\u4e0d\u91c7\u7528\u5e26\u7d22\u5f15\u7684\u5217\uff0c\u5219\u4f1a\u63d0\u5347\u4e3a\u8868\u9501) UPDATE student SET NAME='\u738b\u4e94\u4e94' WHERE id=3; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT; InnoDB\u6392\u4ed6\u9501_\u7a97\u53e31 \u00b6 -- \u7a97\u53e3 1 /* \u6392\u4ed6\u9501\uff1a\u52a0\u9501\u7684\u6570\u636e\uff0c\u4e0d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u52a0\u9501\u67e5\u8be2\u6216\u4fee\u6539 \u6392\u4ed6\u9501\u521b\u5efa\u683c\u5f0f SELECT\u8bed\u53e5 FOR UPDATE; */ -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u6392\u4ed6\u9501 SELECT * FROM student WHERE id = 1 FOR UPDATE ; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT ; InnoDB\u6392\u4ed6\u9501_\u7a97\u53e32 \u00b6 -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002 ( \u666e\u901a\u67e5\u8be2\u6ca1\u95ee\u9898 ) SELECT * FROM student WHERE id = 1 ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501 ( \u6392\u4ed6\u9501\u4e0d\u80fd\u548c\u5171\u4eab\u9501\u5171\u5b58 ) SELECT * FROM student WHERE id = 1 LOCK IN SHARE MODE ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u6392\u4ed6\u9501 ( \u6392\u4ed6\u9501\u548c\u6392\u4ed6\u9501\u4e0d\u80fd\u5171\u5b58 ) SELECT * FROM student WHERE id = 1 FOR UPDATE ; -- \u4fee\u6539 id \u4e3a 1 \u7684\u6570\u636e\u3002\u5c06\u59d3\u540d\u4fee\u6539\u4e3a\u5f20\u4e09\u4e09 ( \u4e0d\u80fd\u4fee\u6539\u3002\u4f1a\u51fa\u73b0\u9501\u7684\u60c5\u51b5\u3002\u53ea\u6709\u7a97\u53e3 1 \u63d0\u4ea4\u4e8b\u52a1\u540e\uff0c\u624d\u80fd\u4fee\u6539\u6210\u529f ) UPDATE student SET NAME = ' \u5f20\u4e09\u4e09 ' WHERE id = 1 ; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT ; MYISAM\u9501\u7684\u6570\u636e\u51c6\u5907 \u00b6 -- \u521b\u5efaproduct\u8868 CREATE TABLE product( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(20), price INT )ENGINE = MYISAM; -- \u6307\u5b9a\u5b58\u50a8\u5f15\u64ce\u4e3aMyISAM -- \u6dfb\u52a0\u6570\u636e INSERT INTO product VALUES (NULL,'\u534e\u4e3a\u624b\u673a',4999),(NULL,'\u5c0f\u7c73\u624b\u673a',2999), (NULL,'\u82f9\u679c',8999),(NULL,'\u4e2d\u5174',1999); MYISAM\u8bfb\u9501_\u7a97\u53e31 \u00b6 /* \u8bfb\u9501\uff1a\u6240\u6709\u8fde\u63a5\u53ea\u80fd\u8bfb\u53d6\u6570\u636e\uff0c\u4e0d\u80fd\u4fee\u6539 \u52a0\u9501 LOCK TABLE \u8868\u540d READ; \u89e3\u9501(\u5c06\u5f53\u524d\u4f1a\u8bdd\u6240\u6709\u7684\u8868\u8fdb\u884c\u89e3\u9501) UNLOCK TABLES; */ -- \u4e3aproduct\u8868\u6dfb\u52a0\u8bfb\u9501 LOCK TABLE product READ; -- \u67e5\u8be2product\u8868(\u67e5\u8be2\u6210\u529f) SELECT * FROM product; -- \u5c06id\u4e3a1\u7684\u4ef7\u683c\u4fee\u6539\u4e3a5999(\u4e0d\u80fd\u4fee\u6539) UPDATE product SET price=5999 WHERE id=1; -- \u89e3\u9501 UNLOCK TABLES; MYISAM\u8bfb\u9501_\u7a97\u53e32 \u00b6 -- \u67e5\u8be2product\u8868(\u67e5\u8be2\u6210\u529f) SELECT * FROM product; -- \u5c06id\u4e3a1\u7684\u4ef7\u683c\u4fee\u6539\u4e3a5999(\u4e0d\u80fd\u4fee\u6539\u3002\u53ea\u6709\u7a97\u53e31\u89e3\u9501\u540e\u624d\u80fd\u4fee\u6539\u6210\u529f) UPDATE product SET price=5999 WHERE id=1; MYISAM\u5199\u9501_\u7a97\u53e31 \u00b6 /* \u5199\u9501\uff1a\u5176\u4ed6\u8fde\u63a5\u4e0d\u80fd\u67e5\u8be2\u548c\u4fee\u6539\u6570\u636e \u52a0\u9501 LOCK TABLE \u8868\u540d WRITE; \u89e3\u9501(\u5c06\u5f53\u524d\u4f1a\u8bdd\u6240\u6709\u7684\u8868\u8fdb\u884c\u89e3\u9501) UNLOCK TABLES; */ -- \u4e3a product\u8868\u6dfb\u52a0\u5199\u9501 LOCK TABLE product WRITE ; -- \u67e5\u8be2 product\u8868 ( \u67e5\u8be2\u6210\u529f ) SELECT * FROM product ; -- \u4fee\u6539 id\u4e3a2\u7684\u4ef7\u683c\u4e3a3999 ( \u4fee\u6539\u6210\u529f ) UPDATE product SET price = 3999 WHERE id = 2 ; -- \u89e3\u9501 UNLOCK TABLES ; MYISAM\u5199\u9501_\u7a97\u53e32 \u00b6 -- \u67e5\u8be2product\u8868\uff08\u67e5\u8be2\u5931\u8d25\u3002\u53ea\u6709\u7a97\u53e31\u89e3\u9501\u540e\uff0c\u624d\u80fd\u67e5\u8be2\u6210\u529f\uff09 SELECT * FROM product; -- \u4fee\u6539id\u4e3a2\u7684\u4ef7\u683c\u4e3a1999(\u4fee\u6539\u5931\u8d25\u3002\u53ea\u6709\u7a97\u53e31\u89e3\u9501\u540e\uff0c\u624d\u80fd\u4fee\u6539\u6210\u529f) UPDATE product SET price=1999 WHERE id=2; \u4e50\u89c2\u9501 \u00b6 -- \u521b\u5efacity\u8868 CREATE TABLE city( id INT PRIMARY KEY AUTO_INCREMENT, -- \u57ce\u5e02id NAME VARCHAR(20), -- \u57ce\u5e02\u540d\u79f0 VERSION INT -- \u7248\u672c\u53f7 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO city VALUES (NULL,'\u5317\u4eac',1),(NULL,'\u4e0a\u6d77',1),(NULL,'\u5e7f\u5dde',1),(NULL,'\u6df1\u5733',1); -- \u5c06\u5317\u4eac\u4fee\u6539\u4e3a\u5317\u4eac\u5e02 -- 1.\u5c06\u5317\u4eac\u7684\u7248\u672c\u53f7\u8bfb\u53d6\u51fa\u6765 SELECT VERSION FROM city WHERE NAME='\u5317\u4eac'; -- 1 -- 2.\u4fee\u6539\u5317\u4eac\u4e3a\u5317\u4eac\u5e02\uff0c\u7248\u672c\u53f7+1.\u5e76\u5bf9\u6bd4\u7248\u672c\u53f7\u662f\u5426\u76f8\u540c UPDATE city SET NAME='\u5317\u4eac\u5e02',VERSION=VERSION+1 WHERE NAME='\u5317\u4eac' AND VERSION=1; 04\u4e3b\u4ece\u590d\u5236 \u00b6 \u4e3b\u4ece\u590d\u5236_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u4e3b\u670d\u52a1\u5668\u521b\u5efadb1\u6570\u636e\u5e93,\u4ece\u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u540c\u6b65 CREATE DATABASE db1; \u4e3b\u4ece\u590d\u5236_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u4ece\u670d\u52a1\u5668\u521b\u5efadb2\u6570\u636e\u5e93,\u4e3b\u670d\u52a1\u5668\u4e0d\u4f1a\u81ea\u52a8\u540c\u6b65 CREATE DATABASE db2; 05\u8bfb\u5199\u5206\u79bb \u00b6 \u8bfb\u5199\u5206\u79bb_mycat\u64cd\u4f5c \u00b6 -- \u521b\u5efa\u5b66\u751f\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(10) ); -- \u67e5\u8be2\u5b66\u751f\u8868 SELECT * FROM student; -- \u6dfb\u52a0\u4e24\u6761\u8bb0\u5f55 INSERT INTO student VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u505c\u6b62\u4e3b\u4ece\u590d\u5236\u540e\uff0c\u6dfb\u52a0\u7684\u6570\u636e\u53ea\u4f1a\u4fdd\u5b58\u5230\u4e3b\u670d\u52a1\u5668\u4e0a\u3002 INSERT INTO student VALUES (NULL,'\u738b\u4e94'); \u8bfb\u5199\u5206\u79bb_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u4e3b\u670d\u52a1\u5668\uff1a\u67e5\u8be2\u5b66\u751f\u8868\uff0c\u53ef\u4ee5\u770b\u5230\u6570\u636e SELECT * FROM student; \u8bfb\u5199\u5206\u79bb_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u4ece\u670d\u52a1\u5668\uff1a\u67e5\u8be2\u5b66\u751f\u8868\uff0c\u53ef\u4ee5\u770b\u5230\u6570\u636e(\u56e0\u4e3a\u6709\u4e3b\u4ece\u590d\u5236) SELECT * FROM student; -- \u4ece\u670d\u52a1\u5668\uff1a\u5220\u9664\u4e00\u6761\u8bb0\u5f55\u3002(\u4e3b\u670d\u52a1\u5668\u5e76\u6ca1\u6709\u5220\u9664\uff0cmycat\u4e2d\u95f4\u4ef6\u67e5\u8be2\u7684\u7ed3\u679c\u662f\u4ece\u670d\u52a1\u5668\u7684\u6570\u636e) DELETE FROM student WHERE id=2; 06\u6c34\u5e73\u62c6\u5206 \u00b6 \u6c34\u5e73\u62c6\u5206_mycat\u64cd\u4f5c \u00b6 -- \u521b\u5efa product \u8868 CREATE TABLE product ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 20 ) , price INT ) ; -- \u6dfb\u52a0 6 \u6761\u6570\u636e INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u82f9\u679c\u624b\u673a ' , 6999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u534e\u4e3a\u624b\u673a ' , 5999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u4e09\u661f\u624b\u673a ' , 4999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u5c0f\u7c73\u624b\u673a ' , 3999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u4e2d\u5174\u624b\u673a ' , 2999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' OOPO\u624b\u673a ' , 1999 ) ; -- \u67e5\u8be2 product \u8868 SELECT * FROM product ; \u6c34\u5e73\u62c6\u5206_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u5728\u4e0d\u540c\u6570\u636e\u5e93\u4e2d\u67e5\u8be2product\u8868 SELECT * FROM product; \u6c34\u5e73\u62c6\u5206_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u5728\u4e0d\u540c\u6570\u636e\u5e93\u4e2d\u67e5\u8be2product\u8868 SELECT * FROM product; 07\u5782\u76f4\u62c6\u5206 \u00b6 \u5782\u76f4\u62c6\u5206_mycat\u64cd\u4f5c \u00b6 -- \u521b\u5efa dog \u8868 CREATE TABLE dog ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO dog ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u54c8\u58eb\u5947 ' ) ; -- \u67e5\u8be2 dog \u8868 SELECT * FROM dog ; -- \u521b\u5efa cat \u8868 CREATE TABLE cat ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO cat ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u6ce2\u65af\u732b ' ) ; -- \u67e5\u8be2 cat \u8868 SELECT * FROM cat ; -- \u521b\u5efa apple \u8868 CREATE TABLE apple ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO apple ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u7ea2\u5bcc\u58eb ' ) ; -- \u67e5\u8be2 apple \u8868 SELECT * FROM apple ; -- \u521b\u5efa banana \u8868 CREATE TABLE banana ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO banana ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u9999\u8549 ' ) ; -- \u67e5\u8be2 banana \u8868 SELECT * FROM banana ; \u5782\u76f4\u62c6\u5206_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u67e5\u8be2dog\u8868 SELECT * FROM dog; -- \u67e5\u8be2cat\u8868 SELECT * FROM cat; -- \u67e5\u8be2apple\u8868 SELECT * FROM apple; -- \u67e5\u8be2banana\u8868 SELECT * FROM banana; \u5782\u76f4\u62c6\u5206_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c \u00b6 -- \u67e5\u8be2dog\u8868 SELECT * FROM dog; -- \u67e5\u8be2cat\u8868 SELECT * FROM cat; -- \u67e5\u8be2apple\u8868 SELECT * FROM apple; -- \u67e5\u8be2banana\u8868 SELECT * FROM banana;","title":"Mysql"},{"location":"MySQL/#mysql","text":"Reference Manual","title":"MySQL \u53c2\u8003\u624b\u518c"},{"location":"MySQL/#day01","text":"","title":"day01"},{"location":"MySQL/#01","text":"","title":"01\u64cd\u4f5c\u6570\u636e\u5e93\u548c\u6570\u636e\u8868"},{"location":"MySQL/#_1","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW DATABASES; */","title":"\u67e5\u8be2\u6240\u6709\u6570\u636e\u5e93"},{"location":"MySQL/#_2","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u7684\u521b\u5efa\u8bed\u53e5"},{"location":"MySQL/#_3","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u521b\u5efa\u6570\u636e\u5e93"},{"location":"MySQL/#_4","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE DATABASE IF NOT EXISTS \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u521b\u5efa\u6570\u636e\u5e93\uff0c\u5224\u65ad\u3001\u5982\u679c\u4e0d\u5b58\u5728\u5219\u521b\u5efa"},{"location":"MySQL/#_5","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0 CHARACTER SET \u5b57\u7b26\u96c6\u540d\u79f0; */","title":"\u521b\u5efa\u6570\u636e\u5e93\u3001\u5e76\u6307\u5b9a\u5b57\u7b26\u96c6"},{"location":"MySQL/#_6","text":"SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0 ;","title":"\u67e5\u770b\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6"},{"location":"MySQL/#_7","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER DATABASE \u6570\u636e\u5e93\u540d\u79f0 CHARACTER SET \u5b57\u7b26\u96c6\u540d\u79f0; */","title":"\u4fee\u6539\u6570\u636e\u5e93\u7684\u5b57\u7b26\u96c6"},{"location":"MySQL/#_8","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a DROP DATABASE \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u5220\u9664\u6570\u636e\u5e93"},{"location":"MySQL/#_9","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a DROP DATABASE IF EXISTS \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u5220\u9664\u6570\u636e\u5e93\uff0c\u5224\u65ad\u3001\u5982\u679c\u5b58\u5728\u5219\u5220\u9664"},{"location":"MySQL/#_10","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a USE \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u4f7f\u7528\u6570\u636e\u5e93"},{"location":"MySQL/#_11","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT DATABASE(); */","title":"\u67e5\u8be2\u5f53\u524d\u4f7f\u7528\u7684\u6570\u636e\u5e93"},{"location":"MySQL/#_12","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW TABLES; */","title":"\u67e5\u8be2\u6240\u6709\u6570\u636e\u8868"},{"location":"MySQL/#_13","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a DESC \u8868\u540d; */","title":"\u67e5\u8be2\u8868\u7ed3\u6784"},{"location":"MySQL/#_14","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SHOW TABLE STATUS FROM \u6570\u636e\u5e93\u540d\u79f0 LIKE '\u8868\u540d'; */","title":"\u67e5\u8be2\u6570\u636e\u8868\u7684\u5b57\u7b26\u96c6"},{"location":"MySQL/#_15","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a CREATE TABLE \u8868\u540d( \u5217\u540d \u6570\u636e\u7c7b\u578b \u7ea6\u675f, \u5217\u540d \u6570\u636e\u7c7b\u578b \u7ea6\u675f, ... \u5217\u540d \u6570\u636e\u7c7b\u578b \u7ea6\u675f ); */","title":"\u521b\u5efa\u6570\u636e\u8868"},{"location":"MySQL/#_16","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u65e7\u8868\u540d RENAME TO \u65b0\u8868\u540d; */","title":"\u4fee\u6539\u8868\u540d"},{"location":"MySQL/#_17","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d CHARACTER SET \u5b57\u7b26\u96c6\u540d\u79f0; */","title":"\u4fee\u6539\u8868\u7684\u5b57\u7b26\u96c6"},{"location":"MySQL/#_18","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD \u5217\u540d \u6570\u636e\u7c7b\u578b; */","title":"\u7ed9\u8868\u6dfb\u52a0\u5217"},{"location":"MySQL/#_19","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d MODIFY \u5217\u540d \u6570\u636e\u7c7b\u578b; */","title":"\u4fee\u6539\u8868\u4e2d\u5217\u7684\u6570\u636e\u7c7b\u578b"},{"location":"MySQL/#_20","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d CHANGE \u65e7\u5217\u540d \u65b0\u5217\u540d \u6570\u636e\u7c7b\u578b; */","title":"\u4fee\u6539\u8868\u4e2d\u5217\u7684\u540d\u79f0\u548c\u6570\u636e\u7c7b\u578b"},{"location":"MySQL/#_21","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d DROP \u5217\u540d; */","title":"\u5220\u9664\u8868\u4e2d\u7684\u5217"},{"location":"MySQL/#_22","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a DROP TABLE \u8868\u540d; */","title":"\u5220\u9664\u8868"},{"location":"MySQL/#_23","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a DROP TABLE IF EXISTS \u8868\u540d; */","title":"\u5220\u9664\u8868\uff0c\u5224\u65ad\u3001\u5982\u679c\u5b58\u5728\u5219\u5220\u9664"},{"location":"MySQL/#02","text":"","title":"02\u8868\u6570\u636e\u7684\u589e\u5220\u6539"},{"location":"MySQL/#_24","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a INSERT INTO \u8868\u540d(\u5217\u540d1,\u5217\u540d2,...) VALUES (\u503c1,\u503c2,...); */","title":"\u7ed9\u6307\u5b9a\u5217\u6dfb\u52a0\u6570\u636e"},{"location":"MySQL/#_25","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a INSERT INTO \u8868\u540d VALUES (\u503c1,\u503c2,\u503c3,...); */","title":"\u7ed9\u5168\u90e8\u5217\u6dfb\u52a0\u6570\u636e"},{"location":"MySQL/#_26","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a INSERT INTO \u8868\u540d VALUES (\u503c1,\u503c2,\u503c3,...),(\u503c1,\u503c2,\u503c3,...),(\u503c1,\u503c2,\u503c3,...); */","title":"\u6279\u91cf\u6dfb\u52a0\u6240\u6709\u5217\u6570\u636e"},{"location":"MySQL/#_27","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a UPDATE \u8868\u540d SET \u5217\u540d1 = \u503c1,\u5217\u540d2 = \u503c2,... [where \u6761\u4ef6]; */","title":"\u4fee\u6539\u8868\u6570\u636e"},{"location":"MySQL/#_28","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a DELETE FROM \u8868\u540d [WHERE \u6761\u4ef6]; */","title":"\u5220\u9664\u8868\u6570\u636e"},{"location":"MySQL/#03","text":"","title":"03\u8868\u6570\u636e\u7684\u67e5\u8be2"},{"location":"MySQL/#_29","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT * FROM \u8868\u540d; */","title":"\u67e5\u8be2\u5168\u90e8\u6570\u636e"},{"location":"MySQL/#_30","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d1,\u5217\u540d2,... FROM \u8868\u540d; */","title":"\u67e5\u8be2\u6307\u5b9a\u5217"},{"location":"MySQL/#_31","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT DISTINCT \u5217\u540d1,\u5217\u540d2,... FROM \u8868\u540d; */","title":"\u53bb\u9664\u91cd\u590d\u67e5\u8be2"},{"location":"MySQL/#_32","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d1 \u8fd0\u7b97\u7b26(+ - * /) \u5217\u540d2 FROM \u8868\u540d; \u5982\u679c\u67d0\u4e00\u5217\u4e3anull\uff0c\u53ef\u4ee5\u8fdb\u884c\u66ff\u6362 ifnull(\u8868\u8fbe\u5f0f1,\u8868\u8fbe\u5f0f2) \u8868\u8fbe\u5f0f1\uff1a\u60f3\u66ff\u6362\u7684\u5217 \u8868\u8fbe\u5f0f2\uff1a\u60f3\u66ff\u6362\u7684\u503c */ example -- \u67e5\u8be2\u5546\u54c1\u540d\u79f0\u548c\u5e93\u5b58\uff0c\u5e93\u5b58\u6570\u91cf\u5728\u539f\u6709\u57fa\u7840\u4e0a\u52a010 SELECT NAME,stock+10 FROM product; -- \u67e5\u8be2\u5546\u54c1\u540d\u79f0\u548c\u5e93\u5b58\uff0c\u5e93\u5b58\u6570\u91cf\u5728\u539f\u6709\u57fa\u7840\u4e0a\u52a010\u3002\u8fdb\u884cnull\u503c\u5224\u65ad SELECT NAME,IFNULL(stock,0)+10 FROM product;","title":"\u8ba1\u7b97\u5217\u7684\u503c"},{"location":"MySQL/#_33","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d1,\u5217\u540d2,... AS \u522b\u540d FROM \u8868\u540d; */ as\u53ef\u4ee5\u7701\u7565","title":"\u8d77\u522b\u540d"},{"location":"MySQL/#_34","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d\u5217\u8868 FROM \u8868\u540d WHERE \u6761\u4ef6; */ example -- \u67e5\u8be2\u5e93\u5b58\u5927\u4e8e20\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock > 20; -- \u67e5\u8be2\u54c1\u724c\u4e3a\u534e\u4e3a\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE brand='\u534e\u4e3a'; -- \u67e5\u8be2\u91d1\u989d\u57284000 ~ 6000\u4e4b\u95f4\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE price >= 4000 AND price <= 6000; SELECT * FROM product WHERE price BETWEEN 4000 AND 6000; -- \u67e5\u8be2\u5e93\u5b58\u4e3a14\u300130\u300123\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock=14 OR stock=30 OR stock=23; SELECT * FROM product WHERE stock IN(14,30,23); -- \u67e5\u8be2\u5e93\u5b58\u4e3anull\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock IS NULL; -- \u67e5\u8be2\u5e93\u5b58\u4e0d\u4e3anull\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE stock IS NOT NULL; -- \u67e5\u8be2\u540d\u79f0\u4ee5\u5c0f\u7c73\u4e3a\u5f00\u5934\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '\u5c0f\u7c73%'; -- \u67e5\u8be2\u540d\u79f0\u7b2c\u4e8c\u4e2a\u5b57\u662f\u4e3a\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '_\u4e3a%'; -- \u67e5\u8be2\u540d\u79f0\u4e3a\u56db\u4e2a\u5b57\u7b26\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '____'; -- \u67e5\u8be2\u540d\u79f0\u4e2d\u5305\u542b\u7535\u8111\u7684\u5546\u54c1\u4fe1\u606f SELECT * FROM product WHERE NAME LIKE '%\u7535\u8111%';","title":"\u6761\u4ef6\u67e5\u8be2"},{"location":"MySQL/#_35","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u51fd\u6570\u540d(\u5217\u540d) FROM \u8868\u540d [WHERE \u6761\u4ef6]; */ example -- \u8ba1\u7b97product\u8868\u4e2d\u603b\u8bb0\u5f55\u6761\u6570 SELECT COUNT(*) FROM product; -- \u83b7\u53d6\u6700\u9ad8\u4ef7\u683c SELECT MAX(price) FROM product; -- \u83b7\u53d6\u6700\u4f4e\u5e93\u5b58 SELECT MIN(stock) FROM product; -- \u83b7\u53d6\u603b\u5e93\u5b58\u6570\u91cf SELECT SUM(stock) FROM product; -- \u83b7\u53d6\u54c1\u724c\u4e3a\u82f9\u679c\u7684\u603b\u5e93\u5b58\u6570\u91cf SELECT SUM(stock) FROM product WHERE brand='\u82f9\u679c'; -- \u83b7\u53d6\u54c1\u724c\u4e3a\u5c0f\u7c73\u7684\u5e73\u5747\u5546\u54c1\u4ef7\u683c SELECT AVG(price) FROM product WHERE brand='\u5c0f\u7c73';","title":"\u805a\u5408\u51fd\u6570"},{"location":"MySQL/#_36","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6] ORDER BY \u5217\u540d1 \u6392\u5e8f\u65b9\u5f0f1,\u5217\u540d2 \u6392\u5e8f\u65b9\u5f0f2; */ example -- \u6309\u7167\u5e93\u5b58\u5347\u5e8f\u6392\u5e8f SELECT * FROM product ORDER BY stock ASC; -- \u67e5\u8be2\u540d\u79f0\u4e2d\u5305\u542b\u624b\u673a\u7684\u5546\u54c1\u4fe1\u606f\u3002\u6309\u7167\u91d1\u989d\u964d\u5e8f\u6392\u5e8f SELECT * FROM product WHERE NAME LIKE '%\u624b\u673a%' ORDER BY price DESC; -- \u6309\u7167\u91d1\u989d\u5347\u5e8f\u6392\u5e8f\uff0c\u5982\u679c\u91d1\u989d\u76f8\u540c\uff0c\u6309\u7167\u5e93\u5b58\u964d\u5e8f\u6392\u5217 SELECT * FROM product ORDER BY price ASC,stock DESC;","title":"\u6392\u5e8f\u67e5\u8be2"},{"location":"MySQL/#_37","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6] GROUP BY \u5206\u7ec4\u5217\u540d [HAVING \u5206\u7ec4\u540e\u6761\u4ef6\u8fc7\u6ee4] [ORDER BY \u6392\u5e8f\u5217\u540d \u6392\u5e8f\u65b9\u5f0f]; */","title":"\u5206\u7ec4\u67e5\u8be2"},{"location":"MySQL/#_38","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6] [GROUP BY \u5206\u7ec4\u5217\u540d] [HAVING \u5206\u7ec4\u540e\u6761\u4ef6\u8fc7\u6ee4] [ORDER BY \u6392\u5e8f\u5217\u540d \u6392\u5e8f\u65b9\u5f0f] LIMIT \u5f53\u524d\u9875\u6570,\u6bcf\u9875\u663e\u793a\u7684\u6761\u6570; LIMIT \u5f53\u524d\u9875\u6570,\u6bcf\u9875\u663e\u793a\u7684\u6761\u6570; \u516c\u5f0f\uff1a\u5f53\u524d\u9875\u6570 = (\u5f53\u524d\u9875\u6570-1) * \u6bcf\u9875\u663e\u793a\u7684\u6761\u6570 */ example -- \u6bcf\u9875\u663e\u793a3\u6761\u6570\u636e -- \u7b2c1\u9875 \u5f53\u524d\u9875\u6570=(1-1) * 3 SELECT * FROM product LIMIT 0,3; -- \u7b2c2\u9875 \u5f53\u524d\u9875\u6570=(2-1) * 3 SELECT * FROM product LIMIT 3,3; -- \u7b2c3\u9875 \u5f53\u524d\u9875\u6570=(3-1) * 3 SELECT * FROM product LIMIT 6,3;","title":"\u5206\u9875\u67e5\u8be2"},{"location":"MySQL/#04","text":"","title":"04\u7ea6\u675f"},{"location":"MySQL/#_39","text":"-- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e CREATE TABLE student( id INT PRIMARY KEY, NAME VARCHAR(30), age INT ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (1,'\u5f20\u4e09',23); INSERT INTO student VALUES (2,'\u674e\u56db',24); -- \u5220\u9664\u4e3b\u952e ALTER TABLE student DROP PRIMARY KEY; -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u4e3b\u952e\u7ea6\u675f ALTER TABLE student MODIFY id INT PRIMARY KEY;","title":"\u4e3b\u952e\u7ea6\u675f"},{"location":"MySQL/#_40","text":"-- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e\u81ea\u589e CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(30), age INT ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23),(NULL,'\u674e\u56db',24); -- \u5220\u9664\u81ea\u589e\u7ea6\u675f ALTER TABLE student MODIFY id INT; INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23); -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u81ea\u589e\u7ea6\u675f ALTER TABLE student MODIFY id INT AUTO_INCREMENT;","title":"\u4e3b\u952e\u81ea\u589e\u7ea6\u675f"},{"location":"MySQL/#_41","text":"-- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e\u81ea\u589e\uff0c\u5e74\u9f84\u8bbe\u4e3a\u552f\u4e00 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(30), age INT UNIQUE ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23); INSERT INTO student VALUES (NULL,'\u674e\u56db',23); -- \u5220\u9664\u552f\u4e00\u7ea6\u675f ALTER TABLE student DROP INDEX age; -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u552f\u4e00\u7ea6\u675f ALTER TABLE student MODIFY age INT UNIQUE;","title":"\u552f\u4e00\u7ea6\u675f"},{"location":"MySQL/#_42","text":"-- \u521b\u5efa\u5b66\u751f\u8868(\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84) \u7f16\u53f7\u8bbe\u4e3a\u4e3b\u952e\u81ea\u589e\uff0c\u59d3\u540d\u8bbe\u4e3a\u975e\u7a7a\uff0c\u5e74\u9f84\u8bbe\u4e3a\u552f\u4e00 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(30) NOT NULL, age INT UNIQUE ); -- \u67e5\u8be2\u5b66\u751f\u8868\u7684\u8be6\u7ec6\u4fe1\u606f DESC student; -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23); -- \u5220\u9664\u975e\u7a7a\u7ea6\u675f ALTER TABLE student MODIFY NAME VARCHAR(30); INSERT INTO student VALUES (NULL,NULL,25); -- \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u975e\u7a7a\u7ea6\u675f ALTER TABLE student MODIFY NAME VARCHAR(30) NOT NULL;","title":"\u975e\u7a7a\u7ea6\u675f"},{"location":"MySQL/#day02","text":"","title":"day02"},{"location":"MySQL/#01_1","text":"","title":"01\u7ea6\u675f"},{"location":"MySQL/#_43","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u8868\u4e3b\u952e\u5217\u540d) */","title":"\u5916\u952e\u7ea6\u675f"},{"location":"MySQL/#_44","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d DROP FOREIGN KEY \u5916\u952e\u540d; */","title":"\u5220\u9664\u5916\u952e\u7ea6\u675f"},{"location":"MySQL/#_45","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d); */ \u5916\u952e\u7ea6\u675fexample -- \u521b\u5efadb2\u6570\u636e\u5e93 CREATE DATABASE db2; -- \u4f7f\u7528db2\u6570\u636e\u5e93 USE db2; /* \u5916\u952e\u7ea6\u675f \u6807\u51c6\u8bed\u6cd5\uff1a CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u8868\u4e3b\u952e\u5217\u540d) */ -- \u5efa\u8868\u65f6\u6dfb\u52a0\u5916\u952e\u7ea6\u675f -- \u521b\u5efauser\u7528\u6237\u8868 CREATE TABLE USER( id INT PRIMARY KEY AUTO_INCREMENT, -- id NAME VARCHAR(20) NOT NULL -- \u59d3\u540d ); -- \u6dfb\u52a0\u7528\u6237\u6570\u636e INSERT INTO USER VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efaorderlist\u8ba2\u5355\u8868 CREATE TABLE orderlist( id INT PRIMARY KEY AUTO_INCREMENT, -- id number VARCHAR(20) NOT NULL, -- \u8ba2\u5355\u7f16\u53f7 uid INT, -- \u5916\u952e\u5217 CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ); -- \u6dfb\u52a0\u8ba2\u5355\u6570\u636e INSERT INTO orderlist VALUES (NULL,'hm001',1),(NULL,'hm002',1), (NULL,'hm003',2),(NULL,'hm004',2); -- \u6dfb\u52a0\u4e00\u4e2a\u8ba2\u5355\uff0c\u4f46\u662f\u6ca1\u6709\u771f\u5b9e\u7528\u6237\u3002\u6dfb\u52a0\u5931\u8d25 INSERT INTO orderlist VALUES (NULL,'hm005',3); -- \u5220\u9664\u674e\u56db\u7528\u6237\u3002\u5220\u9664\u5931\u8d25 DELETE FROM USER WHERE NAME='\u674e\u56db'; /* \u5220\u9664\u5916\u952e\u7ea6\u675f \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d DROP FOREIGN KEY \u5916\u952e\u540d; */ -- \u5220\u9664\u5916\u952e\u7ea6\u675f ALTER TABLE orderlist DROP FOREIGN KEY ou_fk1; /* \u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u5916\u952e\u7ea6\u675f \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d); */ -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ALTER TABLE orderlist ADD CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id);","title":"\u5efa\u8868\u540e\u5355\u72ec\u6dfb\u52a0\u5916\u952e\u7ea6\u675f"},{"location":"MySQL/#_46","text":"/* \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u66f4\u65b0 \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d) ON UPDATE CASCADE; \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u5220\u9664 \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d) ON DELETE CASCADE; \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u66f4\u65b0\u548c\u7ea7\u8054\u5220\u9664 \u6807\u51c6\u8bed\u6cd5\uff1a ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d) ON UPDATE CASCADE ON DELETE CASCADE; */ \u5916\u952e\u7ea7\u8054\u64cd\u4f5cexample -- \u5220\u9664\u5916\u952e\u7ea6\u675f ALTER TABLE orderlist DROP FOREIGN KEY ou_fk1; -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u540c\u65f6\u6dfb\u52a0\u7ea7\u8054\u66f4\u65b0\u548c\u7ea7\u8054\u5220\u9664 ALTER TABLE orderlist ADD CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ON UPDATE CASCADE ON DELETE CASCADE; -- \u5c06\u674e\u56db\u8fd9\u4e2a\u7528\u6237\u7684id\u4fee\u6539\u4e3a3,\u8ba2\u5355\u8868\u4e2d\u7684uid\u4e5f\u81ea\u52a8\u4fee\u6539 UPDATE USER SET id=3 WHERE id=2; -- \u5c06\u674e\u56db\u8fd9\u4e2a\u7528\u6237\u5220\u9664,\u8ba2\u5355\u8868\u4e2d\u7684\u8be5\u7528\u6237\u6240\u5c5e\u7684\u8ba2\u5355\u4e5f\u81ea\u52a8\u5220\u9664 DELETE FROM USER WHERE id=3;","title":"\u5916\u952e\u7ea7\u8054\u64cd\u4f5c"},{"location":"MySQL/#02_1","text":"","title":"02\u591a\u8868\u64cd\u4f5c"},{"location":"MySQL/#_47","text":"-- \u521b\u5efadb3\u6570\u636e\u5e93 CREATE DATABASE db3; -- \u4f7f\u7528db3\u6570\u636e\u5e93 USE db3; -- \u521b\u5efaperson\u8868 CREATE TABLE person( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(20) -- \u59d3\u540d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO person VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efacard\u8868 CREATE TABLE card( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid number VARCHAR(20) UNIQUE NOT NULL, -- \u8eab\u4efd\u8bc1\u53f7 pid INT UNIQUE, -- \u5916\u952e\u5217 CONSTRAINT cp_fk1 FOREIGN KEY (pid) REFERENCES person(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO card VALUES (NULL,'12345',1),(NULL,'56789',2);","title":"\u8868\u5173\u7cfb\u4e00\u5bf9\u4e00"},{"location":"MySQL/#_48","text":"-- \u521b\u5efauser\u8868 CREATE TABLE USER( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(20) -- \u59d3\u540d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO USER VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efaorderlist\u8868 CREATE TABLE orderlist( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid number VARCHAR(20), -- \u8ba2\u5355\u7f16\u53f7 uid INT, -- \u5916\u952e\u5217 CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO orderlist VALUES (NULL,'hm001',1),(NULL,'hm002',1),(NULL,'hm003',2),(NULL,'hm004',2); /* \u5546\u54c1\u5206\u7c7b\u548c\u5546\u54c1 */ -- \u521b\u5efacategory\u8868 CREATE TABLE category( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(10) -- \u5206\u7c7b\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO category VALUES (NULL,'\u624b\u673a\u6570\u7801'),(NULL,'\u7535\u8111\u529e\u516c'); -- \u521b\u5efaproduct\u8868 CREATE TABLE product( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(30), -- \u5546\u54c1\u540d\u79f0 cid INT, -- \u5916\u952e\u5217 CONSTRAINT pc_fk1 FOREIGN KEY (cid) REFERENCES category(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO product VALUES (NULL,'\u534e\u4e3aP30',1),(NULL,'\u5c0f\u7c73note3',1), (NULL,'\u8054\u60f3\u7535\u8111',2),(NULL,'\u82f9\u679c\u7535\u8111',2);","title":"\u8868\u5173\u7cfb\u4e00\u5bf9\u591a"},{"location":"MySQL/#_49","text":"-- \u521b\u5efastudent\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(20) -- \u5b66\u751f\u59d3\u540d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u521b\u5efacourse\u8868 CREATE TABLE course( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid NAME VARCHAR(10) -- \u8bfe\u7a0b\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO course VALUES (NULL,'\u8bed\u6587'),(NULL,'\u6570\u5b66'); -- \u521b\u5efa\u4e2d\u95f4\u8868 CREATE TABLE stu_course( id INT PRIMARY KEY AUTO_INCREMENT, -- \u4e3b\u952eid sid INT, -- \u7528\u4e8e\u548cstudent\u8868\u4e2d\u7684id\u8fdb\u884c\u5916\u952e\u5173\u8054 cid INT, -- \u7528\u4e8e\u548ccourse\u8868\u4e2d\u7684id\u8fdb\u884c\u5916\u952e\u5173\u8054 CONSTRAINT sc_fk1 FOREIGN KEY (sid) REFERENCES student(id), -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f CONSTRAINT sc_fk2 FOREIGN KEY (cid) REFERENCES course(id) -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO stu_course VALUES (NULL,1,1),(NULL,1,2),(NULL,2,1),(NULL,2,2);","title":"\u8868\u5173\u7cfb\u591a\u5bf9\u591a"},{"location":"MySQL/#_50","text":"-- \u521b\u5efadb4\u6570\u636e\u5e93 CREATE DATABASE db4; -- \u4f7f\u7528db4\u6570\u636e\u5e93 USE db4; -- \u521b\u5efauser\u8868 CREATE TABLE USER( id INT PRIMARY KEY AUTO_INCREMENT, -- \u7528\u6237id NAME VARCHAR(20), -- \u7528\u6237\u59d3\u540d age INT -- \u7528\u6237\u5e74\u9f84 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO USER VALUES (1,'\u5f20\u4e09',23); INSERT INTO USER VALUES (2,'\u674e\u56db',24); INSERT INTO USER VALUES (3,'\u738b\u4e94',25); INSERT INTO USER VALUES (4,'\u8d75\u516d',26); -- \u8ba2\u5355\u8868 CREATE TABLE orderlist( id INT PRIMARY KEY AUTO_INCREMENT, -- \u8ba2\u5355id number VARCHAR(30), -- \u8ba2\u5355\u7f16\u53f7 uid INT, -- \u5916\u952e\u5b57\u6bb5 CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO orderlist VALUES (1,'hm001',1); INSERT INTO orderlist VALUES (2,'hm002',1); INSERT INTO orderlist VALUES (3,'hm003',2); INSERT INTO orderlist VALUES (4,'hm004',2); INSERT INTO orderlist VALUES (5,'hm005',3); INSERT INTO orderlist VALUES (6,'hm006',3); INSERT INTO orderlist VALUES (7,'hm007',NULL); -- \u5546\u54c1\u5206\u7c7b\u8868 CREATE TABLE category( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5546\u54c1\u5206\u7c7bid NAME VARCHAR(10) -- \u5546\u54c1\u5206\u7c7b\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO category VALUES (1,'\u624b\u673a\u6570\u7801'); INSERT INTO category VALUES (2,'\u7535\u8111\u529e\u516c'); INSERT INTO category VALUES (3,'\u70df\u9152\u8336\u7cd6'); INSERT INTO category VALUES (4,'\u978b\u9774\u7bb1\u5305'); -- \u5546\u54c1\u8868 CREATE TABLE product( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5546\u54c1id NAME VARCHAR(30), -- \u5546\u54c1\u540d\u79f0 cid INT, -- \u5916\u952e\u5b57\u6bb5 CONSTRAINT cp_fk1 FOREIGN KEY (cid) REFERENCES category(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO product VALUES (1,'\u534e\u4e3a\u624b\u673a',1); INSERT INTO product VALUES (2,'\u5c0f\u7c73\u624b\u673a',1); INSERT INTO product VALUES (3,'\u8054\u60f3\u7535\u8111',2); INSERT INTO product VALUES (4,'\u82f9\u679c\u7535\u8111',2); INSERT INTO product VALUES (5,'\u4e2d\u534e\u9999\u70df',3); INSERT INTO product VALUES (6,'\u7389\u6eaa\u9999\u70df',3); INSERT INTO product VALUES (7,'\u8ba1\u751f\u7528\u54c1',NULL); -- \u4e2d\u95f4\u8868 CREATE TABLE us_pro( upid INT PRIMARY KEY AUTO_INCREMENT, -- \u4e2d\u95f4\u8868id uid INT, -- \u5916\u952e\u5b57\u6bb5\u3002\u9700\u8981\u548c\u7528\u6237\u8868\u7684\u4e3b\u952e\u4ea7\u751f\u5173\u8054 pid INT, -- \u5916\u952e\u5b57\u6bb5\u3002\u9700\u8981\u548c\u5546\u54c1\u8868\u7684\u4e3b\u952e\u4ea7\u751f\u5173\u8054 CONSTRAINT up_fk1 FOREIGN KEY (uid) REFERENCES USER(id), CONSTRAINT up_fk2 FOREIGN KEY (pid) REFERENCES product(id) ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO us_pro VALUES (NULL,1,1); INSERT INTO us_pro VALUES (NULL,1,2); INSERT INTO us_pro VALUES (NULL,1,3); INSERT INTO us_pro VALUES (NULL,1,4); INSERT INTO us_pro VALUES (NULL,1,5); INSERT INTO us_pro VALUES (NULL,1,6); INSERT INTO us_pro VALUES (NULL,1,7); INSERT INTO us_pro VALUES (NULL,2,1); INSERT INTO us_pro VALUES (NULL,2,2); INSERT INTO us_pro VALUES (NULL,2,3); INSERT INTO us_pro VALUES (NULL,2,4); INSERT INTO us_pro VALUES (NULL,2,5); INSERT INTO us_pro VALUES (NULL,2,6); INSERT INTO us_pro VALUES (NULL,2,7); INSERT INTO us_pro VALUES (NULL,3,1); INSERT INTO us_pro VALUES (NULL,3,2); INSERT INTO us_pro VALUES (NULL,3,3); INSERT INTO us_pro VALUES (NULL,3,4); INSERT INTO us_pro VALUES (NULL,3,5); INSERT INTO us_pro VALUES (NULL,3,6); INSERT INTO us_pro VALUES (NULL,3,7); INSERT INTO us_pro VALUES (NULL,4,1); INSERT INTO us_pro VALUES (NULL,4,2); INSERT INTO us_pro VALUES (NULL,4,3); INSERT INTO us_pro VALUES (NULL,4,4); INSERT INTO us_pro VALUES (NULL,4,5); INSERT INTO us_pro VALUES (NULL,4,6); INSERT INTO us_pro VALUES (NULL,4,7);","title":"\u591a\u8868\u67e5\u8be2\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#_51","text":"","title":"\u5185\u8fde\u63a5\u67e5\u8be2"},{"location":"MySQL/#_52","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1 [INNER] JOIN \u8868\u540d2 ON \u5173\u8054\u6761\u4ef6; */","title":"\u663e\u793a\u5185\u8fde\u63a5"},{"location":"MySQL/#_53","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1,\u8868\u540d2 WHERE \u5173\u8054\u6761\u4ef6; */","title":"\u9690\u5f0f\u5185\u8fde\u63a5"},{"location":"MySQL/#_54","text":"","title":"\u5916\u8fde\u63a5\u67e5\u8be2"},{"location":"MySQL/#_55","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1 LEFT [OUTER] JOIN \u8868\u540d2 ON \u6761\u4ef6; */","title":"\u5de6\u5916\u8fde\u63a5"},{"location":"MySQL/#_56","text":"/* \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d1 RIGHT [OUTER] JOIN \u8868\u540d2 ON \u6761\u4ef6; */","title":"\u53f3\u5916\u8fde\u63a5"},{"location":"MySQL/#_57","text":"/* \u7ed3\u679c\u662f\u5355\u884c\u5355\u5217\u7684 \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d WHERE \u5217\u540d=(SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]); */ -- \u67e5\u8be2\u5e74\u9f84\u6700\u9ad8\u7684\u7528\u6237\u59d3\u540d SELECT MAX(age) FROM USER; SELECT NAME,age FROM USER WHERE age=(SELECT MAX(age) FROM USER); /* \u7ed3\u679c\u662f\u591a\u884c\u5355\u5217\u7684 \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d WHERE \u5217\u540d [NOT] IN (SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]); */ -- \u67e5\u8be2\u5f20\u4e09\u548c\u674e\u56db\u7684\u8ba2\u5355\u4fe1\u606f SELECT * FROM orderlist WHERE uid IN (1,2); SELECT id FROM USER WHERE NAME IN ('\u5f20\u4e09','\u674e\u56db'); SELECT * FROM orderlist WHERE uid IN (SELECT id FROM USER WHERE NAME IN ('\u5f20\u4e09','\u674e\u56db')); /* \u7ed3\u679c\u662f\u591a\u884c\u591a\u5217\u7684 \u6807\u51c6\u8bed\u6cd5\uff1a SELECT \u5217\u540d FROM \u8868\u540d [\u522b\u540d],(SELECT \u5217\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]) [\u522b\u540d] [WHERE \u6761\u4ef6]; */ -- \u67e5\u8be2\u8ba2\u5355\u8868\u4e2did\u5927\u4e8e4\u7684\u8ba2\u5355\u4fe1\u606f\u548c\u6240\u5c5e\u7528\u6237\u4fe1\u606f SELECT * FROM orderlist WHERE id > 4; SELECT u.name, o.number FROM USER u, (SELECT * FROM orderlist WHERE id > 4) o WHERE o.uid=u.id;","title":"\u5b50\u67e5\u8be2"},{"location":"MySQL/#_58","text":"-- \u521b\u5efa\u5458\u5de5\u8868 CREATE TABLE employee( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5458\u5de5\u7f16\u53f7 NAME VARCHAR(20), -- \u5458\u5de5\u59d3\u540d mgr INT, -- \u4e0a\u7ea7\u7f16\u53f7 salary DOUBLE -- \u5458\u5de5\u5de5\u8d44 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO employee VALUES (1001,'\u5b59\u609f\u7a7a',1005,9000.00), (1002,'\u732a\u516b\u6212',1005,8000.00), (1003,'\u6c99\u548c\u5c1a',1005,8500.00), (1004,'\u5c0f\u767d\u9f99',1005,7900.00), (1005,'\u5510\u50e7',NULL,15000.00), (1006,'\u6b66\u677e',1009,7600.00), (1007,'\u674e\u9035',1009,7400.00), (1008,'\u6797\u51b2',1009,8100.00), (1009,'\u5b8b\u6c5f',NULL,16000.00); -- \u67e5\u8be2\u6240\u6709\u5458\u5de5\u7684\u59d3\u540d\u53ca\u5176\u76f4\u63a5\u4e0a\u7ea7\u7684\u59d3\u540d\uff0c\u6ca1\u6709\u4e0a\u7ea7\u7684\u5458\u5de5\u4e5f\u9700\u8981\u67e5\u8be2 /* \u5206\u6790 \u5458\u5de5\u4fe1\u606f employee\u8868 \u6761\u4ef6\uff1aemployee.mgr = employee.id \u67e5\u8be2\u5de6\u8868\u7684\u5168\u90e8\u6570\u636e\uff0c\u548c\u5de6\u53f3\u4e24\u5f20\u8868\u6709\u4ea4\u96c6\u90e8\u5206\u6570\u636e\uff0c\u5de6\u5916\u8fde\u63a5 */ SELECT e1.id, e1.name, e1.mgr, e2.id, e2.name FROM employee e1 LEFT OUTER JOIN employee e2 ON e1.mgr = e2.id;","title":"\u81ea\u5173\u8054\u67e5\u8be2"},{"location":"MySQL/#_59","text":"-- 1.\u67e5\u8be2\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid */ SELECT u.id, u.name, u.age, o.number FROM USER u, orderlist o WHERE u.id=o.uid; -- 2.\u67e5\u8be2\u6240\u6709\u7684\u7528\u6237\u3002\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid \u67e5\u8be2\u6240\u6709\u7684\u7528\u6237\uff0c\u5de6\u5916\u8fde\u63a5 */ SELECT u.id, u.name, u.age, o.number FROM USER u LEFT OUTER JOIN orderlist o ON u.id=o.uid; -- 3.\u67e5\u8be2\u6240\u6709\u7684\u8ba2\u5355\u3002\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid \u67e5\u8be2\u6240\u6709\u7684\u8ba2\u5355\uff0c\u53f3\u5916\u8fde\u63a5 */ SELECT u.id, u.name, u.age, o.number FROM USER u RIGHT OUTER JOIN orderlist o ON u.id=o.uid; -- 4.\u67e5\u8be2\u7528\u6237\u5e74\u9f84\u5927\u4e8e23\u5c81\u7684\u4fe1\u606f\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid AND user.age > 23 */ SELECT u.id, u.name, u.age, o.number FROM USER u, orderlist o WHERE u.id=o.uid AND u.age > 23; -- 5.\u67e5\u8be2\u5f20\u4e09\u548c\u674e\u56db\u7528\u6237\u7684\u4fe1\u606f\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u8ba2\u5355\u7f16\u53f7 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u8ba2\u5355\u7f16\u53f7 orderlist\u8868 \u6761\u4ef6\uff1auser.id=orderlist.uid AND user.name IN ('\u5f20\u4e09','\u674e\u56db') */ SELECT u.id, u.name, u.age, o.number FROM USER u, orderlist o WHERE u.id=o.uid AND u.name IN ('\u5f20\u4e09','\u674e\u56db'); -- 6.\u67e5\u8be2\u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0\u3002\u5206\u7c7b\u4e0b\u7684\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0 category\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u6761\u4ef6\uff1acategory.id=product.cid */ SELECT c.id, c.name, p.name FROM category c, product p WHERE c.id=p.cid; -- 7.\u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u5206\u7c7b\u3002\u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0\u3002\u5206\u7c7b\u4e0b\u7684\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0 category\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u6761\u4ef6\uff1acategory.id=product.cid \u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u5206\u7c7b\uff0c\u5de6\u5916\u8fde\u63a5 */ SELECT c.id, c.name, p.name FROM category c LEFT OUTER JOIN product p ON c.id=p.cid; -- 8.\u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u4fe1\u606f\u3002\u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0\u3002\u5206\u7c7b\u4e0b\u7684\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u5546\u54c1\u5206\u7c7b\u7684\u7f16\u53f7\u3001\u5206\u7c7b\u540d\u79f0 category\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u6761\u4ef6\uff1acategory.id=product.cid \u67e5\u8be2\u6240\u6709\u7684\u5546\u54c1\u4fe1\u606f\uff0c\u53f3\u5916\u8fde\u63a5 */ SELECT c.id, c.name, p.name FROM category c RIGHT OUTER JOIN product p ON c.id=p.cid; -- 9.\u67e5\u8be2\u6240\u6709\u7684\u7528\u6237\u548c\u8be5\u7528\u6237\u80fd\u67e5\u770b\u7684\u6240\u6709\u7684\u5546\u54c1\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u4e2d\u95f4\u8868 us_pro \u6761\u4ef6\uff1aus_pro.uid=user.id AND us_pro.pid=product.id */ SELECT u.id, u.name, u.age, p.name FROM USER u, product p, us_pro up WHERE up.uid=u.id AND up.pid=p.id; -- 10.\u67e5\u8be2\u5f20\u4e09\u548c\u674e\u56db\u8fd9\u4e24\u4e2a\u7528\u6237\u53ef\u4ee5\u770b\u5230\u7684\u5546\u54c1\u3002\u663e\u793a\u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84\u3002\u5546\u54c1\u540d\u79f0 /* \u5206\u6790 \u7528\u6237\u7684\u7f16\u53f7\u3001\u59d3\u540d\u3001\u5e74\u9f84 user\u8868 \u5546\u54c1\u540d\u79f0 product\u8868 \u4e2d\u95f4\u8868 us_pro \u6761\u4ef6\uff1aus_pro.uid=user.id AND us_pro.pid=product.id AND user.name IN ('\u5f20\u4e09','\u674e\u56db') */ SELECT u.id, u.name, u.age, p.name FROM USER u, product p, us_pro up WHERE up.uid=u.id AND up.pid=p.id AND u.name IN ('\u5f20\u4e09','\u674e\u56db');","title":"\u591a\u8868\u67e5\u8be2\u7ec3\u4e60"},{"location":"MySQL/#03_1","text":"","title":"03\u89c6\u56fe"},{"location":"MySQL/#_","text":"-- \u521b\u5efadb5\u6570\u636e\u5e93 CREATE DATABASE db5; -- \u4f7f\u7528db5\u6570\u636e\u5e93 USE db5; -- \u521b\u5efacountry\u8868 CREATE TABLE country( id INT PRIMARY KEY AUTO_INCREMENT, -- \u56fd\u5bb6id NAME VARCHAR(30) -- \u56fd\u5bb6\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO country VALUES (NULL,'\u4e2d\u56fd'),(NULL,'\u7f8e\u56fd'),(NULL,'\u4fc4\u7f57\u65af'); -- \u521b\u5efacity\u8868 CREATE TABLE city( id INT PRIMARY KEY AUTO_INCREMENT, -- \u57ce\u5e02id NAME VARCHAR(30), -- \u57ce\u5e02\u540d\u79f0 cid INT, -- \u5916\u952e\u5217\u3002\u5173\u8054country\u8868\u7684\u4e3b\u952e\u5217id CONSTRAINT cc_fk1 FOREIGN KEY (cid) REFERENCES country(id) -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO city VALUES (NULL,'\u5317\u4eac',1),(NULL,'\u4e0a\u6d77',1),(NULL,'\u7ebd\u7ea6',2),(NULL,'\u83ab\u65af\u79d1',3);","title":"\u89c6\u56fe_\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#_60","text":"/* \u6807\u51c6\u8bed\u6cd5 CREATE VIEW \u89c6\u56fe\u540d\u79f0 [(\u5217\u540d\u5217\u8868)] AS \u67e5\u8be2\u8bed\u53e5; */ example -- \u521b\u5efacity_country\u89c6\u56fe\uff0c\u4fdd\u5b58\u57ce\u5e02\u548c\u56fd\u5bb6\u7684\u4fe1\u606f(\u4f7f\u7528\u6307\u5b9a\u5217\u540d) CREATE VIEW city_country (city_id,city_name,country_name) AS SELECT c1.id, c1.name, c2.name FROM city c1, country c2 WHERE c1.cid=c2.id;","title":"\u521b\u5efa\u89c6\u56fe"},{"location":"MySQL/#_61","text":"/* \u6807\u51c6\u8bed\u6cd5 SELECT * FROM \u89c6\u56fe\u540d\u79f0; */ example -- \u67e5\u8be2\u89c6\u56fe SELECT * FROM city_country;","title":"\u67e5\u8be2\u89c6\u56fe"},{"location":"MySQL/#day03","text":"","title":"day03"},{"location":"MySQL/#01_2","text":"","title":"01\u89c6\u56fe"},{"location":"MySQL/#_62","text":"-- \u521b\u5efadb7\u6570\u636e\u5e93 CREATE DATABASE db7; -- \u4f7f\u7528db7\u6570\u636e\u5e93 USE db7; -- \u521b\u5efacountry\u8868 CREATE TABLE country( id INT PRIMARY KEY AUTO_INCREMENT, -- \u56fd\u5bb6id country_name VARCHAR(30) -- \u56fd\u5bb6\u540d\u79f0 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO country VALUES (NULL,'\u4e2d\u56fd'),(NULL,'\u7f8e\u56fd'),(NULL,'\u4fc4\u7f57\u65af'); -- \u521b\u5efacity\u8868 CREATE TABLE city( id INT PRIMARY KEY AUTO_INCREMENT, -- \u57ce\u5e02id city_name VARCHAR(30), -- \u57ce\u5e02\u540d\u79f0 cid INT, -- \u5916\u952e\u5217\u3002\u5173\u8054country\u8868\u7684\u4e3b\u952e\u5217id CONSTRAINT cc_fk1 FOREIGN KEY (cid) REFERENCES country(id) -- \u6dfb\u52a0\u5916\u952e\u7ea6\u675f ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO city VALUES (NULL,'\u5317\u4eac',1),(NULL,'\u4e0a\u6d77',1),(NULL,'\u7ebd\u7ea6',2),(NULL,'\u83ab\u65af\u79d1',3);","title":"\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#_63","text":"/* \u521b\u5efa\u89c6\u56fe \u6807\u51c6\u8bed\u6cd5 CREATE VIEW \u89c6\u56fe\u540d\u79f0 [(\u5217\u540d\u5217\u8868)] AS \u67e5\u8be2\u8bed\u53e5; */","title":"\u521b\u5efa\u89c6\u56fe"},{"location":"MySQL/#_64","text":"","title":"\u67e5\u8be2\u89c6\u56fe"},{"location":"MySQL/#_65","text":"/* \u6807\u51c6\u8bed\u6cd5 SELECT * FROM \u89c6\u56fe\u540d\u79f0; */","title":"\u67e5\u8be2\u89c6\u56fe"},{"location":"MySQL/#_66","text":"/* \u6807\u51c6\u8bed\u6cd5 SHOW CREATE VIEW \u89c6\u56fe\u540d\u79f0; */","title":"\u67e5\u8be2\u521b\u5efa\u89c6\u56fe\u7684\u8bed\u53e5"},{"location":"MySQL/#_67","text":"","title":"\u4fee\u6539\u89c6\u56fe"},{"location":"MySQL/#_68","text":"/* \u6807\u51c6\u8bed\u6cd5 UPDATE \u89c6\u56fe\u540d\u79f0 SET \u5217\u540d=\u503c WHERE \u6761\u4ef6; */","title":"\u4fee\u6539\u89c6\u56fe\u8868\u6570\u636e"},{"location":"MySQL/#_69","text":"/* \u4fee\u6539\u89c6\u56fe\u8868\u7ed3\u6784 \u6807\u51c6\u8bed\u6cd5 ALTER VIEW \u89c6\u56fe\u540d\u79f0 [(\u5217\u540d\u5217\u8868)] AS \u67e5\u8be2\u8bed\u53e5; */","title":"\u4fee\u6539\u89c6\u56fe\u8868\u7ed3\u6784"},{"location":"MySQL/#_70","text":"/* \u5220\u9664\u89c6\u56fe \u6807\u51c6\u8bed\u6cd5 DROP VIEW [IF EXISTS] \u89c6\u56fe\u540d\u79f0; */","title":"\u5220\u9664\u89c6\u56fe"},{"location":"MySQL/#02_2","text":"","title":"02\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570"},{"location":"MySQL/#_71","text":"-- \u521b\u5efadb8\u6570\u636e\u5e93 CREATE DATABASE db8; -- \u4f7f\u7528db8\u6570\u636e\u5e93 USE db8; -- \u521b\u5efa\u5b66\u751f\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, -- \u5b66\u751fid NAME VARCHAR(20), -- \u5b66\u751f\u59d3\u540d age INT, -- \u5b66\u751f\u5e74\u9f84 gender VARCHAR(5), -- \u5b66\u751f\u6027\u522b score INT -- \u5b66\u751f\u6210\u7ee9 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,'\u7537',95),(NULL,'\u674e\u56db',24,'\u7537',98), (NULL,'\u738b\u4e94',25,'\u5973',100),(NULL,'\u8d75\u516d',26,'\u5973',90); -- \u6309\u7167\u6027\u522b\u8fdb\u884c\u5206\u7ec4\uff0c\u67e5\u8be2\u6bcf\u7ec4\u5b66\u751f\u7684\u603b\u6210\u7ee9\u3002\u6309\u7167\u603b\u6210\u7ee9\u7684\u5347\u5e8f\u6392\u5e8f SELECT gender,SUM(score) getSum FROM student GROUP BY gender ORDER BY getSum ASC;","title":"\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#_72","text":"/* -- \u4fee\u6539\u5206\u9694\u7b26\u4e3a $ DELIMITER $ -- \u6807\u51c6\u8bed\u6cd5 CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ( \u53c2\u6570 ...) BEGIN sql\u8bed\u53e5 ; END $ -- \u4fee\u6539\u5206\u9694\u7b26\u4e3a\u5206\u53f7 DELIMITER ; */ -- \u521b\u5efastu_group()\u5b58\u50a8\u8fc7\u7a0b\uff0c\u5c01\u88c5 \u5206\u7ec4\u67e5\u8be2\u603b\u6210\u7ee9\uff0c\u5e76\u6309\u7167\u603b\u6210\u7ee9\u5347\u5e8f\u6392\u5e8f\u7684\u529f\u80fd DELIMITER $ CREATE PROCEDURE stu_group () BEGIN SELECT gender , SUM ( score ) getSum FROM student GROUP BY gender ORDER BY getSum ASC ; END $ DELIMITER ;","title":"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b"},{"location":"MySQL/#_73","text":"/* \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b \u6807\u51c6\u8bed\u6cd5 CALL \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0(\u5b9e\u9645\u53c2\u6570); */ -- \u8c03\u7528stu_group\u5b58\u50a8\u8fc7\u7a0b CALL stu_group();","title":"\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b"},{"location":"MySQL/#_74","text":"/* \u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b \u6807\u51c6\u8bed\u6cd5 SELECT name FROM mysql.proc WHERE db='\u6570\u636e\u5e93\u540d\u79f0'; */ -- \u67e5\u770bdb8\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b SELECT NAME FROM mysql.proc WHERE db='db8';","title":"\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u5b58\u50a8\u8fc7\u7a0b"},{"location":"MySQL/#_75","text":"/* \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u72b6\u6001\u4fe1\u606f \u6807\u51c6\u8bed\u6cd5 SHOW PROCEDURE STATUS ; */ -- \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u72b6\u6001\u4fe1\u606f SHOW PROCEDURE STATUS ;","title":"\u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u72b6\u6001\u4fe1\u606f"},{"location":"MySQL/#_76","text":"/* \u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u521b\u5efa\u8bed\u53e5 \u6807\u51c6\u8bed\u6cd5 SHOW CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ; */ -- \u67e5\u8be2stu_group\u5b58\u50a8\u8fc7\u7a0b\u7684\u521b\u5efa\u8bed\u53e5 SHOW CREATE PROCEDURE stu_group ;","title":"\u67e5\u770b\u5b58\u50a8\u8fc7\u7a0b\u7684\u521b\u5efa\u8bed\u53e5"},{"location":"MySQL/#_77","text":"/* \u5220\u9664\u5b58\u50a8\u8fc7\u7a0b \u6807\u51c6\u8bed\u6cd5 DROP PROCEDURE [IF EXISTS] \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0; */ -- \u5220\u9664stu_group\u5b58\u50a8\u8fc7\u7a0b DROP PROCEDURE IF EXISTS stu_group ;","title":"\u5220\u9664\u5b58\u50a8\u8fc7\u7a0b"},{"location":"MySQL/#-","text":"","title":"\u5b58\u50a8\u8fc7\u7a0b-\u53d8\u91cf"},{"location":"MySQL/#_78","text":"/* \u5b9a\u4e49\u53d8\u91cf \u6807\u51c6\u8bed\u6cd5 DECLARE \u53d8\u91cf\u540d \u6570\u636e\u7c7b\u578b [DEFAULT \u9ed8\u8ba4\u503c]; */ -- \u5b9a\u4e49\u4e00\u4e2aint\u7c7b\u578b\u53d8\u91cf\uff0c\u5e76\u8d4b\u9ed8\u8ba4\u503c\u4e3a10 DELIMITER $ CREATE PROCEDURE pro_test1 () BEGIN -- \u5b9a\u4e49\u53d8\u91cf DECLARE num INT DEFAULT 10 ; -- \u67e5\u8be2\u53d8\u91cf SELECT num ; END $ DELIMITER ; -- \u8c03\u7528pro_test1\u5b58\u50a8\u8fc7\u7a0b CALL pro_test1();","title":"\u5b9a\u4e49\u53d8\u91cf"},{"location":"MySQL/#-_1","text":"/* \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e00 \u6807\u51c6\u8bed\u6cd5 SET \u53d8\u91cf\u540d = \u53d8\u91cf\u503c; */ -- \u5b9a\u4e49\u4e00\u4e2avarchar\u7c7b\u578b\u53d8\u91cf\u5e76\u8d4b\u503c DELIMITER $ CREATE PROCEDURE pro_test2 () BEGIN -- \u5b9a\u4e49\u53d8\u91cf DECLARE NAME VARCHAR ( 10 ); -- \u4e3a\u53d8\u91cf\u8d4b\u503c SET NAME = '\u5b58\u50a8\u8fc7\u7a0b' ; -- \u67e5\u8be2\u53d8\u91cf SELECT NAME ; END $ DELIMITER ; -- \u8c03\u7528pro_test2\u5b58\u50a8\u8fc7\u7a0b CALL pro_test2(); \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e8c /* \u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e8c \u6807\u51c6\u8bed\u6cd5 SELECT \u5217\u540d INTO \u53d8\u91cf\u540d FROM \u8868\u540d [WHERE \u6761\u4ef6]; */ -- \u5b9a\u4e49\u4e24\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u7537\u5973\u540c\u5b66\u7684\u603b\u5206\u6570 DELIMITER $ CREATE PROCEDURE pro_test3 () BEGIN -- \u5b9a\u4e49\u53d8\u91cf DECLARE men , women INT ; -- \u67e5\u8be2\u7537\u540c\u5b66\u7684\u603b\u5206\u6570\uff0c\u4e3a men\u53d8\u91cf\u8d4b\u503c SELECT SUM ( score ) INTO men FROM student WHERE gender = '\u7537' ; -- \u67e5\u8be2\u5973\u540c\u5b66\u7684\u603b\u5206\u6570\uff0c\u4e3a women\u53d8\u91cf\u8d4b\u503c SELECT SUM ( score ) INTO women FROM student WHERE gender = '\u5973' ; -- \u67e5\u8be2\u53d8\u91cf SELECT men , women ; END $ DELIMITER ; -- \u8c03\u7528pro_test3\u5b58\u50a8\u8fc7\u7a0b CALL pro_test3();","title":"\u53d8\u91cf\u8d4b\u503c-\u65b9\u5f0f\u4e00"},{"location":"MySQL/#-if","text":"/* \u5b58\u50a8\u8fc7\u7a0b - if\u8bed\u53e5 \u6807\u51c6\u8bed\u6cd5 IF \u5224\u65ad\u6761\u4ef6 1 THEN \u6267\u884c\u7684 sql\u8bed\u53e51 ; [ ELSEIF \u5224\u65ad\u6761\u4ef6 2 THEN \u6267\u884c\u7684 sql\u8bed\u53e52 ;] ... [ ELSE \u6267\u884c\u7684 sql\u8bed\u53e5n ;] END IF ; */ / \u5b9a\u4e49\u4e00\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u73ed\u7ea7\u603b\u6210\u7ee9 \u5b9a\u4e49\u4e00\u4e2avarchar\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u6570\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c / DELIMITER $ CREATE PROCEDURE pro_test4 () BEGIN -- \u5b9a\u4e49\u4fdd\u5b58\u603b\u6210\u7ee9\u7684\u53d8\u91cf DECLARE total INT ; -- \u5b9a\u4e49\u4fdd\u5b58\u5206\u6570\u63cf\u8ff0\u7684\u53d8\u91cf DECLARE description VARCHAR ( 10 ); -- \u4e3a total\u8d4b\u503c SELECT SUM ( score ) INTO total FROM student ; -- \u5224\u65ad\u603b\u6210\u7ee9 IF total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; ELSEIF total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END IF ; -- \u67e5\u8be2\u603b\u6210\u7ee9\u548c\u63cf\u8ff0\u4fe1\u606f SELECT total , description ; END $ DELIMITER ; -- \u8c03\u7528pro_test4\u5b58\u50a8\u8fc7\u7a0b CALL pro_test4();","title":"\u5b58\u50a8\u8fc7\u7a0b-if\u8bed\u53e5"},{"location":"MySQL/#__1","text":"/* \u8f93\u5165\u53c2\u6570 DELIMITER $ -- \u6807\u51c6\u8bed\u6cd5 CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ( IN \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b ) BEGIN \u6267\u884c\u7684 sql\u8bed\u53e5 ; END $ DELIMITER ; */ / \u8f93\u5165\u603b\u6210\u7ee9\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9 \u5b9a\u4e49\u4e00\u4e2avarchar\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u6570\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c / DELIMITER $ CREATE PROCEDURE pro_test5 ( IN total INT ) BEGIN -- \u5b9a\u4e49\u5206\u6570\u63cf\u8ff0\u53d8\u91cf DECLARE description VARCHAR ( 10 ); -- \u5224\u65ad\u603b\u6210\u7ee9 IF total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; ELSEIF total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END IF ; -- \u67e5\u8be2\u603b\u6210\u7ee9\u548c\u63cf\u8ff0\u4fe1\u606f SELECT total , description ; END $ DELIMITER ; -- \u8c03\u7528pro_test5\u5b58\u50a8\u8fc7\u7a0b CALL pro_test5(310); CALL pro_test5((SELECT SUM(score) FROM student));","title":"\u5b58\u50a8\u8fc7\u7a0b_\u8f93\u5165\u53c2\u6570"},{"location":"MySQL/#__2","text":"/* \u8f93\u51fa\u53c2\u6570 DELIMITER $ -- \u6807\u51c6\u8bed\u6cd5 CREATE PROCEDURE \u5b58\u50a8\u8fc7\u7a0b\u540d\u79f0 ( OUT \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b ) BEGIN \u6267\u884c\u7684 sql\u8bed\u53e5 ; END $ DELIMITER ; */ /\u8f93\u5165\u603b\u6210\u7ee9\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9 \u8f93\u51fa\u5206\u6570\u63cf\u8ff0\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9\u7684\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c */ DELIMITER $ CREATE PROCEDURE pro_test6 ( IN total INT , OUT description VARCHAR ( 10 )) BEGIN -- \u5224\u65ad\u603b\u6210\u7ee9 IF total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; ELSEIF total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END IF ; END $ DELIMITER ; -- \u8c03\u7528pro_test6\u5b58\u50a8\u8fc7\u7a0b CALL pro_test6 ( 390 , @description ); -- \u67e5\u8be2\u603b\u6210\u7ee9\u63cf\u8ff0\u4fe1\u606f\u53d8\u91cf SELECT @description ;","title":"\u5b58\u50a8\u8fc7\u7a0b_\u8f93\u51fa\u53c2\u6570"},{"location":"MySQL/#_case","text":"/* case\u8bed\u53e5 \u6807\u51c6\u8bed\u6cd5 CASE WHEN \u5224\u65ad\u6761\u4ef6 1 THEN \u6267\u884c sql\u8bed\u53e51 ; [ WHEN \u5224\u65ad\u6761\u4ef6 2 THEN \u6267\u884c sql\u8bed\u53e52 ;] ... [ ELSE \u6267\u884c sql\u8bed\u53e5n ;] END CASE ; */ / \u8f93\u5165\u603b\u6210\u7ee9\u53d8\u91cf\uff0c\u4ee3\u8868\u5b66\u751f\u603b\u6210\u7ee9 \u5b9a\u4e49\u4e00\u4e2avarchar\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u6570\u63cf\u8ff0 \u6839\u636e\u603b\u6210\u7ee9\u5224\u65ad\uff1a 380\u5206\u53ca\u4ee5\u4e0a \u5b66\u4e60\u4f18\u79c0 320 ~ 380 \u5b66\u4e60\u4e0d\u9519 320\u4ee5\u4e0b \u5b66\u4e60\u4e00\u822c / DELIMITER $ CREATE PROCEDURE pro_test7 ( IN total INT ) BEGIN -- \u5b9a\u4e49\u603b\u6210\u7ee9\u63cf\u8ff0\u4fe1\u606f\u53d8\u91cf DECLARE description VARCHAR ( 10 ); -- \u5224\u65ad\u603b\u6210\u7ee9 CASE WHEN total >= 380 THEN SET description = '\u5b66\u4e60\u4f18\u79c0' ; WHEN total >= 320 AND total < 380 THEN SET description = '\u5b66\u4e60\u4e0d\u9519' ; ELSE SET description = '\u5b66\u4e60\u4e00\u822c' ; END CASE ; -- \u67e5\u8be2\u603b\u6210\u7ee9\u548c\u63cf\u8ff0\u4fe1\u606f SELECT total , description ; END $ DELIMITER ; -- \u8c03\u7528pro_test7\u5b58\u50a8\u8fc7\u7a0b CALL pro_test7(310);","title":"\u5b58\u50a8\u8fc7\u7a0b_case\u8bed\u53e5"},{"location":"MySQL/#_while","text":"/* while\u5faa\u73af \u6807\u51c6\u8bed\u6cd5 \u521d\u59cb\u5316\u8bed\u53e5 ; WHILE \u6761\u4ef6\u5224\u65ad\u8bed\u53e5 DO \u5faa\u73af\u4f53\u8bed\u53e5 ; \u6761\u4ef6\u63a7\u5236\u8bed\u53e5 ; END WHILE ; */ -- \u8ba1\u7b971~100\u4e4b\u95f4\u7684\u5076\u6570\u548c DELIMITER $ CREATE PROCEDURE pro_test8 () BEGIN -- \u5b9a\u4e49\u6c42\u548c\u53d8\u91cf DECLARE result INT DEFAULT 0 ; -- \u5b9a\u4e49\u521d\u59cb\u5316\u53d8\u91cf DECLARE num INT DEFAULT 1 ; -- while\u5faa\u73af WHILE num <= 100 DO -- \u5224\u65ad num\u662f\u5426\u662f\u5076\u6570 IF num % 2 = 0 THEN -- \u8ba9 num\u548cresult\u8fdb\u884c\u7d2f\u52a0 SET result = result + num ; END IF ; -- \u8ba9 num\u8fdb\u884c\u81ea\u589e SET num = num + 1 ; END WHILE ; -- \u67e5\u8be2\u6c42\u548c\u7ed3\u679c SELECT result ; END $ DELIMITER ; -- \u8c03\u7528pro_test8\u5b58\u50a8\u8fc7\u7a0b CALL pro_test8();","title":"\u5b58\u50a8\u8fc7\u7a0b_while\u5faa\u73af"},{"location":"MySQL/#_repeat","text":"/* repeat\u5faa\u73af \u6807\u51c6\u8bed\u6cd5 \u521d\u59cb\u5316\u8bed\u53e5 ; REPEAT \u5faa\u73af\u4f53\u8bed\u53e5 ; \u6761\u4ef6\u63a7\u5236\u8bed\u53e5 ; UNTIL \u6761\u4ef6\u5224\u65ad\u8bed\u53e5 END REPEAT ; */ -- \u8ba1\u7b971~10\u4e4b\u95f4\u7684\u548c DELIMITER $ CREATE PROCEDURE pro_test9 () BEGIN -- \u5b9a\u4e49\u6c42\u548c\u53d8\u91cf DECLARE result INT DEFAULT 0 ; -- \u5b9a\u4e49\u521d\u59cb\u5316\u53d8\u91cf DECLARE num INT DEFAULT 1 ; -- repeat\u5faa\u73af REPEAT -- \u7d2f\u52a0 SET result = result + num ; -- \u8ba9 num + 1 SET num = num + 1 ; -- \u505c\u6b62\u5faa\u73af UNTIL num > 10 END REPEAT ; -- \u67e5\u8be2\u6c42\u548c\u7ed3\u679c SELECT result ; END $ DELIMITER ; -- \u8c03\u7528pro_test9\u5b58\u50a8\u8fc7\u7a0b CALL pro_test9();","title":"\u5b58\u50a8\u8fc7\u7a0b_repeat\u5faa\u73af"},{"location":"MySQL/#_loop","text":"/* loop\u5faa\u73af \u6807\u51c6\u8bed\u6cd5 \u521d\u59cb\u5316\u8bed\u53e5; [ \u5faa\u73af\u540d\u79f0 : ] LOOP \u6761\u4ef6\u5224\u65ad\u8bed\u53e5 [ LEAVE \u5faa\u73af\u540d\u79f0 ; ] \u5faa\u73af\u4f53\u8bed\u53e5; \u6761\u4ef6\u63a7\u5236\u8bed\u53e5; END LOOP \u5faa\u73af\u540d\u79f0; */ -- \u8ba1\u7b971~10\u4e4b\u95f4\u7684\u548c DELIMITER $ CREATE PROCEDURE pro_test10 () BEGIN -- \u5b9a\u4e49\u6c42\u548c\u53d8\u91cf DECLARE result INT DEFAULT 0 ; -- \u5b9a\u4e49\u521d\u59cb\u5316\u53d8\u91cf DECLARE num INT DEFAULT 1 ; -- loop\u5faa\u73af l : LOOP -- \u6761\u4ef6\u5224\u65ad \uff0c \u505c\u6b62\u5faa\u73af IF num > 10 THEN LEAVE l ; END IF ; -- \u7d2f\u52a0 SET result = result + num ; -- \u8ba9num + 1 SET num = num + 1 ; END LOOP l ; -- \u67e5\u8be2\u6c42\u548c\u7ed3\u679c SELECT result ; END $ DELIMITER ; -- \u8c03\u7528pro_test10\u5b58\u50a8\u8fc7\u7a0b CALL pro_test10();","title":"\u5b58\u50a8\u8fc7\u7a0b_loop\u5faa\u73af"},{"location":"MySQL/#__3","text":"/* \u6e38\u6807 \u6807\u51c6\u8bed\u6cd5 1.\u521b\u5efa\u6e38\u6807\uff1aDECLARE \u6e38\u6807\u540d\u79f0 CURSOR FOR \u67e5\u8be2sql\u8bed\u53e5; 2.\u6253\u5f00\u6e38\u6807\uff1aOPEN \u6e38\u6807\u540d\u79f0; 3.\u4f7f\u7528\u6e38\u6807\uff1aFETCH \u6e38\u6807\u540d\u79f0 INTO \u53d8\u91cf\u540d1,\u53d8\u91cf\u540d2,...; 4.\u5173\u95ed\u6e38\u6807\uff1aCLOSE \u6e38\u6807\u540d\u79f0; */ -- \u521b\u5efastu_score\u8868 CREATE TABLE stu_score( id INT PRIMARY KEY AUTO_INCREMENT, score INT ); -- \u5c06student\u8868\u4e2d\u6240\u6709\u7684\u6210\u7ee9\u4fdd\u5b58\u5230stu_score\u8868\u4e2d DELIMITER $ CREATE PROCEDURE pro_test11 () BEGIN -- \u5b9a\u4e49\u4e00\u4e2a\u4fdd\u5b58\u6210\u7ee9\u7684\u53d8\u91cf DECLARE s_score INT ; -- \u521b\u5efa\u6e38\u6807 DECLARE stu_result CURSOR FOR SELECT score FROM student ; -- \u5f00\u542f\u6e38\u6807 OPEN stu_result ; -- \u4f7f\u7528\u6e38\u6807 -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 1 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 2 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 3 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u7b2c 4 \u884c\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u5173\u95ed\u6e38\u6807 CLOSE stu_result ; END $ DELIMITER ; -- \u8c03\u7528pro_test11\u5b58\u50a8\u8fc7\u7a0b CALL pro_test11(); -- \u67e5\u8be2stu_score\u6570\u636e\u8868 SELECT * FROM stu_score;","title":"\u5b58\u50a8\u8fc7\u7a0b_\u6e38\u6807"},{"location":"MySQL/#__4","text":"/* \u5f53\u6e38\u6807\u7ed3\u675f\u540e\uff0c\u4f1a\u81ea\u52a8\u7684\u89e6\u53d1\u4e00\u4e2a\u4e8b\u4ef6\u3002\u5c31\u4ee3\u8868\u6e38\u6807\u5df2\u7ecf\u7ed3\u675f\u4e86\uff01 \u52a0\u6807\u8bb0\u7684\u601d\u60f3\uff1a 1.\u5b9a\u4e49\u4e00\u4e2a\u6807\u8bb0\u53d8\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff08\u610f\u5473\u7740\u6709\u6570\u636e\uff09 2.\u5f53\u6e38\u6807\u7ed3\u675f\u540e\uff0c\u5c06\u6807\u8bb0\u53d8\u91cf\u7684\u503c\u4fee\u6539\u4e3a1\uff08\u610f\u5473\u7740\u6ca1\u6709\u6570\u636e\u4e86\uff09 */ DELIMITER $ CREATE PROCEDURE pro_test12 () BEGIN -- \u5b9a\u4e49\u4e00\u4e2a\u4fdd\u5b58\u6210\u7ee9\u7684\u53d8\u91cf DECLARE s_score INT ; -- \u5b9a\u4e49\u4e00\u4e2a\u6807\u8bb0\u53d8\u91cf\uff0c\u9ed8\u8ba4\u503c\u4e3a 0 \uff08\u610f\u5473\u7740\u6709\u6570\u636e\uff09 DECLARE flag INT DEFAULT 0 ; -- \u521b\u5efa\u6e38\u6807 DECLARE stu_result CURSOR FOR SELECT score FROM student ; -- \u5f53\u6e38\u6807\u7ed3\u675f\u540e\uff0c\u5c06\u6807\u8bb0\u53d8\u91cf\u7684\u503c\u4fee\u6539\u4e3a 1 \uff08\u610f\u5473\u7740\u6ca1\u6709\u6570\u636e\u4e86\uff09 DECLARE EXIT HANDLER FOR NOT FOUND SET flag = 1 ; -- \u5f00\u542f\u6e38\u6807 OPEN stu_result ; -- \u5faa\u73af\u4f7f\u7528\u6e38\u6807 REPEAT -- \u904d\u5386\u7ed3\u679c\uff0c\u62ff\u5230\u6570\u636e FETCH stu_result INTO s_score ; -- \u5c06\u6570\u636e\u4fdd\u5b58\u5230 stu_score\u8868\u4e2d INSERT INTO stu_score VALUES ( NULL , s_score ); -- \u5f53 flag\u7684\u503c\u662f1\u7684\u65f6\u5019 \uff0c\u5c31\u505c\u6b62\u5faa\u73af UNTIL flag = 1 END REPEAT ; -- \u5173\u95ed\u6e38\u6807 CLOSE stu_result ; END $ DELIMITER ; -- \u8c03\u7528pro_test12\u5b58\u50a8\u8fc7\u7a0b CALL pro_test12(); -- \u67e5\u8be2stu_score\u8868 SELECT * FROM stu_score;","title":"\u5b58\u50a8\u8fc7\u7a0b_\u6e38\u6807\u4f18\u5316"},{"location":"MySQL/#_79","text":"","title":"\u5b58\u50a8\u51fd\u6570"},{"location":"MySQL/#_80","text":"/* \u521b\u5efa\u5b58\u50a8\u51fd\u6570 \u6807\u51c6\u8bed\u6cd5 CREATE FUNCTION \u51fd\u6570\u540d\u79f0 ([ \u53c2\u6570 \u6570\u636e\u7c7b\u578b ]) RETURNS \u8fd4\u56de\u503c\u7c7b\u578b BEGIN \u6267\u884c\u7684 sql\u8bed\u53e5 ; RETURN \u7ed3\u679c ; END $ */ -- \u5b9a\u4e49\u5b58\u50a8\u51fd\u6570\uff0c\u83b7\u53d6\u5b66\u751f\u8868\u4e2d\u6210\u7ee9\u5927\u4e8e95\u5206\u7684\u5b66\u751f\u6570\u91cf DELIMITER $ CREATE FUNCTION fun_test1 () RETURNS INT BEGIN -- \u5b9a\u4e49\u4e00\u4e2a\u7edf\u8ba1\u53d8\u91cf DECLARE result INT ; -- \u67e5\u8be2\u6210\u7ee9\u5927\u4e8e 95 \u5206\u7684\u6570\u91cf SELECT COUNT ( * ) INTO result FROM student WHERE score > 95 ; -- \u5c06\u7ed3\u679c\u8fd4\u56de RETURN result ; END $ DELIMITER ;","title":"\u521b\u5efa\u5b58\u50a8\u51fd\u6570"},{"location":"MySQL/#_81","text":"/* \u8c03\u7528\u51fd\u6570 \u6807\u51c6\u8bed\u6cd5 SELECT \u51fd\u6570\u540d\u79f0(\u5b9e\u9645\u53c2\u6570); */ -- \u8c03\u7528\u51fd\u6570 SELECT fun_test1();","title":"\u8c03\u7528\u51fd\u6570"},{"location":"MySQL/#_82","text":"/* \u5220\u9664\u51fd\u6570 \u6807\u51c6\u8bed\u6cd5 DROP FUNCTION \u51fd\u6570\u540d\u79f0; */ -- \u5220\u9664\u51fd\u6570 DROP FUNCTION fun_test1;","title":"\u5220\u9664\u51fd\u6570"},{"location":"MySQL/#03_2","text":"","title":"03\u89e6\u53d1\u5668"},{"location":"MySQL/#_83","text":"-- \u521b\u5efadb9\u6570\u636e\u5e93 CREATE DATABASE db9; -- \u4f7f\u7528db9\u6570\u636e\u5e93 USE db9; -- \u521b\u5efa\u8d26\u6237\u8868account CREATE TABLE account( id INT PRIMARY KEY AUTO_INCREMENT, -- \u8d26\u6237id NAME VARCHAR(20), -- \u59d3\u540d money DOUBLE -- \u4f59\u989d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO account VALUES (NULL,'\u5f20\u4e09',1000),(NULL,'\u674e\u56db',2000); -- \u521b\u5efa\u65e5\u5fd7\u8868account_log CREATE TABLE account_log( id INT PRIMARY KEY AUTO_INCREMENT, -- \u65e5\u5fd7id operation VARCHAR(20), -- \u64cd\u4f5c\u7c7b\u578b (insert update delete) operation_time DATETIME, -- \u64cd\u4f5c\u65f6\u95f4 operation_id INT, -- \u64cd\u4f5c\u8868\u7684id operation_params VARCHAR(200) -- \u64cd\u4f5c\u53c2\u6570 );","title":"\u89e6\u53d1\u5668\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#insert","text":"/* \u521b\u5efa\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DELIMITER $ CREATE TRIGGER \u89e6\u53d1\u5668\u540d\u79f0 BEFORE | AFTER INSERT | UPDATE | DELETE ON \u8868\u540d FOR EACH ROW BEGIN \u89e6\u53d1\u5668\u8981\u6267\u884c\u7684\u529f\u80fd ; END $ DELIMITER ; */ -- \u521b\u5efaINSERT\u578b\u89e6\u53d1\u5668\u3002\u7528\u4e8e\u5bf9account\u8868\u65b0\u589e\u6570\u636e\u8fdb\u884c\u65e5\u5fd7\u7684\u8bb0\u5f55 DELIMITER $ CREATE TRIGGER account_insert AFTER INSERT ON account FOR EACH ROW BEGIN INSERT INTO account_log VALUES ( NULL , 'INSERT' , NOW (), new . id , CONCAT ( '\u63d2\u5165\u540e{id=' , new . id , ',name=' , new . name , ',money=' , new . money , '}' )); END $ DELIMITER ; -- \u5411account\u8868\u6765\u6dfb\u52a0\u4e00\u6761\u8bb0\u5f55 INSERT INTO account VALUES (NULL,'\u738b\u4e94',3000); -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u67e5\u8be2account_log\u8868 SELECT * FROM account_log;","title":"INSERT\u578b\u89e6\u53d1\u5668"},{"location":"MySQL/#update","text":"/* \u521b\u5efa\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DELIMITER $ CREATE TRIGGER \u89e6\u53d1\u5668\u540d\u79f0 BEFORE | AFTER INSERT | UPDATE | DELETE ON \u8868\u540d FOR EACH ROW BEGIN \u89e6\u53d1\u5668\u8981\u6267\u884c\u7684\u529f\u80fd ; END $ DELIMITER ; */ -- \u521b\u5efaUPDATE\u578b\u89e6\u53d1\u5668\u3002\u7528\u4e8e\u5bf9account\u8868\u4fee\u6539\u6570\u636e\u8fdb\u884c\u65e5\u5fd7\u7684\u8bb0\u5f55 DELIMITER $ CREATE TRIGGER account_update AFTER UPDATE ON account FOR EACH ROW BEGIN INSERT INTO account_log VALUES ( NULL , 'UPDATE' , NOW (), new . id , CONCAT ( '\u4fee\u6539\u524d{id=' , old . id , ',name=' , old . name , ',money=' , old . money , '}' , '\u4fee\u6539\u540e{id=' , new . id , ',name=' , new . name , ',money=' , new . money , '}' )); END $ DELIMITER ; -- \u4fee\u6539account\u8868\u4e2d\u674e\u56db\u7684\u91d1\u989d\u4e3a2500 UPDATE account SET money=2500 WHERE NAME='\u674e\u56db'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u67e5\u8be2account_log\u8868 SELECT * FROM account_log;","title":"UPDATE\u578b\u89e6\u53d1\u5668"},{"location":"MySQL/#delete","text":"/* \u521b\u5efa\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DELIMITER $ CREATE TRIGGER \u89e6\u53d1\u5668\u540d\u79f0 BEFORE | AFTER INSERT | UPDATE | DELETE ON \u8868\u540d FOR EACH ROW BEGIN \u89e6\u53d1\u5668\u8981\u6267\u884c\u7684\u529f\u80fd ; END $ DELIMITER ; */ -- \u521b\u5efaDELETE\u578b\u89e6\u53d1\u5668\u3002\u7528\u4e8e\u5bf9account\u8868\u5220\u9664\u6570\u636e\u8fdb\u884c\u65e5\u5fd7\u7684\u8bb0\u5f55 DELIMITER $ CREATE TRIGGER account_delete AFTER DELETE ON account FOR EACH ROW BEGIN INSERT INTO account_log VALUES ( NULL , 'DELETE' , NOW (), old . id , CONCAT ( '\u5220\u9664\u524d{id=' , old . id , ',name=' , old . name , ',money=' , old . money , '}' )); END $ DELIMITER ; -- \u5220\u9664account\u8868\u4e2d\u738b\u4e94 DELETE FROM account WHERE NAME='\u738b\u4e94'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u67e5\u8be2account_log\u8868 SELECT * FROM account_log;","title":"DELETE\u578b\u89e6\u53d1\u5668"},{"location":"MySQL/#_84","text":"/* \u67e5\u770b\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 SHOW TRIGGERS; */ -- \u67e5\u770b\u89e6\u53d1\u5668 SHOW TRIGGERS ;","title":"\u67e5\u770b\u89e6\u53d1\u5668"},{"location":"MySQL/#_85","text":"/* \u5220\u9664\u89e6\u53d1\u5668 \u6807\u51c6\u8bed\u6cd5 DROP TRIGGER \u89e6\u53d1\u5668\u540d\u79f0; */ -- \u5220\u9664\u89e6\u53d1\u5668 DROP TRIGGER account_delete;","title":"\u5220\u9664\u89e6\u53d1\u5668"},{"location":"MySQL/#04_1","text":"","title":"04\u4e8b\u52a1"},{"location":"MySQL/#_86","text":"-- \u521b\u5efadb10\u6570\u636e\u5e93 CREATE DATABASE db10; -- \u4f7f\u7528db10\u6570\u636e\u5e93 USE db10; -- \u521b\u5efa\u8d26\u6237\u8868 CREATE TABLE account( id INT PRIMARY KEY AUTO_INCREMENT, -- \u8d26\u6237id NAME VARCHAR(20), -- \u8d26\u6237\u540d\u79f0 money DOUBLE -- \u8d26\u6237\u4f59\u989d ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO account VALUES (NULL,'\u5f20\u4e09',1000),(NULL,'\u674e\u56db',1000);","title":"\u4e8b\u52a1\u7684\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#_87","text":"-- \u5f20\u4e09\u7ed9\u674e\u56db\u8f6c\u8d26500\u5143 -- 1.\u5f20\u4e09\u8d26\u6237-500 UPDATE account SET money=money-500 WHERE NAME='\u5f20\u4e09'; \u51fa\u9519\u4e86... -- 2.\u674e\u56db\u8d26\u6237+500 UPDATE account SET money=money+500 WHERE NAME='\u674e\u56db';","title":"\u672a\u7ba1\u7406\u4e8b\u52a1"},{"location":"MySQL/#_88","text":"/* \u5f00\u542f\u4e8b\u52a1\uff1aSTART TRANSACTION; \u56de\u6eda\u4e8b\u52a1\uff1aROLLBACK; \u63d0\u4ea4\u4e8b\u52a1\uff1aCOMMIT; */ -- \u5f20\u4e09\u7ed9\u674e\u56db\u8f6c\u8d26500\u5143 -- 1.\u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- 2.\u6267\u884c\u8f6c\u8d26\u7684\u64cd\u4f5c UPDATE account SET money=money-500 WHERE NAME='\u5f20\u4e09'; \u51fa\u9519\u4e86... UPDATE account SET money=money+500 WHERE NAME='\u674e\u56db'; -- 3.\u7ed3\u675f\u4e8b\u52a1 -- 3.1\u56de\u6eda\u4e8b\u52a1 ROLLBACK; -- 3.2\u63d0\u4ea4\u4e8b\u52a1 COMMIT;","title":"\u7ba1\u7406\u4e8b\u52a1"},{"location":"MySQL/#_89","text":"/* \u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f \u67e5\u8be2\u4e8b\u52a1\u63d0\u4ea4\u65b9\u5f0f\uff1aSELECT @@AUTOCOMMIT; -- 1\u4ee3\u8868\u81ea\u52a8\u63d0\u4ea4 0\u4ee3\u8868\u624b\u52a8\u63d0\u4ea4 \u4fee\u6539\u4e8b\u52a1\u63d0\u4ea4\u65b9\u5f0f\uff1aSET @@AUTOCOMMIT=\u6570\u5b57; */ -- \u67e5\u8be2\u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f SELECT @@autocommit ; UPDATE account SET money = 1000 WHERE NAME = '\u5f20\u4e09' ; COMMIT ; -- \u4fee\u6539\u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f SET @@autocommit = 0 ;","title":"\u4e8b\u52a1\u7684\u63d0\u4ea4\u65b9\u5f0f"},{"location":"MySQL/#_90","text":"/* \u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b \u67e5\u8be2\u9694\u79bb\u7ea7\u522b\uff1aSELECT @@TX_ISOLATION; \u4fee\u6539\u9694\u79bb\u7ea7\u522b\uff1aSET GLOBAL TRANSACTION ISOLATION LEVEL \u7ea7\u522b\u5b57\u7b26\u4e32; */ -- \u67e5\u8be2\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u4fee\u6539\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;","title":"\u67e5\u8be2\u548c\u4fee\u6539\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b"},{"location":"MySQL/#_91","text":"/* \u810f\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3 \u810f\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u8bfb\u53d6\u5230\u4e86\u5176\u4ed6\u4e8b\u52a1\u672a\u63d0\u4ea4\u7684\u6570\u636e */ -- \u8bbe\u7f6e\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3aread uncommitted SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED; SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u8f6c\u8d26 UPDATE account SET money = money-500 WHERE NAME='\u5f20\u4e09'; UPDATE account SET money = money+500 WHERE NAME='\u674e\u56db'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u56de\u6eda ROLLBACK;","title":"\u810f\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e31"},{"location":"MySQL/#_92","text":"-- \u67e5\u8be2\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2account\u8868 SELECT * FROM account;","title":"\u810f\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e32"},{"location":"MySQL/#_93","text":"/* \u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3 \u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u8bfb\u53d6\u5230\u4e86\u5176\u4ed6\u4e8b\u52a1\u5df2\u63d0\u4ea4\u7684\u6570\u636e */ -- \u8bbe\u7f6e\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3aread committed SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED; SET GLOBAL TRANSACTION ISOLATION LEVEL REPEATABLE READ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u8f6c\u8d26 UPDATE account SET money = money-500 WHERE NAME='\u5f20\u4e09'; UPDATE account SET money = money+500 WHERE NAME='\u674e\u56db'; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT;","title":"\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e31"},{"location":"MySQL/#_94","text":"-- \u67e5\u8be2\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT;","title":"\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e32"},{"location":"MySQL/#_95","text":"/* \u5e7b\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3 \u5e7b\u8bfb\uff1a \u67e5\u8be2\u67d0\u8bb0\u5f55\u662f\u5426\u5b58\u5728\uff0c\u4e0d\u5b58\u5728 \u51c6\u5907\u63d2\u5165\u6b64\u8bb0\u5f55\uff0c\u4f46\u6267\u884c\u63d2\u5165\u65f6\u53d1\u73b0\u6b64\u8bb0\u5f55\u5df2\u5b58\u5728\uff0c\u65e0\u6cd5\u63d2\u5165 \u6216\u67d0\u8bb0\u5f55\u4e0d\u5b58\u5728\u6267\u884c\u5220\u9664\uff0c\u5374\u53d1\u73b0\u5220\u9664\u6210\u529f */ -- \u8bbe\u7f6e\u9694\u79bb\u7ea7\u522b\u4e3arepeatable read SET GLOBAL TRANSACTION ISOLATION LEVEL REPEATABLE READ; SET GLOBAL TRANSACTION ISOLATION LEVEL SERIALIZABLE; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u6dfb\u52a0\u8bb0\u5f55 INSERT INTO account VALUES (4,'\u8d75\u516d',2000); -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT;","title":"\u5e7b\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e31"},{"location":"MySQL/#_96","text":"-- \u67e5\u8be2\u9694\u79bb\u7ea7\u522b SELECT @@tx_isolation ; -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2account\u8868 SELECT * FROM account; -- \u6dfb\u52a0 INSERT INTO account VALUES (3,'\u738b\u4e94',2000);","title":"\u5e7b\u8bfb\u7684\u95ee\u9898\u6f14\u793a\u548c\u89e3\u51b3_\u7a97\u53e32"},{"location":"MySQL/#day04","text":"","title":"day04"},{"location":"MySQL/#01_3","text":"","title":"01\u5b58\u50a8\u5f15\u64ce"},{"location":"MySQL/#_97","text":"/* \u67e5\u8be2\u6570\u636e\u5e93\u652f\u6301\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 SHOW ENGINES; */","title":"\u67e5\u8be2\u6570\u636e\u5e93\u652f\u6301\u7684\u5b58\u50a8\u5f15\u64ce"},{"location":"MySQL/#_98","text":"/* \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u6240\u6709\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 SHOW TABLE STATUS FROM \u6570\u636e\u5e93\u540d\u79f0; */","title":"\u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u6240\u6709\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce"},{"location":"MySQL/#_99","text":"/* \u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u67d0\u4e2a\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 SHOW TABLE STATUS FROM \u6570\u636e\u5e93\u540d\u79f0 WHERE NAME = '\u6570\u636e\u8868\u540d\u79f0'; */","title":"\u67e5\u8be2\u67d0\u4e2a\u6570\u636e\u5e93\u4e2d\u67d0\u4e2a\u8868\u7684\u5b58\u50a8\u5f15\u64ce"},{"location":"MySQL/#_100","text":"/* \u521b\u5efa\u6570\u636e\u8868\u6307\u5b9a\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 CREATE TABLE \u8868\u540d( \u5217\u540d,\u6570\u636e\u7c7b\u578b, ... )ENGINE = \u5f15\u64ce\u540d\u79f0; */","title":"\u521b\u5efa\u6570\u636e\u8868\u6307\u5b9a\u5b58\u50a8\u5f15\u64ce"},{"location":"MySQL/#_101","text":"/* \u4fee\u6539\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce \u6807\u51c6\u8bed\u6cd5 ALTER TABLE \u8868\u540d ENGINE = \u5f15\u64ce\u540d\u79f0; */ -- \u4fee\u6539engine_test\u8868\u7684\u5f15\u64ce\u4e3aInnoDB ALTER TABLE engine_test ENGINE = INNODB; -- \u67e5\u8be2engine_test\u8868\u7684\u5b58\u50a8\u5f15\u64ce SHOW TABLE STATUS FROM db11 WHERE NAME = ' engine_test ' ;","title":"\u4fee\u6539\u6570\u636e\u8868\u7684\u5b58\u50a8\u5f15\u64ce"},{"location":"MySQL/#02_3","text":"","title":"02\u7d22\u5f15"},{"location":"MySQL/#_102","text":"-- \u521b\u5efadb12\u6570\u636e\u5e93 CREATE DATABASE db12; -- \u4f7f\u7528db12\u6570\u636e\u5e93 USE db12; -- \u521b\u5efastudent\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(10), age INT, score INT ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,98),(NULL,'\u674e\u56db',24,95), (NULL,'\u738b\u4e94',25,96),(NULL,'\u8d75\u516d',26,94),(NULL,'\u5468\u4e03',27,99);","title":"\u7d22\u5f15\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#_103","text":"","title":"\u521b\u5efa\u548c\u67e5\u8be2\u7d22\u5f15"},{"location":"MySQL/#_104","text":"/* \u521b\u5efa\u7d22\u5f15 \u6807\u51c6\u8bed\u6cd5 CREATE [UNIQUE|FULLTEXT] INDEX \u7d22\u5f15\u540d\u79f0 [USING \u7d22\u5f15\u7c7b\u578b] -- \u9ed8\u8ba4\u662fB+TREE ON \u8868\u540d(\u5217\u540d...); */ -- \u4e3astudent\u8868\u4e2d\u7684name\u5217\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7d22\u5f15 CREATE INDEX idx_name ON student(NAME); -- \u4e3astudent\u8868\u4e2d\u7684age\u5217\u521b\u5efa\u4e00\u4e2a\u552f\u4e00\u7d22\u5f15 CREATE UNIQUE INDEX idx_age ON student(age);","title":"\u521b\u5efa\u7d22\u5f15"},{"location":"MySQL/#_105","text":"/* \u67e5\u8be2\u7d22\u5f15 \u6807\u51c6\u8bed\u6cd5 SHOW INDEX FROM \u8868\u540d; */ -- \u67e5\u8be2student\u8868\u4e2d\u7684\u7d22\u5f15 SHOW INDEX FROM student ;","title":"\u67e5\u8be2\u7d22\u5f15"},{"location":"MySQL/#alter","text":"/* ALTER\u6dfb\u52a0\u7d22\u5f15 -- \u666e\u901a\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD INDEX \u7d22\u5f15\u540d\u79f0(\u5217\u540d); -- \u7ec4\u5408\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD INDEX \u7d22\u5f15\u540d\u79f0(\u5217\u540d1,\u5217\u540d2,...); -- \u4e3b\u952e\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD PRIMARY KEY(\u4e3b\u952e\u5217\u540d); -- \u5916\u952e\u7d22\u5f15(\u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u5c31\u662f\u5916\u952e\u7d22\u5f15) ALTER TABLE \u8868\u540d ADD CONSTRAINT \u5916\u952e\u540d FOREIGN KEY (\u672c\u8868\u5916\u952e\u5217\u540d) REFERENCES \u4e3b\u8868\u540d(\u4e3b\u952e\u5217\u540d); -- \u552f\u4e00\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD UNIQUE \u7d22\u5f15\u540d\u79f0(\u5217\u540d); -- \u5168\u6587\u7d22\u5f15 ALTER TABLE \u8868\u540d ADD FULLTEXT \u7d22\u5f15\u540d\u79f0(\u5217\u540d); */ -- \u4e3astudent\u8868\u4e2dname\u5217\u6dfb\u52a0\u5168\u6587\u7d22\u5f15 ALTER TABLE student ADD FULLTEXT idx_fulltext_name(NAME); -- \u67e5\u8be2student\u8868\u7684\u7d22\u5f15 SHOW INDEX FROM student ;","title":"ALTER\u6dfb\u52a0\u7d22\u5f15"},{"location":"MySQL/#_106","text":"/* \u5220\u9664\u7d22\u5f15 \u6807\u51c6\u8bed\u6cd5 DROP INDEX \u7d22\u5f15\u540d\u79f0 ON \u8868\u540d; */ -- \u5220\u9664idx_name\u7d22\u5f15 DROP INDEX idx_name ON student;","title":"\u5220\u9664\u7d22\u5f15"},{"location":"MySQL/#_107","text":"-- \u521b\u5efa product\u5546\u54c1\u8868 CREATE TABLE product ( id INT PRIMARY KEY AUTO_INCREMENT , -- \u5546\u54c1 id NAME VARCHAR ( 10 ), -- \u5546\u54c1\u540d\u79f0 price INT -- \u5546\u54c1\u4ef7\u683c ); -- \u5b9a\u4e49\u5b58\u50a8\u51fd\u6570\uff0c\u751f\u6210\u957f\u5ea6\u4e3a 10 \u7684\u968f\u673a\u5b57\u7b26\u4e32\u5e76\u8fd4\u56de DELIMITER $ CREATE FUNCTION rand_string () RETURNS VARCHAR ( 255 ) BEGIN DECLARE big_str VARCHAR ( 100 ) DEFAULT 'abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ' ; DECLARE small_str VARCHAR ( 255 ) DEFAULT '' ; DECLARE i INT DEFAULT 1 ; WHILE i <= 10 DO SET small_str = CONCAT ( small_str , SUBSTRING ( big_str , FLOOR ( 1 + RAND () * 52 ), 1 )); SET i = i + 1 ; END WHILE ; RETURN small_str ; END $ DELIMITER ; -- \u5b9a\u4e49\u5b58\u50a8\u8fc7\u7a0b\uff0c\u6dfb\u52a0 100 \u4e07\u6761\u6570\u636e\u5230 product\u8868\u4e2d DELIMITER $ CREATE PROCEDURE pro_test () BEGIN DECLARE num INT DEFAULT 1 ; WHILE num <= 1000000 DO INSERT INTO product VALUES ( NULL , rand_string (), num ); SET num = num + 1 ; END WHILE ; END $ DELIMITER ; -- \u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b CALL pro_test (); -- \u67e5\u8be2\u603b\u8bb0\u5f55\u6761\u6570 SELECT COUNT ( * ) FROM product ; -- \u67e5\u8be2 product\u8868\u7684\u7d22\u5f15 SHOW INDEX FROM product ; -- \u67e5\u8be2 name\u4e3aOkIKDLVwtG\u7684\u6570\u636e ( 0.049 ) SELECT * FROM product WHERE NAME = 'OkIKDLVwtG' ; -- \u901a\u8fc7 id\u5217\u67e5\u8be2OkIKDLVwtG\u7684\u6570\u636e ( 1 \u6beb\u79d2 ) SELECT * FROM product WHERE id = 999998 ; -- \u4e3a name\u5217\u6dfb\u52a0\u7d22\u5f15 ALTER TABLE product ADD INDEX idx_name ( NAME ); -- \u67e5\u8be2 name\u4e3aOkIKDLVwtG\u7684\u6570\u636e ( 0.001 ) SELECT * FROM product WHERE NAME = 'OkIKDLVwtG' ; /* \u8303\u56f4\u67e5\u8be2 */ -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e ( 0.052 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ; /* \u6392\u5e8f\u67e5\u8be2 */ -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e , \u964d\u5e8f\u6392\u5217 ( 0.083 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ORDER BY price DESC ; -- \u4e3a price\u5217\u6dfb\u52a0\u7d22\u5f15 ALTER TABLE product ADD INDEX idx_price ( price ); -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e ( 0.011 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ; -- \u67e5\u8be2\u4ef7\u683c\u4e3a 800 ~ 1000 \u4e4b\u95f4\u7684\u6240\u6709\u6570\u636e , \u964d\u5e8f\u6392\u5217 ( 0.001 ) SELECT * FROM product WHERE price BETWEEN 800 AND 1000 ORDER BY price DESC ;","title":"\u7d22\u5f15\u7684\u6548\u7387\u6d4b\u8bd5"},{"location":"MySQL/#03_3","text":"","title":"03\u9501"},{"location":"MySQL/#innodb","text":"-- \u521b\u5efadb13\u6570\u636e\u5e93 CREATE DATABASE db13; -- \u4f7f\u7528db13\u6570\u636e\u5e93 USE db13; -- \u521b\u5efastudent\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(10), age INT, score INT ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO student VALUES (NULL,'\u5f20\u4e09',23,99),(NULL,'\u674e\u56db',24,95), (NULL,'\u738b\u4e94',25,98),(NULL,'\u8d75\u516d',26,97);","title":"InnoDB\u9501\u7684\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#innodb_1","text":"-- \u7a97\u53e31 /* \u5171\u4eab\u9501\uff1a\u6570\u636e\u53ef\u4ee5\u88ab\u591a\u4e2a\u4e8b\u52a1\u67e5\u8be2\uff0c\u4f46\u662f\u4e0d\u80fd\u4fee\u6539 \u521b\u5efa\u9501\u7684\u683c\u5f0f SELECT\u8bed\u53e5 LOCK IN SHARE MODE; */ -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2id\u4e3a1\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501 SELECT * FROM student WHERE id=1 LOCK IN SHARE MODE; -- \u67e5\u8be2\u5206\u6570\u4e3a99\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501 SELECT * FROM student WHERE score=99 LOCK IN SHARE MODE; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT;","title":"InnoDB\u5171\u4eab\u9501_\u7a97\u53e31"},{"location":"MySQL/#innodb_2","text":"-- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION; -- \u67e5\u8be2id\u4e3a1\u7684\u6570\u636e\u8bb0\u5f55\u3002(\u666e\u901a\u67e5\u8be2\u6ca1\u95ee\u9898) SELECT * FROM student WHERE id=1; -- \u67e5\u8be2id\u4e3a1\u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501(\u5171\u4eab\u9501\u548c\u5171\u4eab\u9501\u662f\u517c\u5bb9\u7684) SELECT * FROM student WHERE id=1 LOCK IN SHARE MODE; -- \u4fee\u6539id\u4e3a1\u7684\u6570\u636e\u3002\u4fee\u6539\u59d3\u540d\u4e3a\u5f20\u4e09\u4e09(\u4fee\u6539\u5931\u8d25\uff0c\u4f1a\u51fa\u73b0\u9501\u7684\u60c5\u51b5\u3002\u53ea\u6709\u7a97\u53e31\u63d0\u4ea4\u4e8b\u52a1\u540e\uff0c\u624d\u80fd\u4fee\u6539\u6210\u529f) UPDATE student SET NAME='\u5f20\u4e09\u4e09' WHERE id=1; -- \u4fee\u6539id\u4e3a2\u7684\u6570\u636e\u3002\u4fee\u6539\u59d3\u540d\u4e3a\u674e\u56db\u56db(\u4fee\u6539\u6210\u529f\u3002InnoDB\u5f15\u64ce\u9ed8\u8ba4\u662f\u884c\u9501) UPDATE student SET NAME='\u674e\u56db\u56db' WHERE id=2; -- \u4fee\u6539id\u4e3a3\u7684\u6570\u636e\u3002\u4fee\u6539\u59d3\u540d\u4e3a\u738b\u4e94\u4e94(\u6ce8\u610f\uff1aInnoDB\u5f15\u64ce\u5982\u679c\u4e0d\u91c7\u7528\u5e26\u7d22\u5f15\u7684\u5217\uff0c\u5219\u4f1a\u63d0\u5347\u4e3a\u8868\u9501) UPDATE student SET NAME='\u738b\u4e94\u4e94' WHERE id=3; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT;","title":"InnoDB\u5171\u4eab\u9501_\u7a97\u53e32"},{"location":"MySQL/#innodb_3","text":"-- \u7a97\u53e3 1 /* \u6392\u4ed6\u9501\uff1a\u52a0\u9501\u7684\u6570\u636e\uff0c\u4e0d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u52a0\u9501\u67e5\u8be2\u6216\u4fee\u6539 \u6392\u4ed6\u9501\u521b\u5efa\u683c\u5f0f SELECT\u8bed\u53e5 FOR UPDATE; */ -- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u6392\u4ed6\u9501 SELECT * FROM student WHERE id = 1 FOR UPDATE ; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT ;","title":"InnoDB\u6392\u4ed6\u9501_\u7a97\u53e31"},{"location":"MySQL/#innodb_4","text":"-- \u5f00\u542f\u4e8b\u52a1 START TRANSACTION ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002 ( \u666e\u901a\u67e5\u8be2\u6ca1\u95ee\u9898 ) SELECT * FROM student WHERE id = 1 ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u5171\u4eab\u9501 ( \u6392\u4ed6\u9501\u4e0d\u80fd\u548c\u5171\u4eab\u9501\u5171\u5b58 ) SELECT * FROM student WHERE id = 1 LOCK IN SHARE MODE ; -- \u67e5\u8be2 id \u4e3a 1 \u7684\u6570\u636e\u8bb0\u5f55\u3002\u5e76\u4e14\u52a0\u5165\u6392\u4ed6\u9501 ( \u6392\u4ed6\u9501\u548c\u6392\u4ed6\u9501\u4e0d\u80fd\u5171\u5b58 ) SELECT * FROM student WHERE id = 1 FOR UPDATE ; -- \u4fee\u6539 id \u4e3a 1 \u7684\u6570\u636e\u3002\u5c06\u59d3\u540d\u4fee\u6539\u4e3a\u5f20\u4e09\u4e09 ( \u4e0d\u80fd\u4fee\u6539\u3002\u4f1a\u51fa\u73b0\u9501\u7684\u60c5\u51b5\u3002\u53ea\u6709\u7a97\u53e3 1 \u63d0\u4ea4\u4e8b\u52a1\u540e\uff0c\u624d\u80fd\u4fee\u6539\u6210\u529f ) UPDATE student SET NAME = ' \u5f20\u4e09\u4e09 ' WHERE id = 1 ; -- \u63d0\u4ea4\u4e8b\u52a1 COMMIT ;","title":"InnoDB\u6392\u4ed6\u9501_\u7a97\u53e32"},{"location":"MySQL/#myisam","text":"-- \u521b\u5efaproduct\u8868 CREATE TABLE product( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(20), price INT )ENGINE = MYISAM; -- \u6307\u5b9a\u5b58\u50a8\u5f15\u64ce\u4e3aMyISAM -- \u6dfb\u52a0\u6570\u636e INSERT INTO product VALUES (NULL,'\u534e\u4e3a\u624b\u673a',4999),(NULL,'\u5c0f\u7c73\u624b\u673a',2999), (NULL,'\u82f9\u679c',8999),(NULL,'\u4e2d\u5174',1999);","title":"MYISAM\u9501\u7684\u6570\u636e\u51c6\u5907"},{"location":"MySQL/#myisam_1","text":"/* \u8bfb\u9501\uff1a\u6240\u6709\u8fde\u63a5\u53ea\u80fd\u8bfb\u53d6\u6570\u636e\uff0c\u4e0d\u80fd\u4fee\u6539 \u52a0\u9501 LOCK TABLE \u8868\u540d READ; \u89e3\u9501(\u5c06\u5f53\u524d\u4f1a\u8bdd\u6240\u6709\u7684\u8868\u8fdb\u884c\u89e3\u9501) UNLOCK TABLES; */ -- \u4e3aproduct\u8868\u6dfb\u52a0\u8bfb\u9501 LOCK TABLE product READ; -- \u67e5\u8be2product\u8868(\u67e5\u8be2\u6210\u529f) SELECT * FROM product; -- \u5c06id\u4e3a1\u7684\u4ef7\u683c\u4fee\u6539\u4e3a5999(\u4e0d\u80fd\u4fee\u6539) UPDATE product SET price=5999 WHERE id=1; -- \u89e3\u9501 UNLOCK TABLES;","title":"MYISAM\u8bfb\u9501_\u7a97\u53e31"},{"location":"MySQL/#myisam_2","text":"-- \u67e5\u8be2product\u8868(\u67e5\u8be2\u6210\u529f) SELECT * FROM product; -- \u5c06id\u4e3a1\u7684\u4ef7\u683c\u4fee\u6539\u4e3a5999(\u4e0d\u80fd\u4fee\u6539\u3002\u53ea\u6709\u7a97\u53e31\u89e3\u9501\u540e\u624d\u80fd\u4fee\u6539\u6210\u529f) UPDATE product SET price=5999 WHERE id=1;","title":"MYISAM\u8bfb\u9501_\u7a97\u53e32"},{"location":"MySQL/#myisam_3","text":"/* \u5199\u9501\uff1a\u5176\u4ed6\u8fde\u63a5\u4e0d\u80fd\u67e5\u8be2\u548c\u4fee\u6539\u6570\u636e \u52a0\u9501 LOCK TABLE \u8868\u540d WRITE; \u89e3\u9501(\u5c06\u5f53\u524d\u4f1a\u8bdd\u6240\u6709\u7684\u8868\u8fdb\u884c\u89e3\u9501) UNLOCK TABLES; */ -- \u4e3a product\u8868\u6dfb\u52a0\u5199\u9501 LOCK TABLE product WRITE ; -- \u67e5\u8be2 product\u8868 ( \u67e5\u8be2\u6210\u529f ) SELECT * FROM product ; -- \u4fee\u6539 id\u4e3a2\u7684\u4ef7\u683c\u4e3a3999 ( \u4fee\u6539\u6210\u529f ) UPDATE product SET price = 3999 WHERE id = 2 ; -- \u89e3\u9501 UNLOCK TABLES ;","title":"MYISAM\u5199\u9501_\u7a97\u53e31"},{"location":"MySQL/#myisam_4","text":"-- \u67e5\u8be2product\u8868\uff08\u67e5\u8be2\u5931\u8d25\u3002\u53ea\u6709\u7a97\u53e31\u89e3\u9501\u540e\uff0c\u624d\u80fd\u67e5\u8be2\u6210\u529f\uff09 SELECT * FROM product; -- \u4fee\u6539id\u4e3a2\u7684\u4ef7\u683c\u4e3a1999(\u4fee\u6539\u5931\u8d25\u3002\u53ea\u6709\u7a97\u53e31\u89e3\u9501\u540e\uff0c\u624d\u80fd\u4fee\u6539\u6210\u529f) UPDATE product SET price=1999 WHERE id=2;","title":"MYISAM\u5199\u9501_\u7a97\u53e32"},{"location":"MySQL/#_108","text":"-- \u521b\u5efacity\u8868 CREATE TABLE city( id INT PRIMARY KEY AUTO_INCREMENT, -- \u57ce\u5e02id NAME VARCHAR(20), -- \u57ce\u5e02\u540d\u79f0 VERSION INT -- \u7248\u672c\u53f7 ); -- \u6dfb\u52a0\u6570\u636e INSERT INTO city VALUES (NULL,'\u5317\u4eac',1),(NULL,'\u4e0a\u6d77',1),(NULL,'\u5e7f\u5dde',1),(NULL,'\u6df1\u5733',1); -- \u5c06\u5317\u4eac\u4fee\u6539\u4e3a\u5317\u4eac\u5e02 -- 1.\u5c06\u5317\u4eac\u7684\u7248\u672c\u53f7\u8bfb\u53d6\u51fa\u6765 SELECT VERSION FROM city WHERE NAME='\u5317\u4eac'; -- 1 -- 2.\u4fee\u6539\u5317\u4eac\u4e3a\u5317\u4eac\u5e02\uff0c\u7248\u672c\u53f7+1.\u5e76\u5bf9\u6bd4\u7248\u672c\u53f7\u662f\u5426\u76f8\u540c UPDATE city SET NAME='\u5317\u4eac\u5e02',VERSION=VERSION+1 WHERE NAME='\u5317\u4eac' AND VERSION=1;","title":"\u4e50\u89c2\u9501"},{"location":"MySQL/#04_2","text":"","title":"04\u4e3b\u4ece\u590d\u5236"},{"location":"MySQL/#__5","text":"-- \u4e3b\u670d\u52a1\u5668\u521b\u5efadb1\u6570\u636e\u5e93,\u4ece\u670d\u52a1\u5668\u4f1a\u81ea\u52a8\u540c\u6b65 CREATE DATABASE db1;","title":"\u4e3b\u4ece\u590d\u5236_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#__6","text":"-- \u4ece\u670d\u52a1\u5668\u521b\u5efadb2\u6570\u636e\u5e93,\u4e3b\u670d\u52a1\u5668\u4e0d\u4f1a\u81ea\u52a8\u540c\u6b65 CREATE DATABASE db2;","title":"\u4e3b\u4ece\u590d\u5236_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#05","text":"","title":"05\u8bfb\u5199\u5206\u79bb"},{"location":"MySQL/#_mycat","text":"-- \u521b\u5efa\u5b66\u751f\u8868 CREATE TABLE student( id INT PRIMARY KEY AUTO_INCREMENT, NAME VARCHAR(10) ); -- \u67e5\u8be2\u5b66\u751f\u8868 SELECT * FROM student; -- \u6dfb\u52a0\u4e24\u6761\u8bb0\u5f55 INSERT INTO student VALUES (NULL,'\u5f20\u4e09'),(NULL,'\u674e\u56db'); -- \u505c\u6b62\u4e3b\u4ece\u590d\u5236\u540e\uff0c\u6dfb\u52a0\u7684\u6570\u636e\u53ea\u4f1a\u4fdd\u5b58\u5230\u4e3b\u670d\u52a1\u5668\u4e0a\u3002 INSERT INTO student VALUES (NULL,'\u738b\u4e94');","title":"\u8bfb\u5199\u5206\u79bb_mycat\u64cd\u4f5c"},{"location":"MySQL/#__7","text":"-- \u4e3b\u670d\u52a1\u5668\uff1a\u67e5\u8be2\u5b66\u751f\u8868\uff0c\u53ef\u4ee5\u770b\u5230\u6570\u636e SELECT * FROM student;","title":"\u8bfb\u5199\u5206\u79bb_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#__8","text":"-- \u4ece\u670d\u52a1\u5668\uff1a\u67e5\u8be2\u5b66\u751f\u8868\uff0c\u53ef\u4ee5\u770b\u5230\u6570\u636e(\u56e0\u4e3a\u6709\u4e3b\u4ece\u590d\u5236) SELECT * FROM student; -- \u4ece\u670d\u52a1\u5668\uff1a\u5220\u9664\u4e00\u6761\u8bb0\u5f55\u3002(\u4e3b\u670d\u52a1\u5668\u5e76\u6ca1\u6709\u5220\u9664\uff0cmycat\u4e2d\u95f4\u4ef6\u67e5\u8be2\u7684\u7ed3\u679c\u662f\u4ece\u670d\u52a1\u5668\u7684\u6570\u636e) DELETE FROM student WHERE id=2;","title":"\u8bfb\u5199\u5206\u79bb_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#06","text":"","title":"06\u6c34\u5e73\u62c6\u5206"},{"location":"MySQL/#_mycat_1","text":"-- \u521b\u5efa product \u8868 CREATE TABLE product ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 20 ) , price INT ) ; -- \u6dfb\u52a0 6 \u6761\u6570\u636e INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u82f9\u679c\u624b\u673a ' , 6999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u534e\u4e3a\u624b\u673a ' , 5999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u4e09\u661f\u624b\u673a ' , 4999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u5c0f\u7c73\u624b\u673a ' , 3999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u4e2d\u5174\u624b\u673a ' , 2999 ) ; INSERT INTO product ( id , NAME , price ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' OOPO\u624b\u673a ' , 1999 ) ; -- \u67e5\u8be2 product \u8868 SELECT * FROM product ;","title":"\u6c34\u5e73\u62c6\u5206_mycat\u64cd\u4f5c"},{"location":"MySQL/#__9","text":"-- \u5728\u4e0d\u540c\u6570\u636e\u5e93\u4e2d\u67e5\u8be2product\u8868 SELECT * FROM product;","title":"\u6c34\u5e73\u62c6\u5206_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#__10","text":"-- \u5728\u4e0d\u540c\u6570\u636e\u5e93\u4e2d\u67e5\u8be2product\u8868 SELECT * FROM product;","title":"\u6c34\u5e73\u62c6\u5206_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#07","text":"","title":"07\u5782\u76f4\u62c6\u5206"},{"location":"MySQL/#_mycat_2","text":"-- \u521b\u5efa dog \u8868 CREATE TABLE dog ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO dog ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u54c8\u58eb\u5947 ' ) ; -- \u67e5\u8be2 dog \u8868 SELECT * FROM dog ; -- \u521b\u5efa cat \u8868 CREATE TABLE cat ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO cat ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u6ce2\u65af\u732b ' ) ; -- \u67e5\u8be2 cat \u8868 SELECT * FROM cat ; -- \u521b\u5efa apple \u8868 CREATE TABLE apple ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO apple ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u7ea2\u5bcc\u58eb ' ) ; -- \u67e5\u8be2 apple \u8868 SELECT * FROM apple ; -- \u521b\u5efa banana \u8868 CREATE TABLE banana ( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR ( 10 ) ) ; -- \u6dfb\u52a0\u6570\u636e INSERT INTO banana ( id , NAME ) VALUES ( NEXT VALUE FOR MYCATSEQ_GLOBAL , ' \u9999\u8549 ' ) ; -- \u67e5\u8be2 banana \u8868 SELECT * FROM banana ;","title":"\u5782\u76f4\u62c6\u5206_mycat\u64cd\u4f5c"},{"location":"MySQL/#__11","text":"-- \u67e5\u8be2dog\u8868 SELECT * FROM dog; -- \u67e5\u8be2cat\u8868 SELECT * FROM cat; -- \u67e5\u8be2apple\u8868 SELECT * FROM apple; -- \u67e5\u8be2banana\u8868 SELECT * FROM banana;","title":"\u5782\u76f4\u62c6\u5206_\u4e3b\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"MySQL/#__12","text":"-- \u67e5\u8be2dog\u8868 SELECT * FROM dog; -- \u67e5\u8be2cat\u8868 SELECT * FROM cat; -- \u67e5\u8be2apple\u8868 SELECT * FROM apple; -- \u67e5\u8be2banana\u8868 SELECT * FROM banana;","title":"\u5782\u76f4\u62c6\u5206_\u4ece\u670d\u52a1\u5668\u64cd\u4f5c"},{"location":"license/","text":"License \u00b6 MIT License The graduate cap icon made by Freepik from www.flaticon.com is licensed by CC 3.0 BY Support Author \u00b6 Amazon wish list","title":"MongoDB"},{"location":"license/#license","text":"MIT License The graduate cap icon made by Freepik from www.flaticon.com is licensed by CC 3.0 BY","title":"License"},{"location":"license/#support_author","text":"Amazon wish list","title":"Support Author"},{"location":"MongoDB/MongoDB/","text":"3\u3001MongoDB\u5feb\u901f\u5165\u95e8 \u00b6 3.1\u3001MongoDB\u7b80\u4ecb \u00b6 MongoDB\u662f\u4e00\u4e2a\u57fa\u4e8e\u5206\u5e03\u5f0f\u6587\u4ef6\u5b58\u50a8\u7684\u6570\u636e\u5e93\u3002\u7531C++\u8bed\u8a00\u7f16\u5199\u3002\u65e8\u5728\u4e3aWEB\u5e94\u7528\u63d0\u4f9b\u53ef\u6269\u5c55\u7684\u9ad8\u6027\u80fd\u6570\u636e\u5b58\u50a8\u89e3\u51b3\u65b9\u6848\u3002 MongoDB\u662f\u4e00\u4e2a\u4ecb\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\u548c\u975e\u5173\u7cfb\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4ea7\u54c1\uff0c\u662f\u975e\u5173\u7cfb\u6570\u636e\u5e93\u5f53\u4e2d\u529f\u80fd\u6700\u4e30\u5bcc\uff0c\u6700\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u7684\uff0c\u5b83\u652f\u6301\u7684\u6570\u636e\u7ed3\u6784\u975e\u5e38\u677e\u6563\uff0c\u662f\u7c7b\u4f3cjson\u7684bson\u683c\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b58\u50a8\u6bd4\u8f83\u590d\u6742\u7684\u6570\u636e\u7c7b\u578b\u3002 MongoDB\u6700\u5927\u7684\u7279\u70b9\u662f\u5b83\u652f\u6301\u7684\u67e5\u8be2\u8bed\u8a00\u975e\u5e38\u5f3a\u5927\uff0c\u5176\u8bed\u6cd5\u6709\u70b9\u7c7b\u4f3c\u4e8e\u9762\u5411\u5bf9\u8c61\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u51e0\u4e4e\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u5173\u7cfb\u6570\u636e\u5e93\u5355\u8868\u67e5\u8be2\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd\uff0c\u800c\u4e14\u8fd8\u652f\u6301\u5bf9\u6570\u636e\u5efa\u7acb\u7d22\u5f15\u3002 \u5b98\u7f51\uff1ahttps://www.mongodb.com 3.2\u3001\u901a\u8fc7docker\u5b89\u88c5MongoDB \u00b6 #\u62c9\u53d6\u955c\u50cf docker pull mongo:4.0.3 #\u521b\u5efa\u5bb9\u5668 docker create --name mongodb-server -p 27018 :27017 -v mongodb-data:/data/db mongo:4.0.3 --auth #\u542f\u52a8\u5bb9\u5668 docker start mongodb-server #\u8fdb\u5165\u5bb9\u5668 docker exec -it mongodb-server /bin/bash #\u8fdb\u5165admin\u6570\u636e\u5e93 mongo use admin #\u6dfb\u52a0\u7ba1\u7406\u5458\uff0c\u5176\u62e5\u6709\u7ba1\u7406\u7528\u6237\u548c\u89d2\u8272\u7684\u6743\u9650 db.createUser ({ user: 'root' , pwd: 'root' , roles: [ { role: \"root\" , db: \"admin\" } ] }) #\u6d4b\u8bd5\uff0c\u53d1\u73b0\u662f\u6ca1\u6709\u6743\u9650\u64cd\u4f5c\u7684 > show dbs 2020 -10-20T09:09:15.543+0000 E QUERY [ js ] Error: listDatabases failed: { \"ok\" : 0 , \"errmsg\" : \"command listDatabases requires authentication\" , \"code\" : 13 , \"codeName\" : \"Unauthorized\" } : #\u8fdb\u884c\u8ba4\u8bc1 mongo -u \"root\" -p \"root\" --authenticationDatabase \"admin\" #\u901a\u8fc7admin\u6dfb\u52a0\u666e\u901a\u7528\u6237 use admin db.createUser ({ user: 'tanhua' , pwd: 'l3SCjl0HvmSkTtiSbN0Swv40spYnHhDV' , roles: [ { role: \"readWrite\" , db: \"tanhua\" } ] }) ; #\u901a\u8fc7tanhua\u7528\u6237\u767b\u5f55\u8fdb\u884c\u6d4b\u8bd5 mongo -u \"tanhua\" -p \"l3SCjl0HvmSkTtiSbN0Swv40spYnHhDV\" --authenticationDatabase \"admin\" #\u6d4b\u8bd5 root@5d848955ff7e:/# mongo -u \"tanhua\" -p \"tanhua123\" --authenticationDatabase \"admin\" MongoDB shell version v4.0.3 connecting to: mongodb://127.0.0.1:27017 Implicit session: session { \"id\" : UUID ( \"6c368269-30f0-4b29-a224-05a38b5847e2\" ) } MongoDB server version: 4 .0.3 > use tanhua switched to db tanhua > db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) WriteResult ({ \"nInserted\" : 1 }) > db.user.find () { \"_id\" : ObjectId ( \"5f8eb2726e0de0aa9517afd3\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 20 } 3.3\u3001MongoDB\u57fa\u672c\u64cd\u4f5c \u00b6 3.3.1\u3001\u57fa\u672c\u6982\u5ff5 \u00b6 \u4e3a\u4e86\u66f4\u597d\u7684\u7406\u89e3\uff0c\u4e0b\u9762\u4e0eSQL\u4e2d\u7684\u6982\u5ff5\u8fdb\u884c\u5bf9\u6bd4\uff1a SQL\u672f\u8bed/\u6982\u5ff5 MongoDB\u672f\u8bed/\u6982\u5ff5 \u89e3\u91ca/\u8bf4\u660e database database \u6570\u636e\u5e93 table collection \u6570\u636e\u5e93\u8868/\u96c6\u5408 row document \u6570\u636e\u8bb0\u5f55\u884c/\u6587\u6863 column field \u6570\u636e\u5b57\u6bb5/\u57df index index \u7d22\u5f15 table joins \u8868\u8fde\u63a5,MongoDB\u4e0d\u652f\u6301 primary key primary key \u4e3b\u952e,MongoDB\u81ea\u52a8\u5c06_id\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u4e3b\u952e 3.3.2\u3001\u6570\u636e\u5e93\u4ee5\u53ca\u8868\u7684\u64cd\u4f5c \u00b6 #\u67e5\u770b\u6240\u6709\u7684\u6570\u636e\u5e93 > show dbs admin 0 .000GB config 0 .000GB local 0 .000GB #\u901a\u8fc7use\u5173\u952e\u5b57\u5207\u6362\u6570\u636e\u5e93 > use admin switched to db admin #\u521b\u5efa\u6570\u636e\u5e93 #\u8bf4\u660e\uff1a\u5728MongoDB\u4e2d\uff0c\u6570\u636e\u5e93\u662f\u81ea\u52a8\u521b\u5efa\u7684\uff0c\u901a\u8fc7use\u5207\u6362\u5230\u65b0\u6570\u636e\u5e93\u4e2d\uff0c\u8fdb\u884c\u63d2\u5165\u6570\u636e\u5373\u53ef\u81ea\u52a8\u521b\u5efa\u6570\u636e\u5e93 > use testdb switched to db testdb > show dbs #\u5e76\u6ca1\u6709\u521b\u5efa\u6570\u636e\u5e93 admin 0 .000GB config 0 .000GB local 0 .000GB > db.user.insert ({ id:1,name: 'zhangsan' }) #\u63d2\u5165\u6570\u636e WriteResult ({ \"nInserted\" : 1 }) > show dbs admin 0 .000GB config 0 .000GB local 0 .000GB testdb 0 .000GB #\u6570\u636e\u5e93\u81ea\u52a8\u521b\u5efa #\u67e5\u770b\u8868 > show tables user > show collections user > #\u5220\u9664\u96c6\u5408\uff08\u8868\uff09 > db.user.drop () true #\u5982\u679c\u6210\u529f\u5220\u9664\u9009\u5b9a\u96c6\u5408\uff0c\u5219 drop() \u65b9\u6cd5\u8fd4\u56de true\uff0c\u5426\u5219\u8fd4\u56de false\u3002 #\u5220\u9664\u6570\u636e\u5e93 > use testdb #\u5148\u5207\u6362\u5230\u8981\u5220\u9664\u7684\u6570\u636e\u5e93\u4e2d switched to db testdb > db.dropDatabase () #\u5220\u9664\u6570\u636e\u5e93 { \"dropped\" : \"testdb\" , \"ok\" : 1 } > show dbs admin 0 .000GB config 0 .000GB local 0 .000GB 3.3.3\u3001\u65b0\u589e\u6570\u636e \u00b6 \u5728MongoDB\u4e2d\uff0c\u5b58\u50a8\u7684\u6587\u6863\u7ed3\u6784\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8ejson\u7684\u7ed3\u6784\uff0c\u79f0\u4e4b\u4e3abson\uff08\u5168\u79f0\u4e3a\uff1aBinary JSON\uff09\u3002 #\u63d2\u5165\u6570\u636e #\u8bed\u6cd5\uff1adb.COLLECTION_NAME.insert(document) > db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) WriteResult ({ \"nInserted\" : 1 }) > db.user.save ({ id:2,username: 'lisi' ,age:25 }) WriteResult ({ \"nInserted\" : 1 }) > db.user.find () #\u67e5\u8be2\u6570\u636e { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 20 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } 3.3.4\u3001\u66f4\u65b0\u6570\u636e \u00b6 update() \u65b9\u6cd5\u7528\u4e8e\u66f4\u65b0\u5df2\u5b58\u5728\u7684\u6587\u6863\u3002\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a db.collection.update ( <query>, <update>, [ upsert: <boolean>, multi: <boolean>, writeConcern: <document> ] ) \u53c2\u6570\u8bf4\u660e\uff1a query : update\u7684\u67e5\u8be2\u6761\u4ef6\uff0c\u7c7b\u4f3csql update\u67e5\u8be2\u5185where\u540e\u9762\u7684\u3002 update : update\u7684\u5bf9\u8c61\u548c\u4e00\u4e9b\u66f4\u65b0\u7684\u64cd\u4f5c\u7b26\uff08\u5982 , inc...\uff09\u7b49\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3asql update\u67e5\u8be2\u5185set\u540e\u9762\u7684 upsert : \u53ef\u9009\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u610f\u601d\u662f\uff0c\u5982\u679c\u4e0d\u5b58\u5728update\u7684\u8bb0\u5f55\uff0c\u662f\u5426\u63d2\u5165objNew,true\u4e3a\u63d2\u5165\uff0c\u9ed8\u8ba4\u662ffalse\uff0c\u4e0d\u63d2\u5165\u3002 multi : \u53ef\u9009\uff0cmongodb \u9ed8\u8ba4\u662ffalse,\u53ea\u66f4\u65b0\u627e\u5230\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\uff0c\u5982\u679c\u8fd9\u4e2a\u53c2\u6570\u4e3atrue,\u5c31\u628a\u6309\u6761\u4ef6\u67e5\u51fa\u6765\u591a\u6761\u8bb0\u5f55\u5168\u90e8\u66f4\u65b0\u3002 writeConcern :\u53ef\u9009\uff0c\u629b\u51fa\u5f02\u5e38\u7684\u7ea7\u522b\u3002 > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 20 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } > db.user.update ({ id:1 } , { $set : { age:22 }}) #\u66f4\u65b0\u6570\u636e WriteResult ({ \"nMatched\" : 1 , \"nUpserted\" : 0 , \"nModified\" : 1 }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 22 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } #\u6ce8\u610f\uff1a\u5982\u679c\u8fd9\u6837\u5199\uff0c\u4f1a\u5220\u9664\u6389\u5176\u4ed6\u7684\u5b57\u6bb5 > db.user.update ({ id:1 } , { age:25 }) WriteResult ({ \"nMatched\" : 1 , \"nUpserted\" : 0 , \"nModified\" : 1 }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } #\u66f4\u65b0\u4e0d\u5b58\u5728\u7684\u5b57\u6bb5\uff0c\u4f1a\u65b0\u589e\u5b57\u6bb5 > db.user.update ({ id:2 } , { $set : { sex:1 }}) #\u66f4\u65b0\u6570\u636e > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 , \"sex\" : 1 } #\u66f4\u65b0\u4e0d\u5b58\u5728\u7684\u6570\u636e\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u65b0\u589e\u6570\u636e > db.user.update ({ id:3 } , { $set : { sex:1 }}) WriteResult ({ \"nMatched\" : 0 , \"nUpserted\" : 0 , \"nModified\" : 0 }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 , \"sex\" : 1 } #\u5982\u679c\u8bbe\u7f6e\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3atrue\uff0c\u5c31\u662f\u65b0\u589e\u6570\u636e > db.user.update ({ id:3 } , { $set : { sex:1 }} ,true ) WriteResult ({ \"nMatched\" : 0 , \"nUpserted\" : 1 , \"nModified\" : 0 , \"_id\" : ObjectId ( \"5c08cb281418d073246bc642\" ) }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 , \"sex\" : 1 } { \"_id\" : ObjectId ( \"5c08cb281418d073246bc642\" ) , \"id\" : 3 , \"sex\" : 1 } 3.3.5\u3001\u5220\u9664\u6570\u636e \u00b6 \u901a\u8fc7remove()\u65b9\u6cd5\u8fdb\u884c\u5220\u9664\u6570\u636e\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a db.collection.remove ( <query>, { justOne: <boolean>, writeConcern: <document> } ) \u53c2\u6570\u8bf4\u660e\uff1a query :\uff08\u53ef\u9009\uff09\u5220\u9664\u7684\u6587\u6863\u7684\u6761\u4ef6\u3002 justOne : \uff08\u53ef\u9009\uff09\u5982\u679c\u8bbe\u4e3a true \u6216 1\uff0c\u5219\u53ea\u5220\u9664\u4e00\u4e2a\u6587\u6863\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\u8be5\u53c2\u6570\uff0c\u6216\u4f7f\u7528\u9ed8\u8ba4\u503c false\uff0c\u5219\u5220\u9664\u6240\u6709\u5339\u914d\u6761\u4ef6\u7684\u6587\u6863\u3002 writeConcern :\uff08\u53ef\u9009\uff09\u629b\u51fa\u5f02\u5e38\u7684\u7ea7\u522b\u3002 \u5b9e\u4f8b\uff1a > db.user.remove ({ age:25 }) WriteResult ({ \"nRemoved\" : 2 }) #\u5220\u9664\u4e862\u6761\u6570\u636e #\u63d2\u51654\u6761\u6d4b\u8bd5\u6570\u636e db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) db.user.insert ({ id:2,username: 'lisi' ,age:21 }) db.user.insert ({ id:3,username: 'wangwu' ,age:22 }) db.user.insert ({ id:4,username: 'zhaoliu' ,age:22 }) > db.user.remove ({ age:22 } ,true ) WriteResult ({ \"nRemoved\" : 1 }) #\u5220\u9664\u4e861\u6761\u6570\u636e #\u5220\u9664\u6240\u6709\u6570\u636e > db.user.remove ({}) #\u8bf4\u660e\uff1a\u4e3a\u4e86\u7b80\u5316\u64cd\u4f5c\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528deleteOne()\u4e0edeleteMany()\u8fdb\u884c\u5220\u9664\u6570\u636e\u64cd\u4f5c\u3002 db.user.deleteOne ({ id:1 }) db.user.deleteMany ({}) #\u5220\u9664\u6240\u6709\u6570\u636e 3.3.6\u3001\u67e5\u8be2\u6570\u636e \u00b6 MongoDB \u67e5\u8be2\u6570\u636e\u7684\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a db . user . find ( [ query ] , [ fields ] ) query \uff1a\u53ef\u9009\uff0c\u4f7f\u7528\u67e5\u8be2\u64cd\u4f5c\u7b26\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6 fields \uff1a\u53ef\u9009\uff0c\u4f7f\u7528\u6295\u5f71\u64cd\u4f5c\u7b26\u6307\u5b9a\u8fd4\u56de\u7684\u952e\u3002\u67e5\u8be2\u65f6\u8fd4\u56de\u6587\u6863\u4e2d\u6240\u6709\u952e\u503c\uff0c \u53ea\u9700\u7701\u7565\u8be5\u53c2\u6570\u5373\u53ef\uff08\u9ed8\u8ba4\u7701\u7565\uff09\u3002 \u5982\u679c\u4f60\u9700\u8981\u4ee5\u6613\u8bfb\u7684\u65b9\u5f0f\u6765\u8bfb\u53d6\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528 pretty() \u65b9\u6cd5\uff0c\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a >db.col.find().pretty() pretty() \u65b9\u6cd5\u4ee5\u683c\u5f0f\u5316\u7684\u65b9\u5f0f\u6765\u663e\u793a\u6240\u6709\u6587\u6863\u3002 \u6761\u4ef6\u67e5\u8be2\uff1a \u64cd\u4f5c \u683c\u5f0f \u8303\u4f8b RDBMS\u4e2d\u7684\u7c7b\u4f3c\u8bed\u53e5 \u7b49\u4e8e {<key>:<value> } db.col.find({\"by\":\"\u9ed1\u9a6c\u7a0b\u5e8f\u5458\"}).pretty() where by = '\u9ed1\u9a6c\u7a0b\u5e8f\u5458' \u5c0f\u4e8e {<key>:{$lt:<value>}} db.col.find({\"likes\":{$lt:50}}).pretty() where likes < 50 \u5c0f\u4e8e\u6216\u7b49\u4e8e {<key>:{$lte:<value>}} db.col.find({\"likes\":{$lte:50}}).pretty() where likes <= 50 \u5927\u4e8e {<key>:{$gt:<value>}} db.col.find({\"likes\":{$gt:50}}).pretty() where likes > 50 \u5927\u4e8e\u6216\u7b49\u4e8e {<key>:{$gte:<value>}} db.col.find({\"likes\":{$gte:50}}).pretty() where likes >= 50 \u4e0d\u7b49\u4e8e {<key>:{$ne:<value>}} db.col.find({\"likes\":{$ne:50}}).pretty() where likes != 50 \u5b9e\u4f8b\uff1a #\u63d2\u5165\u6d4b\u8bd5\u6570\u636e db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) db.user.insert ({ id:2,username: 'lisi' ,age:21 }) db.user.insert ({ id:3,username: 'wangwu' ,age:22 }) db.user.insert ({ id:4,username: 'zhaoliu' ,age:22 }) db.user.find () #\u67e5\u8be2\u5168\u90e8\u6570\u636e db.user.find ({} , { id:1,username:1 }) #\u53ea\u67e5\u8be2id\u4e0eusername\u5b57\u6bb5 db.user.find () .count () #\u67e5\u8be2\u6570\u636e\u6761\u6570 db.user.find ({ id:1 }) #\u67e5\u8be2id\u4e3a1\u7684\u6570\u636e db.user.find ({ age: { $lte :21 }}) #\u67e5\u8be2\u5c0f\u4e8e\u7b49\u4e8e21\u7684\u6570\u636e db.user.find ({ age: { $lte :21 } , id: { $gte :2 }}) #and\u67e5\u8be2\uff0cage\u5c0f\u4e8e\u7b49\u4e8e21\u5e76\u4e14id\u5927\u4e8e\u7b49\u4e8e2 db.user.find ({ $or : [{ id:1 } , { id:2 }]}) #\u67e5\u8be2id=1 or id=2 #\u5206\u9875\u67e5\u8be2\uff1aSkip()\u8df3\u8fc7\u51e0\u6761\uff0climit()\u67e5\u8be2\u6761\u6570 db.user.find () .limit ( 2 ) .skip ( 1 ) #\u8df3\u8fc71\u6761\u6570\u636e\uff0c\u67e5\u8be22\u6761\u6570\u636e db.user.find () .sort ({ id:-1 }) #\u6309\u7167age\u5012\u5e8f\u6392\u5e8f\uff0c-1\u4e3a\u5012\u5e8f\uff0c1\u4e3a\u6b63\u5e8f 3.4\u3001\u7d22\u5f15 \u00b6 \u7d22\u5f15\u901a\u5e38\u80fd\u591f\u6781\u5927\u7684\u63d0\u9ad8\u67e5\u8be2\u7684\u6548\u7387\uff0c\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0cMongoDB\u5728\u8bfb\u53d6\u6570\u636e\u65f6\u5fc5\u987b\u626b\u63cf\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u6587\u4ef6\u5e76\u9009\u53d6\u90a3\u4e9b\u7b26\u5408\u67e5\u8be2\u6761\u4ef6\u7684\u8bb0\u5f55\u3002 \u8fd9\u79cd\u626b\u63cf\u5168\u96c6\u5408\u7684\u67e5\u8be2\u6548\u7387\u662f\u975e\u5e38\u4f4e\u7684\uff0c\u7279\u522b\u5728\u5904\u7406\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c\u67e5\u8be2\u53ef\u4ee5\u8981\u82b1\u8d39\u51e0\u5341\u79d2\u751a\u81f3\u51e0\u5206\u949f\uff0c\u8fd9\u5bf9\u7f51\u7ad9\u7684\u6027\u80fd\u662f\u975e\u5e38\u81f4\u547d\u7684\u3002 \u7d22\u5f15\u662f\u7279\u6b8a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7d22\u5f15\u5b58\u50a8\u5728\u4e00\u4e2a\u6613\u4e8e\u904d\u5386\u8bfb\u53d6\u7684\u6570\u636e\u96c6\u5408\u4e2d\uff0c\u7d22\u5f15\u662f\u5bf9\u6570\u636e\u5e93\u8868\u4e2d\u4e00\u5217\u6216\u591a\u5217\u7684\u503c\u8fdb\u884c\u6392\u5e8f\u7684\u4e00\u79cd\u7ed3\u6784 #\u67e5\u770b\u7d22\u5f15 > db.user.getIndexes () [ { \"v\" : 2 , \"key\" : { \"_id\" : 1 } , \"name\" : \"_id_\" , \"ns\" : \"testdb.user\" } ] #\u8bf4\u660e\uff1a1\u8868\u793a\u5347\u5e8f\u521b\u5efa\u7d22\u5f15\uff0c-1\u8868\u793a\u964d\u5e8f\u521b\u5efa\u7d22\u5f15\u3002 #\u521b\u5efa\u7d22\u5f15 > db.user.createIndex ({ 'age' :1 }) { \"createdCollectionAutomatically\" : false, \"numIndexesBefore\" : 1 , \"numIndexesAfter\" : 2 , \"ok\" : 1 } #\u5220\u9664\u7d22\u5f15 db.user.dropIndex ( \"age_1\" ) #\u6216\u8005\uff0c\u5220\u9664\u9664\u4e86_id\u4e4b\u5916\u7684\u7d22\u5f15 db.user.dropIndexes () #\u521b\u5efa\u8054\u5408\u7d22\u5f15 db.user.createIndex ({ 'age' :1, 'id' :-1 }) #\u67e5\u770b\u7d22\u5f15\u5927\u5c0f\uff0c\u5355\u4f4d\uff1a\u5b57\u8282 db.user.totalIndexSize () 3.5\u3001\u6267\u884c\u8ba1\u5212 \u00b6 MongoDB \u67e5\u8be2\u5206\u6790\u53ef\u4ee5\u786e\u4fdd\u6211\u4eec\u5efa\u8bae\u7684\u7d22\u5f15\u662f\u5426\u6709\u6548\uff0c\u662f\u67e5\u8be2\u8bed\u53e5\u6027\u80fd\u5206\u6790\u7684\u91cd\u8981\u5de5\u5177\u3002 #\u63d2\u51651000\u6761\u6570\u636e for ( var i = 1 ; i< 1000 ; i++ ) db.user.insert ({ id:100+i,username: 'name_' +i,age:10+i }) #\u67e5\u770b\u6267\u884c\u8ba1\u5212 > db.user.find ({ age: { $gt :100 } ,id: { $lt :200 }}) .explain () { \"queryPlanner\" : { \"plannerVersion\" : 1 , \"namespace\" : \"testdb.user\" , \"indexFilterSet\" : false, \"parsedQuery\" : { \" $and \" : [ { \"id\" : { \" $lt \" : 200 } } , { \"age\" : { \" $gt \" : 100 } } ] } , \"winningPlan\" : { #\u6700\u4f73\u6267\u884c\u8ba1\u5212 \"stage\" : \"FETCH\" , #\u67e5\u8be2\u65b9\u5f0f\uff0c\u5e38\u89c1\u7684\u6709COLLSCAN/\u5168\u8868\u626b\u63cf\u3001IXSCAN/\u7d22\u5f15\u626b\u63cf\u3001FETCH/\u6839\u636e\u7d22\u5f15\u53bb\u68c0\u7d22\u6587\u6863\u3001SHARD_MERGE/\u5408\u5e76\u5206\u7247\u7ed3\u679c\u3001IDHACK/\u9488\u5bf9_id\u8fdb\u884c\u67e5\u8be2 \"inputStage\" : { \"stage\" : \"IXSCAN\" , \"keyPattern\" : { \"age\" : 1 , \"id\" : -1 } , \"indexName\" : \"age_1_id_-1\" , \"isMultiKey\" : false, \"multiKeyPaths\" : { \"age\" : [ ] , \"id\" : [ ] } , \"isUnique\" : false, \"isSparse\" : false, \"isPartial\" : false, \"indexVersion\" : 2 , \"direction\" : \"forward\" , \"indexBounds\" : { \"age\" : [ \"(100.0, inf.0]\" ] , \"id\" : [ \"(200.0, -inf.0]\" ] } } } , \"rejectedPlans\" : [ ] } , \"serverInfo\" : { \"host\" : \"c493d5ff750a\" , \"port\" : 27017 , \"version\" : \"4.0.3\" , \"gitVersion\" : \"7ea530946fa7880364d88c8d8b6026bbc9ffa48c\" } , \"ok\" : 1 } #\u6d4b\u8bd5\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15 > db.user.find ({ username: 'zhangsan' }) .explain () { \"queryPlanner\" : { \"plannerVersion\" : 1 , \"namespace\" : \"testdb.user\" , \"indexFilterSet\" : false, \"parsedQuery\" : { \"username\" : { \" $eq \" : \"zhangsan\" } } , \"winningPlan\" : { \"stage\" : \"COLLSCAN\" , #\u5168\u8868\u626b\u63cf \"filter\" : { \"username\" : { \" $eq \" : \"zhangsan\" } } , \"direction\" : \"forward\" } , \"rejectedPlans\" : [ ] } , \"serverInfo\" : { \"host\" : \"c493d5ff750a\" , \"port\" : 27017 , \"version\" : \"4.0.3\" , \"gitVersion\" : \"7ea530946fa7880364d88c8d8b6026bbc9ffa48c\" } , \"ok\" : 1 } 3.6\u3001UI\u5ba2\u6237\u7aef\u5de5\u5177 \u00b6 Robo 3T\u662fMongoDB\u7684\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u64cd\u4f5cMongoDB\u3002 \u67e5\u770b\u6570\u636e\uff1a \u6216\u4f7f\u7528Navicat Premium 15\uff1a 4\u3001SpringBoot\u6574\u5408MongoDB \u00b6 spring-data\u5bf9MongoDB\u505a\u4e86\u652f\u6301\uff0c\u4f7f\u7528spring-data-mongodb\u53ef\u4ee5\u7b80\u5316MongoDB\u7684\u64cd\u4f5c\u3002 \u5730\u5740\uff1ahttps://spring.io/projects/spring-data-mongodb 4.1\u3001\u5bfc\u5165\u4f9d\u8d56 \u00b6 <?xml version=\"1.0\" encoding=\"UTF-8\"?> <project xmlns= \"http://maven.apache.org/POM/4.0.0\" xmlns:xsi= \"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation= \"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" > <modelVersion> 4.0.0 </modelVersion> <parent> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-parent </artifactId> <version> 2.1.0.RELEASE </version> </parent> <groupId> cn.itcast.mongodb </groupId> <artifactId> itcast-mongodb </artifactId> <version> 1.0-SNAPSHOT </version> <dependencies> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-data-mongodb </artifactId> </dependency> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-test </artifactId> <scope> test </scope> </dependency> <dependency> <groupId> org.projectlombok </groupId> <artifactId> lombok </artifactId> <optional> true </optional> <version> 1.18.4 </version> </dependency> </dependencies> <build> <plugins> <!-- java\u7f16\u8bd1\u63d2\u4ef6 --> <plugin> <groupId> org.apache.maven.plugins </groupId> <artifactId> maven-compiler-plugin </artifactId> <version> 3.2 </version> <configuration> <source> 1.8 </source> <target> 1.8 </target> <encoding> UTF-8 </encoding> </configuration> </plugin> </plugins> </build> </project> 4.2\u3001\u7f16\u5199application.properties\u914d\u7f6e\u6587\u4ef6 \u00b6 # Spring boot application spring.application.name = itcast-mongodb #\u65e0\u8ba4\u8bc1\u4fe1\u606f\u7684\u914d\u7f6e #spring.data.mongodb.uri=mongodb://192.168.31.81:27017/tanhua #springboot \u914d\u7f6e spring.data.mongodb.username = tanhua spring.data.mongodb.password = l3SCjl0HvmSkTtiSbN0Swv40spYnHhDV spring.data.mongodb.authentication-database = admin spring.data.mongodb.database = tanhua spring.data.mongodb.port = 27018 spring.data.mongodb.host = 192.168.31.81 4.3\u3001\u7f16\u5199\u5b9e\u4f53 \u00b6 package cn.itcast.mongodb.pojo ; import lombok.AllArgsConstructor ; import lombok.Data ; import lombok.NoArgsConstructor ; import org.bson.types.ObjectId ; @Data @AllArgsConstructor @NoArgsConstructor public class Person { private ObjectId id ; private String name ; private int age ; private Address address ; } package cn.itcast.mongodb.pojo ; import lombok.AllArgsConstructor ; import lombok.Data ; import lombok.NoArgsConstructor ; @Data @AllArgsConstructor @NoArgsConstructor public class Address { private String street ; private String city ; private String zip ; } 4.4\u3001\u7f16\u5199dao \u00b6 package cn.itcast.mongodb.dao ; import cn.itcast.mongodb.pojo.Person ; import com.mongodb.client.result.DeleteResult ; import com.mongodb.client.result.UpdateResult ; import org.springframework.beans.factory.annotation.Autowired ; import org.springframework.data.mongodb.core.MongoTemplate ; import org.springframework.data.mongodb.core.query.Criteria ; import org.springframework.data.mongodb.core.query.Query ; import org.springframework.data.mongodb.core.query.Update ; import org.springframework.stereotype.Component ; import java.util.List ; @Component public class PersonDao { @Autowired private MongoTemplate mongoTemplate ; public void savePerson ( Person person ) { this . mongoTemplate . save ( person ); } public List < Person > queryPersonListByName ( String name ) { Query query = Query . query ( Criteria . where ( \"name\" ). is ( name )); return this . mongoTemplate . find ( query , Person . class ); } public List < Person > queryPersonPageList ( Integer page , Integer rows ) { Query query = new Query (). limit ( rows ). skip (( page - 1 ) * rows ); return this . mongoTemplate . find ( query , Person . class ); } public UpdateResult update ( Person person ) { Query query = Query . query ( Criteria . where ( \"id\" ). is ( person . getId ())); Update update = Update . update ( \"age\" , person . getAge ()); return this . mongoTemplate . updateFirst ( query , update , Person . class ); } public DeleteResult deleteById ( String id ) { Query query = Query . query ( Criteria . where ( \"id\" ). is ( id )); return this . mongoTemplate . remove ( query , Person . class ); } } 4.5\u3001\u7f16\u5199\u542f\u52a8\u7c7b \u00b6 package cn.itcast.mongodb ; import org.springframework.boot.SpringApplication ; import org.springframework.boot.autoconfigure.SpringBootApplication ; @SpringBootApplication public class MongoApplication { public static void main ( String [] args ) { SpringApplication . run ( MongoApplication . class , args ); } } 4.6\u3001\u7f16\u5199\u5355\u5143\u6d4b\u8bd5 \u00b6 package cn.itcast.mongodb ; import cn.itcast.mongodb.dao.PersonDao ; import cn.itcast.mongodb.pojo.Address ; import cn.itcast.mongodb.pojo.Person ; import org.bson.types.ObjectId ; import org.junit.Test ; import org.junit.runner.RunWith ; import org.springframework.beans.factory.annotation.Autowired ; import org.springframework.boot.test.context.SpringBootTest ; import org.springframework.test.context.junit4.SpringRunner ; import java.util.List ; @RunWith ( SpringRunner . class ) @SpringBootTest public class TestPersonDao { @Autowired private PersonDao personDao ; @Test public void testSave () { Person person = new Person ( ObjectId . get (), \"\u5f20\u4e09\" , 20 , new Address ( \"\u4eba\u6c11\u8def\" , \"\u4e0a\u6d77\u5e02\" , \"666666\" )); this . personDao . savePerson ( person ); } @Test public void testQuery () { List < Person > personList = this . personDao . queryPersonListByName ( \"\u5f20\u4e09\" ); for ( Person person : personList ) { System . out . println ( person ); } } @Test public void testQuery2 () { List < Person > personList = this . personDao . queryPersonPageList ( 2 , 2 ); for ( Person person : personList ) { System . out . println ( person ); } } @Test public void testUpdate () { Person person = new Person (); person . setId ( new ObjectId ( \"5c0956ce235e192520086736\" )); person . setAge ( 30 ); this . personDao . update ( person ); } @Test public void testDelete () { this . personDao . deleteById ( \"5c09ca05235e192d8887a389\" ); } }","title":"MongoDB"},{"location":"MongoDB/MongoDB/#3mongodb","text":"","title":"3\u3001MongoDB\u5feb\u901f\u5165\u95e8"},{"location":"MongoDB/MongoDB/#31mongodb","text":"MongoDB\u662f\u4e00\u4e2a\u57fa\u4e8e\u5206\u5e03\u5f0f\u6587\u4ef6\u5b58\u50a8\u7684\u6570\u636e\u5e93\u3002\u7531C++\u8bed\u8a00\u7f16\u5199\u3002\u65e8\u5728\u4e3aWEB\u5e94\u7528\u63d0\u4f9b\u53ef\u6269\u5c55\u7684\u9ad8\u6027\u80fd\u6570\u636e\u5b58\u50a8\u89e3\u51b3\u65b9\u6848\u3002 MongoDB\u662f\u4e00\u4e2a\u4ecb\u4e8e\u5173\u7cfb\u6570\u636e\u5e93\u548c\u975e\u5173\u7cfb\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4ea7\u54c1\uff0c\u662f\u975e\u5173\u7cfb\u6570\u636e\u5e93\u5f53\u4e2d\u529f\u80fd\u6700\u4e30\u5bcc\uff0c\u6700\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u7684\uff0c\u5b83\u652f\u6301\u7684\u6570\u636e\u7ed3\u6784\u975e\u5e38\u677e\u6563\uff0c\u662f\u7c7b\u4f3cjson\u7684bson\u683c\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b58\u50a8\u6bd4\u8f83\u590d\u6742\u7684\u6570\u636e\u7c7b\u578b\u3002 MongoDB\u6700\u5927\u7684\u7279\u70b9\u662f\u5b83\u652f\u6301\u7684\u67e5\u8be2\u8bed\u8a00\u975e\u5e38\u5f3a\u5927\uff0c\u5176\u8bed\u6cd5\u6709\u70b9\u7c7b\u4f3c\u4e8e\u9762\u5411\u5bf9\u8c61\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u51e0\u4e4e\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u5173\u7cfb\u6570\u636e\u5e93\u5355\u8868\u67e5\u8be2\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd\uff0c\u800c\u4e14\u8fd8\u652f\u6301\u5bf9\u6570\u636e\u5efa\u7acb\u7d22\u5f15\u3002 \u5b98\u7f51\uff1ahttps://www.mongodb.com","title":"3.1\u3001MongoDB\u7b80\u4ecb"},{"location":"MongoDB/MongoDB/#32dockermongodb","text":"#\u62c9\u53d6\u955c\u50cf docker pull mongo:4.0.3 #\u521b\u5efa\u5bb9\u5668 docker create --name mongodb-server -p 27018 :27017 -v mongodb-data:/data/db mongo:4.0.3 --auth #\u542f\u52a8\u5bb9\u5668 docker start mongodb-server #\u8fdb\u5165\u5bb9\u5668 docker exec -it mongodb-server /bin/bash #\u8fdb\u5165admin\u6570\u636e\u5e93 mongo use admin #\u6dfb\u52a0\u7ba1\u7406\u5458\uff0c\u5176\u62e5\u6709\u7ba1\u7406\u7528\u6237\u548c\u89d2\u8272\u7684\u6743\u9650 db.createUser ({ user: 'root' , pwd: 'root' , roles: [ { role: \"root\" , db: \"admin\" } ] }) #\u6d4b\u8bd5\uff0c\u53d1\u73b0\u662f\u6ca1\u6709\u6743\u9650\u64cd\u4f5c\u7684 > show dbs 2020 -10-20T09:09:15.543+0000 E QUERY [ js ] Error: listDatabases failed: { \"ok\" : 0 , \"errmsg\" : \"command listDatabases requires authentication\" , \"code\" : 13 , \"codeName\" : \"Unauthorized\" } : #\u8fdb\u884c\u8ba4\u8bc1 mongo -u \"root\" -p \"root\" --authenticationDatabase \"admin\" #\u901a\u8fc7admin\u6dfb\u52a0\u666e\u901a\u7528\u6237 use admin db.createUser ({ user: 'tanhua' , pwd: 'l3SCjl0HvmSkTtiSbN0Swv40spYnHhDV' , roles: [ { role: \"readWrite\" , db: \"tanhua\" } ] }) ; #\u901a\u8fc7tanhua\u7528\u6237\u767b\u5f55\u8fdb\u884c\u6d4b\u8bd5 mongo -u \"tanhua\" -p \"l3SCjl0HvmSkTtiSbN0Swv40spYnHhDV\" --authenticationDatabase \"admin\" #\u6d4b\u8bd5 root@5d848955ff7e:/# mongo -u \"tanhua\" -p \"tanhua123\" --authenticationDatabase \"admin\" MongoDB shell version v4.0.3 connecting to: mongodb://127.0.0.1:27017 Implicit session: session { \"id\" : UUID ( \"6c368269-30f0-4b29-a224-05a38b5847e2\" ) } MongoDB server version: 4 .0.3 > use tanhua switched to db tanhua > db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) WriteResult ({ \"nInserted\" : 1 }) > db.user.find () { \"_id\" : ObjectId ( \"5f8eb2726e0de0aa9517afd3\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 20 }","title":"3.2\u3001\u901a\u8fc7docker\u5b89\u88c5MongoDB"},{"location":"MongoDB/MongoDB/#33mongodb","text":"","title":"3.3\u3001MongoDB\u57fa\u672c\u64cd\u4f5c"},{"location":"MongoDB/MongoDB/#331","text":"\u4e3a\u4e86\u66f4\u597d\u7684\u7406\u89e3\uff0c\u4e0b\u9762\u4e0eSQL\u4e2d\u7684\u6982\u5ff5\u8fdb\u884c\u5bf9\u6bd4\uff1a SQL\u672f\u8bed/\u6982\u5ff5 MongoDB\u672f\u8bed/\u6982\u5ff5 \u89e3\u91ca/\u8bf4\u660e database database \u6570\u636e\u5e93 table collection \u6570\u636e\u5e93\u8868/\u96c6\u5408 row document \u6570\u636e\u8bb0\u5f55\u884c/\u6587\u6863 column field \u6570\u636e\u5b57\u6bb5/\u57df index index \u7d22\u5f15 table joins \u8868\u8fde\u63a5,MongoDB\u4e0d\u652f\u6301 primary key primary key \u4e3b\u952e,MongoDB\u81ea\u52a8\u5c06_id\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u4e3b\u952e","title":"3.3.1\u3001\u57fa\u672c\u6982\u5ff5"},{"location":"MongoDB/MongoDB/#332","text":"#\u67e5\u770b\u6240\u6709\u7684\u6570\u636e\u5e93 > show dbs admin 0 .000GB config 0 .000GB local 0 .000GB #\u901a\u8fc7use\u5173\u952e\u5b57\u5207\u6362\u6570\u636e\u5e93 > use admin switched to db admin #\u521b\u5efa\u6570\u636e\u5e93 #\u8bf4\u660e\uff1a\u5728MongoDB\u4e2d\uff0c\u6570\u636e\u5e93\u662f\u81ea\u52a8\u521b\u5efa\u7684\uff0c\u901a\u8fc7use\u5207\u6362\u5230\u65b0\u6570\u636e\u5e93\u4e2d\uff0c\u8fdb\u884c\u63d2\u5165\u6570\u636e\u5373\u53ef\u81ea\u52a8\u521b\u5efa\u6570\u636e\u5e93 > use testdb switched to db testdb > show dbs #\u5e76\u6ca1\u6709\u521b\u5efa\u6570\u636e\u5e93 admin 0 .000GB config 0 .000GB local 0 .000GB > db.user.insert ({ id:1,name: 'zhangsan' }) #\u63d2\u5165\u6570\u636e WriteResult ({ \"nInserted\" : 1 }) > show dbs admin 0 .000GB config 0 .000GB local 0 .000GB testdb 0 .000GB #\u6570\u636e\u5e93\u81ea\u52a8\u521b\u5efa #\u67e5\u770b\u8868 > show tables user > show collections user > #\u5220\u9664\u96c6\u5408\uff08\u8868\uff09 > db.user.drop () true #\u5982\u679c\u6210\u529f\u5220\u9664\u9009\u5b9a\u96c6\u5408\uff0c\u5219 drop() \u65b9\u6cd5\u8fd4\u56de true\uff0c\u5426\u5219\u8fd4\u56de false\u3002 #\u5220\u9664\u6570\u636e\u5e93 > use testdb #\u5148\u5207\u6362\u5230\u8981\u5220\u9664\u7684\u6570\u636e\u5e93\u4e2d switched to db testdb > db.dropDatabase () #\u5220\u9664\u6570\u636e\u5e93 { \"dropped\" : \"testdb\" , \"ok\" : 1 } > show dbs admin 0 .000GB config 0 .000GB local 0 .000GB","title":"3.3.2\u3001\u6570\u636e\u5e93\u4ee5\u53ca\u8868\u7684\u64cd\u4f5c"},{"location":"MongoDB/MongoDB/#333","text":"\u5728MongoDB\u4e2d\uff0c\u5b58\u50a8\u7684\u6587\u6863\u7ed3\u6784\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8ejson\u7684\u7ed3\u6784\uff0c\u79f0\u4e4b\u4e3abson\uff08\u5168\u79f0\u4e3a\uff1aBinary JSON\uff09\u3002 #\u63d2\u5165\u6570\u636e #\u8bed\u6cd5\uff1adb.COLLECTION_NAME.insert(document) > db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) WriteResult ({ \"nInserted\" : 1 }) > db.user.save ({ id:2,username: 'lisi' ,age:25 }) WriteResult ({ \"nInserted\" : 1 }) > db.user.find () #\u67e5\u8be2\u6570\u636e { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 20 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 }","title":"3.3.3\u3001\u65b0\u589e\u6570\u636e"},{"location":"MongoDB/MongoDB/#334","text":"update() \u65b9\u6cd5\u7528\u4e8e\u66f4\u65b0\u5df2\u5b58\u5728\u7684\u6587\u6863\u3002\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a db.collection.update ( <query>, <update>, [ upsert: <boolean>, multi: <boolean>, writeConcern: <document> ] ) \u53c2\u6570\u8bf4\u660e\uff1a query : update\u7684\u67e5\u8be2\u6761\u4ef6\uff0c\u7c7b\u4f3csql update\u67e5\u8be2\u5185where\u540e\u9762\u7684\u3002 update : update\u7684\u5bf9\u8c61\u548c\u4e00\u4e9b\u66f4\u65b0\u7684\u64cd\u4f5c\u7b26\uff08\u5982 , inc...\uff09\u7b49\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3asql update\u67e5\u8be2\u5185set\u540e\u9762\u7684 upsert : \u53ef\u9009\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u610f\u601d\u662f\uff0c\u5982\u679c\u4e0d\u5b58\u5728update\u7684\u8bb0\u5f55\uff0c\u662f\u5426\u63d2\u5165objNew,true\u4e3a\u63d2\u5165\uff0c\u9ed8\u8ba4\u662ffalse\uff0c\u4e0d\u63d2\u5165\u3002 multi : \u53ef\u9009\uff0cmongodb \u9ed8\u8ba4\u662ffalse,\u53ea\u66f4\u65b0\u627e\u5230\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\uff0c\u5982\u679c\u8fd9\u4e2a\u53c2\u6570\u4e3atrue,\u5c31\u628a\u6309\u6761\u4ef6\u67e5\u51fa\u6765\u591a\u6761\u8bb0\u5f55\u5168\u90e8\u66f4\u65b0\u3002 writeConcern :\u53ef\u9009\uff0c\u629b\u51fa\u5f02\u5e38\u7684\u7ea7\u522b\u3002 > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 20 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } > db.user.update ({ id:1 } , { $set : { age:22 }}) #\u66f4\u65b0\u6570\u636e WriteResult ({ \"nMatched\" : 1 , \"nUpserted\" : 0 , \"nModified\" : 1 }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"id\" : 1 , \"username\" : \"zhangsan\" , \"age\" : 22 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } #\u6ce8\u610f\uff1a\u5982\u679c\u8fd9\u6837\u5199\uff0c\u4f1a\u5220\u9664\u6389\u5176\u4ed6\u7684\u5b57\u6bb5 > db.user.update ({ id:1 } , { age:25 }) WriteResult ({ \"nMatched\" : 1 , \"nUpserted\" : 0 , \"nModified\" : 1 }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 } #\u66f4\u65b0\u4e0d\u5b58\u5728\u7684\u5b57\u6bb5\uff0c\u4f1a\u65b0\u589e\u5b57\u6bb5 > db.user.update ({ id:2 } , { $set : { sex:1 }}) #\u66f4\u65b0\u6570\u636e > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 , \"sex\" : 1 } #\u66f4\u65b0\u4e0d\u5b58\u5728\u7684\u6570\u636e\uff0c\u9ed8\u8ba4\u4e0d\u4f1a\u65b0\u589e\u6570\u636e > db.user.update ({ id:3 } , { $set : { sex:1 }}) WriteResult ({ \"nMatched\" : 0 , \"nUpserted\" : 0 , \"nModified\" : 0 }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 , \"sex\" : 1 } #\u5982\u679c\u8bbe\u7f6e\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3atrue\uff0c\u5c31\u662f\u65b0\u589e\u6570\u636e > db.user.update ({ id:3 } , { $set : { sex:1 }} ,true ) WriteResult ({ \"nMatched\" : 0 , \"nUpserted\" : 1 , \"nModified\" : 0 , \"_id\" : ObjectId ( \"5c08cb281418d073246bc642\" ) }) > db.user.find () { \"_id\" : ObjectId ( \"5c08c0024b318926e0c1f6dc\" ) , \"age\" : 25 } { \"_id\" : ObjectId ( \"5c08c0134b318926e0c1f6dd\" ) , \"id\" : 2 , \"username\" : \"lisi\" , \"age\" : 25 , \"sex\" : 1 } { \"_id\" : ObjectId ( \"5c08cb281418d073246bc642\" ) , \"id\" : 3 , \"sex\" : 1 }","title":"3.3.4\u3001\u66f4\u65b0\u6570\u636e"},{"location":"MongoDB/MongoDB/#335","text":"\u901a\u8fc7remove()\u65b9\u6cd5\u8fdb\u884c\u5220\u9664\u6570\u636e\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a db.collection.remove ( <query>, { justOne: <boolean>, writeConcern: <document> } ) \u53c2\u6570\u8bf4\u660e\uff1a query :\uff08\u53ef\u9009\uff09\u5220\u9664\u7684\u6587\u6863\u7684\u6761\u4ef6\u3002 justOne : \uff08\u53ef\u9009\uff09\u5982\u679c\u8bbe\u4e3a true \u6216 1\uff0c\u5219\u53ea\u5220\u9664\u4e00\u4e2a\u6587\u6863\uff0c\u5982\u679c\u4e0d\u8bbe\u7f6e\u8be5\u53c2\u6570\uff0c\u6216\u4f7f\u7528\u9ed8\u8ba4\u503c false\uff0c\u5219\u5220\u9664\u6240\u6709\u5339\u914d\u6761\u4ef6\u7684\u6587\u6863\u3002 writeConcern :\uff08\u53ef\u9009\uff09\u629b\u51fa\u5f02\u5e38\u7684\u7ea7\u522b\u3002 \u5b9e\u4f8b\uff1a > db.user.remove ({ age:25 }) WriteResult ({ \"nRemoved\" : 2 }) #\u5220\u9664\u4e862\u6761\u6570\u636e #\u63d2\u51654\u6761\u6d4b\u8bd5\u6570\u636e db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) db.user.insert ({ id:2,username: 'lisi' ,age:21 }) db.user.insert ({ id:3,username: 'wangwu' ,age:22 }) db.user.insert ({ id:4,username: 'zhaoliu' ,age:22 }) > db.user.remove ({ age:22 } ,true ) WriteResult ({ \"nRemoved\" : 1 }) #\u5220\u9664\u4e861\u6761\u6570\u636e #\u5220\u9664\u6240\u6709\u6570\u636e > db.user.remove ({}) #\u8bf4\u660e\uff1a\u4e3a\u4e86\u7b80\u5316\u64cd\u4f5c\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528deleteOne()\u4e0edeleteMany()\u8fdb\u884c\u5220\u9664\u6570\u636e\u64cd\u4f5c\u3002 db.user.deleteOne ({ id:1 }) db.user.deleteMany ({}) #\u5220\u9664\u6240\u6709\u6570\u636e","title":"3.3.5\u3001\u5220\u9664\u6570\u636e"},{"location":"MongoDB/MongoDB/#336","text":"MongoDB \u67e5\u8be2\u6570\u636e\u7684\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a db . user . find ( [ query ] , [ fields ] ) query \uff1a\u53ef\u9009\uff0c\u4f7f\u7528\u67e5\u8be2\u64cd\u4f5c\u7b26\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6 fields \uff1a\u53ef\u9009\uff0c\u4f7f\u7528\u6295\u5f71\u64cd\u4f5c\u7b26\u6307\u5b9a\u8fd4\u56de\u7684\u952e\u3002\u67e5\u8be2\u65f6\u8fd4\u56de\u6587\u6863\u4e2d\u6240\u6709\u952e\u503c\uff0c \u53ea\u9700\u7701\u7565\u8be5\u53c2\u6570\u5373\u53ef\uff08\u9ed8\u8ba4\u7701\u7565\uff09\u3002 \u5982\u679c\u4f60\u9700\u8981\u4ee5\u6613\u8bfb\u7684\u65b9\u5f0f\u6765\u8bfb\u53d6\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528 pretty() \u65b9\u6cd5\uff0c\u8bed\u6cd5\u683c\u5f0f\u5982\u4e0b\uff1a >db.col.find().pretty() pretty() \u65b9\u6cd5\u4ee5\u683c\u5f0f\u5316\u7684\u65b9\u5f0f\u6765\u663e\u793a\u6240\u6709\u6587\u6863\u3002 \u6761\u4ef6\u67e5\u8be2\uff1a \u64cd\u4f5c \u683c\u5f0f \u8303\u4f8b RDBMS\u4e2d\u7684\u7c7b\u4f3c\u8bed\u53e5 \u7b49\u4e8e {<key>:<value> } db.col.find({\"by\":\"\u9ed1\u9a6c\u7a0b\u5e8f\u5458\"}).pretty() where by = '\u9ed1\u9a6c\u7a0b\u5e8f\u5458' \u5c0f\u4e8e {<key>:{$lt:<value>}} db.col.find({\"likes\":{$lt:50}}).pretty() where likes < 50 \u5c0f\u4e8e\u6216\u7b49\u4e8e {<key>:{$lte:<value>}} db.col.find({\"likes\":{$lte:50}}).pretty() where likes <= 50 \u5927\u4e8e {<key>:{$gt:<value>}} db.col.find({\"likes\":{$gt:50}}).pretty() where likes > 50 \u5927\u4e8e\u6216\u7b49\u4e8e {<key>:{$gte:<value>}} db.col.find({\"likes\":{$gte:50}}).pretty() where likes >= 50 \u4e0d\u7b49\u4e8e {<key>:{$ne:<value>}} db.col.find({\"likes\":{$ne:50}}).pretty() where likes != 50 \u5b9e\u4f8b\uff1a #\u63d2\u5165\u6d4b\u8bd5\u6570\u636e db.user.insert ({ id:1,username: 'zhangsan' ,age:20 }) db.user.insert ({ id:2,username: 'lisi' ,age:21 }) db.user.insert ({ id:3,username: 'wangwu' ,age:22 }) db.user.insert ({ id:4,username: 'zhaoliu' ,age:22 }) db.user.find () #\u67e5\u8be2\u5168\u90e8\u6570\u636e db.user.find ({} , { id:1,username:1 }) #\u53ea\u67e5\u8be2id\u4e0eusername\u5b57\u6bb5 db.user.find () .count () #\u67e5\u8be2\u6570\u636e\u6761\u6570 db.user.find ({ id:1 }) #\u67e5\u8be2id\u4e3a1\u7684\u6570\u636e db.user.find ({ age: { $lte :21 }}) #\u67e5\u8be2\u5c0f\u4e8e\u7b49\u4e8e21\u7684\u6570\u636e db.user.find ({ age: { $lte :21 } , id: { $gte :2 }}) #and\u67e5\u8be2\uff0cage\u5c0f\u4e8e\u7b49\u4e8e21\u5e76\u4e14id\u5927\u4e8e\u7b49\u4e8e2 db.user.find ({ $or : [{ id:1 } , { id:2 }]}) #\u67e5\u8be2id=1 or id=2 #\u5206\u9875\u67e5\u8be2\uff1aSkip()\u8df3\u8fc7\u51e0\u6761\uff0climit()\u67e5\u8be2\u6761\u6570 db.user.find () .limit ( 2 ) .skip ( 1 ) #\u8df3\u8fc71\u6761\u6570\u636e\uff0c\u67e5\u8be22\u6761\u6570\u636e db.user.find () .sort ({ id:-1 }) #\u6309\u7167age\u5012\u5e8f\u6392\u5e8f\uff0c-1\u4e3a\u5012\u5e8f\uff0c1\u4e3a\u6b63\u5e8f","title":"3.3.6\u3001\u67e5\u8be2\u6570\u636e"},{"location":"MongoDB/MongoDB/#34","text":"\u7d22\u5f15\u901a\u5e38\u80fd\u591f\u6781\u5927\u7684\u63d0\u9ad8\u67e5\u8be2\u7684\u6548\u7387\uff0c\u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0cMongoDB\u5728\u8bfb\u53d6\u6570\u636e\u65f6\u5fc5\u987b\u626b\u63cf\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u6587\u4ef6\u5e76\u9009\u53d6\u90a3\u4e9b\u7b26\u5408\u67e5\u8be2\u6761\u4ef6\u7684\u8bb0\u5f55\u3002 \u8fd9\u79cd\u626b\u63cf\u5168\u96c6\u5408\u7684\u67e5\u8be2\u6548\u7387\u662f\u975e\u5e38\u4f4e\u7684\uff0c\u7279\u522b\u5728\u5904\u7406\u5927\u91cf\u7684\u6570\u636e\u65f6\uff0c\u67e5\u8be2\u53ef\u4ee5\u8981\u82b1\u8d39\u51e0\u5341\u79d2\u751a\u81f3\u51e0\u5206\u949f\uff0c\u8fd9\u5bf9\u7f51\u7ad9\u7684\u6027\u80fd\u662f\u975e\u5e38\u81f4\u547d\u7684\u3002 \u7d22\u5f15\u662f\u7279\u6b8a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7d22\u5f15\u5b58\u50a8\u5728\u4e00\u4e2a\u6613\u4e8e\u904d\u5386\u8bfb\u53d6\u7684\u6570\u636e\u96c6\u5408\u4e2d\uff0c\u7d22\u5f15\u662f\u5bf9\u6570\u636e\u5e93\u8868\u4e2d\u4e00\u5217\u6216\u591a\u5217\u7684\u503c\u8fdb\u884c\u6392\u5e8f\u7684\u4e00\u79cd\u7ed3\u6784 #\u67e5\u770b\u7d22\u5f15 > db.user.getIndexes () [ { \"v\" : 2 , \"key\" : { \"_id\" : 1 } , \"name\" : \"_id_\" , \"ns\" : \"testdb.user\" } ] #\u8bf4\u660e\uff1a1\u8868\u793a\u5347\u5e8f\u521b\u5efa\u7d22\u5f15\uff0c-1\u8868\u793a\u964d\u5e8f\u521b\u5efa\u7d22\u5f15\u3002 #\u521b\u5efa\u7d22\u5f15 > db.user.createIndex ({ 'age' :1 }) { \"createdCollectionAutomatically\" : false, \"numIndexesBefore\" : 1 , \"numIndexesAfter\" : 2 , \"ok\" : 1 } #\u5220\u9664\u7d22\u5f15 db.user.dropIndex ( \"age_1\" ) #\u6216\u8005\uff0c\u5220\u9664\u9664\u4e86_id\u4e4b\u5916\u7684\u7d22\u5f15 db.user.dropIndexes () #\u521b\u5efa\u8054\u5408\u7d22\u5f15 db.user.createIndex ({ 'age' :1, 'id' :-1 }) #\u67e5\u770b\u7d22\u5f15\u5927\u5c0f\uff0c\u5355\u4f4d\uff1a\u5b57\u8282 db.user.totalIndexSize ()","title":"3.4\u3001\u7d22\u5f15"},{"location":"MongoDB/MongoDB/#35","text":"MongoDB \u67e5\u8be2\u5206\u6790\u53ef\u4ee5\u786e\u4fdd\u6211\u4eec\u5efa\u8bae\u7684\u7d22\u5f15\u662f\u5426\u6709\u6548\uff0c\u662f\u67e5\u8be2\u8bed\u53e5\u6027\u80fd\u5206\u6790\u7684\u91cd\u8981\u5de5\u5177\u3002 #\u63d2\u51651000\u6761\u6570\u636e for ( var i = 1 ; i< 1000 ; i++ ) db.user.insert ({ id:100+i,username: 'name_' +i,age:10+i }) #\u67e5\u770b\u6267\u884c\u8ba1\u5212 > db.user.find ({ age: { $gt :100 } ,id: { $lt :200 }}) .explain () { \"queryPlanner\" : { \"plannerVersion\" : 1 , \"namespace\" : \"testdb.user\" , \"indexFilterSet\" : false, \"parsedQuery\" : { \" $and \" : [ { \"id\" : { \" $lt \" : 200 } } , { \"age\" : { \" $gt \" : 100 } } ] } , \"winningPlan\" : { #\u6700\u4f73\u6267\u884c\u8ba1\u5212 \"stage\" : \"FETCH\" , #\u67e5\u8be2\u65b9\u5f0f\uff0c\u5e38\u89c1\u7684\u6709COLLSCAN/\u5168\u8868\u626b\u63cf\u3001IXSCAN/\u7d22\u5f15\u626b\u63cf\u3001FETCH/\u6839\u636e\u7d22\u5f15\u53bb\u68c0\u7d22\u6587\u6863\u3001SHARD_MERGE/\u5408\u5e76\u5206\u7247\u7ed3\u679c\u3001IDHACK/\u9488\u5bf9_id\u8fdb\u884c\u67e5\u8be2 \"inputStage\" : { \"stage\" : \"IXSCAN\" , \"keyPattern\" : { \"age\" : 1 , \"id\" : -1 } , \"indexName\" : \"age_1_id_-1\" , \"isMultiKey\" : false, \"multiKeyPaths\" : { \"age\" : [ ] , \"id\" : [ ] } , \"isUnique\" : false, \"isSparse\" : false, \"isPartial\" : false, \"indexVersion\" : 2 , \"direction\" : \"forward\" , \"indexBounds\" : { \"age\" : [ \"(100.0, inf.0]\" ] , \"id\" : [ \"(200.0, -inf.0]\" ] } } } , \"rejectedPlans\" : [ ] } , \"serverInfo\" : { \"host\" : \"c493d5ff750a\" , \"port\" : 27017 , \"version\" : \"4.0.3\" , \"gitVersion\" : \"7ea530946fa7880364d88c8d8b6026bbc9ffa48c\" } , \"ok\" : 1 } #\u6d4b\u8bd5\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15 > db.user.find ({ username: 'zhangsan' }) .explain () { \"queryPlanner\" : { \"plannerVersion\" : 1 , \"namespace\" : \"testdb.user\" , \"indexFilterSet\" : false, \"parsedQuery\" : { \"username\" : { \" $eq \" : \"zhangsan\" } } , \"winningPlan\" : { \"stage\" : \"COLLSCAN\" , #\u5168\u8868\u626b\u63cf \"filter\" : { \"username\" : { \" $eq \" : \"zhangsan\" } } , \"direction\" : \"forward\" } , \"rejectedPlans\" : [ ] } , \"serverInfo\" : { \"host\" : \"c493d5ff750a\" , \"port\" : 27017 , \"version\" : \"4.0.3\" , \"gitVersion\" : \"7ea530946fa7880364d88c8d8b6026bbc9ffa48c\" } , \"ok\" : 1 }","title":"3.5\u3001\u6267\u884c\u8ba1\u5212"},{"location":"MongoDB/MongoDB/#36ui","text":"Robo 3T\u662fMongoDB\u7684\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u64cd\u4f5cMongoDB\u3002 \u67e5\u770b\u6570\u636e\uff1a \u6216\u4f7f\u7528Navicat Premium 15\uff1a","title":"3.6\u3001UI\u5ba2\u6237\u7aef\u5de5\u5177"},{"location":"MongoDB/MongoDB/#4springbootmongodb","text":"spring-data\u5bf9MongoDB\u505a\u4e86\u652f\u6301\uff0c\u4f7f\u7528spring-data-mongodb\u53ef\u4ee5\u7b80\u5316MongoDB\u7684\u64cd\u4f5c\u3002 \u5730\u5740\uff1ahttps://spring.io/projects/spring-data-mongodb","title":"4\u3001SpringBoot\u6574\u5408MongoDB"},{"location":"MongoDB/MongoDB/#41","text":"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <project xmlns= \"http://maven.apache.org/POM/4.0.0\" xmlns:xsi= \"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation= \"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" > <modelVersion> 4.0.0 </modelVersion> <parent> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-parent </artifactId> <version> 2.1.0.RELEASE </version> </parent> <groupId> cn.itcast.mongodb </groupId> <artifactId> itcast-mongodb </artifactId> <version> 1.0-SNAPSHOT </version> <dependencies> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-data-mongodb </artifactId> </dependency> <dependency> <groupId> org.springframework.boot </groupId> <artifactId> spring-boot-starter-test </artifactId> <scope> test </scope> </dependency> <dependency> <groupId> org.projectlombok </groupId> <artifactId> lombok </artifactId> <optional> true </optional> <version> 1.18.4 </version> </dependency> </dependencies> <build> <plugins> <!-- java\u7f16\u8bd1\u63d2\u4ef6 --> <plugin> <groupId> org.apache.maven.plugins </groupId> <artifactId> maven-compiler-plugin </artifactId> <version> 3.2 </version> <configuration> <source> 1.8 </source> <target> 1.8 </target> <encoding> UTF-8 </encoding> </configuration> </plugin> </plugins> </build> </project>","title":"4.1\u3001\u5bfc\u5165\u4f9d\u8d56"},{"location":"MongoDB/MongoDB/#42applicationproperties","text":"# Spring boot application spring.application.name = itcast-mongodb #\u65e0\u8ba4\u8bc1\u4fe1\u606f\u7684\u914d\u7f6e #spring.data.mongodb.uri=mongodb://192.168.31.81:27017/tanhua #springboot \u914d\u7f6e spring.data.mongodb.username = tanhua spring.data.mongodb.password = l3SCjl0HvmSkTtiSbN0Swv40spYnHhDV spring.data.mongodb.authentication-database = admin spring.data.mongodb.database = tanhua spring.data.mongodb.port = 27018 spring.data.mongodb.host = 192.168.31.81","title":"4.2\u3001\u7f16\u5199application.properties\u914d\u7f6e\u6587\u4ef6"},{"location":"MongoDB/MongoDB/#43","text":"package cn.itcast.mongodb.pojo ; import lombok.AllArgsConstructor ; import lombok.Data ; import lombok.NoArgsConstructor ; import org.bson.types.ObjectId ; @Data @AllArgsConstructor @NoArgsConstructor public class Person { private ObjectId id ; private String name ; private int age ; private Address address ; } package cn.itcast.mongodb.pojo ; import lombok.AllArgsConstructor ; import lombok.Data ; import lombok.NoArgsConstructor ; @Data @AllArgsConstructor @NoArgsConstructor public class Address { private String street ; private String city ; private String zip ; }","title":"4.3\u3001\u7f16\u5199\u5b9e\u4f53"},{"location":"MongoDB/MongoDB/#44dao","text":"package cn.itcast.mongodb.dao ; import cn.itcast.mongodb.pojo.Person ; import com.mongodb.client.result.DeleteResult ; import com.mongodb.client.result.UpdateResult ; import org.springframework.beans.factory.annotation.Autowired ; import org.springframework.data.mongodb.core.MongoTemplate ; import org.springframework.data.mongodb.core.query.Criteria ; import org.springframework.data.mongodb.core.query.Query ; import org.springframework.data.mongodb.core.query.Update ; import org.springframework.stereotype.Component ; import java.util.List ; @Component public class PersonDao { @Autowired private MongoTemplate mongoTemplate ; public void savePerson ( Person person ) { this . mongoTemplate . save ( person ); } public List < Person > queryPersonListByName ( String name ) { Query query = Query . query ( Criteria . where ( \"name\" ). is ( name )); return this . mongoTemplate . find ( query , Person . class ); } public List < Person > queryPersonPageList ( Integer page , Integer rows ) { Query query = new Query (). limit ( rows ). skip (( page - 1 ) * rows ); return this . mongoTemplate . find ( query , Person . class ); } public UpdateResult update ( Person person ) { Query query = Query . query ( Criteria . where ( \"id\" ). is ( person . getId ())); Update update = Update . update ( \"age\" , person . getAge ()); return this . mongoTemplate . updateFirst ( query , update , Person . class ); } public DeleteResult deleteById ( String id ) { Query query = Query . query ( Criteria . where ( \"id\" ). is ( id )); return this . mongoTemplate . remove ( query , Person . class ); } }","title":"4.4\u3001\u7f16\u5199dao"},{"location":"MongoDB/MongoDB/#45","text":"package cn.itcast.mongodb ; import org.springframework.boot.SpringApplication ; import org.springframework.boot.autoconfigure.SpringBootApplication ; @SpringBootApplication public class MongoApplication { public static void main ( String [] args ) { SpringApplication . run ( MongoApplication . class , args ); } }","title":"4.5\u3001\u7f16\u5199\u542f\u52a8\u7c7b"},{"location":"MongoDB/MongoDB/#46","text":"package cn.itcast.mongodb ; import cn.itcast.mongodb.dao.PersonDao ; import cn.itcast.mongodb.pojo.Address ; import cn.itcast.mongodb.pojo.Person ; import org.bson.types.ObjectId ; import org.junit.Test ; import org.junit.runner.RunWith ; import org.springframework.beans.factory.annotation.Autowired ; import org.springframework.boot.test.context.SpringBootTest ; import org.springframework.test.context.junit4.SpringRunner ; import java.util.List ; @RunWith ( SpringRunner . class ) @SpringBootTest public class TestPersonDao { @Autowired private PersonDao personDao ; @Test public void testSave () { Person person = new Person ( ObjectId . get (), \"\u5f20\u4e09\" , 20 , new Address ( \"\u4eba\u6c11\u8def\" , \"\u4e0a\u6d77\u5e02\" , \"666666\" )); this . personDao . savePerson ( person ); } @Test public void testQuery () { List < Person > personList = this . personDao . queryPersonListByName ( \"\u5f20\u4e09\" ); for ( Person person : personList ) { System . out . println ( person ); } } @Test public void testQuery2 () { List < Person > personList = this . personDao . queryPersonPageList ( 2 , 2 ); for ( Person person : personList ) { System . out . println ( person ); } } @Test public void testUpdate () { Person person = new Person (); person . setId ( new ObjectId ( \"5c0956ce235e192520086736\" )); person . setAge ( 30 ); this . personDao . update ( person ); } @Test public void testDelete () { this . personDao . deleteById ( \"5c09ca05235e192d8887a389\" ); } }","title":"4.6\u3001\u7f16\u5199\u5355\u5143\u6d4b\u8bd5"},{"location":"docker/1/","text":"\u521d\u8bc6 Docker \u00b6 1.1\u5b89\u88c5docker \u00b6 Docker\u53ef\u4ee5\u8fd0\u884c\u5728MAC\u3001Windows\u3001CentOS\u3001UBUNTU\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u672c\u8bfe\u7a0b\u57fa\u4e8eCentOS 7 \u5b89\u88c5 Docker\u3002\u5b98\u7f51\uff1ahttps://www.docker.com # 1\u3001yum \u5305\u66f4\u65b0\u5230\u6700\u65b0 yum update # 2\u3001\u5b89\u88c5\u9700\u8981\u7684\u8f6f\u4ef6\u5305\uff0c yum-util \u63d0\u4f9byum-config-manager\u529f\u80fd\uff0c\u53e6\u5916\u4e24\u4e2a\u662fdevicemapper\u9a71\u52a8\u4f9d\u8d56\u7684 yum install -y yum-utils device-mapper-persistent-data lvm2 # 3\u3001 \u8bbe\u7f6eyum\u6e90 yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo # 4\u3001 \u5b89\u88c5docker\uff0c\u51fa\u73b0\u8f93\u5165\u7684\u754c\u9762\u90fd\u6309 y yum install -y docker-ce # 5\u3001 \u67e5\u770bdocker\u7248\u672c\uff0c\u9a8c\u8bc1\u662f\u5426\u9a8c\u8bc1\u6210\u529f docker -v 1.2\u914d\u7f6e Docker \u955c\u50cf\u52a0\u901f\u5668 \u00b6","title":"\u521d\u8bc6 Docker"},{"location":"docker/1/#docker","text":"","title":"\u521d\u8bc6 Docker"},{"location":"docker/1/#11docker","text":"Docker\u53ef\u4ee5\u8fd0\u884c\u5728MAC\u3001Windows\u3001CentOS\u3001UBUNTU\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0a\uff0c\u672c\u8bfe\u7a0b\u57fa\u4e8eCentOS 7 \u5b89\u88c5 Docker\u3002\u5b98\u7f51\uff1ahttps://www.docker.com # 1\u3001yum \u5305\u66f4\u65b0\u5230\u6700\u65b0 yum update # 2\u3001\u5b89\u88c5\u9700\u8981\u7684\u8f6f\u4ef6\u5305\uff0c yum-util \u63d0\u4f9byum-config-manager\u529f\u80fd\uff0c\u53e6\u5916\u4e24\u4e2a\u662fdevicemapper\u9a71\u52a8\u4f9d\u8d56\u7684 yum install -y yum-utils device-mapper-persistent-data lvm2 # 3\u3001 \u8bbe\u7f6eyum\u6e90 yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo # 4\u3001 \u5b89\u88c5docker\uff0c\u51fa\u73b0\u8f93\u5165\u7684\u754c\u9762\u90fd\u6309 y yum install -y docker-ce # 5\u3001 \u67e5\u770bdocker\u7248\u672c\uff0c\u9a8c\u8bc1\u662f\u5426\u9a8c\u8bc1\u6210\u529f docker -v","title":"1.1\u5b89\u88c5docker"},{"location":"docker/1/#12_docker","text":"","title":"1.2\u914d\u7f6e Docker \u955c\u50cf\u52a0\u901f\u5668"},{"location":"docker/2/","text":"docker\u547d\u4ee4 \u00b6 2.1 \u8fdb\u7a0b\u76f8\u5173\u547d\u4ee4 \u00b6 \u5173\u4e8e\u8fdb\u7a0b\u76f8\u5173\u7684\u547d\u4ee4 2.1.1 \u542f\u52a8docker\u670d\u52a1 \u00b6 systemctl start docker 2.1.2 \u505c\u6b62docker\u670d\u52a1 \u00b6 systemctl stop docker 2.1.3 \u91cd\u542fdocker\u670d\u52a1 \u00b6 systemctl restart docker 2.1.4 \u67e5\u770bdocker\u670d\u52a1\u72b6\u6001 \u00b6 systemctl status docker 2.1.5 \u5f00\u673a\u542f\u52a8docker\u670d\u52a1 \u00b6 systemctl enable docker 2.2 Docker \u955c\u50cf\u76f8\u5173\u547d\u4ee4 \u00b6 2.2.1 \u67e5\u770b\u955c\u50cf \u00b6 \u67e5\u770b\u672c\u5730\u6240\u6709\u7684\u955c\u50cf docker images docker images \u2013q # \u67e5\u770b\u6240\u7528\u955c\u50cf\u7684id REPOSITORY\uff1a\u955c\u50cf\u540d\u79f0 TAG\uff1a\u955c\u50cf\u6807\u7b7e IMAGE ID\uff1a\u955c\u50cfID CREATED\uff1a\u955c\u50cf\u7684\u521b\u5efa\u65e5\u671f SIZE\uff1a\u955c\u50cf\u5927\u5c0f 2.2.2 \u641c\u7d22\u955c\u50cf \u00b6 \u4ece\u7f51\u7edc\u4e2d\u67e5\u627e\u9700\u8981\u7684\u955c\u50cf docker search \u955c\u50cf\u540d\u79f0 NAME\uff1a\u955c\u50cf\u540d\u79f0 DESCRIPTION\uff1a\u955c\u50cf\u63cf\u8ff0 STARS\uff1a\u7528\u6237\u8bc4\u4ef7\uff0c\u53cd\u5e94\u4e00\u4e2a\u955c\u50cf\u7684\u53d7\u6b22\u8fce\u7a0b\u5ea6 OFFICIAL\uff1a\u662f\u5426\u5b98\u65b9 AUTOMATED\uff1a\u81ea\u52a8\u6784\u5efa\uff0c\u8868\u793a\u8be5\u955c\u50cf\u7531Docker Hub\u81ea\u52a8\u6784\u5efa\u6d41\u7a0b\u521b\u5efa\u7684 2.2.3 \u62c9\u53d6\u955c\u50cf \u00b6 \u4eceDocker\u4ed3\u5e93\u4e0b\u8f7d\u955c\u50cf\u5230\u672c\u5730\uff0c\u955c\u50cf\u540d\u79f0\u683c\u5f0f\u4e3a \u540d\u79f0:\u7248\u672c\u53f7\uff0c\u5982\u679c\u7248\u672c\u53f7\u4e0d\u6307\u5b9a\u5219\u662f\u6700\u65b0\u7684\u7248\u672c\u3002 \u5982\u679c\u4e0d\u77e5\u9053\u955c\u50cf\u7248\u672c\uff0c\u53ef\u4ee5\u53bbdocker hub \u641c\u7d22\u5bf9\u5e94\u955c\u50cf\u67e5\u770b\u3002 docker pull \u955c\u50cf\u540d\u79f0 2.2.4 \u5220\u9664\u955c\u50cf \u00b6 \u5220\u9664\u672c\u5730\u955c\u50cf docker rmi \u955c\u50cfid # \u5220\u9664\u6307\u5b9a\u672c\u5730\u955c\u50cf docker rmi ` docker images -q ` # \u5220\u9664\u6240\u6709\u672c\u5730\u955c\u50cf \u5173\u4e8edocker\u66f4\u591a\u547d\u4ee4\uff0c \u5927\u5bb6\u53ef\u4ee5\u83dc\u9e1f\u6559\u7a0b\u67e5\u770b, \u7f51\u5740\uff1a https://www.runoob.com/docker/docker-command-manual.html 2.3 \u5bb9\u5668\u76f8\u5173\u7684\u547d\u4ee4 \u00b6 2.3.1 \u67e5\u770b\u5bb9\u5668 \u00b6 docker ps # \u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 docker ps -a # \u67e5\u770b\u6240\u6709\u5bb9\u5668\uff0c\u5305\u62ec\u6b63\u5728\u8fd0\u884c\u548c\u505c\u6b62\u7684\u5bb9\u5668 2.3.2 \u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668 \u00b6 docker run \u53c2\u6570 \u53c2\u6570\u8bf4\u660e\uff1a \u2022 -i\uff1a\u4fdd\u6301\u5bb9\u5668\u8fd0\u884c\u3002\u901a\u5e38\u4e0e -t \u540c\u65f6\u4f7f\u7528\u3002\u52a0\u5165it\u8fd9\u4e24\u4e2a\u53c2\u6570\u540e\uff0c\u5bb9\u5668\u521b\u5efa\u540e\u81ea\u52a8\u8fdb\u5165\u5bb9\u5668\u4e2d\uff0c\u9000\u51fa\u5bb9\u5668\u540e\uff0c\u5bb9\u5668\u81ea\u52a8\u5173\u95ed\u3002 \u2022 -t\uff1a\u4e3a\u5bb9\u5668\u91cd\u65b0\u5206\u914d\u4e00\u4e2a\u4f2a\u8f93\u5165\u7ec8\u7aef\uff0c\u901a\u5e38\u4e0e -i \u540c\u65f6\u4f7f\u7528\u3002 \u2022 -d\uff1a\u4ee5\u5b88\u62a4\uff08\u540e\u53f0\uff09\u6a21\u5f0f\u8fd0\u884c\u5bb9\u5668\u3002\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u9700\u8981\u4f7f\u7528docker exec \u8fdb\u5165\u5bb9\u5668\u3002\u9000\u51fa\u540e\uff0c\u5bb9\u5668\u4e0d\u4f1a\u5173\u95ed\u3002 \u2022 -it \u521b\u5efa\u7684\u5bb9\u5668\u4e00\u822c\u79f0\u4e3a\u4ea4\u4e92\u5f0f\u5bb9\u5668\uff0c-id \u521b\u5efa\u7684\u5bb9\u5668\u4e00\u822c\u79f0\u4e3a\u5b88\u62a4\u5f0f\u5bb9\u5668 \u2022 --name\uff1a\u4e3a\u521b\u5efa\u7684\u5bb9\u5668\u547d\u540d\u3002 1\uff09\u4ea4\u4e92\u5f0f\u5bb9\u5668 \u4ee5 \u4ea4\u4e92\u5f0f \u65b9\u5f0f\u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668\uff0c\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u76f4\u63a5\u8fdb\u5165\u5f53\u524d\u5bb9\u5668\u3002\u4f7f\u7528exit\u547d\u4ee4\u9000\u51fa\u5bb9\u5668\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u4ee5\u6b64\u79cd\u65b9\u5f0f \u542f\u52a8\u5bb9\u5668\uff0c\u5982\u679c\u9000\u51fa\u5bb9\u5668\uff0c\u5219\u5bb9\u5668\u4f1a\u8fdb\u5165 \u505c\u6b62 \u72b6\u6001\u3002 # \u5148\u62c9\u53d6\u4e00\u4e2a\u955c\u50cf\uff1b\u8fd9\u4e00\u6b65\u4e0d\u662f\u6bcf\u6b21\u542f\u52a8\u5bb9\u5668\u90fd\u8981\u505a\u7684\uff0c\u800c\u662f\u56e0\u4e3a\u524d\u9762\u6211\u4eec\u5220\u9664\u4e86\u955c\u50cf\uff0c\u65e0\u955c\u50cf\u53ef\u7528\u6240\u4ee5\u624d\u518d\u62c9\u53d6\u4e00\u4e2a docker pull centos:7 #\u521b\u5efa\u5e76\u542f\u52a8\u540d\u79f0\u4e3a mycentos7 \u7684\u4ea4\u4e92\u5f0f\u5bb9\u5668\uff1b\u4e0b\u9762\u6307\u4ee4\u4e2d\u7684\u955c\u50cf\u540d\u79f0 centos:7 \u4e5f\u53ef\u4ee5\u4f7f\u7528\u955c\u50cfid docker run -it --name = mycentos7 centos:7 /bin/bash 2\uff09\u5b88\u62a4\u5f0f\u5bb9\u5668 \u521b\u5efa\u4e00\u4e2a\u5b88\u62a4\u5f0f\u5bb9\u5668\uff1b\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u9700\u8981\u957f\u671f\u8fd0\u884c\u7684\u5bb9\u5668\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5b88\u62a4\u5f0f\u5bb9\u5668\u3002\u547d\u4ee4\u5982\u4e0b\uff08\u5bb9\u5668\u540d\u79f0 \u4e0d\u80fd\u91cd\u590d\uff09\uff1a #\u521b\u5efa\u5e76\u542f\u52a8\u5b88\u62a4\u5f0f\u5bb9\u5668 docker run -di --name = mycentos2 centos:7 #\u767b\u5f55\u8fdb\u5165\u5bb9\u5668\u547d\u4ee4\u4e3a\uff1adocker exec -it container_name (\u6216\u8005 container_id) /bin/bash\uff08exit\u9000\u51fa \u65f6\uff0c\u5bb9\u5668\u4e0d\u4f1a\u505c\u6b62\uff09 docker exec -it mycentos2 /bin/bash 2.3.3 \u8fdb\u5165\u5bb9\u5668 \u00b6 docker exec \u53c2\u6570 # \u9000\u51fa\u5bb9\u5668\uff0c\u5bb9\u5668\u4e0d\u4f1a\u5173\u95ed eg: docker exec -it mycentos2 /bin/bash 2.3.4 \u505c\u6b62\u5bb9\u5668 \u00b6 docker stop \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id 2.3.5 \u542f\u52a8\u5bb9\u5668 \u00b6 docker start \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id 2.3.6 \u5220\u9664\u5bb9\u5668 \u00b6 #\u5220\u9664\u6307\u5b9a\u5bb9\u5668 docker rm \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id # \u5220\u9664\u6240\u6709\u5bb9\u5668\uff1a docker rm ` docker ps -a -q ` \u6ce8\u610f\uff1a\u5982\u679c\u5bb9\u5668\u662f\u8fd0\u884c\u72b6\u6001\u5219\u5220\u9664\u5931\u8d25\uff0c\u9700\u8981\u505c\u6b62\u5bb9\u5668\u624d\u80fd\u5220\u9664 2.3. 7 \u67e5\u770b\u5bb9\u5668\u4fe1\u606f \u00b6 docker inspect \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id \u8bf4\u660e\uff1a\u5bb9\u5668\u4e4b\u95f4\u5728\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\uff0clinux\u5bbf\u4e3b\u673a\u5668\u53ef\u4ee5\u4e0e\u5bb9\u5668\u8fdb\u884c\u901a\u4fe1\uff1b\u4f46\u662f\u5916\u90e8\u7684\u7269\u7406\u673a\u7b14\u8bb0\u672c\u662f\u4e0d\u80fd\u4e0e\u5bb9\u5668\u76f4\u63a5\u901a\u4fe1\u7684\uff0c\u5982\u679c\u9700\u8981\u5219\u9700\u8981\u901a\u8fc7\u5bbf\u4e3b\u673a\u5668\u7aef\u53e3\u7684\u4ee3\u7406\u3002","title":"docker\u547d\u4ee4"},{"location":"docker/2/#docker","text":"","title":"docker\u547d\u4ee4"},{"location":"docker/2/#21","text":"\u5173\u4e8e\u8fdb\u7a0b\u76f8\u5173\u7684\u547d\u4ee4","title":"2.1 \u8fdb\u7a0b\u76f8\u5173\u547d\u4ee4"},{"location":"docker/2/#211_docker","text":"systemctl start docker","title":"2.1.1 \u542f\u52a8docker\u670d\u52a1"},{"location":"docker/2/#212_docker","text":"systemctl stop docker","title":"2.1.2 \u505c\u6b62docker\u670d\u52a1"},{"location":"docker/2/#213_docker","text":"systemctl restart docker","title":"2.1.3 \u91cd\u542fdocker\u670d\u52a1"},{"location":"docker/2/#214_docker","text":"systemctl status docker","title":"2.1.4 \u67e5\u770bdocker\u670d\u52a1\u72b6\u6001"},{"location":"docker/2/#215_docker","text":"systemctl enable docker","title":"2.1.5 \u5f00\u673a\u542f\u52a8docker\u670d\u52a1"},{"location":"docker/2/#22_docker","text":"","title":"2.2 Docker \u955c\u50cf\u76f8\u5173\u547d\u4ee4"},{"location":"docker/2/#221","text":"\u67e5\u770b\u672c\u5730\u6240\u6709\u7684\u955c\u50cf docker images docker images \u2013q # \u67e5\u770b\u6240\u7528\u955c\u50cf\u7684id REPOSITORY\uff1a\u955c\u50cf\u540d\u79f0 TAG\uff1a\u955c\u50cf\u6807\u7b7e IMAGE ID\uff1a\u955c\u50cfID CREATED\uff1a\u955c\u50cf\u7684\u521b\u5efa\u65e5\u671f SIZE\uff1a\u955c\u50cf\u5927\u5c0f","title":"2.2.1 \u67e5\u770b\u955c\u50cf"},{"location":"docker/2/#222","text":"\u4ece\u7f51\u7edc\u4e2d\u67e5\u627e\u9700\u8981\u7684\u955c\u50cf docker search \u955c\u50cf\u540d\u79f0 NAME\uff1a\u955c\u50cf\u540d\u79f0 DESCRIPTION\uff1a\u955c\u50cf\u63cf\u8ff0 STARS\uff1a\u7528\u6237\u8bc4\u4ef7\uff0c\u53cd\u5e94\u4e00\u4e2a\u955c\u50cf\u7684\u53d7\u6b22\u8fce\u7a0b\u5ea6 OFFICIAL\uff1a\u662f\u5426\u5b98\u65b9 AUTOMATED\uff1a\u81ea\u52a8\u6784\u5efa\uff0c\u8868\u793a\u8be5\u955c\u50cf\u7531Docker Hub\u81ea\u52a8\u6784\u5efa\u6d41\u7a0b\u521b\u5efa\u7684","title":"2.2.2 \u641c\u7d22\u955c\u50cf"},{"location":"docker/2/#223","text":"\u4eceDocker\u4ed3\u5e93\u4e0b\u8f7d\u955c\u50cf\u5230\u672c\u5730\uff0c\u955c\u50cf\u540d\u79f0\u683c\u5f0f\u4e3a \u540d\u79f0:\u7248\u672c\u53f7\uff0c\u5982\u679c\u7248\u672c\u53f7\u4e0d\u6307\u5b9a\u5219\u662f\u6700\u65b0\u7684\u7248\u672c\u3002 \u5982\u679c\u4e0d\u77e5\u9053\u955c\u50cf\u7248\u672c\uff0c\u53ef\u4ee5\u53bbdocker hub \u641c\u7d22\u5bf9\u5e94\u955c\u50cf\u67e5\u770b\u3002 docker pull \u955c\u50cf\u540d\u79f0","title":"2.2.3 \u62c9\u53d6\u955c\u50cf"},{"location":"docker/2/#224","text":"\u5220\u9664\u672c\u5730\u955c\u50cf docker rmi \u955c\u50cfid # \u5220\u9664\u6307\u5b9a\u672c\u5730\u955c\u50cf docker rmi ` docker images -q ` # \u5220\u9664\u6240\u6709\u672c\u5730\u955c\u50cf \u5173\u4e8edocker\u66f4\u591a\u547d\u4ee4\uff0c \u5927\u5bb6\u53ef\u4ee5\u83dc\u9e1f\u6559\u7a0b\u67e5\u770b, \u7f51\u5740\uff1a https://www.runoob.com/docker/docker-command-manual.html","title":"2.2.4 \u5220\u9664\u955c\u50cf"},{"location":"docker/2/#23","text":"","title":"2.3 \u5bb9\u5668\u76f8\u5173\u7684\u547d\u4ee4"},{"location":"docker/2/#231","text":"docker ps # \u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 docker ps -a # \u67e5\u770b\u6240\u6709\u5bb9\u5668\uff0c\u5305\u62ec\u6b63\u5728\u8fd0\u884c\u548c\u505c\u6b62\u7684\u5bb9\u5668","title":"2.3.1 \u67e5\u770b\u5bb9\u5668"},{"location":"docker/2/#232","text":"docker run \u53c2\u6570 \u53c2\u6570\u8bf4\u660e\uff1a \u2022 -i\uff1a\u4fdd\u6301\u5bb9\u5668\u8fd0\u884c\u3002\u901a\u5e38\u4e0e -t \u540c\u65f6\u4f7f\u7528\u3002\u52a0\u5165it\u8fd9\u4e24\u4e2a\u53c2\u6570\u540e\uff0c\u5bb9\u5668\u521b\u5efa\u540e\u81ea\u52a8\u8fdb\u5165\u5bb9\u5668\u4e2d\uff0c\u9000\u51fa\u5bb9\u5668\u540e\uff0c\u5bb9\u5668\u81ea\u52a8\u5173\u95ed\u3002 \u2022 -t\uff1a\u4e3a\u5bb9\u5668\u91cd\u65b0\u5206\u914d\u4e00\u4e2a\u4f2a\u8f93\u5165\u7ec8\u7aef\uff0c\u901a\u5e38\u4e0e -i \u540c\u65f6\u4f7f\u7528\u3002 \u2022 -d\uff1a\u4ee5\u5b88\u62a4\uff08\u540e\u53f0\uff09\u6a21\u5f0f\u8fd0\u884c\u5bb9\u5668\u3002\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u9700\u8981\u4f7f\u7528docker exec \u8fdb\u5165\u5bb9\u5668\u3002\u9000\u51fa\u540e\uff0c\u5bb9\u5668\u4e0d\u4f1a\u5173\u95ed\u3002 \u2022 -it \u521b\u5efa\u7684\u5bb9\u5668\u4e00\u822c\u79f0\u4e3a\u4ea4\u4e92\u5f0f\u5bb9\u5668\uff0c-id \u521b\u5efa\u7684\u5bb9\u5668\u4e00\u822c\u79f0\u4e3a\u5b88\u62a4\u5f0f\u5bb9\u5668 \u2022 --name\uff1a\u4e3a\u521b\u5efa\u7684\u5bb9\u5668\u547d\u540d\u3002 1\uff09\u4ea4\u4e92\u5f0f\u5bb9\u5668 \u4ee5 \u4ea4\u4e92\u5f0f \u65b9\u5f0f\u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668\uff0c\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u76f4\u63a5\u8fdb\u5165\u5f53\u524d\u5bb9\u5668\u3002\u4f7f\u7528exit\u547d\u4ee4\u9000\u51fa\u5bb9\u5668\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u4ee5\u6b64\u79cd\u65b9\u5f0f \u542f\u52a8\u5bb9\u5668\uff0c\u5982\u679c\u9000\u51fa\u5bb9\u5668\uff0c\u5219\u5bb9\u5668\u4f1a\u8fdb\u5165 \u505c\u6b62 \u72b6\u6001\u3002 # \u5148\u62c9\u53d6\u4e00\u4e2a\u955c\u50cf\uff1b\u8fd9\u4e00\u6b65\u4e0d\u662f\u6bcf\u6b21\u542f\u52a8\u5bb9\u5668\u90fd\u8981\u505a\u7684\uff0c\u800c\u662f\u56e0\u4e3a\u524d\u9762\u6211\u4eec\u5220\u9664\u4e86\u955c\u50cf\uff0c\u65e0\u955c\u50cf\u53ef\u7528\u6240\u4ee5\u624d\u518d\u62c9\u53d6\u4e00\u4e2a docker pull centos:7 #\u521b\u5efa\u5e76\u542f\u52a8\u540d\u79f0\u4e3a mycentos7 \u7684\u4ea4\u4e92\u5f0f\u5bb9\u5668\uff1b\u4e0b\u9762\u6307\u4ee4\u4e2d\u7684\u955c\u50cf\u540d\u79f0 centos:7 \u4e5f\u53ef\u4ee5\u4f7f\u7528\u955c\u50cfid docker run -it --name = mycentos7 centos:7 /bin/bash 2\uff09\u5b88\u62a4\u5f0f\u5bb9\u5668 \u521b\u5efa\u4e00\u4e2a\u5b88\u62a4\u5f0f\u5bb9\u5668\uff1b\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u9700\u8981\u957f\u671f\u8fd0\u884c\u7684\u5bb9\u5668\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5b88\u62a4\u5f0f\u5bb9\u5668\u3002\u547d\u4ee4\u5982\u4e0b\uff08\u5bb9\u5668\u540d\u79f0 \u4e0d\u80fd\u91cd\u590d\uff09\uff1a #\u521b\u5efa\u5e76\u542f\u52a8\u5b88\u62a4\u5f0f\u5bb9\u5668 docker run -di --name = mycentos2 centos:7 #\u767b\u5f55\u8fdb\u5165\u5bb9\u5668\u547d\u4ee4\u4e3a\uff1adocker exec -it container_name (\u6216\u8005 container_id) /bin/bash\uff08exit\u9000\u51fa \u65f6\uff0c\u5bb9\u5668\u4e0d\u4f1a\u505c\u6b62\uff09 docker exec -it mycentos2 /bin/bash","title":"2.3.2 \u521b\u5efa\u5e76\u542f\u52a8\u5bb9\u5668"},{"location":"docker/2/#233","text":"docker exec \u53c2\u6570 # \u9000\u51fa\u5bb9\u5668\uff0c\u5bb9\u5668\u4e0d\u4f1a\u5173\u95ed eg: docker exec -it mycentos2 /bin/bash","title":"2.3.3 \u8fdb\u5165\u5bb9\u5668"},{"location":"docker/2/#234","text":"docker stop \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id","title":"2.3.4 \u505c\u6b62\u5bb9\u5668"},{"location":"docker/2/#235","text":"docker start \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id","title":"2.3.5 \u542f\u52a8\u5bb9\u5668"},{"location":"docker/2/#236","text":"#\u5220\u9664\u6307\u5b9a\u5bb9\u5668 docker rm \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id # \u5220\u9664\u6240\u6709\u5bb9\u5668\uff1a docker rm ` docker ps -a -q ` \u6ce8\u610f\uff1a\u5982\u679c\u5bb9\u5668\u662f\u8fd0\u884c\u72b6\u6001\u5219\u5220\u9664\u5931\u8d25\uff0c\u9700\u8981\u505c\u6b62\u5bb9\u5668\u624d\u80fd\u5220\u9664","title":"2.3.6 \u5220\u9664\u5bb9\u5668"},{"location":"docker/2/#23_7","text":"docker inspect \u5bb9\u5668\u540d\u79f0\u6216\u8005\u5bb9\u5668id \u8bf4\u660e\uff1a\u5bb9\u5668\u4e4b\u95f4\u5728\u4e00\u4e2a\u5c40\u57df\u7f51\u5185\uff0clinux\u5bbf\u4e3b\u673a\u5668\u53ef\u4ee5\u4e0e\u5bb9\u5668\u8fdb\u884c\u901a\u4fe1\uff1b\u4f46\u662f\u5916\u90e8\u7684\u7269\u7406\u673a\u7b14\u8bb0\u672c\u662f\u4e0d\u80fd\u4e0e\u5bb9\u5668\u76f4\u63a5\u901a\u4fe1\u7684\uff0c\u5982\u679c\u9700\u8981\u5219\u9700\u8981\u901a\u8fc7\u5bbf\u4e3b\u673a\u5668\u7aef\u53e3\u7684\u4ee3\u7406\u3002","title":"2.3. 7 \u67e5\u770b\u5bb9\u5668\u4fe1\u606f"},{"location":"docker/3/","text":"docker\u5bb9\u5668\u7684\u6570\u636e\u5377 \u00b6 3.1 \u6570\u636e\u5377\u6982\u5ff5 \u00b6 \u601d\u8003\uff1a \u2022 Docker \u5bb9\u5668\u5220\u9664\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u4ea7\u751f\u7684\u6570\u636e\u4e5f\u4f1a\u968f\u4e4b\u9500\u6bc1 \u2022 Docker \u5bb9\u5668\u548c\u5916\u90e8\u673a\u5668\u53ef\u4ee5\u76f4\u63a5\u4ea4\u6362\u6587\u4ef6\u5417\uff1f \u2022 \u5bb9\u5668\u4e4b\u95f4\u60f3\u8981\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\uff1f \u6570\u636e\u5377 \u6570\u636e\u5377\u662f\u5bbf\u4e3b\u673a\u4e2d\u7684\u4e00\u4e2a\u76ee\u5f55\u6216\u6587\u4ef6 \u5f53\u5bb9\u5668\u76ee\u5f55\u548c\u6570\u636e\u5377\u76ee\u5f55\u7ed1\u5b9a\u540e\uff0c\u5bf9\u65b9\u7684\u4fee\u6539\u4f1a\u7acb\u5373\u540c\u6b65 \u4e00\u4e2a\u6570\u636e\u5377\u53ef\u4ee5\u88ab\u591a\u4e2a\u5bb9\u5668\u540c\u65f6\u6302\u8f7d \u4e00\u4e2a\u5bb9\u5668\u4e5f\u53ef\u4ee5\u88ab\u6302\u8f7d\u591a\u4e2a\u6570\u636e\u5377 \u6570\u636e\u5377\u7684\u4f5c\u7528 \u2022 \u5bb9\u5668\u6570\u636e\u6301\u4e45\u5316 \u2022 \u5916\u90e8\u673a\u5668\u548c\u5bb9\u5668\u95f4\u63a5\u901a\u4fe1 \u2022 \u5bb9\u5668\u4e4b\u95f4\u6570\u636e\u4ea4\u6362 3.2 \u914d\u7f6e\u6570\u636e\u5377 \u00b6 \u521b\u5efa\u542f\u52a8\u5bb9\u5668\u65f6\uff0c\u4f7f\u7528 \u2013v \u53c2\u6570 \u8bbe\u7f6e\u6570\u636e\u5377 docker run ... -v \u5bbf\u4e3b\u673a\u76ee\u5f55 ( \u6587\u4ef6 ) :\u5bb9\u5668\u5185\u76ee\u5f55 ( \u6587\u4ef6 ) ... \u6ce8\u610f\u4e8b\u9879\uff1a \u76ee\u5f55\u5fc5\u987b\u662f\u7edd\u5bf9\u8def\u5f84 \u5982\u679c\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa \u4e00\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u591a\u4e2a\u6570\u636e\u5377 \u4e00\u4e2a\u6570\u636e\u5377\u4e5f\u53ef\u4ee5\u88ab\u591a\u4e2a\u5bb9\u5668\u6302\u8f7d \u4e24\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u540c\u4e00\u4e2a\u5bb9\u5668 \u5728\u5bbf\u4e3b\u673a\u4e2d\u5b9e\u73b0\u4e0e\u5bb9\u5668\u76ee\u5f55\u7684\u6302\u8f7d\uff1a \u6570\u636e\u5377\u7684\u6301\u4e45\u5316\uff1a \u200b \u5f53\u6211\u4eec\u628ac1\u5bb9\u5668\u5220\u9664\u540e\uff0c\u5bbf\u4e3b\u673a\u4e2d\u7684\u6570\u636e\u5377\u4f9d\u7136\u5b58\u5728\u3002 \u6240\u4ee5\u5f53\u6211\u4eec\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u7684\u540c\u65f6\u4f9d\u7136\u53ef\u4ee5\u6302\u8f7d\u5bbf\u4e3b\u673a\u4e2d\u7684data\u6587\u4ef6\u5939\uff0c\u5bf9\u5e94data\u91cc\u7684\u6570\u636e\u4f9d\u7136\u540c\u6b65\u5230\u5bb9\u5668\u4e2d\u3002 \u4e00\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u591a\u4e2a\u6570\u636e\u5377 \u591a\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u540c\u4e00\u4e2a\u6570\u636e\u5377 \u5206\u522b\u521b\u5efa\u4e24\u4e2a\u5bb9\u5668\uff0c\u4e24\u4e2a\u5bb9\u5668\u90fd\u6302\u8f7d\u5bbf\u4e3b\u673a\u4e2ddata\u76ee\u5f55\uff0c\u5f53 \u4fee\u6539c3\u5bb9\u5668\u7684data\u76ee\u5f55c4\u4f1a\u5b9e\u73b0\u540c\u6b65\u3002 \u4ece\u800c\u5b9e\u73b0\u4e24\u4e2a\u5bb9\u5668\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002 3.3 \u914d\u7f6e\u6570\u636e\u5377\u5bb9\u5668 \u00b6 \u591a\u5bb9\u5668\u8fdb\u884c\u6570\u636e\u4ea4\u6362 \u591a\u4e2a\u5bb9\u5668\u6302\u8f7d\u540c\u4e00\u4e2a\u6570\u636e\u5377 \u6570\u636e\u5377\u5bb9\u5668 \u6b65\u9aa4\uff1a 1.\u521b\u5efa\u542f\u52a8c3\u6570\u636e\u5377\u5bb9\u5668\uff0c\u4f7f\u7528 \u2013v \u53c2\u6570 \u8bbe\u7f6e\u6570\u636e\u5377 docker run \u2013it --name = c3 -v /volume centos:7 /bin/bash \u521b\u5efa\u542f\u52a8 c1 c2 \u5bb9\u5668\uff0c\u4f7f\u7528 \u2013-volumes-from \u53c2\u6570 \u8bbe\u7f6e\u6570\u636e\u5377 docker run \u2013it --name = c1 --volumes-from c3 centos:7 /bin/bash docker run \u2013it --name = c2 --volumes-from c3 centos:7 /bin/bash 3.4 \u6570\u636e\u5377\u5c0f\u7ed3 \u00b6 \u6570\u636e\u5377\u6982\u5ff5 \u2022\u5bbf\u4e3b\u673a\u7684\u4e00\u4e2a\u76ee\u5f55\u6216\u6587\u4ef6 \u6570\u636e\u5377\u4f5c\u7528 \u2022 \u5bb9\u5668\u6570\u636e\u6301\u4e45\u5316 \u2022 \u5ba2\u6237\u7aef\u548c\u5bb9\u5668\u6570\u636e\u4ea4\u6362 \u2022 \u5bb9\u5668\u95f4\u6570\u636e\u4ea4\u6362 \u6570\u636e\u5377\u5bb9\u5668 \u2022 \u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\uff0c\u6302\u8f7d\u4e00\u4e2a\u76ee\u5f55\uff0c\u8ba9\u5176\u4ed6\u5bb9\u5668\u7ee7\u627f\u81ea\u8be5\u5bb9\u5668( --volume-from )\u3002 \u2022 \u901a\u8fc7\u7b80\u5355\u65b9\u5f0f\u5b9e\u73b0\u6570\u636e\u5377\u914d\u7f6e","title":"docker\u5bb9\u5668\u7684\u6570\u636e\u5377"},{"location":"docker/3/#docker","text":"","title":"docker\u5bb9\u5668\u7684\u6570\u636e\u5377"},{"location":"docker/3/#31","text":"\u601d\u8003\uff1a \u2022 Docker \u5bb9\u5668\u5220\u9664\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u4ea7\u751f\u7684\u6570\u636e\u4e5f\u4f1a\u968f\u4e4b\u9500\u6bc1 \u2022 Docker \u5bb9\u5668\u548c\u5916\u90e8\u673a\u5668\u53ef\u4ee5\u76f4\u63a5\u4ea4\u6362\u6587\u4ef6\u5417\uff1f \u2022 \u5bb9\u5668\u4e4b\u95f4\u60f3\u8981\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\uff1f \u6570\u636e\u5377 \u6570\u636e\u5377\u662f\u5bbf\u4e3b\u673a\u4e2d\u7684\u4e00\u4e2a\u76ee\u5f55\u6216\u6587\u4ef6 \u5f53\u5bb9\u5668\u76ee\u5f55\u548c\u6570\u636e\u5377\u76ee\u5f55\u7ed1\u5b9a\u540e\uff0c\u5bf9\u65b9\u7684\u4fee\u6539\u4f1a\u7acb\u5373\u540c\u6b65 \u4e00\u4e2a\u6570\u636e\u5377\u53ef\u4ee5\u88ab\u591a\u4e2a\u5bb9\u5668\u540c\u65f6\u6302\u8f7d \u4e00\u4e2a\u5bb9\u5668\u4e5f\u53ef\u4ee5\u88ab\u6302\u8f7d\u591a\u4e2a\u6570\u636e\u5377 \u6570\u636e\u5377\u7684\u4f5c\u7528 \u2022 \u5bb9\u5668\u6570\u636e\u6301\u4e45\u5316 \u2022 \u5916\u90e8\u673a\u5668\u548c\u5bb9\u5668\u95f4\u63a5\u901a\u4fe1 \u2022 \u5bb9\u5668\u4e4b\u95f4\u6570\u636e\u4ea4\u6362","title":"3.1 \u6570\u636e\u5377\u6982\u5ff5"},{"location":"docker/3/#32","text":"\u521b\u5efa\u542f\u52a8\u5bb9\u5668\u65f6\uff0c\u4f7f\u7528 \u2013v \u53c2\u6570 \u8bbe\u7f6e\u6570\u636e\u5377 docker run ... -v \u5bbf\u4e3b\u673a\u76ee\u5f55 ( \u6587\u4ef6 ) :\u5bb9\u5668\u5185\u76ee\u5f55 ( \u6587\u4ef6 ) ... \u6ce8\u610f\u4e8b\u9879\uff1a \u76ee\u5f55\u5fc5\u987b\u662f\u7edd\u5bf9\u8def\u5f84 \u5982\u679c\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa \u4e00\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u591a\u4e2a\u6570\u636e\u5377 \u4e00\u4e2a\u6570\u636e\u5377\u4e5f\u53ef\u4ee5\u88ab\u591a\u4e2a\u5bb9\u5668\u6302\u8f7d \u4e24\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u540c\u4e00\u4e2a\u5bb9\u5668 \u5728\u5bbf\u4e3b\u673a\u4e2d\u5b9e\u73b0\u4e0e\u5bb9\u5668\u76ee\u5f55\u7684\u6302\u8f7d\uff1a \u6570\u636e\u5377\u7684\u6301\u4e45\u5316\uff1a \u200b \u5f53\u6211\u4eec\u628ac1\u5bb9\u5668\u5220\u9664\u540e\uff0c\u5bbf\u4e3b\u673a\u4e2d\u7684\u6570\u636e\u5377\u4f9d\u7136\u5b58\u5728\u3002 \u6240\u4ee5\u5f53\u6211\u4eec\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u7684\u540c\u65f6\u4f9d\u7136\u53ef\u4ee5\u6302\u8f7d\u5bbf\u4e3b\u673a\u4e2d\u7684data\u6587\u4ef6\u5939\uff0c\u5bf9\u5e94data\u91cc\u7684\u6570\u636e\u4f9d\u7136\u540c\u6b65\u5230\u5bb9\u5668\u4e2d\u3002 \u4e00\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u591a\u4e2a\u6570\u636e\u5377 \u591a\u4e2a\u5bb9\u5668\u53ef\u4ee5\u6302\u8f7d\u540c\u4e00\u4e2a\u6570\u636e\u5377 \u5206\u522b\u521b\u5efa\u4e24\u4e2a\u5bb9\u5668\uff0c\u4e24\u4e2a\u5bb9\u5668\u90fd\u6302\u8f7d\u5bbf\u4e3b\u673a\u4e2ddata\u76ee\u5f55\uff0c\u5f53 \u4fee\u6539c3\u5bb9\u5668\u7684data\u76ee\u5f55c4\u4f1a\u5b9e\u73b0\u540c\u6b65\u3002 \u4ece\u800c\u5b9e\u73b0\u4e24\u4e2a\u5bb9\u5668\u4e4b\u95f4\u7684\u4ea4\u4e92\u3002","title":"3.2 \u914d\u7f6e\u6570\u636e\u5377"},{"location":"docker/3/#33","text":"\u591a\u5bb9\u5668\u8fdb\u884c\u6570\u636e\u4ea4\u6362 \u591a\u4e2a\u5bb9\u5668\u6302\u8f7d\u540c\u4e00\u4e2a\u6570\u636e\u5377 \u6570\u636e\u5377\u5bb9\u5668 \u6b65\u9aa4\uff1a 1.\u521b\u5efa\u542f\u52a8c3\u6570\u636e\u5377\u5bb9\u5668\uff0c\u4f7f\u7528 \u2013v \u53c2\u6570 \u8bbe\u7f6e\u6570\u636e\u5377 docker run \u2013it --name = c3 -v /volume centos:7 /bin/bash \u521b\u5efa\u542f\u52a8 c1 c2 \u5bb9\u5668\uff0c\u4f7f\u7528 \u2013-volumes-from \u53c2\u6570 \u8bbe\u7f6e\u6570\u636e\u5377 docker run \u2013it --name = c1 --volumes-from c3 centos:7 /bin/bash docker run \u2013it --name = c2 --volumes-from c3 centos:7 /bin/bash","title":"3.3 \u914d\u7f6e\u6570\u636e\u5377\u5bb9\u5668"},{"location":"docker/3/#34","text":"\u6570\u636e\u5377\u6982\u5ff5 \u2022\u5bbf\u4e3b\u673a\u7684\u4e00\u4e2a\u76ee\u5f55\u6216\u6587\u4ef6 \u6570\u636e\u5377\u4f5c\u7528 \u2022 \u5bb9\u5668\u6570\u636e\u6301\u4e45\u5316 \u2022 \u5ba2\u6237\u7aef\u548c\u5bb9\u5668\u6570\u636e\u4ea4\u6362 \u2022 \u5bb9\u5668\u95f4\u6570\u636e\u4ea4\u6362 \u6570\u636e\u5377\u5bb9\u5668 \u2022 \u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\uff0c\u6302\u8f7d\u4e00\u4e2a\u76ee\u5f55\uff0c\u8ba9\u5176\u4ed6\u5bb9\u5668\u7ee7\u627f\u81ea\u8be5\u5bb9\u5668( --volume-from )\u3002 \u2022 \u901a\u8fc7\u7b80\u5355\u65b9\u5f0f\u5b9e\u73b0\u6570\u636e\u5377\u914d\u7f6e","title":"3.4 \u6570\u636e\u5377\u5c0f\u7ed3"},{"location":"docker/4/","text":"\u4e00\u3001\u90e8\u7f72MySQL \u00b6 \u641c\u7d22mysql\u955c\u50cf docker search mysql \u62c9\u53d6mysql\u955c\u50cf docker pull mysql:5.6 \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04\u3001\u76ee\u5f55\u6620\u5c04 # \u5728/root\u76ee\u5f55\u4e0b\u521b\u5efamysql\u76ee\u5f55\u7528\u4e8e\u5b58\u50a8mysql\u6570\u636e\u4fe1\u606f mkdir ~/mysql cd ~/mysql docker run -id \\ -p 3306 :3306 \\ --name = c_mysql1 \\ -v $PWD /conf:/etc/mysql/conf.d \\ -v $PWD /logs:/logs \\ -v $PWD /data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD = 123456 \\ mysql:5.6 \u53c2\u6570\u8bf4\u660e\uff1a -p 3307:3306 \uff1a\u5c06\u5bb9\u5668\u7684 3306 \u7aef\u53e3\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u7684 3307 \u7aef\u53e3\u3002 -v $PWD/conf:/etc/mysql/conf.d \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 conf/my.cnf \u6302\u8f7d\u5230\u5bb9\u5668\u7684 /etc/mysql/my.cnf\u3002\u914d\u7f6e\u76ee\u5f55 -v $PWD/logs:/logs \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 logs \u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684 /logs\u3002\u65e5\u5fd7\u76ee\u5f55 -v $PWD/data:/var/lib/mysql \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684data\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684 /var/lib/mysql \u3002\u6570\u636e\u76ee\u5f55 -e MYSQL_ROOT_PASSWORD=123456\uff1a \u521d\u59cb\u5316 root \u7528\u6237\u7684\u5bc6\u7801\u3002 \u8fdb\u5165\u5bb9\u5668\uff0c\u64cd\u4f5cmysql docker exec \u2013it c_mysql /bin/bash \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8fde\u63a5\u5bb9\u5668\u4e2d\u7684mysql \u4e8c\u3001\u90e8\u7f72Tomcat \u00b6 \u641c\u7d22tomcat\u955c\u50cf docker search tomcat \u62c9\u53d6tomcat\u955c\u50cf docker pull tomcat \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04\u3001\u76ee\u5f55\u6620\u5c04 # \u5728/root\u76ee\u5f55\u4e0b\u521b\u5efatomcat\u76ee\u5f55\u7528\u4e8e\u5b58\u50a8tomcat\u6570\u636e\u4fe1\u606f mkdir ~/tomcat cd ~/tomcat docker run -id --name = c_tomcat \\ -p 8080 :8080 \\ -v $PWD :/usr/local/tomcat/webapps \\ tomcat \u53c2\u6570\u8bf4\u660e\uff1a -p 8080:8080\uff1a \u5c06\u5bb9\u5668\u76848080\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u76848080\u7aef\u53e3 -v $PWD:/usr/local/tomcat/webapps\uff1a \u5c06\u4e3b\u673a\u4e2d\u5f53\u524d\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684webapps \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8bbf\u95eetomcat \u4e09\u3001\u90e8\u7f72Nginx \u00b6 \u641c\u7d22nginx\u955c\u50cf docker search nginx \u62c9\u53d6nginx\u955c\u50cf docker pull nginx \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04\u3001\u76ee\u5f55\u6620\u5c04 # \u5728/root\u76ee\u5f55\u4e0b\u521b\u5efanginx\u76ee\u5f55\u7528\u4e8e\u5b58\u50a8nginx\u6570\u636e\u4fe1\u606f mkdir ~/nginx cd ~/nginx mkdir conf cd conf # \u5728~/nginx/conf/\u4e0b\u521b\u5efanginx.conf\u6587\u4ef6,\u7c98\u8d34\u4e0b\u9762\u5185\u5bb9 vim nginx.conf user nginx ; worker_processes 1 ; error_log /var/log/nginx/error.log warn ; pid /var/run/nginx.pid ; events { worker_connections 1024 ; } http { include /etc/nginx/mime.types ; default_type application/octet-stream ; log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' '$status $body_bytes_sent \"$http_referer\" ' '\"$http_user_agent\" \"$http_x_forwarded_for\"' ; access_log /var/log/nginx/access.log main ; sendfile on ; #tcp_nopush on; keepalive_timeout 65 ; #gzip on; include /etc/nginx/conf.d/*.conf ; } docker run -id --name = c_nginx \\ -p 80 :80 \\ -v $PWD /conf/nginx.conf:/etc/nginx/nginx.conf \\ -v $PWD /logs:/var/log/nginx \\ -v $PWD /html:/usr/share/nginx/html \\ nginx \u53c2\u6570\u8bf4\u660e\uff1a -p 80:80 \uff1a\u5c06\u5bb9\u5668\u7684 80\u7aef\u53e3\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u7684 80 \u7aef\u53e3\u3002 -v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 /conf/nginx.conf \u6302\u8f7d\u5230\u5bb9\u5668\u7684 :/etc/nginx/nginx.conf\u3002\u914d\u7f6e\u76ee\u5f55 -v $PWD/logs:/var/log/nginx \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 logs \u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684/var/log/nginx\u3002\u65e5\u5fd7\u76ee\u5f55 \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8bbf\u95eenginx \u56db\u3001\u90e8\u7f72Redis \u00b6 \u641c\u7d22redis\u955c\u50cf docker search redis \u62c9\u53d6redis\u955c\u50cf docker pull redis:5.0 \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04 docker run -id --name = c_redis -p 6379 :6379 redis:5.0 \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8fde\u63a5redis ./redis-cli.exe -h 192 .168.149.135 -p 6379","title":"docker\u90e8\u7f72\u5bb9\u5668"},{"location":"docker/4/#mysql","text":"\u641c\u7d22mysql\u955c\u50cf docker search mysql \u62c9\u53d6mysql\u955c\u50cf docker pull mysql:5.6 \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04\u3001\u76ee\u5f55\u6620\u5c04 # \u5728/root\u76ee\u5f55\u4e0b\u521b\u5efamysql\u76ee\u5f55\u7528\u4e8e\u5b58\u50a8mysql\u6570\u636e\u4fe1\u606f mkdir ~/mysql cd ~/mysql docker run -id \\ -p 3306 :3306 \\ --name = c_mysql1 \\ -v $PWD /conf:/etc/mysql/conf.d \\ -v $PWD /logs:/logs \\ -v $PWD /data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD = 123456 \\ mysql:5.6 \u53c2\u6570\u8bf4\u660e\uff1a -p 3307:3306 \uff1a\u5c06\u5bb9\u5668\u7684 3306 \u7aef\u53e3\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u7684 3307 \u7aef\u53e3\u3002 -v $PWD/conf:/etc/mysql/conf.d \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 conf/my.cnf \u6302\u8f7d\u5230\u5bb9\u5668\u7684 /etc/mysql/my.cnf\u3002\u914d\u7f6e\u76ee\u5f55 -v $PWD/logs:/logs \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 logs \u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684 /logs\u3002\u65e5\u5fd7\u76ee\u5f55 -v $PWD/data:/var/lib/mysql \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684data\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684 /var/lib/mysql \u3002\u6570\u636e\u76ee\u5f55 -e MYSQL_ROOT_PASSWORD=123456\uff1a \u521d\u59cb\u5316 root \u7528\u6237\u7684\u5bc6\u7801\u3002 \u8fdb\u5165\u5bb9\u5668\uff0c\u64cd\u4f5cmysql docker exec \u2013it c_mysql /bin/bash \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8fde\u63a5\u5bb9\u5668\u4e2d\u7684mysql","title":"\u4e00\u3001\u90e8\u7f72MySQL"},{"location":"docker/4/#tomcat","text":"\u641c\u7d22tomcat\u955c\u50cf docker search tomcat \u62c9\u53d6tomcat\u955c\u50cf docker pull tomcat \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04\u3001\u76ee\u5f55\u6620\u5c04 # \u5728/root\u76ee\u5f55\u4e0b\u521b\u5efatomcat\u76ee\u5f55\u7528\u4e8e\u5b58\u50a8tomcat\u6570\u636e\u4fe1\u606f mkdir ~/tomcat cd ~/tomcat docker run -id --name = c_tomcat \\ -p 8080 :8080 \\ -v $PWD :/usr/local/tomcat/webapps \\ tomcat \u53c2\u6570\u8bf4\u660e\uff1a -p 8080:8080\uff1a \u5c06\u5bb9\u5668\u76848080\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a\u76848080\u7aef\u53e3 -v $PWD:/usr/local/tomcat/webapps\uff1a \u5c06\u4e3b\u673a\u4e2d\u5f53\u524d\u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684webapps \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8bbf\u95eetomcat","title":"\u4e8c\u3001\u90e8\u7f72Tomcat"},{"location":"docker/4/#nginx","text":"\u641c\u7d22nginx\u955c\u50cf docker search nginx \u62c9\u53d6nginx\u955c\u50cf docker pull nginx \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04\u3001\u76ee\u5f55\u6620\u5c04 # \u5728/root\u76ee\u5f55\u4e0b\u521b\u5efanginx\u76ee\u5f55\u7528\u4e8e\u5b58\u50a8nginx\u6570\u636e\u4fe1\u606f mkdir ~/nginx cd ~/nginx mkdir conf cd conf # \u5728~/nginx/conf/\u4e0b\u521b\u5efanginx.conf\u6587\u4ef6,\u7c98\u8d34\u4e0b\u9762\u5185\u5bb9 vim nginx.conf user nginx ; worker_processes 1 ; error_log /var/log/nginx/error.log warn ; pid /var/run/nginx.pid ; events { worker_connections 1024 ; } http { include /etc/nginx/mime.types ; default_type application/octet-stream ; log_format main '$remote_addr - $remote_user [$time_local] \"$request\" ' '$status $body_bytes_sent \"$http_referer\" ' '\"$http_user_agent\" \"$http_x_forwarded_for\"' ; access_log /var/log/nginx/access.log main ; sendfile on ; #tcp_nopush on; keepalive_timeout 65 ; #gzip on; include /etc/nginx/conf.d/*.conf ; } docker run -id --name = c_nginx \\ -p 80 :80 \\ -v $PWD /conf/nginx.conf:/etc/nginx/nginx.conf \\ -v $PWD /logs:/var/log/nginx \\ -v $PWD /html:/usr/share/nginx/html \\ nginx \u53c2\u6570\u8bf4\u660e\uff1a -p 80:80 \uff1a\u5c06\u5bb9\u5668\u7684 80\u7aef\u53e3\u6620\u5c04\u5230\u5bbf\u4e3b\u673a\u7684 80 \u7aef\u53e3\u3002 -v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 /conf/nginx.conf \u6302\u8f7d\u5230\u5bb9\u5668\u7684 :/etc/nginx/nginx.conf\u3002\u914d\u7f6e\u76ee\u5f55 -v $PWD/logs:/var/log/nginx \uff1a\u5c06\u4e3b\u673a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 logs \u76ee\u5f55\u6302\u8f7d\u5230\u5bb9\u5668\u7684/var/log/nginx\u3002\u65e5\u5fd7\u76ee\u5f55 \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8bbf\u95eenginx","title":"\u4e09\u3001\u90e8\u7f72Nginx"},{"location":"docker/4/#redis","text":"\u641c\u7d22redis\u955c\u50cf docker search redis \u62c9\u53d6redis\u955c\u50cf docker pull redis:5.0 \u521b\u5efa\u5bb9\u5668\uff0c\u8bbe\u7f6e\u7aef\u53e3\u6620\u5c04 docker run -id --name = c_redis -p 6379 :6379 redis:5.0 \u4f7f\u7528\u5916\u90e8\u673a\u5668\u8fde\u63a5redis ./redis-cli.exe -h 192 .168.149.135 -p 6379","title":"\u56db\u3001\u90e8\u7f72Redis"},{"location":"docker/5/","text":"Docerfile \u00b6 \u524d\u9762\u7684\u8bfe\u7a0b\u4e2d\u5df2\u7ecf\u77e5\u9053\u4e86\uff0c\u8981\u83b7\u5f97\u955c\u50cf\uff0c\u53ef\u4ee5\u4eceDocker\u4ed3\u5e93\u4e2d\u8fdb\u884c\u4e0b\u8f7d\u3002\u90a3\u5982\u679c\u6211\u4eec\u60f3\u81ea\u5df1\u5f00\u53d1\u4e00\u4e2a\u955c\u50cf\uff0c\u90a3\u8be5\u5982 \u4f55\u505a\u5462\uff1f\u7b54\u6848\u662f\uff1aDockerfifile Dockerfifile\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u7531\u4e00\u7cfb\u5217\u547d\u4ee4\u548c\u53c2\u6570\u6784\u6210\uff0cDocker\u53ef\u4ee5\u8bfb\u53d6Dockerfifile\u6587\u4ef6\u5e76\u6839\u636eDockerfifile\u6587 \u4ef6\u7684\u63cf\u8ff0\u6765\u6784\u5efa\u955c\u50cf\u3002 \u5173\u952e\u5b57 \u4f5c\u7528 \u5907\u6ce8 FROM \u6307\u5b9a\u7236\u955c\u50cf \u6307\u5b9adockerfile\u57fa\u4e8e\u90a3\u4e2aimage\u6784\u5efa MAINTAINER \u4f5c\u8005\u4fe1\u606f \u7528\u6765\u6807\u660e\u8fd9\u4e2adockerfile\u8c01\u5199\u7684 LABEL \u6807\u7b7e \u7528\u6765\u6807\u660edockerfile\u7684\u6807\u7b7e \u53ef\u4ee5\u4f7f\u7528Label\u4ee3\u66ffMaintainer \u6700\u7ec8\u90fd\u662f\u5728docker image\u57fa\u672c\u4fe1\u606f\u4e2d\u53ef\u4ee5\u67e5\u770b RUN \u6267\u884c\u547d\u4ee4 \u6267\u884c\u4e00\u6bb5\u547d\u4ee4 \u9ed8\u8ba4\u662f/bin/sh \u683c\u5f0f: RUN command \u6216\u8005 RUN [\"command\" , \"param1\",\"param2\"] CMD \u5bb9\u5668\u542f\u52a8\u547d\u4ee4 \u63d0\u4f9b\u542f\u52a8\u5bb9\u5668\u65f6\u5019\u7684\u9ed8\u8ba4\u547d\u4ee4 \u548cENTRYPOINT\u914d\u5408\u4f7f\u7528.\u683c\u5f0f CMD command param1 param2 \u6216\u8005 CMD [\"command\" , \"param1\",\"param2\"] ENTRYPOINT \u5165\u53e3 \u4e00\u822c\u5728\u5236\u4f5c\u4e00\u4e9b\u6267\u884c\u5c31\u5173\u95ed\u7684\u5bb9\u5668\u4e2d\u4f1a\u4f7f\u7528 COPY \u590d\u5236\u6587\u4ef6 build\u7684\u65f6\u5019\u590d\u5236\u6587\u4ef6\u5230image\u4e2d ADD \u6dfb\u52a0\u6587\u4ef6 build\u7684\u65f6\u5019\u6dfb\u52a0\u6587\u4ef6\u5230image\u4e2d \u4e0d\u4ec5\u4ec5\u5c40\u9650\u4e8e\u5f53\u524dbuild\u4e0a\u4e0b\u6587 \u53ef\u4ee5\u6765\u6e90\u4e8e\u8fdc\u7a0b\u670d\u52a1 ENV \u73af\u5883\u53d8\u91cf \u6307\u5b9abuild\u65f6\u5019\u7684\u73af\u5883\u53d8\u91cf \u53ef\u4ee5\u5728\u542f\u52a8\u7684\u5bb9\u5668\u7684\u65f6\u5019 \u901a\u8fc7-e\u8986\u76d6 \u683c\u5f0fENV name=value ARG \u6784\u5efa\u53c2\u6570 \u6784\u5efa\u53c2\u6570 \u53ea\u5728\u6784\u5efa\u7684\u65f6\u5019\u4f7f\u7528\u7684\u53c2\u6570 \u5982\u679c\u6709ENV \u90a3\u4e48ENV\u7684\u76f8\u540c\u540d\u5b57\u7684\u503c\u59cb\u7ec8\u8986\u76d6arg\u7684\u53c2\u6570 VOLUME \u5b9a\u4e49\u5916\u90e8\u53ef\u4ee5\u6302\u8f7d\u7684\u6570\u636e\u5377 \u6307\u5b9abuild\u7684image\u90a3\u4e9b\u76ee\u5f55\u53ef\u4ee5\u542f\u52a8\u7684\u65f6\u5019\u6302\u8f7d\u5230\u6587\u4ef6\u7cfb\u7edf\u4e2d \u542f\u52a8\u5bb9\u5668\u7684\u65f6\u5019\u4f7f\u7528 -v \u7ed1\u5b9a \u683c\u5f0f VOLUME [\"\u76ee\u5f55\"] EXPOSE \u66b4\u9732\u7aef\u53e3 \u5b9a\u4e49\u5bb9\u5668\u8fd0\u884c\u7684\u65f6\u5019\u76d1\u542c\u7684\u7aef\u53e3 \u542f\u52a8\u5bb9\u5668\u7684\u4f7f\u7528-p\u6765\u7ed1\u5b9a\u66b4\u9732\u7aef\u53e3 \u683c\u5f0f: EXPOSE 8080 \u6216\u8005 EXPOSE 8080/udp WORKDIR \u5de5\u4f5c\u76ee\u5f55 \u6307\u5b9a\u5bb9\u5668\u5185\u90e8\u7684\u5de5\u4f5c\u76ee\u5f55 \u5982\u679c\u6ca1\u6709\u521b\u5efa\u5219\u81ea\u52a8\u521b\u5efa \u5982\u679c\u6307\u5b9a/ \u4f7f\u7528\u7684\u662f\u7edd\u5bf9\u5730\u5740 \u5982\u679c\u4e0d\u662f/\u5f00\u5934\u90a3\u4e48\u662f\u5728\u4e0a\u4e00\u6761workdir\u7684\u8def\u5f84\u7684\u76f8\u5bf9\u8def\u5f84 USER \u6307\u5b9a\u6267\u884c\u7528\u6237 \u6307\u5b9abuild\u6216\u8005\u542f\u52a8\u7684\u65f6\u5019 \u7528\u6237 \u5728RUN CMD ENTRYPONT\u6267\u884c\u7684\u65f6\u5019\u7684\u7528\u6237 HEALTHCHECK \u5065\u5eb7\u68c0\u67e5 \u6307\u5b9a\u76d1\u6d4b\u5f53\u524d\u5bb9\u5668\u7684\u5065\u5eb7\u76d1\u6d4b\u7684\u547d\u4ee4 \u57fa\u672c\u4e0a\u6ca1\u7528 \u56e0\u4e3a\u5f88\u591a\u65f6\u5019 \u5e94\u7528\u672c\u8eab\u6709\u5065\u5eb7\u76d1\u6d4b\u673a\u5236 ONBUILD \u89e6\u53d1\u5668 \u5f53\u5b58\u5728ONBUILD\u5173\u952e\u5b57\u7684\u955c\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\u7684\u65f6\u5019 \u5f53\u6267\u884cFROM\u5b8c\u6210\u4e4b\u540e \u4f1a\u6267\u884c ONBUILD\u7684\u547d\u4ee4 \u4f46\u662f\u4e0d\u5f71\u54cd\u5f53\u524d\u955c\u50cf \u7528\u5904\u4e5f\u4e0d\u600e\u4e48\u5927 STOPSIGNAL \u53d1\u9001\u4fe1\u53f7\u91cf\u5230\u5bbf\u4e3b\u673a \u8be5STOPSIGNAL\u6307\u4ee4\u8bbe\u7f6e\u5c06\u53d1\u9001\u5230\u5bb9\u5668\u7684\u7cfb\u7edf\u8c03\u7528\u4fe1\u53f7\u4ee5\u9000\u51fa\u3002 SHELL \u6307\u5b9a\u6267\u884c\u811a\u672c\u7684shell \u6307\u5b9aRUN CMD ENTRYPOINT \u6267\u884c\u547d\u4ee4\u7684\u65f6\u5019 \u4f7f\u7528\u7684shell","title":"Docerfile"},{"location":"docker/5/#docerfile","text":"\u524d\u9762\u7684\u8bfe\u7a0b\u4e2d\u5df2\u7ecf\u77e5\u9053\u4e86\uff0c\u8981\u83b7\u5f97\u955c\u50cf\uff0c\u53ef\u4ee5\u4eceDocker\u4ed3\u5e93\u4e2d\u8fdb\u884c\u4e0b\u8f7d\u3002\u90a3\u5982\u679c\u6211\u4eec\u60f3\u81ea\u5df1\u5f00\u53d1\u4e00\u4e2a\u955c\u50cf\uff0c\u90a3\u8be5\u5982 \u4f55\u505a\u5462\uff1f\u7b54\u6848\u662f\uff1aDockerfifile Dockerfifile\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u7531\u4e00\u7cfb\u5217\u547d\u4ee4\u548c\u53c2\u6570\u6784\u6210\uff0cDocker\u53ef\u4ee5\u8bfb\u53d6Dockerfifile\u6587\u4ef6\u5e76\u6839\u636eDockerfifile\u6587 \u4ef6\u7684\u63cf\u8ff0\u6765\u6784\u5efa\u955c\u50cf\u3002 \u5173\u952e\u5b57 \u4f5c\u7528 \u5907\u6ce8 FROM \u6307\u5b9a\u7236\u955c\u50cf \u6307\u5b9adockerfile\u57fa\u4e8e\u90a3\u4e2aimage\u6784\u5efa MAINTAINER \u4f5c\u8005\u4fe1\u606f \u7528\u6765\u6807\u660e\u8fd9\u4e2adockerfile\u8c01\u5199\u7684 LABEL \u6807\u7b7e \u7528\u6765\u6807\u660edockerfile\u7684\u6807\u7b7e \u53ef\u4ee5\u4f7f\u7528Label\u4ee3\u66ffMaintainer \u6700\u7ec8\u90fd\u662f\u5728docker image\u57fa\u672c\u4fe1\u606f\u4e2d\u53ef\u4ee5\u67e5\u770b RUN \u6267\u884c\u547d\u4ee4 \u6267\u884c\u4e00\u6bb5\u547d\u4ee4 \u9ed8\u8ba4\u662f/bin/sh \u683c\u5f0f: RUN command \u6216\u8005 RUN [\"command\" , \"param1\",\"param2\"] CMD \u5bb9\u5668\u542f\u52a8\u547d\u4ee4 \u63d0\u4f9b\u542f\u52a8\u5bb9\u5668\u65f6\u5019\u7684\u9ed8\u8ba4\u547d\u4ee4 \u548cENTRYPOINT\u914d\u5408\u4f7f\u7528.\u683c\u5f0f CMD command param1 param2 \u6216\u8005 CMD [\"command\" , \"param1\",\"param2\"] ENTRYPOINT \u5165\u53e3 \u4e00\u822c\u5728\u5236\u4f5c\u4e00\u4e9b\u6267\u884c\u5c31\u5173\u95ed\u7684\u5bb9\u5668\u4e2d\u4f1a\u4f7f\u7528 COPY \u590d\u5236\u6587\u4ef6 build\u7684\u65f6\u5019\u590d\u5236\u6587\u4ef6\u5230image\u4e2d ADD \u6dfb\u52a0\u6587\u4ef6 build\u7684\u65f6\u5019\u6dfb\u52a0\u6587\u4ef6\u5230image\u4e2d \u4e0d\u4ec5\u4ec5\u5c40\u9650\u4e8e\u5f53\u524dbuild\u4e0a\u4e0b\u6587 \u53ef\u4ee5\u6765\u6e90\u4e8e\u8fdc\u7a0b\u670d\u52a1 ENV \u73af\u5883\u53d8\u91cf \u6307\u5b9abuild\u65f6\u5019\u7684\u73af\u5883\u53d8\u91cf \u53ef\u4ee5\u5728\u542f\u52a8\u7684\u5bb9\u5668\u7684\u65f6\u5019 \u901a\u8fc7-e\u8986\u76d6 \u683c\u5f0fENV name=value ARG \u6784\u5efa\u53c2\u6570 \u6784\u5efa\u53c2\u6570 \u53ea\u5728\u6784\u5efa\u7684\u65f6\u5019\u4f7f\u7528\u7684\u53c2\u6570 \u5982\u679c\u6709ENV \u90a3\u4e48ENV\u7684\u76f8\u540c\u540d\u5b57\u7684\u503c\u59cb\u7ec8\u8986\u76d6arg\u7684\u53c2\u6570 VOLUME \u5b9a\u4e49\u5916\u90e8\u53ef\u4ee5\u6302\u8f7d\u7684\u6570\u636e\u5377 \u6307\u5b9abuild\u7684image\u90a3\u4e9b\u76ee\u5f55\u53ef\u4ee5\u542f\u52a8\u7684\u65f6\u5019\u6302\u8f7d\u5230\u6587\u4ef6\u7cfb\u7edf\u4e2d \u542f\u52a8\u5bb9\u5668\u7684\u65f6\u5019\u4f7f\u7528 -v \u7ed1\u5b9a \u683c\u5f0f VOLUME [\"\u76ee\u5f55\"] EXPOSE \u66b4\u9732\u7aef\u53e3 \u5b9a\u4e49\u5bb9\u5668\u8fd0\u884c\u7684\u65f6\u5019\u76d1\u542c\u7684\u7aef\u53e3 \u542f\u52a8\u5bb9\u5668\u7684\u4f7f\u7528-p\u6765\u7ed1\u5b9a\u66b4\u9732\u7aef\u53e3 \u683c\u5f0f: EXPOSE 8080 \u6216\u8005 EXPOSE 8080/udp WORKDIR \u5de5\u4f5c\u76ee\u5f55 \u6307\u5b9a\u5bb9\u5668\u5185\u90e8\u7684\u5de5\u4f5c\u76ee\u5f55 \u5982\u679c\u6ca1\u6709\u521b\u5efa\u5219\u81ea\u52a8\u521b\u5efa \u5982\u679c\u6307\u5b9a/ \u4f7f\u7528\u7684\u662f\u7edd\u5bf9\u5730\u5740 \u5982\u679c\u4e0d\u662f/\u5f00\u5934\u90a3\u4e48\u662f\u5728\u4e0a\u4e00\u6761workdir\u7684\u8def\u5f84\u7684\u76f8\u5bf9\u8def\u5f84 USER \u6307\u5b9a\u6267\u884c\u7528\u6237 \u6307\u5b9abuild\u6216\u8005\u542f\u52a8\u7684\u65f6\u5019 \u7528\u6237 \u5728RUN CMD ENTRYPONT\u6267\u884c\u7684\u65f6\u5019\u7684\u7528\u6237 HEALTHCHECK \u5065\u5eb7\u68c0\u67e5 \u6307\u5b9a\u76d1\u6d4b\u5f53\u524d\u5bb9\u5668\u7684\u5065\u5eb7\u76d1\u6d4b\u7684\u547d\u4ee4 \u57fa\u672c\u4e0a\u6ca1\u7528 \u56e0\u4e3a\u5f88\u591a\u65f6\u5019 \u5e94\u7528\u672c\u8eab\u6709\u5065\u5eb7\u76d1\u6d4b\u673a\u5236 ONBUILD \u89e6\u53d1\u5668 \u5f53\u5b58\u5728ONBUILD\u5173\u952e\u5b57\u7684\u955c\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\u7684\u65f6\u5019 \u5f53\u6267\u884cFROM\u5b8c\u6210\u4e4b\u540e \u4f1a\u6267\u884c ONBUILD\u7684\u547d\u4ee4 \u4f46\u662f\u4e0d\u5f71\u54cd\u5f53\u524d\u955c\u50cf \u7528\u5904\u4e5f\u4e0d\u600e\u4e48\u5927 STOPSIGNAL \u53d1\u9001\u4fe1\u53f7\u91cf\u5230\u5bbf\u4e3b\u673a \u8be5STOPSIGNAL\u6307\u4ee4\u8bbe\u7f6e\u5c06\u53d1\u9001\u5230\u5bb9\u5668\u7684\u7cfb\u7edf\u8c03\u7528\u4fe1\u53f7\u4ee5\u9000\u51fa\u3002 SHELL \u6307\u5b9a\u6267\u884c\u811a\u672c\u7684shell \u6307\u5b9aRUN CMD ENTRYPOINT \u6267\u884c\u547d\u4ee4\u7684\u65f6\u5019 \u4f7f\u7528\u7684shell","title":"Docerfile"},{"location":"docker/6/","text":"\u670d\u52a1\u7f16\u6392 \u00b6 6.1 \u670d\u52a1\u7f16\u6392\u6982\u5ff5 \u00b6 \u5fae\u670d\u52a1\u67b6\u6784\u7684\u5e94\u7528\u7cfb\u7edf\u4e2d\u4e00\u822c\u5305\u542b\u82e5\u5e72\u4e2a\u5fae\u670d\u52a1\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u4e00\u822c\u90fd\u4f1a\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5982\u679c\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u8981\u624b\u52a8\u542f\u505c\uff0c\u7ef4\u62a4\u7684\u5de5\u4f5c\u91cf\u4f1a\u5f88\u5927\u3002 \u8981\u4eceDockerfile build image \u6216\u8005\u53bbdockerhub\u62c9\u53d6image \u8981\u521b\u5efa\u591a\u4e2acontainer \u8981\u7ba1\u7406\u8fd9\u4e9bcontainer\uff08\u542f\u52a8\u505c\u6b62\u5220\u9664\uff09 \u670d\u52a1\u7f16\u6392\uff1a \u6309\u7167\u4e00\u5b9a\u7684\u4e1a\u52a1\u89c4\u5219\u6279\u91cf\u7ba1\u7406\u5bb9\u5668 6.2 Docker Compose \u6982\u8ff0 \u00b6 6.2.1 Docker Compose \u00b6 Docker Compose\u662f\u4e00\u4e2a\u7f16\u6392\u591a\u5bb9\u5668\u5206\u5e03\u5f0f\u90e8\u7f72\u7684\u5de5\u5177\uff0c\u63d0\u4f9b\u547d\u4ee4\u96c6\u7ba1\u7406\u5bb9\u5668\u5316\u5e94\u7528\u7684\u5b8c\u6574\u5f00\u53d1\u5468\u671f\uff0c\u5305\u62ec\u670d\u52a1\u6784\u5efa \uff0c\u542f\u52a8\u548c\u505c\u6b62\u3002\u4f7f\u7528\u6b65\u9aa4\uff1a \u5229\u7528 Dockerfile \u5b9a\u4e49\u8fd0\u884c\u73af\u5883\u955c\u50cf \u4f7f\u7528 docker-compose.yml \u5b9a\u4e49\u7ec4\u6210\u5e94\u7528\u7684\u5404\u670d\u52a1 \u8fd0\u884c docker-compose up \u542f\u52a8\u5e94\u7528 6.2.2 Docker Compose \u5b89\u88c5\u4f7f\u7528 \u00b6 Docker Compose \u00b6 \u4e00\u3001\u5b89\u88c5Docker Compose \u00b6 # Compose\u76ee\u524d\u5df2\u7ecf\u5b8c\u5168\u652f\u6301Linux\u3001Mac OS\u548cWindows\uff0c\u5728\u6211\u4eec\u5b89\u88c5Compose\u4e4b\u524d\uff0c\u9700\u8981\u5148\u5b89\u88c5Docker\u3002\u4e0b\u9762\u6211 \u4eec\u4ee5\u7f16\u8bd1\u597d\u7684\u4e8c\u8fdb\u5236\u5305\u65b9\u5f0f\u5b89\u88c5\u5728Linux\u7cfb\u7edf\u4e2d\u3002 curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose- ` uname -s ` - ` uname -m ` -o /usr/local/bin/docker-compose # \u8bbe\u7f6e\u6587\u4ef6\u53ef\u6267\u884c\u6743\u9650 chmod +x /usr/local/bin/docker-compose # \u67e5\u770b\u7248\u672c\u4fe1\u606f docker-compose -version \u4e8c\u3001\u5378\u8f7dDocker Compose \u00b6 # \u4e8c\u8fdb\u5236\u5305\u65b9\u5f0f\u5b89\u88c5\u7684\uff0c\u5220\u9664\u4e8c\u8fdb\u5236\u6587\u4ef6\u5373\u53ef rm /usr/local/bin/docker-compose \u4e09\u3001 \u4f7f\u7528docker compose\u7f16\u6392nginx+springboot\u9879\u76ee \u00b6 \u521b\u5efadocker-compose\u76ee\u5f55 mkdir ~/docker-compose cd ~/docker-compose \u7f16\u5199 docker-compose.yml \u6587\u4ef6 version: '3' services: nginx: image: nginx ports: - 80 :80 links: - app volumes: - ./nginx/conf.d:/etc/nginx/conf.d app: image: app expose: - \"8080\" \u521b\u5efa./nginx/conf.d\u76ee\u5f55 mkdir -p ./nginx/conf.d \u5728./nginx/conf.d\u76ee\u5f55\u4e0b \u7f16\u5199itheima.conf\u6587\u4ef6 server { listen 80 ; access_log off ; location / { proxy_pass http://app:8080 ; } } \u5728~/docker-compose \u76ee\u5f55\u4e0b \u4f7f\u7528docker-compose \u542f\u52a8\u5bb9\u5668 docker-compose up \u6d4b\u8bd5\u8bbf\u95ee http://192.168.149.135/hello","title":"\u670d\u52a1\u7f16\u6392"},{"location":"docker/6/#_1","text":"","title":"\u670d\u52a1\u7f16\u6392"},{"location":"docker/6/#61","text":"\u5fae\u670d\u52a1\u67b6\u6784\u7684\u5e94\u7528\u7cfb\u7edf\u4e2d\u4e00\u822c\u5305\u542b\u82e5\u5e72\u4e2a\u5fae\u670d\u52a1\uff0c\u6bcf\u4e2a\u5fae\u670d\u52a1\u4e00\u822c\u90fd\u4f1a\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5982\u679c\u6bcf\u4e2a\u5fae\u670d\u52a1\u90fd\u8981\u624b\u52a8\u542f\u505c\uff0c\u7ef4\u62a4\u7684\u5de5\u4f5c\u91cf\u4f1a\u5f88\u5927\u3002 \u8981\u4eceDockerfile build image \u6216\u8005\u53bbdockerhub\u62c9\u53d6image \u8981\u521b\u5efa\u591a\u4e2acontainer \u8981\u7ba1\u7406\u8fd9\u4e9bcontainer\uff08\u542f\u52a8\u505c\u6b62\u5220\u9664\uff09 \u670d\u52a1\u7f16\u6392\uff1a \u6309\u7167\u4e00\u5b9a\u7684\u4e1a\u52a1\u89c4\u5219\u6279\u91cf\u7ba1\u7406\u5bb9\u5668","title":"6.1 \u670d\u52a1\u7f16\u6392\u6982\u5ff5"},{"location":"docker/6/#62_docker_compose","text":"","title":"6.2 Docker Compose \u6982\u8ff0"},{"location":"docker/6/#621_docker_compose","text":"Docker Compose\u662f\u4e00\u4e2a\u7f16\u6392\u591a\u5bb9\u5668\u5206\u5e03\u5f0f\u90e8\u7f72\u7684\u5de5\u5177\uff0c\u63d0\u4f9b\u547d\u4ee4\u96c6\u7ba1\u7406\u5bb9\u5668\u5316\u5e94\u7528\u7684\u5b8c\u6574\u5f00\u53d1\u5468\u671f\uff0c\u5305\u62ec\u670d\u52a1\u6784\u5efa \uff0c\u542f\u52a8\u548c\u505c\u6b62\u3002\u4f7f\u7528\u6b65\u9aa4\uff1a \u5229\u7528 Dockerfile \u5b9a\u4e49\u8fd0\u884c\u73af\u5883\u955c\u50cf \u4f7f\u7528 docker-compose.yml \u5b9a\u4e49\u7ec4\u6210\u5e94\u7528\u7684\u5404\u670d\u52a1 \u8fd0\u884c docker-compose up \u542f\u52a8\u5e94\u7528","title":"6.2.1 Docker Compose"},{"location":"docker/6/#622_docker_compose","text":"","title":"6.2.2  Docker Compose \u5b89\u88c5\u4f7f\u7528"},{"location":"docker/6/#docker_compose","text":"","title":"Docker Compose"},{"location":"docker/6/#docker_compose_1","text":"# Compose\u76ee\u524d\u5df2\u7ecf\u5b8c\u5168\u652f\u6301Linux\u3001Mac OS\u548cWindows\uff0c\u5728\u6211\u4eec\u5b89\u88c5Compose\u4e4b\u524d\uff0c\u9700\u8981\u5148\u5b89\u88c5Docker\u3002\u4e0b\u9762\u6211 \u4eec\u4ee5\u7f16\u8bd1\u597d\u7684\u4e8c\u8fdb\u5236\u5305\u65b9\u5f0f\u5b89\u88c5\u5728Linux\u7cfb\u7edf\u4e2d\u3002 curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose- ` uname -s ` - ` uname -m ` -o /usr/local/bin/docker-compose # \u8bbe\u7f6e\u6587\u4ef6\u53ef\u6267\u884c\u6743\u9650 chmod +x /usr/local/bin/docker-compose # \u67e5\u770b\u7248\u672c\u4fe1\u606f docker-compose -version","title":"\u4e00\u3001\u5b89\u88c5Docker Compose"},{"location":"docker/6/#docker_compose_2","text":"# \u4e8c\u8fdb\u5236\u5305\u65b9\u5f0f\u5b89\u88c5\u7684\uff0c\u5220\u9664\u4e8c\u8fdb\u5236\u6587\u4ef6\u5373\u53ef rm /usr/local/bin/docker-compose","title":"\u4e8c\u3001\u5378\u8f7dDocker Compose"},{"location":"docker/6/#docker_composenginxspringboot","text":"\u521b\u5efadocker-compose\u76ee\u5f55 mkdir ~/docker-compose cd ~/docker-compose \u7f16\u5199 docker-compose.yml \u6587\u4ef6 version: '3' services: nginx: image: nginx ports: - 80 :80 links: - app volumes: - ./nginx/conf.d:/etc/nginx/conf.d app: image: app expose: - \"8080\" \u521b\u5efa./nginx/conf.d\u76ee\u5f55 mkdir -p ./nginx/conf.d \u5728./nginx/conf.d\u76ee\u5f55\u4e0b \u7f16\u5199itheima.conf\u6587\u4ef6 server { listen 80 ; access_log off ; location / { proxy_pass http://app:8080 ; } } \u5728~/docker-compose \u76ee\u5f55\u4e0b \u4f7f\u7528docker-compose \u542f\u52a8\u5bb9\u5668 docker-compose up \u6d4b\u8bd5\u8bbf\u95ee http://192.168.149.135/hello","title":"\u4e09\u3001 \u4f7f\u7528docker compose\u7f16\u6392nginx+springboot\u9879\u76ee"},{"location":"docker/7/","text":"\u4e00\u3001\u79c1\u6709\u4ed3\u5e93\u642d\u5efa \u00b6 # 1\u3001\u62c9\u53d6\u79c1\u6709\u4ed3\u5e93\u955c\u50cf docker pull registry # 2\u3001\u542f\u52a8\u79c1\u6709\u4ed3\u5e93\u5bb9\u5668 docker run -id --name = registry -p 5000 :5000 registry # 3\u3001\u6253\u5f00\u6d4f\u89c8\u5668 \u8f93\u5165\u5730\u5740http://\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip:5000/v2/_catalog\uff0c\u770b\u5230{\"repositories\":[]} \u8868\u793a\u79c1\u6709\u4ed3\u5e93 \u642d\u5efa\u6210\u529f # 4\u3001\u4fee\u6539daemon.json vim /etc/docker/daemon.json # \u5728\u4e0a\u8ff0\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e00\u4e2akey\uff0c\u4fdd\u5b58\u9000\u51fa\u3002\u6b64\u6b65\u7528\u4e8e\u8ba9 docker \u4fe1\u4efb\u79c1\u6709\u4ed3\u5e93\u5730\u5740\uff1b\u6ce8\u610f\u5c06\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip\u4fee\u6539\u4e3a\u81ea\u5df1\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668\u771f\u5b9eip { \"insecure-registries\" : [ \"\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip:5000\" ]} # 5\u3001\u91cd\u542fdocker \u670d\u52a1 systemctl restart docker docker start registry \u4e8c\u3001\u5c06\u955c\u50cf\u4e0a\u4f20\u81f3\u79c1\u6709\u4ed3\u5e93 \u00b6 # 1\u3001\u6807\u8bb0\u955c\u50cf\u4e3a\u79c1\u6709\u4ed3\u5e93\u7684\u955c\u50cf docker tag centos:7 \u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668IP:5000/centos:7 # 2\u3001\u4e0a\u4f20\u6807\u8bb0\u7684\u955c\u50cf docker push \u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668IP:5000/centos:7 \u4e09\u3001 \u4ece\u79c1\u6709\u4ed3\u5e93\u62c9\u53d6\u955c\u50cf \u00b6 #\u62c9\u53d6\u955c\u50cf docker pull \u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip:5000/centos:7","title":"\u79c1\u6709\u4ed3\u5e93"},{"location":"docker/7/#_1","text":"# 1\u3001\u62c9\u53d6\u79c1\u6709\u4ed3\u5e93\u955c\u50cf docker pull registry # 2\u3001\u542f\u52a8\u79c1\u6709\u4ed3\u5e93\u5bb9\u5668 docker run -id --name = registry -p 5000 :5000 registry # 3\u3001\u6253\u5f00\u6d4f\u89c8\u5668 \u8f93\u5165\u5730\u5740http://\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip:5000/v2/_catalog\uff0c\u770b\u5230{\"repositories\":[]} \u8868\u793a\u79c1\u6709\u4ed3\u5e93 \u642d\u5efa\u6210\u529f # 4\u3001\u4fee\u6539daemon.json vim /etc/docker/daemon.json # \u5728\u4e0a\u8ff0\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e00\u4e2akey\uff0c\u4fdd\u5b58\u9000\u51fa\u3002\u6b64\u6b65\u7528\u4e8e\u8ba9 docker \u4fe1\u4efb\u79c1\u6709\u4ed3\u5e93\u5730\u5740\uff1b\u6ce8\u610f\u5c06\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip\u4fee\u6539\u4e3a\u81ea\u5df1\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668\u771f\u5b9eip { \"insecure-registries\" : [ \"\u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip:5000\" ]} # 5\u3001\u91cd\u542fdocker \u670d\u52a1 systemctl restart docker docker start registry","title":"\u4e00\u3001\u79c1\u6709\u4ed3\u5e93\u642d\u5efa"},{"location":"docker/7/#_2","text":"# 1\u3001\u6807\u8bb0\u955c\u50cf\u4e3a\u79c1\u6709\u4ed3\u5e93\u7684\u955c\u50cf docker tag centos:7 \u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668IP:5000/centos:7 # 2\u3001\u4e0a\u4f20\u6807\u8bb0\u7684\u955c\u50cf docker push \u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668IP:5000/centos:7","title":"\u4e8c\u3001\u5c06\u955c\u50cf\u4e0a\u4f20\u81f3\u79c1\u6709\u4ed3\u5e93"},{"location":"docker/7/#_3","text":"#\u62c9\u53d6\u955c\u50cf docker pull \u79c1\u6709\u4ed3\u5e93\u670d\u52a1\u5668ip:5000/centos:7","title":"\u4e09\u3001 \u4ece\u79c1\u6709\u4ed3\u5e93\u62c9\u53d6\u955c\u50cf"},{"location":"redis/day01/","text":"1. Redis \u7b80\u4ecb \u00b6 Redis \u7684\u4e0b\u8f7d\u4e0e\u5b89\u88c5 \u00b6 \u672c\u8bfe\u7a0b\u6240\u793a\uff0c\u5747\u57fa\u4e8eCenter OS7\u5b89\u88c5Redis\u3002 0 ) \u5982\u679c wget \u547d\u4ee4\u627e\u4e0d\u5230 yum - y install wget 0 ) \u5982\u679cmake \u62a5\u9519 \u5b89\u88c5 c \u8bed\u8a00\u7f16\u8bd1\u73af\u5883 yum install gcc - c ++ (1)\u4e0b\u8f7dRedis \u4e0b\u8f7d\u5b89\u88c5\u5305\uff1a wget http://download.redis.io/releases/redis-5.0.0.tar.gz \u89e3\u538b\u5b89\u88c5\u5305\uff1a tar -xvf redis-5.0.0.tar.gz \u7f16\u8bd1\uff08\u5728\u89e3\u538b\u7684\u76ee\u5f55\u4e2d\u6267\u884c\uff09\uff1a make \u5b89\u88c5\uff08\u5728\u89e3\u538b\u7684\u76ee\u5f55\u4e2d\u6267\u884c\uff09\uff1a make install \uff082\uff09\u5b89\u88c5 Redis redis-server\uff0c\u670d\u52a1\u5668\u542f\u52a8\u547d\u4ee4 \u5ba2\u6237\u7aef\u542f\u52a8\u547d\u4ee4 redis-cli\uff0credis\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6 redis.conf\uff0cRDB\u6587\u4ef6\u68c0\u67e5\u5de5\u5177\uff08\u5feb\u7167\u6301\u4e45\u5316\u6587\u4ef6\uff09 redis-check-dump\uff0cAOF\u6587\u4ef6\u4fee\u590d\u5de5\u5177 redis-check-aof Redis\u670d\u52a1\u5668\u542f\u52a8 \u00b6 Redis\u670d\u52a1\u5668\u542f\u52a8 \u00b6 \u542f\u52a8\u670d\u52a1\u5668\u2014\u2014\u53c2\u6570\u542f\u52a8 redis-server [ --port port ] \u8303\u4f8b redis-server --port 6379 \u542f\u52a8\u670d\u52a1\u5668\u2014\u2014\u914d\u7f6e\u6587\u4ef6\u542f\u52a8 redis-server config_file_name \u8303\u4f8b redis-server redis.conf Redis\u5ba2\u6237\u7aef\u542f\u52a8 \u00b6 \u542f\u52a8\u5ba2\u6237\u7aef redis-cli [ -h host ] [ -p port ] \u8303 \u4f8b redis-cli -h 61 .129.65.248 -p 6384 \u6ce8\u610f\uff1a\u670d\u52a1\u5668\u542f\u52a8\u6307\u5b9a\u7aef\u53e3\u4f7f\u7528\u7684\u662f--port\uff0c\u5ba2\u6237\u7aef\u542f\u52a8\u6307\u5b9a\u7aef\u53e3\u4f7f\u7528\u7684\u662f-p\u3002-\u7684\u6570\u91cf\u4e0d\u540c\u3002 Redis\u57fa\u7840\u73af\u5883\u8bbe\u7f6e\u7ea6\u5b9a \u00b6 \u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u5b58\u50a8\u76ee\u5f55 mkdir conf \u521b\u5efa\u670d\u52a1\u5668\u6587\u4ef6\u5b58\u50a8\u76ee\u5f55\uff08\u5305\u542b\u65e5\u5fd7\u3001\u6570\u636e\u3001\u4e34\u65f6\u914d\u7f6e\u6587\u4ef6\u7b49\uff09 mkdir data \u521b\u5efa\u5feb\u901f\u8bbf\u95ee\u94fe\u63a5 ln -s redis-5.0.0 redis \u914d\u7f6e\u6587\u4ef6\u542f\u52a8\u4e0e\u5e38\u7528\u914d\u7f6e \u00b6 # \u67e5\u770b\u914d\u7f6e\u547d\u4ee4 cat redis.conf | grep -v '#' | grep -v '^$' # \u90a3\u4e9bip \u80fd\u8bbf\u95eeredis #bind 127.0.0.1 # \u7aef\u53e3\u53f7 port 6379 # \u8d85\u65f6\u65f6\u95f4 #timeout 0 # \u662f\u5426\u540e\u53f0\u542f\u52a8 daemonize yes # \u65e5\u5fd7\u6587\u4ef6 logfile \"log_6379.log\" # \u6570\u636e\u6587\u4ef6\u4f4d\u7f6e dir /usr/local/redis/data \u670d\u52a1\u5668\u7aef\u8bbe\u5b9a \u00b6 \u8bbe\u7f6e\u670d\u52a1\u5668\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c\uff0c\u5f00\u542f\u540e\u670d\u52a1\u5668\u63a7\u5236\u53f0\u4e2d\u5c06\u6253\u5370\u670d\u52a1\u5668\u8fd0\u884c\u4fe1\u606f\uff08\u540c\u65e5\u5fd7\u5185\u5bb9\u76f8\u540c\uff09 daemonize yes | no \u7ed1\u5b9a\u4e3b\u673a\u5730\u5740 bind ip \u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u53e3 port port \u8bbe\u7f6e\u670d\u52a1\u5668\u6587\u4ef6\u4fdd\u5b58\u5730\u5740 dir path \u5ba2\u6237\u7aef\u914d\u7f6e \u00b6 \u670d\u52a1\u5668\u5141\u8bb8\u5ba2\u6237\u7aef\u8fde\u63a5\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba40\uff0c\u8868\u793a\u65e0\u9650\u5236\u3002\u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u8fbe\u4e0a\u9650\u540e\uff0cRedis\u4f1a\u62d2\u7edd\u65b0\u7684\u8fde\u63a5 maxclients count \u5ba2\u6237\u7aef\u95f2\u7f6e\u7b49\u5f85\u6700\u5927\u65f6\u957f\uff0c\u8fbe\u5230\u6700\u5927\u503c\u540e\u5173\u95ed\u5bf9\u5e94\u8fde\u63a5\u3002\u5982\u9700\u5173\u95ed\u8be5\u529f\u80fd\uff0c\u8bbe\u7f6e\u4e3a 0 timeout seconds \u65e5\u5fd7\u914d\u7f6e \u00b6 \u8bbe\u7f6e\u670d\u52a1\u5668\u4ee5\u6307\u5b9a\u65e5\u5fd7\u8bb0\u5f55\u7ea7\u522b loglevel debug | verbose | notice | warning \u65e5\u5fd7\u8bb0\u5f55\u6587\u4ef6\u540d logfile filename \u6ce8\u610f\uff1a\u65e5\u5fd7\u7ea7\u522b\u5f00\u53d1\u671f\u8bbe\u7f6e\u4e3averbose\u5373\u53ef\uff0c\u751f\u4ea7\u73af\u5883\u4e2d\u914d\u7f6e\u4e3anotice\uff0c\u7b80\u5316\u65e5\u5fd7\u8f93\u51fa\u91cf\uff0c\u964d\u4f4e\u5199\u65e5\u5fd7IO\u7684\u9891\u5ea6\u3002 Redis\u57fa\u672c\u64cd\u4f5c \u00b6 \u547d\u4ee4\u884c\u6a21\u5f0f\u5de5\u5177\u4f7f\u7528\u601d\u8003 \u00b6 \u529f\u80fd\u6027\u547d\u4ee4 \u5e2e\u52a9\u4fe1\u606f\u67e5\u9605 \u9000\u51fa\u6307\u4ee4 \u6e05\u9664\u5c4f\u5e55\u4fe1\u606f \u4fe1\u606f\u8bfb\u5199 \u00b6 \u8bbe\u7f6e key\uff0cvalue \u6570\u636e set key value \u8303\u4f8b set name itheima \u6839\u636e key \u67e5\u8be2\u5bf9\u5e94\u7684 value\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u8fd4\u56de\u7a7a\uff08nil\uff09 get key \u8303\u4f8b get name \u5e2e\u52a9\u4fe1\u606f \u00b6 \u83b7\u53d6\u547d\u4ee4\u5e2e\u52a9\u6587\u6863 help [ command ] \u8303\u4f8b help set \u83b7\u53d6\u7ec4\u4e2d\u6240\u6709\u547d\u4ee4\u4fe1\u606f\u540d\u79f0 help [ @group-name ] \u8303\u4f8b help @string \u9000\u51fa\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\u6a21\u5f0f \u9000\u51fa\u5ba2\u6237\u7aef quit exit \u5feb\u6377\u952e Ctrl+C 1.6.4 redis\u5165\u95e8\u603b\u7ed3 \u00b6 \u5230\u8fd9\u91cc\uff0cRedis \u5165\u95e8\u7684\u76f8\u5173\u77e5\u8bc6\uff0c\u6211\u4eec\u5c31\u5168\u90e8\u5b66\u4e60\u5b8c\u4e86\uff0c\u518d\u6765\u56de\u987e\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u90e8\u5206\u6211\u4eec\u4e3b\u8981\u8bb2\u89e3\u4e86\u54ea\u4e9b\u5185\u5bb9\u5462\uff1f \u9996\u5148\uff0c\u6211\u4eec\u5bf9Redis\u8fdb\u884c\u4e86\u4e00\u4e2a\u7b80\u5355\u4ecb\u7ecd\uff0c\u5305\u62ecNoSQL\u7684\u6982\u5ff5\u3001Redis\u7684\u6982\u5ff5\u7b49\u3002 \u7136\u540e\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86Redis \u7684\u4e0b\u8f7d\u4e0e\u5b89\u88c5\u3002\u5305\u62ec\u4e0b\u8f7d\u4e0e\u5b89\u88c5\u3001\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u542f\u52a8\u3001\u4ee5\u53ca\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff083\u7c7b\uff09\u3002 \u6700\u540e\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86Redis \u7684\u57fa\u672c\u64cd\u4f5c\u3002\u5305\u62ec\u6570\u636e\u8bfb\u5199\u3001\u9000\u51fa\u4e0e\u5e2e\u52a9\u4fe1\u606f\u83b7\u53d6\u3002 2. \u6570\u636e\u7c7b\u578b \u00b6 2.1 Redis \u6570\u636e\u7c7b\u578b(5\u79cd\u5e38\u7528) \u00b6 \u57fa\u4e8e\u4ee5\u4e0a\u6570\u636e\u7279\u5f81\u6211\u4eec\u8fdb\u884c\u5206\u6790\uff0c\u6700\u7ec8\u5f97\u51fa\u6765\u6211\u4eec\u7684Redis\u4e2d\u8981\u8bbe\u8ba15\u79cd \u6570\u636e\u7c7b\u578b\uff1a string\u3001hash\u3001list\u3001set\u3001sorted_set/zset\uff08\u5e94\u7528\u6027\u8f83\u4f4e\uff09 2.2 string\u6570\u636e\u7c7b\u578b \u00b6 \u5728\u5b66\u4e60\u7b2c\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u4e4b\u524d\uff0c\u5148\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e00\u4e0b\uff0c\u5728\u968f\u540e\u8fd9\u90e8\u5206\u5185\u5bb9\u7684\u5b66\u4e60\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u6bcf\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u90fd\u5206\u6210\u4e09\u5757\u6765\u8bb2\uff1a\u9996\u5148\u662f\u8bb2\u4e0b\u5b83\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u63a5\u4e0b\u6765\u8bb2\u4e00\u4e9b\u5b83\u7684\u6269\u5c55\u64cd\u4f5c\uff0c\u6700\u540e\u6211\u4eec\u4f1a\u53bb\u505a\u4e00\u4e2a\u5c0f\u7684\u6848\u4f8b\u5206\u6790\u3002 2.2.1Redis \u6570\u636e\u5b58\u50a8\u683c\u5f0f \u00b6 \u5728\u5b66\u4e60string\u8fd9\u4e2a\u6570\u636e\u5f62\u5f0f\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8981\u660e\u767dstring\u5230\u5e95\u662f\u4fee\u9970\u4ec0\u4e48\u7684\u3002\u6211\u4eec\u77e5\u9053redis \u81ea\u8eab\u662f\u4e00\u4e2a Map\uff0c\u5176\u4e2d\u6240\u6709\u7684\u6570\u636e\u90fd\u662f\u91c7\u7528 key : value \u7684\u5f62\u5f0f\u5b58\u50a8\u3002 \u5bf9\u4e8e\u8fd9\u79cd\u7ed3\u6784\u6765\u8bf4\uff0c\u6211\u4eec\u7528\u6765\u5b58\u50a8\u6570\u636e\u4e00\u5b9a\u662f\u4e00\u4e2a\u503c\u524d\u9762\u5bf9\u5e94\u4e00\u4e2a\u540d\u79f0\u3002\u6211\u4eec\u901a\u8fc7\u540d\u79f0\u6765\u8bbf\u95ee\u540e\u9762\u7684\u503c\u3002\u6309\u7167\u8fd9\u79cd\u5f62\u52bf\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u51fa\u6765\u6211\u4eec\u7684\u5b58\u50a8\u683c\u5f0f\u3002\u524d\u9762\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u79f0\u4e3akey\u3002\u540e\u9762\u7684\u4e00\u90e8\u5206\u79f0\u4e3avalue\uff0c\u800c\u6211\u4eec\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4ed6\u4e00\u5b9a\u662f\u4fee\u9970value\u7684\u3002 \u6570\u636e\u7c7b\u578b\u6307\u7684\u662f\u5b58\u50a8\u7684\u6570\u636e\u7684\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f value \u90e8\u5206\u7684\u7c7b\u578b\uff0ckey \u90e8\u5206\u6c38\u8fdc\u90fd\u662f\u5b57\u7b26\u4e32\u3002 2.2.2 string \u7c7b\u578b \u00b6 \uff081\uff09\u5b58\u50a8\u7684\u6570\u636e\uff1a\u5355\u4e2a\u6570\u636e\uff0c\u6700\u7b80\u5355\u7684\u6570\u636e\u5b58\u50a8\u7c7b\u578b\uff0c\u4e5f\u662f\u6700\u5e38\u7528\u7684\u6570\u636e\u5b58\u50a8\u7c7b\u578b\u3002 string\uff0c\u4ed6\u5c31\u662f\u5b58\u4e00\u4e2a\u5b57\u7b26\u4e32\u513f\uff0c\u6ce8\u610f\u662fvalue\u90a3\u4e00\u90e8\u5206\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5b83\u662fredis\u4e2d\u6700\u57fa\u672c\u3001\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6570\u636e\u7684\u683c\u5f0f\u3002 \uff082\uff09\u5b58\u50a8\u6570\u636e\u7684\u683c\u5f0f\uff1a\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u4e00\u4e2a\u6570\u636e \u6bcf\u4e00\u4e2a\u7a7a\u95f4\u4e2d\u53ea\u80fd\u4fdd\u5b58\u4e00\u4e2a\u5b57\u7b26\u4e32\u4fe1\u606f\uff0c\u8fd9\u4e2a\u4fe1\u606f\u91cc\u8fb9\u5982\u679c\u662f\u5b58\u7684\u7eaf\u6570\u5b57\uff0c\u4ed6\u4e5f\u80fd\u5f53\u6570\u5b57\u4f7f\u7528\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u8fd9\u662f\u6211\u4eec\u7684\u6570\u636e\u7684\u5b58\u50a8\u7a7a\u95f4\u3002 \uff083\uff09\u5b58\u50a8\u5185\u5bb9\uff1a\u901a\u5e38\u4f7f\u7528\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u4ee5\u6574\u6570\u7684\u5f62\u5f0f\u5c55\u793a\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u6570\u5b57\u64cd\u4f5c\u4f7f\u7528. \u4e00\u4e2akey\u5bf9\u4e00\u4e2avalue\uff0c\u800c\u8fd9\u4e2aitheima\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684string\u7c7b\u578b\uff0c\u5f53\u7136\u5b83\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7eaf\u6570\u5b57\u7684\u683c\u5f0f\u3002 2.2.3 string \u7c7b\u578b\u6570\u636e\u7684\u57fa\u672c\u64cd\u4f5c \u00b6 \uff081\uff09\u57fa\u7840\u6307\u4ee4 \u6dfb\u52a0/\u4fee\u6539\u6570\u636e\u6dfb\u52a0/\u4fee\u6539\u6570\u636e set key value \u83b7\u53d6\u6570\u636e get key \u5220\u9664\u6570\u636e del key \u5224\u5b9a\u6027\u6dfb\u52a0\u6570\u636e setnx key value \u6dfb\u52a0/\u4fee\u6539\u591a\u4e2a\u6570\u636e mset key1 value1 key2 value2 \u2026 \u83b7\u53d6\u591a\u4e2a\u6570\u636e mget key1 key2 \u2026 \u83b7\u53d6\u6570\u636e\u5b57\u7b26\u4e2a\u6570\uff08\u5b57\u7b26\u4e32\u957f\u5ea6\uff09 strlen key \u8ffd\u52a0\u4fe1\u606f\u5230\u539f\u59cb\u4fe1\u606f\u540e\u90e8\uff08\u5982\u679c\u539f\u59cb\u4fe1\u606f\u5b58\u5728\u5c31\u8ffd\u52a0\uff0c\u5426\u5219\u65b0\u5efa\uff09 append key value \uff082\uff09\u5355\u6570\u636e\u64cd\u4f5c\u4e0e\u591a\u6570\u636e\u64cd\u4f5c\u7684\u9009\u62e9\u4e4b\u60d1 \u5373set \u4e0emset\u7684\u5173\u7cfb\u3002\u8fd9\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u6765\u8bf4\uff0c\u6ca1\u6709\u4ec0\u4e48\u4f60\u5e94\u8be5\u9009\u54ea\u4e2a\uff0c\u800c\u662f\u4ed6\u4eec\u81ea\u5df1\u7684\u7279\u5f81\u662f\u4ec0\u4e48\uff0c\u4f60\u8981\u6839\u636e\u8fd9\u4e2a\u7279\u5f81\u53bb\u6bd4\u5bf9\u4f60\u7684\u4e1a\u52a1\uff0c\u770b\u770b\u7a76\u7adf\u9002\u7528\u4e8e\u54ea\u4e2a\u3002 \u5047\u5982\u8bf4\u8fd9\u662f\u6211\u4eec\u73b0\u5728\u7684\u670d\u52a1\u5668\uff0c\u4ed6\u8981\u5411redis\u8981\u6570\u636e\u7684\u8bdd\uff0c\u5b83\u4f1a\u53d1\u51fa\u4e00\u6761\u6307\u4ee4\u3002\u90a3\u4e48\u5f53\u8fd9\u6761\u6307\u4ee4\u53d1\u8fc7\u6765\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u8bf4\u662f\u8fd9\u4e2aset\u6307\u4ee4\u8fc7\u6765\uff0c\u90a3\u4e48\u5b83\u4f1a\u628a\u8fd9\u4e2a\u7ed3\u679c\u8fd4\u56de\u7ed9\u4f60\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u8981\u601d\u8003\u8fd9\u91cc\u8fb9\u4e00\u5171\u7ecf\u8fc7\u4e86\u591a\u957f\u65f6\u95f4\u3002 \u9996\u5148\uff0c\u53d1\u9001set\u6307\u4ee4\u8981\u65f6\u95f4\uff0c\u8fd9\u662f\u7f51\u7edc\u7684\u4e00\u4e2a\u65f6\u95f4\uff0c\u63a5\u4e0b\u6765redis\u8981\u53bb\u8fd0\u884c\u8fd9\u4e2a\u6307\u4ee4\u8981\u6d88\u8017\u65f6\u95f4\uff0c\u6700\u7ec8\u628a\u8fd9\u4e2a\u7ed3\u679c\u8fd4\u56de\u7ed9\u4f60\u53c8\u6709\u4e00\u4e2a\u65f6\u95f4\uff0c\u8fd9\u4e2a\u65f6\u95f4\u53c8\u662f\u4e00\u4e2a\u7f51\u7edc\u7684\u65f6\u95f4\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u4e00\u4e2a\u6307\u4ee4\u53d1\u9001\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981\u6d88\u8017\u8fd9\u6837\u7684\u65f6\u95f4. \u4f46\u662f\u5982\u679c\u8bf4\u73b0\u5728\u4e0d\u662f\u4e00\u6761\u6307\u4ee4\u4e86\uff0c\u4f60\u8981\u53d13\u4e2aset\u7684\u8bdd\uff0c\u8fd8\u8981\u591a\u957f\u65f6\u95f4\u5462\uff1f\u5bf9\u5e94\u7684\u53d1\u9001\u65f6\u95f4\u8981\u4e583\u4e86\uff0c\u56e0\u4e3a\u8fd9\u662f\u4e09\u4e2a\u5355\u6761\u6307\u4ee4,\u800c\u8fd0\u884c\u7684\u64cd\u4f5c\u65f6\u95f4\u5462\uff0c\u5b83\u4e5f\u8981\u4e583\u4e86\uff0c\u4f46\u6700\u7ec8\u8fd4\u56de\u7684\u4e5f\u8981\u53d13\u6b21\uff0c\u6240\u4ee5\u8fd9\u8fb9\u4e5f\u8981\u4e583\u3002 \u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5355\u6307\u4ee4\u53d13\u6761\u5b83\u9700\u8981\u7684\u65f6\u95f4\uff0c\u5047\u5b9a\u4ed6\u4eec\u4e24\u4e2a\u4e00\u6837\uff0c\u662f6\u4e2a\u7f51\u7edc\u65f6\u95f4\u52a03\u4e2a\u5904\u7406\u65f6\u95f4\uff0c\u5982\u679c\u6211\u4eec\u628a\u5b83\u5408\u6210\u4e00\u4e2amset\u5462\uff0c\u6211\u4eec\u60f3\u4e00\u60f3\u3002 \u5047\u5982\u8bf4\u7528\u591a\u6307\u4ee4\u53d13\u4e2a\u6307\u4ee4\u7684\u8bdd\uff0c\u5176\u5b9e\u53ea\u9700\u8981\u53d1\u4e00\u6b21\u5c31\u884c\u4e86\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff0c\u591a\u6307\u4ee4\u53d13\u4e2a\u6307\u4ee4\u7684\u8bdd\uff0c\u5176\u5b9e\u5b83\u662f\u4e24\u4e2a\u7f51\u7edc\u65f6\u95f4\u52a0\u4e0a3\u4e2aredis\u7684\u64cd\u4f5c\u65f6\u95f4\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u5199\u4e00\u4e2a\u5c0f\u52a0\u53f7\u5462\uff0c\u5c31\u662f\u56e0\u4e3a\u6bd5\u7adf\u53d1\u7684\u4fe1\u606f\u91cf\u53d8\u5927\u4e86\uff0c\u6240\u4ee5\u7f51\u7edc\u65f6\u95f4\u6709\u53ef\u80fd\u4f1a\u53d8\u957f\u3002 \u90a3\u4e48\u901a\u8fc7\u8fd9\u5f20\u56fe\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u5355\u6307\u4ee4\u548c\u591a\u6307\u4ee4\u4ed6\u4eec\u7684\u5dee\u522b\u5c31\u5728\u4e8e\u4f60\u53d1\u9001\u7684\u6b21\u6570\u662f\u591a\u8fd8\u662f\u5c11\u3002\u5f53\u4f60\u5f71\u54cd\u7684\u6570\u636e\u6bd4\u8f83\u5c11\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u4ee5\u7528\u5355\u6307\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u7528\u591a\u6307\u4ee4\u3002\u4f46\u662f\u4e00\u65e6\u8fd9\u4e2a\u91cf\u5927\u4e86\uff0c\u4f60\u5c31\u8981\u9009\u62e9\u591a\u6307\u4ee4\u4e86\uff0c\u4ed6\u7684\u6548\u7387\u4f1a\u9ad8\u4e00\u4e9b\u3002 2.3 string \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c \u00b6 2.3.1 string \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c \u00b6 \u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00string\u7684\u6269\u5c55\u64cd\u4f5c\uff0c\u5206\u6210\u4e24\u5927\u5757\uff1a\u4e00\u5757\u662f\u5bf9\u6570\u5b57\u8fdb\u884c\u64cd\u4f5c\u7684\uff0c\u7b2c\u4e8c\u5757\u662f\u5bf9\u6211\u4eec\u7684key\u7684\u65f6\u95f4\u8fdb\u884c\u64cd\u4f5c\u7684\u3002 \u8bbe\u7f6e\u6570\u503c\u6570\u636e\u589e\u52a0\u6307\u5b9a\u8303\u56f4\u7684\u503c incr key incrby key increment incrbyfloat key increment \u8bbe\u7f6e\u6570\u503c\u6570\u636e\u51cf\u5c11\u6307\u5b9a\u8303\u56f4\u7684\u503c decr key decrby key increment \u8bbe\u7f6e\u6570\u636e\u5177\u6709\u6307\u5b9a\u7684\u751f\u547d\u5468\u671f setex key seconds value psetex key milliseconds value 2.3.2 string \u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u7684\u6ce8\u610f\u4e8b\u9879 \u00b6 (1)\u6570\u636e\u64cd\u4f5c\u4e0d\u6210\u529f\u7684\u53cd\u9988\u4e0e\u6570\u636e\u6b63\u5e38\u64cd\u4f5c\u4e4b\u95f4\u7684\u5dee\u5f02 \u8868\u793a\u8fd0\u884c\u7ed3\u679c\u662f\u5426\u6210\u529f (integer) 0 \u2192 false \u5931\u8d25 (integer) 1 \u2192 true \u6210\u529f \u8868\u793a\u8fd0\u884c\u7ed3\u679c\u503c (integer) 3 \u2192 3 3\u4e2a (integer) 1 \u2192 1 1\u4e2a (2)\u6570\u636e\u672a\u83b7\u53d6\u5230\u65f6\uff0c\u5bf9\u5e94\u7684\u6570\u636e\u4e3a\uff08nil\uff09\uff0c\u7b49\u540c\u4e8enull (3)\u6570\u636e\u6700\u5927\u5b58\u50a8\u91cf\uff1a512MB (4)string\u5728redis\u5185\u90e8\u5b58\u50a8\u9ed8\u8ba4\u5c31\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5f53\u9047\u5230\u589e\u51cf\u7c7b\u64cd\u4f5cincr\uff0cdecr\u65f6\u4f1a\u8f6c\u6210\u6570\u503c\u578b\u8fdb\u884c\u8ba1\u7b97 (5)\u6309\u6570\u503c\u8fdb\u884c\u64cd\u4f5c\u7684\u6570\u636e\uff0c\u5982\u679c\u539f\u59cb\u6570\u636e\u4e0d\u80fd\u8f6c\u6210\u6570\u503c\uff0c\u6216\u8d85\u8d8a\u4e86redis \u6570\u503c\u4e0a\u9650\u8303\u56f4\uff0c\u5c06\u62a5\u9519 9223372036854775807\uff08java\u4e2dLong\u578b\u6570\u636e\u6700\u5927\u503c\uff0cLong.MAX_VALUE\uff09 (6)redis\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u91c7\u7528\u5355\u7ebf\u7a0b\u5904\u7406\u6240\u6709\u4e1a\u52a1\uff0c\u547d\u4ee4\u662f\u4e00\u4e2a\u4e00\u4e2a\u6267\u884c\u7684\uff0c\u56e0\u6b64\u65e0\u9700\u8003\u8651\u5e76\u53d1\u5e26\u6765\u7684\u6570\u636e\u5f71\u54cd. 2.4string\u5e94\u7528\u573a\u666f\u4e0ekey\u547d\u540d\u7ea6\u5b9a \u00b6 2.4.1 \u5e94\u7528\u573a\u666f \u00b6 \u5b83\u7684\u5e94\u7528\u573a\u666f\u5728\u4e8e\uff1a\u4e3b\u9875\u9ad8\u9891\u8bbf\u95ee\u4fe1\u606f\u663e\u793a\u63a7\u5236\uff0c\u4f8b\u5982\u65b0\u6d6a\u5fae\u535a\u5927V\u4e3b\u9875\u663e\u793a\u7c89\u4e1d\u6570\u4e0e\u5fae\u535a\u6570\u91cf\u3002 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e0b\uff1a\u8fd9\u4e9b\u4fe1\u606f\u662f\u4e0d\u662f\u4f60\u8fdb\u5165\u5927V\u7684\u9875\u9762\u513f\u4ee5\u540e\u5c31\u8981\u8bfb\u53d6\u8fd9\u5199\u4fe1\u606f\u7684\u554a\uff0c\u90a3\u8fd9\u79cd\u4fe1\u606f\u4e00\u5b9a\u8981\u5b58\u50a8\u5230\u6211\u4eec\u7684redis\u4e2d\uff0c\u56e0\u4e3a\u4ed6\u7684\u8bbf\u95ee\u91cf\u592a\u9ad8\u4e86\uff01\u90a3\u8fd9\u79cd\u6570\u636e\u5e94\u8be5\u600e\u4e48\u5b58\u5462\uff1f\u6211\u4eec\u6765\u4e00\u5757\u513f\u770b\u4e00\u4e0b\u65b9\u6848\uff01 2.4.2 \u89e3\u51b3\u65b9\u6848 \u00b6 \uff081\uff09\u5728redis\u4e2d\u4e3a\u5927V\u7528\u6237\u8bbe\u5b9a\u7528\u6237\u4fe1\u606f\uff0c\u4ee5\u7528\u6237\u4e3b\u952e\u548c\u5c5e\u6027\u503c\u4f5c\u4e3akey\uff0c\u540e\u53f0\u8bbe\u5b9a\u5b9a\u65f6\u5237\u65b0\u7b56\u7565\u5373\u53ef\u3002 eg: user:id:3506728370:fans \u2192 12210947 eg: user:id:3506728370:blogs \u2192 6164 eg: user:id:3506728370:focuses \u2192 83 \uff082\uff09\u4e5f\u53ef\u4ee5\u4f7f\u7528json\u683c\u5f0f\u4fdd\u5b58\u6570\u636e eg: user:id:3506728370 \u2192 {\u201cfans\u201d\uff1a12210947\uff0c\u201cblogs\u201d\uff1a6164\uff0c\u201c focuses \u201d\uff1a83 } \uff083\uff09 key \u7684\u8bbe\u7f6e\u7ea6\u5b9a \u6570\u636e\u5e93\u4e2d\u7684\u70ed\u70b9\u6570\u636ekey\u547d\u540d\u60ef\u4f8b \u8868\u540d \u4e3b\u952e\u540d \u4e3b\u952e\u503c \u5b57\u6bb5\u540d eg1\uff1a order id 29437595 name eg2\uff1a equip id 390472345 type eg3\uff1a news id 202004150 title 2.5 hash\u7684\u57fa\u672c\u64cd\u4f5c \u00b6 \u4e0b\u9762\u6211\u4eec\u6765\u5b66\u4e60\u7b2c\u4e8c\u4e2a\u6570\u636e\u7c7b\u578bhash\u3002 2.5.1 \u6570\u636e\u5b58\u50a8\u7684\u56f0\u60d1 \u00b6 \u5bf9\u8c61\u7c7b\u6570\u636e\u7684\u5b58\u50a8\u5982\u679c\u5177\u6709\u8f83\u9891\u7e41\u7684\u66f4\u65b0\u9700\u6c42\u64cd\u4f5c\u4f1a\u663e\u5f97\u7b28\u91cd\uff01 \u5728\u6b63\u5f0f\u5b66\u4e60\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e2a\u5173\u4e8e\u6570\u636e\u5b58\u50a8\u7684\u56f0\u60d1\uff1a \u6bd4\u5982\u8bf4\u524d\u9762\u6211\u4eec\u7528\u4ee5\u4e0a\u5f62\u5f0f\u5b58\u4e86\u6570\u636e\uff0c\u5982\u679c\u6211\u4eec\u7528\u5355\u6761\u53bb\u5b58\u7684\u8bdd\uff0c\u5b83\u5b58\u7684\u6761\u6570\u4f1a\u5f88\u591a\u3002\u4f46\u5982\u679c\u6211\u4eec\u7528json\u683c\u5f0f\uff0c\u5b83\u5b58\u4e00\u6761\u6570\u636e\u5c31\u591f\u4e86\u3002\u95ee\u9898\u6765\u4e86\uff0c\u5047\u5982\u8bf4\u73b0\u5728\u7c89\u4e1d\u6570\u91cf\u53d1\u751f\u53d8\u5316\u4e86\uff0c\u4f60\u8981\u628a\u6574\u4e2a\u503c\u90fd\u6539\u4e86\u3002\u4f46\u662f\u7528\u5355\u6761\u5b58\u7684\u8bdd\u5c31\u4e0d\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f60\u53ea\u9700\u8981\u6539\u5176\u4e2d\u4e00\u4e2a\u5c31\u884c\u4e86\u3002\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u60f3\uff0c\u6709\u6ca1\u6709\u4e00\u79cd\u65b0\u7684\u5b58\u50a8\u7ed3\u6784\uff0c\u80fd\u5e2e\u6211\u4eec\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\u3002 \u6211\u4eec\u4e00\u5757\u513f\u6765\u5206\u6790\u4e00\u4e0b\uff1a \u5982\u4e0a\u56fe\u6240\u793a\uff1a\u5355\u6761\u7684\u8bdd\u662f\u5bf9\u5e94\u7684\u6570\u636e\u5728\u540e\u9762\u653e\u7740\u3002\u4ed4\u7ec6\u89c2\u5bdf\uff1a\u6211\u4eec\u770b\u5de6\u8fb9\u662f\u4e0d\u662f\u957f\u5f97\u90fd\u4e00\u6a21\u4e00\u6837\u554a\uff0c\u90fd\u662f\u5bf9\u5e94\u7684\u8868\u540d\u3001ID\u7b49\u7684\u4e00\u7cfb\u5217\u7684\u4e1c\u897f\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u53f3\u8fb9\u7ea2\u6846\u4e2d\u7684\u8fd9\u4e2a\u533a\u57df\u7ed9\u4ed6\u5c01\u8d77\u6765\u3002 \u90a3\u5982\u679c\u8981\u662f\u8fd9\u6837\u7684\u5f62\u5f0f\u7684\u8bdd\uff0c\u5982\u4e0b\u56fe\uff0c\u6211\u4eec\u628a\u5b83\u4e00\u5408\u5e76\uff0c\u5e76\u628a\u53f3\u8fb9\u7684\u4e1c\u897f\u7ed9\u4ed6\u53d8\u6210\u8fd9\u4e2a\u683c\u5f0f\uff0c\u8fd9\u4e0d\u5c31\u884c\u4e86\u5417\uff1f \u8fd9\u4e2a\u56fe\u5176\u5b9e\u5927\u5bb6\u5e76\u4e0d\u964c\u751f\uff0c\u7b2c\u4e00\uff0c\u4f60\u524d\u9762\u5b66\u8fc7\u4e00\u4e2a\u4e1c\u897f\u53ebhashmap\u4e0d\u5c31\u8fd9\u683c\u5f0f\u5417\uff1f\u7b2c\u4e8c\uff0credis\u81ea\u8eab\u4e0d\u4e5f\u662f\u8fd9\u683c\u5f0f\u5417\uff1f\u90a3\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6ce8\u610f\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u8981\u8bb2\u7684\u7b2c\u4e8c\u79cd\u683c\u5f0f\uff0chash\u3002 \u5728\u53f3\u8fb9\u5bf9\u5e94\u7684\u503c\uff0c\u6211\u4eec\u5c31\u5b58\u5177\u4f53\u7684\u503c\uff0c\u90a3\u5de6\u8fb9\u513f\u8fd9\u5c31\u662f\u6211\u4eec\u7684key\u3002\u95ee\u9898\u6765\u4e86\uff0c\u90a3\u4e2d\u95f4\u7684\u8fd9\u4e00\u5757\u53eb\u4ec0\u4e48\u5462\uff1f\u8fd9\u4e2a\u4e1c\u897f\u6211\u4eec\u7ed9\u4ed6\u8d77\u4e2a\u540d\u513f\uff0c\u53eb\u505afield\u5b57\u6bb5\u3002\u90a3\u4e48\u53f3\u8fb9\u513f\u6574\u4f53\u8fd9\u5757\u513f\u7a7a\u95f4\u6211\u4eec\u5c31\u79f0\u4e3ahash\uff0c\u4e5f\u5c31\u662f\u8bf4hash\u662f\u5b58\u4e86\u4e00\u4e2akey value\u7684\u5b58\u50a8\u7a7a\u95f4\u3002 2.5.2 hash \u7c7b\u578b \u00b6 \u65b0\u7684\u5b58\u50a8\u9700\u6c42\uff1a\u5bf9\u4e00\u7cfb\u5217\u5b58\u50a8\u7684\u6570\u636e\u8fdb\u884c\u7f16\u7ec4\uff0c\u65b9\u4fbf\u7ba1\u7406\uff0c\u5178\u578b\u5e94\u7528\u5b58\u50a8\u5bf9\u8c61\u4fe1\u606f \u9700\u8981\u7684\u5b58\u50a8\u7ed3\u6784\uff1a\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u591a\u4e2a\u952e\u503c\u5bf9\u6570\u636e hash\u7c7b\u578b\uff1a\u5e95\u5c42\u4f7f\u7528\u54c8\u5e0c\u8868\u7ed3\u6784\u5b9e\u73b0\u6570\u636e\u5b58\u50a8 \u5982\u4e0a\u56fe\u6240\u793a\uff0c\u8fd9\u79cd\u7ed3\u6784\u53eb\u505ahash\uff0c\u5de6\u8fb9\u4e00\u4e2akey\uff0c\u5bf9\u53f3\u8fb9\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u3002\u8fd9\u91cc\u8981\u660e\u786e\u4e00\u70b9\uff0c\u53f3\u8fb9\u8fd9\u5757\u513f\u5b58\u50a8\u7a7a\u95f4\u53ebhash\uff0c\u4e5f\u5c31\u662f\u8bf4hash\u662f\u6307\u7684\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\uff0c\u4ed6\u6307\u7684\u4e0d\u662f\u4e00\u4e2a\u6570\u636e\uff0c\u662f\u8fd9\u91cc\u8fb9\u7684\u4e00\u5806\u6570\u636e\uff0c\u90a3\u4e48\u5b83\u5e95\u5c42\u5462\uff0c\u662f\u7528hash\u8868\u7684\u7ed3\u6784\u6765\u5b9e\u73b0\u7684\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a \u5982\u679cfield\u6570\u91cf\u8f83\u5c11\uff0c\u5b58\u50a8\u7ed3\u6784\u4f18\u5316\u4e3a\u7c7b\u6570\u7ec4\u7ed3\u6784 \u5982\u679cfield\u6570\u91cf\u8f83\u591a\uff0c\u5b58\u50a8\u7ed3\u6784\u4f7f\u7528HashMap\u7ed3\u6784 2.5.3 hash \u7c7b\u578b\u6570\u636e\u7684\u57fa\u672c\u64cd\u4f5c \u00b6 \u6dfb\u52a0/\u4fee\u6539\u6570\u636e hset key field value \u83b7\u53d6\u6570\u636e hget key field hgetall key \u5220\u9664\u6570\u636e hdel key field1 [ field2 ] \u8bbe\u7f6efield\u7684\u503c\uff0c\u5982\u679c\u8be5field\u5b58\u5728\u5219\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c hsetnx key field value \u6dfb\u52a0/\u4fee\u6539\u591a\u4e2a\u6570\u636e hmset key field1 value1 field2 value2 \u2026 \u83b7\u53d6\u591a\u4e2a\u6570\u636e hmget key field1 field2 \u2026 \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u5b57\u6bb5\u7684\u6570\u91cf hlen key \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7684\u5b57\u6bb5 hexists key field 2.6 hash\u7684\u62d3\u5c55\u64cd\u4f5c \u00b6 \u5728\u770b\u5b8chash\u7684\u57fa\u672c\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u518d\u6765\u770b\u4ed6\u7684\u62d3\u5c55\u64cd\u4f5c\uff0c\u4ed6\u7684\u62d3\u5c55\u64cd\u4f5c\u76f8\u5bf9\u6bd4\u8f83\u7b80\u5355\uff1a 2.6.1 hash \u7c7b\u578b\u6570\u636e\u6269\u5c55\u64cd\u4f5c \u00b6 \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u6240\u6709\u7684\u5b57\u6bb5\u540d\u6216\u5b57\u6bb5\u503c hkeys key hvals key \u8bbe\u7f6e\u6307\u5b9a\u5b57\u6bb5\u7684\u6570\u503c\u6570\u636e\u589e\u52a0\u6307\u5b9a\u8303\u56f4\u7684\u503c hincrby key field increment hincrbyfloat key field increment 2.6.2 hash\u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u7684\u6ce8\u610f\u4e8b\u9879 \u00b6 (1)hash\u7c7b\u578b\u4e2dvalue\u53ea\u80fd\u5b58\u50a8\u5b57\u7b26\u4e32\uff0c\u4e0d\u5141\u8bb8\u5b58\u50a8\u5176\u4ed6\u6570\u636e\u7c7b\u578b\uff0c\u4e0d\u5b58\u5728\u5d4c\u5957\u73b0\u8c61\u3002\u5982\u679c\u6570\u636e\u672a\u83b7\u53d6\u5230\uff0c\u5bf9\u5e94\u7684\u503c\u4e3a\uff08nil\uff09\u3002 (2\uff09\u6bcf\u4e2a hash \u53ef\u4ee5\u5b58\u50a8 2^32 - 1 \u4e2a\u952e\u503c\u5bf9 hash\u7c7b\u578b\u5341\u5206\u8d34\u8fd1\u5bf9\u8c61\u7684\u6570\u636e\u5b58\u50a8\u5f62\u5f0f\uff0c\u5e76\u4e14\u53ef\u4ee5\u7075\u6d3b\u6dfb\u52a0\u5220\u9664\u5bf9\u8c61\u5c5e\u6027\u3002\u4f46hash\u8bbe\u8ba1\u521d\u8877\u4e0d\u662f\u4e3a\u4e86\u5b58\u50a8\u5927\u91cf\u5bf9\u8c61\u800c\u8bbe\u8ba1 \u7684\uff0c\u5207\u8bb0\u4e0d\u53ef\u6ee5\u7528\uff0c\u66f4\u4e0d\u53ef\u4ee5\u5c06hash\u4f5c\u4e3a\u5bf9\u8c61\u5217\u8868\u4f7f\u7528\u3002 (3)hgetall \u64cd\u4f5c\u53ef\u4ee5\u83b7\u53d6\u5168\u90e8\u5c5e\u6027\uff0c\u5982\u679c\u5185\u90e8field\u8fc7\u591a\uff0c\u904d\u5386\u6574\u4f53\u6570\u636e\u6548\u7387\u5c31\u5f88\u4f1a\u4f4e\uff0c\u6709\u53ef\u80fd\u6210\u4e3a\u6570\u636e\u8bbf\u95ee\u74f6\u9888\u3002 2.7 hash\u5e94\u7528\u573a\u666f \u00b6 2.7.1 \u5e94\u7528\u573a\u666f \u00b6 \u53cc11\u6d3b\u52a8\u65e5\uff0c\u9500\u552e\u624b\u673a\u5145\u503c\u5361\u7684\u5546\u5bb6\u5bf9\u79fb\u52a8\u3001\u8054\u901a\u3001\u7535\u4fe1\u768430\u5143\u300150\u5143\u3001100\u5143\u5546\u54c1\u63a8\u51fa\u62a2\u8d2d\u6d3b\u52a8\uff0c\u6bcf\u79cd\u5546\u54c1\u62a2\u8d2d\u4e0a\u96501000 \u5f20\u3002 \u4e5f\u5c31\u662f\u5546\u5bb6\u6709\u4e86\uff0c\u5546\u54c1\u6709\u4e86\uff0c\u6570\u91cf\u6709\u4e86\u3002\u6700\u7ec8\u6211\u4eec\u7684\u7528\u6237\u4e70\u4e1c\u897f\u5c31\u662f\u5728\u6539\u53d8\u8fd9\u4e2a\u6570\u91cf\u3002\u90a3\u4f60\u8bf4\u8fd9\u4e2a\u7ed3\u6784\u5e94\u8be5\u600e\u4e48\u5b58\u5462\uff1f\u5bf9\u5e94\u7684\u5546\u5bb6\u7684ID\u4f5c\u4e3akey\uff0c\u7136\u540e\u8fd9\u4e9b\u5145\u503c\u5361\u7684ID\u4f5c\u4e3afield\uff0c\u6700\u540e\u8fd9\u4e9b\u6570\u91cf\u4f5c\u4e3avalue\u3002\u800c\u6211\u4eec\u6240\u8c13\u7684\u64cd\u4f5c\u662f\u5176\u5b9e\u5c31\u662fincrea\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u53ea\u4e0d\u8fc7\u4f60\u4f20\u8d1f\u503c\u5c31\u884c\u4e86\u3002\u770b\u4e00\u770b\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6848\uff1a 2.7.2 \u89e3\u51b3\u65b9\u6848 \u00b6 \u4ee5\u5546\u5bb6id\u4f5c\u4e3akey \u5c06\u53c2\u4e0e\u62a2\u8d2d\u7684\u5546\u54c1id\u4f5c\u4e3afield \u5c06\u53c2\u4e0e\u62a2\u8d2d\u7684\u5546\u54c1\u6570\u91cf\u4f5c\u4e3a\u5bf9\u5e94\u7684value \u62a2\u8d2d\u65f6\u4f7f\u7528\u964d\u503c\u7684\u65b9\u5f0f\u63a7\u5236\u4ea7\u54c1\u6570\u91cf \u6ce8\u610f\uff1a\u5b9e\u9645\u4e1a\u52a1\u4e2d\u8fd8\u6709\u8d85\u5356\u7b49\u5b9e\u9645\u95ee\u9898\uff0c\u8fd9\u91cc\u4e0d\u505a\u8ba8\u8bba 2.8 list\u57fa\u672c\u64cd\u4f5c \u00b6 \u524d\u9762\u6211\u4eec\u5b58\u6570\u636e\u7684\u65f6\u5019\u5462\uff0c\u5355\u4e2a\u6570\u636e\u4e5f\u80fd\u5b58\uff0c\u591a\u4e2a\u6570\u636e\u4e5f\u80fd\u5b58\uff0c\u4f46\u662f\u8fd9\u91cc\u9762\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5b58\u591a\u4e2a\u6570\u636e\u7528hash\u7684\u65f6\u5019\u5b83\u662f\u6ca1\u6709\u987a\u5e8f\u7684\u3002\u6211\u4eec\u5e73\u65f6\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\u6570\u636e\u5f88\u591a\u60c5\u51b5\u4e0b\u90fd\u662f\u6709\u987a\u5e8f\u7684\uff0c\u90a3\u6709\u6ca1\u6709\u4e00\u79cd\u80fd\u591f\u7528\u6765\u5b58\u50a8\u5e26\u6709\u987a\u5e8f\u7684\u8fd9\u79cd\u6570\u636e\u6a21\u578b\u5462\uff0clist\u5c31\u4e13\u95e8\u6765\u5e72\u8fd9\u4e8b\u513f\u3002 2.8.1 list \u7c7b\u578b \u00b6 \u6570\u636e\u5b58\u50a8\u9700\u6c42\uff1a\u5b58\u50a8\u591a\u4e2a\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u5165\u5b58\u50a8\u7a7a\u95f4\u7684\u987a\u5e8f\u8fdb\u884c\u533a\u5206 \u9700\u8981\u7684\u5b58\u50a8\u7ed3\u6784\uff1a\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u591a\u4e2a\u6570\u636e\uff0c\u4e14\u901a\u8fc7\u6570\u636e\u53ef\u4ee5\u4f53\u73b0\u8fdb\u5165\u987a\u5e8f list\u7c7b\u578b\uff1a\u4fdd\u5b58\u591a\u4e2a\u6570\u636e\uff0c\u5e95\u5c42\u4f7f\u7528\u53cc\u5411\u94fe\u8868\u5b58\u50a8\u7ed3\u6784\u5b9e\u73b0 \u5148\u6765\u901a\u8fc7\u4e00\u5f20\u56fe\uff0c\u56de\u5fc6\u4e00\u4e0b\u987a\u5e8f\u8868\u3001\u94fe\u8868\u3001\u53cc\u5411\u94fe\u8868\u3002 list\u5bf9\u5e94\u7684\u5b58\u50a8\u7ed3\u6784\u662f\u4ec0\u4e48\u5462\uff1f\u91cc\u8fb9\u5b58\u7684\u8fd9\u4e2a\u4e1c\u897f\u662f\u4e2a\u5217\u8868\uff0c\u4ed6\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u540d\u79f0\u3002\u5c31\u662fkey\u5b58\u4e00\u4e2alist\u7684\u8fd9\u6837\u7ed3\u6784\u3002\u5bf9\u5e94\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u4f60\u5176\u5b9e\u662f\u53ef\u4ee5\u60f3\u5230\u7684\u3002 \u6765\u770b\u4e00\u4e0b\uff0c\u56e0\u4e3a\u5b83\u662f\u53cc\u5411\u7684\uff0c\u6240\u4ee5\u4ed6\u5de6\u8fb9\u53f3\u8fb9\u90fd\u80fd\u64cd\u4f5c\uff0c\u5b83\u5bf9\u5e94\u7684\u64cd\u4f5c\u7ed3\u6784\u4e24\u8fb9\u90fd\u80fd\u8fdb\u6570\u636e\u3002\u8fd9\u5c31\u662f\u94fe\u8868\u7684\u4e00\u4e2a\u5b58\u50a8\u7ed3\u6784\u3002\u5f80\u5916\u62ff\u6570\u636e\u7684\u65f6\u5019\u600e\u4e48\u62ff\u5462\uff1f\u901a\u5e38\u662f\u4ece\u4e00\u7aef\u62ff\uff0c\u5f53\u7136\u53e6\u4e00\u7aef\u4e5f\u80fd\u62ff\u3002\u5982\u679c\u4e24\u7aef\u90fd\u80fd\u62ff\u7684\u8bdd\uff0c\u8fd9\u5c31\u662f\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u4e24\u8fb9\u513f\u90fd\u80fd\u64cd\u4f5c\u3002\u5982\u679c\u53ea\u80fd\u4ece\u4e00\u7aef\u8fdb\u4e00\u7aef\u51fa\uff0c\u8fd9\u4e2a\u6a21\u578b\u54b1\u4eec\u524d\u9762\u4e86\u89e3\u8fc7\uff0c\u53eb\u505a\u6808\u3002 2.8.2 list \u7c7b\u578b\u6570\u636e\u57fa\u672c\u64cd\u4f5c \u00b6 \u6700\u540e\u770b\u4e00\u4e0b\u4ed6\u7684\u57fa\u672c\u64cd\u4f5c \u6dfb\u52a0/\u4fee\u6539\u6570\u636e lpush key value1 [ value2 ] \u2026\u2026 rpush key value1 [ value2 ] \u2026\u2026 \u83b7\u53d6\u6570\u636e lrange key start stop lindex key index llen key \u83b7\u53d6\u5e76\u79fb\u9664\u6570\u636e lpop key rpop key 2.9 list\u6269\u5c55\u64cd\u4f5c \u00b6 2.9.1 list \u7c7b\u578b\u6570\u636e\u6269\u5c55\u64cd\u4f5c \u00b6 \u79fb\u9664\u6307\u5b9a\u6570\u636e lrem key count value \u89c4\u5b9a\u65f6\u95f4\u5185\u83b7\u53d6\u5e76\u79fb\u9664\u6570\u636e blpop key1 [ key2 ] timeout brpop key1 [ key2 ] timeout brpoplpush source destination timeout 2.9.2 list \u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u6ce8\u610f\u4e8b\u9879 \u00b6 \uff081\uff09list\u4e2d\u4fdd\u5b58\u7684\u6570\u636e\u90fd\u662fstring\u7c7b\u578b\u7684\uff0c\u6570\u636e\u603b\u5bb9\u91cf\u662f\u6709\u9650\u7684\uff0c\u6700\u591a2^32 - 1 \u4e2a\u5143\u7d20(4294967295)\u3002 \uff082\uff09list\u5177\u6709\u7d22\u5f15\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u64cd\u4f5c\u6570\u636e\u65f6\u901a\u5e38\u4ee5\u961f\u5217\u7684\u5f62\u5f0f\u8fdb\u884c\u5165\u961f\u51fa\u961f\u64cd\u4f5c\uff0c\u6216\u4ee5\u6808\u7684\u5f62\u5f0f\u8fdb\u884c\u5165\u6808\u51fa\u6808\u64cd\u4f5c \uff083\uff09\u83b7\u53d6\u5168\u90e8\u6570\u636e\u64cd\u4f5c\u7ed3\u675f\u7d22\u5f15\u8bbe\u7f6e\u4e3a-1 \uff084\uff09list\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u9875\u64cd\u4f5c\uff0c\u901a\u5e38\u7b2c\u4e00\u9875\u7684\u4fe1\u606f\u6765\u81ea\u4e8elist\uff0c\u7b2c2\u9875\u53ca\u66f4\u591a\u7684\u4fe1\u606f\u901a\u8fc7\u6570\u636e\u5e93\u7684\u5f62\u5f0f\u52a0\u8f7d 2.10 list \u5e94\u7528\u573a\u666f \u00b6 2.10.1 \u5e94\u7528\u573a\u666f \u00b6 \u4f01\u4e1a\u8fd0\u8425\u8fc7\u7a0b\u4e2d\uff0c\u7cfb\u7edf\u5c06\u4ea7\u751f\u51fa\u5927\u91cf\u7684\u8fd0\u8425\u6570\u636e\uff0c\u5982\u4f55\u4fdd\u969c\u591a\u53f0\u670d\u52a1\u5668\u64cd\u4f5c\u65e5\u5fd7\u7684\u7edf\u4e00\u987a\u5e8f\u8f93\u51fa\uff1f \u5047\u5982\u73b0\u5728\u4f60\u6709\u591a\u53f0\u670d\u52a1\u5668\uff0c\u6bcf\u4e00\u53f0\u670d\u52a1\u5668\u90fd\u4f1a\u4ea7\u751f\u5b83\u7684\u65e5\u5fd7\uff0c\u5047\u8bbe\u4f60\u662f\u4e00\u4e2a\u8fd0\u7ef4\u4eba\u5458\uff0c\u4f60\u60f3\u770b\u5b83\u7684\u64cd\u4f5c\u65e5\u5fd7\uff0c\u4f60\u600e\u4e48\u770b\u5462\uff1f\u6253\u5f00A\u673a\u5668\u7684\u65e5\u5fd7\u770b\u4e00\u770b\uff0c\u6253\u5f00B\u673a\u5668\u7684\u65e5\u5fd7\u518d\u770b\u4e00\u770b\u5417\uff1f\u8fd9\u6837\u7684\u8bdd\u4f60\u4f1a\u53ef\u80fd\u4f1a\u75af\u6389\u7684\uff01\u56e0\u4e3a\u5de6\u8fb9\u770b\u7684\u6709\u53ef\u80fd\u5b83\u7684\u65f6\u95f4\u662f11:01\uff0c\u53f3\u8fb911:02\uff0c\u7136\u540e\u518d\u770b\u5de6\u8fb911:03\uff0c\u5b83\u4eec\u672c\u8eab\u662f\u8fde\u7eed\u7684\uff0c\u4f46\u662f\u4f60\u5728\u770b\u7684\u65f6\u5019\u5c31\u5206\u6210\u56db\u4e2a\u6587\u4ef6\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f60\u770b\u8d77\u6765\u5c31\u4f1a\u5f88\u9ebb\u70e6\u3002\u80fd\u4e0d\u80fd\u628a\u4ed6\u4eec\u5408\u5e76\u5462\uff1f\u7b54\u6848\u662f\u53ef\u4ee5\u7684\uff01\u600e\u4e48\u505a\u5462\uff1f\u5efa\u7acb\u8d77redis\u670d\u52a1\u5668\u3002\u5f53\u4ed6\u4eec\u9700\u8981\u8bb0\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u8bb0\u5728\u54ea\u513f,\u5168\u90e8\u53d1\u7ed9redis\u3002\u7b49\u5230\u4f60\u60f3\u770b\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u670d\u52a1\u5668\u8bbf\u95eeredis\u83b7\u53d6\u65e5\u5fd7\u3002\u7136\u540e\u5f97\u5230\u4ee5\u540e\uff0c\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u5b8c\u6574\u7684\u65e5\u5fd7\u4fe1\u606f\u3002\u90a3\u4e48\u8fd9\u91cc\u9762\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u65e5\u5fd7\u4e86\uff0c\u4f9d\u9760\u4ec0\u4e48\u6765\u5b9e\u73b0\u5462\uff1f\u5c31\u4f9d\u9760\u6211\u4eec\u7684list\u7684\u6a21\u578b\u7684\u987a\u5e8f\u6765\u5b9e\u73b0\u3002\u8fdb\u6765\u4e00\u7ec4\u6570\u636e\u5c31\u5f80\u91cc\u52a0\uff0c\u8c01\u5148\u8fdb\u6765\u8c01\u5148\u52a0\u8fdb\u53bb\uff0c\u5b83\u662f\u6709\u4e00\u5b9a\u7684\u987a\u5e8f\u7684\u3002 2.10.2 \u89e3\u51b3\u65b9\u6848 \u00b6 \u4f9d\u8d56list\u7684\u6570\u636e\u5177\u6709\u987a\u5e8f\u7684\u7279\u5f81\u5bf9\u4fe1\u606f\u8fdb\u884c\u7ba1\u7406 \u4f7f\u7528\u961f\u5217\u6a21\u578b\u89e3\u51b3\u591a\u8def\u4fe1\u606f\u6c47\u603b\u5408\u5e76\u7684\u95ee\u9898 \u4f7f\u7528\u6808\u6a21\u578b\u89e3\u51b3\u6700\u65b0\u6d88\u606f\u7684\u95ee\u9898 2.11 set \u57fa\u672c\u64cd\u4f5c \u00b6 2.11.1 set\u7c7b\u578b \u00b6 \u65b0\u7684\u5b58\u50a8\u9700\u6c42\uff1a\u5b58\u50a8\u5927\u91cf\u7684\u6570\u636e\uff0c\u5728\u67e5\u8be2\u65b9\u9762\u63d0\u4f9b\u66f4\u9ad8\u7684\u6548\u7387 \u9700\u8981\u7684\u5b58\u50a8\u7ed3\u6784\uff1a\u80fd\u591f\u4fdd\u5b58\u5927\u91cf\u7684\u6570\u636e\uff0c\u9ad8\u6548\u7684\u5185\u90e8\u5b58\u50a8\u673a\u5236\uff0c\u4fbf\u4e8e\u67e5\u8be2 set\u7c7b\u578b\uff1a\u4e0ehash\u5b58\u50a8\u7ed3\u6784\u5b8c\u5168\u76f8\u540c\uff0c\u4ec5\u5b58\u50a8\u952e\uff0c\u4e0d\u5b58\u50a8\u503c\uff08nil\uff09\uff0c\u5e76\u4e14\u503c\u662f\u4e0d\u5141\u8bb8\u91cd\u590d\u7684 \u901a\u8fc7\u8fd9\u4e2a\u540d\u79f0\uff0c\u5927\u5bb6\u4e5f\u57fa\u672c\u4e0a\u80fd\u591f\u8ba4\u8bc6\u5230\u548c\u6211\u4eecJava\u4e2d\u7684set\u5b8c\u5168\u4e00\u6837\u3002\u6211\u4eec\u73b0\u5728\u8981\u5b58\u50a8\u5927\u91cf\u7684\u6570\u636e\uff0c\u5e76\u4e14\u8981\u6c42\u63d0\u9ad8\u5b83\u7684\u67e5\u8be2\u6548\u7387\u3002\u7528list\u8fd9\u79cd\u94fe\u8868\u5f62\u5f0f\uff0c\u5b83\u7684\u67e5\u8be2\u6548\u7387\u662f\u4e0d\u9ad8\u7684\uff0c\u90a3\u600e\u4e48\u529e\u5462\uff1f\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u60f3\uff0c\u6709\u6ca1\u6709\u9ad8\u6548\u7684\u5b58\u50a8\u673a\u5236\u3002\u5176\u5b9e\u524d\u9762\u54b1\u8bb2Java\u7684\u65f6\u5019\u8bf4\u8fc7hash\u8868\u7684\u7ed3\u6784\u5c31\u975e\u5e38\u7684\u597d\uff0c\u4f46\u662f\u8fd9\u91cc\u8fb9\u6211\u4eec\u5df2\u7ecf\u6709hash\u4e86\uff0c\u4ed6\u505a\u4e86\u8fd9\u4e48\u4e00\u4e2a\u8bbe\u5b9a\uff0c\u5e72\u561b\u5462\uff0c\u4ed6\u628ahash\u7684\u5b58\u50a8\u7a7a\u95f4\u7ed9\u6539\u4e00\u4e0b\uff0c\u53f3\u8fb9\u4f60\u539f\u6765\u5b58\u6570\u636e\u6539\u6389,\u5168\u90e8\u5b58\u7a7a\uff0c\u90a3\u4f60\u8bf4\u6570\u636e\u653e\u54ea\u513f\u4e86\uff1f\u653e\u5230\u539f\u6765\u7684filed\u7684\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u5728\u8fd9\u91cc\u8fb9\u5b58\u771f\u6b63\u7684\u503c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6a21\u578b\u5c31\u662f\u6211\u4eec\u7684set \u6a21\u578b\u3002 set\u7c7b\u578b\uff1a\u4e0ehash\u5b58\u50a8\u7ed3\u6784\u5b8c\u5168\u76f8\u540c\uff0c\u4ec5\u5b58\u50a8\u952e\uff0c\u4e0d\u5b58\u50a8\u503c\uff08nil\uff09\uff0c\u5e76\u4e14\u503c\u662f\u4e0d\u5141\u8bb8\u91cd\u590d\u7684\u3002 \u770b\u4e00\u4e0b\u5b83\u7684\u6574\u4e2a\u7ed3\u6784\uff1a 2.11.2 set\u7c7b\u578b\u6570\u636e\u7684\u57fa\u672c\u64cd\u4f5c \u00b6 \u6dfb\u52a0\u6570\u636e sadd key member1 [ member2 ] \u83b7\u53d6\u5168\u90e8\u6570\u636e smembers key \u5220\u9664\u6570\u636e srem key member1 [ member2 ] \u83b7\u53d6\u96c6\u5408\u6570\u636e\u603b\u91cf scard key \u5224\u65ad\u96c6\u5408\u4e2d\u662f\u5426\u5305\u542b\u6307\u5b9a\u6570\u636e sismember key member \u968f\u673a\u83b7\u53d6\u96c6\u5408\u4e2d\u6307\u5b9a\u6570\u91cf\u7684\u6570\u636e srandmember key [ count ] \u968f\u673a\u83b7\u53d6\u96c6\u4e2d\u7684\u67d0\u4e2a\u6570\u636e\u5e76\u5c06\u8be5\u6570\u636e\u79fb\u9664\u96c6\u5408 spop key [ count ] 2.12 set \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c \u00b6 2.12.1 set \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c \u00b6 \u6c42\u4e24\u4e2a\u96c6\u5408\u7684\u4ea4\u3001\u5e76\u3001\u5dee\u96c6 sinter key1 [key2 \u2026] sunion key1 [key2 \u2026] sdiff key1 [key2 \u2026] \u6c42\u4e24\u4e2a\u96c6\u5408\u7684\u4ea4\u3001\u5e76\u3001\u5dee\u96c6\u5e76\u5b58\u50a8\u5230\u6307\u5b9a\u96c6\u5408\u4e2d sinterstore destination key1 [key2 \u2026] sunionstore destination key1 [key2 \u2026] sdiffstore destination key1 [key2 \u2026] \u5c06\u6307\u5b9a\u6570\u636e\u4ece\u539f\u59cb\u96c6\u5408\u4e2d\u79fb\u52a8\u5230\u76ee\u6807\u96c6\u5408\u4e2d smove source destination member \u901a\u8fc7\u4e0b\u9762\u4e00\u5f20\u56fe\u56de\u5fc6\u4e00\u4e0b\u4ea4\u3001\u5e76\u3001\u5dee 2.12.2 set \u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u7684\u6ce8\u610f\u4e8b\u9879 \u00b6 set \u7c7b\u578b\u4e0d\u5141\u8bb8\u6570\u636e\u91cd\u590d\uff0c\u5982\u679c\u6dfb\u52a0\u7684\u6570\u636e\u5728 set \u4e2d\u5df2\u7ecf\u5b58\u5728\uff0c\u5c06\u53ea\u4fdd\u7559\u4e00\u4efd\u3002 set \u867d\u7136\u4e0ehash\u7684\u5b58\u50a8\u7ed3\u6784\u76f8\u540c\uff0c\u4f46\u662f\u65e0\u6cd5\u542f\u7528hash\u4e2d\u5b58\u50a8\u503c\u7684\u7a7a\u95f4\u3002 2.13 set\u5e94\u7528\u573a\u666f \u00b6 2.13.1 set\u5e94\u7528\u573a\u666f \u00b6 \uff081\uff09\u9ed1\u540d\u5355 \u8d44\u8baf\u7c7b\u4fe1\u606f\u7c7b\u7f51\u7ad9\u8ffd\u6c42\u9ad8\u8bbf\u95ee\u91cf\uff0c\u4f46\u662f\u7531\u4e8e\u5176\u4fe1\u606f\u7684\u4ef7\u503c\uff0c\u5f80\u5f80\u5bb9\u6613\u88ab\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\uff0c\u901a\u8fc7\u722c\u866b\u6280\u672f\uff0c \u5feb\u901f\u83b7\u53d6\u4fe1\u606f\uff0c\u4e2a\u522b\u7279\u79cd\u884c\u4e1a\u7f51\u7ad9\u4fe1\u606f\u901a\u8fc7\u722c\u866b\u83b7\u53d6\u5206\u6790\u540e\uff0c\u53ef\u4ee5\u8f6c\u6362\u6210\u5546\u4e1a\u673a\u5bc6\u8fdb\u884c\u51fa\u552e\u3002\u4f8b\u5982\u7b2c\u4e09\u65b9\u706b \u8f66\u7968\u3001\u673a\u7968\u3001\u9152\u5e97\u5237\u7968\u4ee3\u8d2d\u8f6f\u4ef6\uff0c\u7535\u5546\u5237\u8bc4\u8bba\u3001\u5237\u597d\u8bc4\u3002 \u540c\u65f6\u722c\u866b\u5e26\u6765\u7684\u4f2a\u6d41\u91cf\u4e5f\u4f1a\u7ed9\u7ecf\u8425\u8005\u5e26\u6765\u9519\u89c9\uff0c\u4ea7\u751f\u9519\u8bef\u7684\u51b3\u7b56\uff0c\u6709\u6548\u907f\u514d\u7f51\u7ad9\u88ab\u722c\u866b\u53cd\u590d\u722c\u53d6\u6210\u4e3a\u6bcf\u4e2a\u7f51\u7ad9\u90fd\u8981\u8003\u8651\u7684\u57fa\u672c\u95ee\u9898\u3002\u5728\u57fa\u4e8e\u6280\u672f\u5c42\u9762\u533a\u5206\u51fa\u722c\u866b\u7528\u6237\u540e\uff0c\u9700\u8981\u5c06\u6b64\u7c7b\u7528\u6237\u8fdb\u884c\u6709\u6548\u7684\u5c4f\u853d\uff0c\u8fd9\u5c31\u662f\u9ed1\u540d\u5355\u7684\u5178\u578b\u5e94\u7528\u3002 ps:\u4e0d\u662f\u8bf4\u722c\u866b\u4e00\u5b9a\u505a\u6467\u6bc1\u6027\u7684\u5de5\u4f5c\uff0c\u6709\u4e9b\u5c0f\u578b\u7f51\u7ad9\u9700\u8981\u722c\u866b\u4e3a\u5176\u5e26\u6765\u4e00\u4e9b\u6d41\u91cf\u3002 \uff082\uff09\u767d\u540d\u5355 \u5bf9\u4e8e\u5b89\u5168\u6027\u66f4\u9ad8\u7684\u5e94\u7528\u8bbf\u95ee\uff0c\u4ec5\u4ec5\u9760\u9ed1\u540d\u5355\u662f\u4e0d\u80fd\u89e3\u51b3\u5b89\u5168\u95ee\u9898\u7684\uff0c\u6b64\u65f6\u9700\u8981\u8bbe\u5b9a\u53ef\u8bbf\u95ee\u7684\u7528\u6237\u7fa4\u4f53\uff0c \u4f9d\u8d56\u767d\u540d\u5355\u505a\u66f4\u4e3a\u82db\u523b\u7684\u8bbf\u95ee\u9a8c\u8bc1\u3002 2.13.2 \u89e3\u51b3\u65b9\u6848 \u00b6 \u57fa\u4e8e\u7ecf\u8425\u6218\u7565\u8bbe\u5b9a\u95ee\u9898\u7528\u6237\u53d1\u73b0\u3001\u9274\u522b\u89c4\u5219 \u5468\u671f\u6027\u66f4\u65b0\u6ee1\u8db3\u89c4\u5219\u7684\u7528\u6237\u9ed1\u540d\u5355\uff0c\u52a0\u5165set\u96c6\u5408 \u7528\u6237\u884c\u4e3a\u4fe1\u606f\u8fbe\u5230\u540e\u4e0e\u9ed1\u540d\u5355\u8fdb\u884c\u6bd4\u5bf9\uff0c\u786e\u8ba4\u884c\u4e3a\u53bb\u5411 \u9ed1\u540d\u5355\u8fc7\u6ee4IP\u5730\u5740\uff1a\u5e94\u7528\u4e8e\u5f00\u653e\u6e38\u5ba2\u8bbf\u95ee\u6743\u9650\u7684\u4fe1\u606f\u6e90 \u9ed1\u540d\u5355\u8fc7\u6ee4\u8bbe\u5907\u4fe1\u606f\uff1a\u5e94\u7528\u4e8e\u9650\u5b9a\u8bbf\u95ee\u8bbe\u5907\u7684\u4fe1\u606f\u6e90 \u9ed1\u540d\u5355\u8fc7\u6ee4\u7528\u6237\uff1a\u5e94\u7528\u4e8e\u57fa\u4e8e\u8bbf\u95ee\u6743\u9650\u7684\u4fe1\u606f\u6e90 2.14 \u5b9e\u8df5\u6848\u4f8b \u00b6 2.14.1\u4e1a\u52a1\u573a\u666f \u00b6 \u4f7f\u7528\u5fae\u4fe1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f53\u5fae\u4fe1\u63a5\u6536\u6d88\u606f\u540e\uff0c\u4f1a\u9ed8\u8ba4\u5c06\u6700\u8fd1\u63a5\u6536\u7684\u6d88\u606f\u7f6e\u9876\uff0c\u5f53\u591a\u4e2a\u597d\u53cb\u53ca\u5173\u6ce8\u7684\u8ba2\u9605\u53f7\u540c\u65f6\u53d1 \u9001\u6d88\u606f\u65f6\uff0c\u8be5\u6392\u5e8f\u4f1a\u4e0d\u505c\u7684\u8fdb\u884c\u4ea4\u66ff\u3002\u540c\u65f6\u8fd8\u53ef\u4ee5\u5c06\u91cd\u8981\u7684\u4f1a\u8bdd\u8bbe\u7f6e\u4e3a\u7f6e\u9876\u3002\u4e00\u65e6\u7528\u6237\u79bb\u7ebf\u540e\uff0c\u518d\u6b21\u6253\u5f00\u5fae\u4fe1\u65f6\uff0c\u6d88\u606f\u8be5\u6309\u7167\u4ec0\u4e48\u6837\u7684\u987a\u5e8f\u663e\u793a\u3002 \u6211\u4eec\u5206\u6790\u4e00\u4e0b\uff1a 100\u8fd9\u53f0\u624b\u673a\u4ee3\u8868\u4f60\u3002\u800c200\u3001300\u3001400\u8fd9\u4e09\u53f0\u4ee3\u8868\u4f60\u597d\u53cb\u7684\u624b\u673a\u3002\u5728\u8fd9\u91cc\u6709\u4e00\u4e9b\u4e1c\u897f\u9700\u8981\u4ea4\u4ee3\u4e00\u4e0b\uff0c\u56e0\u4e3a\u6211\u4eec\u6bcf\u4e2a\u4eba\u7684\u90fd\u4f1a\u5bf9\u81ea\u5df1\u7684\u5fae\u4fe1\u4e2d\u7684\u4e00\u4e9b\u6bd4\u8f83\u91cd\u8981\u7684\u4eba\u8bbe\u7f6e\u4f1a\u8bdd\u7f6e\u9876\uff0c\u5c06\u4ed6\u7684\u90a3\u6761\u5bf9\u8bdd\u653e\u5728\u6700\u4e0a\u9762\u3002\u6211\u4eec\u5047\u5b9a\u8fd9\u4e2a\u4eba\u6709\u4e24\u4e2a\u4f1a\u8bdd\u7f6e\u9876\u7684\u597d\u53cb\uff0c\u5206\u522b\u662f400\u548c500\uff0c\u800c\u8fd9\u91cc\u8fb9\u5c31\u5305\u542b400. \u4e0b\u9762\u5462\uff0c\u6211\u4eec\u5c31\u6765\u53d1\u8fd9\u4e2a\u6d88\u606f\uff0c\u7b2c\u4e00\u4e2a\u53d1\u6d88\u606f\u7684\u662f300\uff0c\u4ed6\u53d1\u4e86\u4e2a\u6d88\u606f\u7ed9100\u3002\u53d1\u5b8c\u4ee5\u540e\uff0c\u8fd9\u4e2a\u4e1c\u897f\u5e94\u8be5\u600e\u4e48\u5b58\u50a8\u5462\uff1f\u5728\u8fd9\u91cc\u9762\u4e00\u5b9a\u8981\u5206\u5f00\uff0c\u8bb0\u5f55\u7f6e\u9876\u7684\u8fd9\u4e9b\u4eba\u7684\u4f1a\u8bdd\uff0c\u5bf9\u5e94\u7684\u4f1a\u8bdd\u663e\u793a\u987a\u5e8f\u548c\u975e\u7f6e\u9876\u7684\u4e00\u5b9a\u8981\u5206\u4e24\u3002 \u8fd9\u91cc\u9762\u6211\u4eec\u521b\u5efa\u4e24\u4e2a\u6a21\u578b\uff0c\u4e00\u4e2a\u662f\u666e\u901a\u7684\uff0c\u4e00\u4e2a\u662f\u7f6e\u9876\u7684\uff0c\u800c\u4e0a\u9762\u7684\u8fd9\u4e2a\u7f6e\u9876\u7684\u7528\u6237\u5462\uff0c\u6211\u4eec\u7528set\u6765\u5b58\u50a8\uff0c\u56e0\u4e3a\u4e0d\u91cd\u590d\u3002\u800c\u4e0b\u9762\u8fd9\u4e9b\u56e0\u4e3a\u6709\u987a\u5e8f\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u7528list\u53bb\u5b58\u50a8,\u4e0d\u7136\u4f60\u600e\u4e48\u8868\u8fbe\u987a\u5e8f\u5462\uff1f \u90a3\u5f53300\u53d1\u7ed9\u6d88\u606f\u7ed9100\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5148\u5224\u5b9a\u4f60\u5728\u7f6e\u9876\u4eba\u7fa4\u4e2d\u5417\uff1f\u4e0d\u5728,\u90a3\u597d\uff0c300\u7684\u6d88\u606f\u5bf9\u5e94\u7684\u987a\u5e8f\u5c31\u5e94\u8be5\u653e\u5728\u666e\u901a\u7684\u5217\u8868\u91cc\u8fb9\u3002\u800c\u5728\u8fd9\u91cc\u8fb9\uff0c\u6211\u4eec\u628a300\u52a0\u8fdb\u53bb\u3002\u7b2c\u4e00\u4e2a\u6570\u636e\u4e5f\u5c31\u662f\u73b0\u5728300\u3002 \u63a5\u4e0b\u6765400\uff0c\u53d1\u4e86\u4e2a\u6d88\u606f\u3002\u5224\u65ad\u4e00\u4e0b\uff0c\u4ed6\u662f\u9700\u8981\u7f6e\u9876\u7684\uff0c\u6240\u4ee5400\u5c06\u8fdb\u5165list\u7684\u7f6e\u9876\u91cc\u8fb9\u653e\u7740\u3002\u5f53\u524d\u8fd8\u6ca1\u6709\u7279\u6b8a\u7684\u5730\u65b9\u3002 \u518d\u6765200\u53d1\u6d88\u606f\u4e86\uff0c\u548c\u521a\u624d\u7684\u5224\u5b9a\u65b9\u6cd5\u4e00\u6837\uff0c\u5148\u770b\u5728\u4e0d\u5728\u7f6e\u9876\u91cc\uff0c\u4e0d\u5728\u7684\u8bdd\u8fdb\u666e\u901a\uff0c\u7136\u540e\u5728\u666e\u901a\u91cc\u8fb9\u628a200\u52a0\u5165\u5c31\u884c\u4e86\uff0cOK\uff0c\u5230\u8fd9\u91cc\u76ee\u524d\u8fd8\u6ca1\u6709\u987a\u5e8f\u53d8\u5316\u3002 \u63a5\u4e0b\u6765200\u53c8\u53d1\u6d88\u606f\u8fc7\u6765\uff0c\u540c\u4e00\u4e2a\u4eba\u7ed9\u4f60\u8fde\u53d1\u4e86\u4e24\u6761\uff0c\u90a3\u8fd9\u4e2a\u65f6\u5019200\u7684\u6d88\u606f\u5230\u8fbe\u4ee5\u540e\uff0c\u5148\u5224\u65ad\u662f\u5426\u5728\u7f6e\u9876\u8303\u56f4\uff0c\u4e0d\u5728\uff0c\u63a5\u4e0b\u6765\u4ed6\u8981\u653e\u5728list\u666e\u901a\u4e2d\uff0c\u8fd9\u91cc\u4f60\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u56e0\u4e3a\u8fd9\u91cc\u8fb9\u5df2\u7ecf\u6709200\uff0c\u6240\u4ee5\u8fdb\u6765\u4ee5\u540e\u5148\u5e72\u4e00\u4ef6\u4e8b\u513f\uff0c\u628a200\u6740\u6389\uff0c\u6ca1\u6709200\uff0c\u7136\u540e\u518d\u628a200\u52a0\u8fdb\u6765\uff0c\u90a3\u4f60\u60f3\u4e00\u4e0b\uff0c\u73b0\u5728\u8fd9\u4e2a\u4f4d\u7f6e\u987a\u5e8f\u662f\u4ec0\u4e48\u5462\uff1f\u5c31\u662f\u65b0\u7684\u90fd\u5728\u53f3\u8fb9\uff0c\u5bf9\u4e0d\u5bf9\uff1f \u8fd8\u8bb0\u5f97\u6211\u4eec\u8bf4list\u6a21\u578b\uff0c\u5982\u679c\u662f\u4e00\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u5b83\u662f\u53ef\u4ee5\u4e24\u5934\u8fdb\u4e24\u5934\u51fa\u3002\u5f53\u7136\u6211\u4eec\u53cc\u7aef\u4ece\u4e00\u5934\u8fdb\u4e00\u5934\u51fa\uff0c\u8fd9\u5c31\u662f\u6808\u6a21\u578b\uff0c\u73b0\u5728\u54b1\u4eec\u8fd0\u7528\u7684\u5c31\u662flist\u6a21\u578b\u4e2d\u7684\u6808\u6a21\u578b\u3002 \u73b0\u5728300\u53d1\u6d88\u606f\uff0c\u5148\u5224\u5b9a\u4ed6\u5728\u4e0d\u5728\uff0c\u4e0d\u5728\uff0c\u7528\u666e\u901a\u7684\u961f\u5217\uff0c\u63a5\u4e0b\u6765\u6309\u7167\u521a\u624d\u7684\u64cd\u4f5c\uff0c\u4e0d\u7ba1\u4f60\u91cc\u8fb9\u539f\u6765\u6709\u6ca1\u6709300\uff0c\u6211\u5148\u628a300\u6740\u6389\uff0c\u6ca1\u4e86\uff0c200\u81ea\u7136\u5c31\u586b\u5230300\u7684\u4f4d\u7f6e\u4e86\uff0c\u4ed6\u73b0\u5728\u662flist\u91cc\u9762\u552f\u4e00\u4e00\u4e2a\uff0c\u7136\u540e\u8ba9300\u8fdb\u6765\uff0c\u6ce8\u610f\u662f\u4ece\u53f3\u4fa7\u8fdb\u6765\u7684\uff0c\u90a3\u4e48\u73b0\u5728300\u5c31\u662f\u6700\u65b0\u7684\u3002 \u90a3\u4e48\u5230\u8fd9\u91cc\u5462\uff0c\u6211\u4eec\u8ba9100\u6765\u8bfb\u53d6\u6d88\u606f\u3002\u4f60\u89c9\u5f97\u8fd9\u4e2a\u6d88\u606f\u987a\u5e8f\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u7684\uff1f\u9996\u5148\u7f6e\u9876\u7684400\u6709\u4e00\u4e2a\uff0c\u4ed6\u8dd1\u5728\u6700\u4e0a\u9762\uff0c\u7136\u540elist\u666e\u901a\u5982\u679c\u51fa\u6765\u7684\u8bdd\uff0c300\u662f\u6700\u65b0\u7684\u6d88\u606f\uff0c\u800c200\u5728\u4ed6\u540e\u9762\u7684\u3002\u7528\u8fd9\u79cd\u5f62\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u505a\u51fa\u6765\u4ed6\u7684\u6d88\u606f\u987a\u5e8f\u6765\u3002 2.14.2 \u89e3\u51b3\u65b9\u6848 \u00b6 \u770b\u4e00\u4e0b\u6700\u7ec8\u7684\u89e3\u51b3\u65b9\u6848\uff1a \u4f9d\u8d56list\u7684\u6570\u636e\u5177\u6709\u987a\u5e8f\u7684\u7279\u5f81\u5bf9\u6d88\u606f\u8fdb\u884c\u7ba1\u7406\uff0c\u5c06list\u7ed3\u6784\u4f5c\u4e3a\u6808\u4f7f\u7528 \u7f6e\u9876\u4e0e\u666e\u901a\u4f1a\u8bdd\u5206\u522b\u521b\u5efa\u72ec\u7acb\u7684list\u5206\u522b\u7ba1\u7406 \u5f53\u67d0\u4e2alist\u4e2d\u63a5\u6536\u5230\u7528\u6237\u6d88\u606f\u540e\uff0c\u5c06\u6d88\u606f\u53d1\u9001\u65b9\u7684id\u4ecelist\u7684\u4e00\u4fa7\u52a0\u5165list\uff08\u6b64\u5904\u8bbe\u5b9a\u5de6\u4fa7\uff09 \u591a\u4e2a\u76f8\u540cid\u53d1\u51fa\u7684\u6d88\u606f\u53cd\u590d\u5165\u6808\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u5728\u5165\u6808\u4e4b\u524d\u65e0\u8bba\u662f\u5426\u5177\u6709\u5f53\u524did\u5bf9\u5e94\u7684\u6d88\u606f\uff0c\u5148\u5220\u9664\u5bf9\u5e94id \u63a8\u9001\u6d88\u606f\u65f6\u5148\u63a8\u9001\u7f6e\u9876\u4f1a\u8bddlist\uff0c\u518d\u63a8\u9001\u666e\u901a\u4f1a\u8bddlist\uff0c\u63a8\u9001\u5b8c\u6210\u7684list\u6e05\u9664\u6240\u6709\u6570\u636e \u6d88\u606f\u7684\u6570\u91cf\uff0c\u4e5f\u5c31\u662f\u5fae\u4fe1\u7528\u6237\u5bf9\u8bdd\u6570\u91cf\u91c7\u7528\u8ba1\u6570\u5668\u7684\u601d\u60f3\u53e6\u884c\u8bb0\u5f55\uff0c\u4f34\u968flist\u64cd\u4f5c\u540c\u6b65\u66f4\u65b0 2.14.3 \u6570\u636e\u7c7b\u578b\u603b\u7ed3 \u00b6 \u603b\u7ed3\u4e00\u4e0b\uff0c\u5728\u6574\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e86\u54ea\u4e9b\u5185\u5bb9\uff1a \u9996\u5148\u6211\u4eec\u4e86\u89e3\u4e86\u4e00\u4e0b\u6570\u636e\u7c7b\u578b\uff0c\u63a5\u4e0b\u6765\u9488\u5bf9\u7740\u6211\u4eec\u8981\u5b66\u4e60\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fdb\u884c\u9010\u4e00\u8bb2\u89e3\u4e86string\u3001hash\u3001list\u3001set\u7b49\uff0c\u6700\u540e\u901a\u8fc7\u4e00\u4e2a\u6848\u4f8b\u603b\u7ed3\u4e86\u4e00\u4e0b\u524d\u9762\u7684\u6570\u636e\u7c7b\u578b\u7684\u4f7f\u7528\u573a\u666f\u3002 3. \u5e38\u7528\u6307\u4ee4 \u00b6 \u5728\u8fd9\u90e8\u5206\u4e2d\u5462\uff0c\u6211\u4eec\u5bb6\u5b66\u4e60\u4e24\u4e2a\u77e5\u8bc6\uff0c\u7b2c\u4e00\u4e2a\u662fkey\u7684\u5e38\u7528\u6307\u4ee4\uff0c\u7b2c\u4e8c\u4e2a\u662f\u6570\u636e\u5e93\u7684\u5e38\u7528\u6307\u4ee4\u3002\u548c\u524d\u9762\u6211\u4eec\u5b66\u6570\u636e\u7c7b\u578b\u505a\u4e00\u4e0b\u533a\u5206\uff0c\u524d\u9762\u4f60\u5b66\u7684\u90a3\u4e9b\u6307\u4ee4\u5462\uff0c\u90fd\u662f\u9488\u5bf9\u67d0\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u64cd\u4f5c\u7684\uff0c\u73b0\u5728\u5b66\u7684\u90fd\u662f\u5bf9\u6240\u6709\u7684\u64cd\u4f5c\u7684\uff0c\u6765\u770b\u4e00\u4e0b\uff0c\u6211\u4eec\u5728\u5b66\u4e60Key\u7684\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5148\u60f3\u4e00\u4e0b\u7684\u64cd\u4f5c\u6211\u4eec\u5e94\u8be5\u5b66\u54ea\u4e9b\u4e1c\u897f: 3.1 key \u64cd\u4f5c\u5206\u6790 \u00b6 3.1.1 key\u5e94\u8be5\u8bbe\u8ba1\u54ea\u4e9b\u64cd\u4f5c\uff1f \u00b6 key\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u901a\u8fc7key\u83b7\u53d6redis\u4e2d\u4fdd\u5b58\u7684\u6570\u636e \u5bf9\u4e8ekey\u81ea\u8eab\u72b6\u6001\u7684\u76f8\u5173\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u5220\u9664\uff0c\u5224\u5b9a\u5b58\u5728\uff0c\u83b7\u53d6\u7c7b\u578b\u7b49 \u5bf9\u4e8ekey\u6709\u6548\u6027\u63a7\u5236\u76f8\u5173\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u6709\u6548\u671f\u8bbe\u5b9a\uff0c\u5224\u5b9a\u662f\u5426\u6709\u6548\uff0c\u6709\u6548\u72b6\u6001\u7684\u5207\u6362\u7b49 \u5bf9\u4e8ekey\u5feb\u901f\u67e5\u8be2\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u6309\u6307\u5b9a\u7b56\u7565\u67e5\u8be2key 3.1.2 key \u57fa\u672c\u64cd\u4f5c \u00b6 \u5220\u9664\u6307\u5b9akey del key \u83b7\u53d6key\u662f\u5426\u5b58\u5728 exists key \u83b7\u53d6key\u7684\u7c7b\u578b type key 3.1.3 \u62d3\u5c55\u64cd\u4f5c \u6392\u5e8f sort \u6539\u540d rename key newkey renamenx key newkey 3.1.3 key \u6269\u5c55\u64cd\u4f5c\uff08\u65f6\u6548\u6027\u63a7\u5236\uff09 \u00b6 \u4e3a\u6307\u5b9akey\u8bbe\u7f6e\u6709\u6548\u671f expire key seconds pexpire key milliseconds expireat key timestamp pexpireat key milliseconds-timestamp \u83b7\u53d6key\u7684\u6709\u6548\u65f6\u95f4 ttl key pttl key \u5207\u6362key\u4ece\u65f6\u6548\u6027\u8f6c\u6362\u4e3a\u6c38\u4e45\u6027 persist key 3.1.4 key \u6269\u5c55\u64cd\u4f5c\uff08\u67e5\u8be2\u6a21\u5f0f\uff09 \u00b6 \u67e5\u8be2key keys pattern \u67e5\u8be2\u6a21\u5f0f\u89c4\u5219 *\u5339\u914d\u4efb\u610f\u6570\u91cf\u7684\u4efb\u610f\u7b26\u53f7 ? \u914d\u5408\u4e00\u4e2a\u4efb\u610f\u7b26\u53f7 [] \u5339\u914d\u4e00\u4e2a\u6307\u5b9a\u7b26\u53f7 keys * keys \u67e5\u8be2\u6240\u6709 it* keys \u67e5\u8be2\u6240\u6709\u4ee5it\u5f00\u5934 *heima \u67e5\u8be2\u6240\u6709\u4ee5heima\u7ed3\u5c3e keys ??heima \u67e5\u8be2\u6240\u6709\u524d\u9762\u4e24\u4e2a\u5b57\u7b26\u4efb\u610f\uff0c\u540e\u9762\u4ee5heima\u7ed3\u5c3e \u67e5\u8be2\u6240\u6709\u4ee5 keys user:? user:\u5f00\u5934\uff0c\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4efb\u610f keys u [ st ] er:1 \u67e5\u8be2\u6240\u6709\u4ee5u\u5f00\u5934\uff0c\u4ee5er:1\u7ed3\u5c3e\uff0c\u4e2d\u95f4\u5305\u542b\u4e00\u4e2a\u5b57\u6bcd\uff0cs\u6216t 3.2 \u6570\u636e\u5e93\u6307\u4ee4 \u00b6 3.2.1 key \u7684\u91cd\u590d\u95ee\u9898 \u00b6 \u5728\u8fd9\u4e2a\u5730\u65b9\u6211\u4eec\u6765\u8bb2\u4e00\u4e0b\u6570\u636e\u5e93\u7684\u5e38\u7528\u6307\u4ee4\uff0c\u5728\u8bb2\u8fd9\u4e2a\u4e1c\u897f\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a \u5047\u5982\u8bf4\u4f60\u4eec\u5341\u4e2a\u4eba\u540c\u65f6\u64cd\u4f5credis\uff0c\u4f1a\u4e0d\u4f1a\u51fa\u73b0key\u540d\u5b57\u547d\u540d\u51b2\u7a81\u7684\u95ee\u9898\u3002 \u4e00\u5b9a\u4f1a\uff0c\u4e3a\u4ec0\u4e48?\u56e0\u4e3a\u4f60\u7684key\u662f\u7531\u7a0b\u5e8f\u800c\u5b9a\u4e49\u7684\u3002\u4f60\u60f3\u5199\u4ec0\u4e48\u5199\u4ec0\u4e48\uff0c\u90a3\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u4e2d\u5927\u5bb6\u90fd\u5728\u4e0d\u505c\u7684\u52a0\uff0c\u65e9\u665a\u6709\u4e00\u5929\u4ed6\u4f1a\u51b2\u7a81\u7684\u3002 redis\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u4f34\u968f\u7740\u64cd\u4f5c\u6570\u636e\u91cf\u7684\u589e\u52a0\uff0c\u4f1a\u51fa\u73b0\u5927\u91cf\u7684\u6570\u636e\u4ee5\u53ca\u5bf9\u5e94\u7684key\u3002 \u90a3\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u8981\u4e0d\u8981\u89e3\u51b3\uff1f\u8981\uff01\u600e\u4e48\u89e3\u51b3\u5462\uff1f\u6211\u4eec\u6700\u597d\u628a\u6570\u636e\u8fdb\u884c\u4e00\u4e2a\u5206\u7c7b\uff0c\u9664\u4e86\u547d\u540d\u89c4\u8303\u6211\u4eec\u505a\u7edf\u4e00\u4ee5\u5916\uff0c\u5982\u679c\u8fd8\u80fd\u628a\u5b83\u5206\u5f00\uff0c\u8fd9\u6837\u662f\u4e0d\u662f\u51b2\u7a81\u7684\u673a\u7387\u5c31\u4f1a\u5c0f\u4e00\u4e9b\u4e86\uff0c\u8fd9\u5c31\u662f\u54b1\u4eec\u4e0b\u9762\u8981\u8bf4\u7684\u89e3\u51b3\u65b9\u6848\uff01 3.2.2 \u89e3\u51b3\u65b9\u6848 \u00b6 redis\u4e3a\u6bcf\u4e2a\u670d\u52a1\u63d0\u4f9b\u670916\u4e2a\u6570\u636e\u5e93\uff0c\u7f16\u53f7\u4ece0\u523015 \u6bcf\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u6570\u636e\u76f8\u4e92\u72ec\u7acb \u5728\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u4e2d\u5212\u51fa\u4e00\u5757\u533a\u57df\uff0c\u8bf4\u4ed6\u5c31\u662f\u51e0\uff0c\u4f60\u5c31\u7528\u51e0\u90a3\u5757\uff0c\u540c\u65f6\uff0c\u5176\u4ed6\u7684\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u8fdb\u884c\u5b9a\u4e49\uff0c\u4e00\u5171\u662f16\u4e2a\uff0c\u8fd9\u91cc\u8fb9\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u4ed6\u4eec\u8fd916\u4e2a\u5171\u7528redis\u7684\u5185\u5b58\u3002\u6ca1\u6709\u8bf4\u8c01\u5927\u8c01\u5c0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6570\u5b57\u53ea\u662f\u4ee3\u8868\u4e86\u4e00\u5757\u513f\u533a\u57df\uff0c\u533a\u57df\u5177\u4f53\u591a\u5927\u672a\u77e5\u3002\u8fd9\u662f\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u5206\u533a\u7684\u4e00\u4e2a\u7b56\u7565\uff01 3.2.3 \u6570\u636e\u5e93\u7684\u57fa\u672c\u64cd\u4f5c \u00b6 \u5207\u6362\u6570\u636e\u5e93 select index \u5176\u4ed6\u64cd\u4f5c ping 3.2.4 \u6570\u636e\u5e93\u6269\u5c55\u64cd\u4f5c \u00b6 \u6570\u636e\u79fb\u52a8 move key db \u6570\u636e\u603b\u91cf dbsize \u6570\u636e\u6e05\u9664 flushdb flushall 4. Jedis \u00b6 \u5728\u5b66\u4e60\u5b8credis\u540e\uff0c\u6211\u4eec\u73b0\u5728\u5c31\u8981\u7528Java\u6765\u8fde\u63a5redis\u4e86\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u7684\u8fd9\u4e00\u7ae0\u8981\u5b66\u7684Jedis\u4e86\u3002\u5728\u8fd9\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u8bb2\u89e3\u4ee5\u4e0b3\u4e2a\u5185\u5bb9\uff1a HelloWorld\uff08Jedis\u7248\uff09 Jedis\u7b80\u6613\u5de5\u5177\u7c7b\u5f00\u53d1 \u53ef\u89c6\u5316\u5ba2\u6237\u7aef 4.1 Jedis\u7b80\u4ecb \u00b6 4.1.1 \u7f16\u7a0b\u8bed\u8a00\u4e0eredis \u00b6 \u5bf9\u4e8e\u6211\u4eec\u73b0\u5728\u7684\u6570\u636e\u6765\u8bf4\uff0c\u5b83\u662f\u5728\u6211\u4eec\u7684redis\u4e2d\uff0c\u800c\u6700\u7ec8\u6211\u4eec\u662f\u8981\u505a\u7a0b\u5e8f\u3002\u90a3\u4e48\u7a0b\u5e8f\u5c31\u8981\u548c\u6211\u4eec\u7684redis\u8fdb\u884c\u8fde\u63a5\u3002\u5e72\u4ec0\u4e48\u4e8b\u60c5\u5462\uff1f\u4e24\u4ef6\u4e8b\uff1a\u7a0b\u5e8f\u4e2d\u6709\u6570\u636e\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8981\u628a\u8fd9\u4e9b\u6570\u636e\u5168\u90e8\u4ea4\u7ed9redis\u7ba1\u7406\u3002\u540c\u65f6\uff0credis\u4e2d\u7684\u6570\u636e\u8fd8\u80fd\u53d6\u51fa\u6765\uff0c\u56de\u5230\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u90a3\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u5728Java\u4e0eredis\u4e4b\u95f4\u6253\u4ea4\u9053\u7684\u8fd9\u4e2a\u4e1c\u897f\u5c31\u53eb\u505aJedis.\u7b80\u5355\u8bf4\uff0cJedis\u5c31\u662f\u63d0\u4f9b\u4e86Java\u4e0eredis\u7684\u8fde\u63a5\u670d\u52a1\u7684\uff0c\u91cc\u8fb9\u6709\u5404\u79cd\u5404\u6837\u7684API\u63a5\u53e3\uff0c\u4f60\u53ef\u4ee5\u53bb\u8c03\u7528\u5b83\u3002 \u9664\u4e86Jedis\u5916\uff0c\u8fd8\u6709\u6ca1\u6709\u5176\u4ed6\u7684\u8fd9\u79cd\u8fde\u63a5\u670d\u52a1\u5462\uff1f\u5176\u5b9e\u8fd8\u6709\u5f88\u591a\uff0c\u4e86\u89e3\u4e00\u4e0b\uff1a Java\u8bed\u8a00\u8fde\u63a5redis\u670d\u52a1 Jedis\uff08SpringData\u3001Redis \u3001 Lettuce\uff09 \u5176\u5b83\u8bed\u8a00\uff1aC \u3001C++ \u3001C# \u3001Erlang\u3001Lua \u3001Objective-C \u3001Perl \u3001PHP \u3001Python \u3001Ruby \u3001Scala 4.1.2 \u51c6\u5907\u5de5\u4f5c \u00b6 (1)jar\u5305\u5bfc\u5165 \u4e0b\u8f7d\u5730\u5740\uff1ahttps://mvnrepository.com/artifact/redis.clients/jedis \u57fa\u4e8emaven <dependency> <groupId> redis.clients </groupId> <artifactId> jedis </artifactId> <version> 2.9.0 </version> </dependency> (2)\u5ba2\u6237\u7aef\u8fde\u63a5redis \u8fde\u63a5redis Jedis jedis = new Jedis(\"localhost\", 6379); \u64cd\u4f5credis jedis.set(\"name\", \"itheima\"); jedis.get(\"name\"); \u5173\u95edredis\u8fde\u63a5 jedis.close(); API\u6587\u6863 http://xetorthio.github.io/jedis/ 4.1.3 \u4ee3\u7801\u5b9e\u73b0 \u00b6 \u521b\u5efa\uff1acom.itheima.JedisTest public class JedisTest { public static void main ( String [] args ) { //1.\u83b7\u53d6\u8fde\u63a5\u5bf9\u8c61 Jedis jedis = new Jedis ( \"192.168.40.130\" , 6379 ); //2.\u6267\u884c\u64cd\u4f5c jedis . set ( \"age\" , \"39\" ); String hello = jedis . get ( \"hello\" ); System . out . println ( hello ); jedis . lpush ( \"list1\" , \"a\" , \"b\" , \"c\" , \"d\" ); List < String > list1 = jedis . lrange ( \"list1\" , 0 , - 1 ); for ( String s : list1 ) { System . out . println ( s ); } jedis . sadd ( \"set1\" , \"abc\" , \"abc\" , \"def\" , \"poi\" , \"cba\" ); Long len = jedis . scard ( \"set1\" ); System . out . println ( len ); //3.\u5173\u95ed\u8fde\u63a5 jedis . close (); } } 4.2 Jedis\u7b80\u6613\u5de5\u5177\u7c7b\u5f00\u53d1 \u00b6 \u524d\u9762\u6211\u4eec\u505a\u7684\u7a0b\u5e8f\u8fd8\u662f\u6709\u70b9\u513f\u5c0f\u95ee\u9898\uff0c\u5c31\u662f\u6211\u4eec\u7684Jedis\u5bf9\u8c61\u7684\u7ba1\u7406\u662f\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u7684\uff0c\u771f\u5b9e\u4f01\u4e1a\u5f00\u53d1\u4e2d\u662f\u4e0d\u53ef\u80fd\u8ba9\u4f60\u53bbnew\u4e00\u4e2a\u7684\uff0c\u90a3\u63a5\u4e0b\u6765\u54b1\u4eec\u5c31\u8981\u505a\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u505a\u4e00\u4e2a\u521b\u5efaJedis\u7684\u8fd9\u6837\u7684\u4e00\u4e2a\u5de5\u5177\u3002 4.2.1 \u57fa\u4e8e\u8fde\u63a5\u6c60\u83b7\u53d6\u8fde\u63a5 \u00b6 JedisPool\uff1aJedis\u63d0\u4f9b\u7684\u8fde\u63a5\u6c60\u6280\u672f poolConfig:\u8fde\u63a5\u6c60\u914d\u7f6e\u5bf9\u8c61 host:redis\u670d\u52a1\u5730\u5740 port:redis\u670d\u52a1\u7aef\u53e3\u53f7 JedisPool\u7684\u6784\u9020\u5668\u5982\u4e0b\uff1a public JedisPool ( GenericObjectPoolConfig poolConfig , String host , int port ) { this ( poolConfig , host , port , 2000 , ( String ) null , 0 , ( String ) null ); } 4.2.2 \u5c01\u88c5\u8fde\u63a5\u53c2\u6570 \u00b6 \u521b\u5efajedis\u7684\u914d\u7f6e\u6587\u4ef6\uff1ajedis.properties jedis.host = 192.168.40.130 jedis.port = 6379 jedis.maxTotal = 50 jedis.maxIdle = 10 4.2.3 \u52a0\u8f7d\u914d\u7f6e\u4fe1\u606f \u00b6 \u521b\u5efaJedisUtils\uff1acom.itheima.util.JedisUtils\uff0c\u4f7f\u7528\u9759\u6001\u4ee3\u7801\u5757\u521d\u59cb\u5316\u8d44\u6e90 public class JedisUtils { private static int maxTotal ; private static int maxIdel ; private static String host ; private static int port ; private static JedisPoolConfig jpc ; private static JedisPool jp ; static { ResourceBundle bundle = ResourceBundle . getBundle ( \"redis\" ); maxTotal = Integer . parseInt ( bundle . getString ( \"redis.maxTotal\" )); maxIdel = Integer . parseInt ( bundle . getString ( \"redis.maxIdel\" )); host = bundle . getString ( \"redis.host\" ); port = Integer . parseInt ( bundle . getString ( \"redis.port\" )); //Jedis\u8fde\u63a5\u6c60\u914d\u7f6e jpc = new JedisPoolConfig (); jpc . setMaxTotal ( maxTotal ); jpc . setMaxIdle ( maxIdel ); jp = new JedisPool ( jpc , host , port ); } } 4.2.4 \u83b7\u53d6\u8fde\u63a5 \u00b6 \u5bf9\u5916\u8bbf\u95ee\u63a5\u53e3\uff0c\u63d0\u4f9bjedis\u8fde\u63a5\u5bf9\u8c61\uff0c\u8fde\u63a5\u4ece\u8fde\u63a5\u6c60\u83b7\u53d6\uff0c\u5728JedisUtils\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u83b7\u53d6jedis\u7684\u65b9\u6cd5\uff1agetJedis public static Jedis getJedis (){ Jedis jedis = jedisPool . getResource (); return jedis ; } 4.3 \u53ef\u89c6\u5316\u5ba2\u6237\u7aef \u00b6 4.3.1 Redis Desktop Manager 5. \u6301\u4e45\u5316 \u00b6 \u4e0b\u9762\u5462\uff0c\u8fdb\u5165\u5230\u6301\u4e45\u5316\u7684\u5b66\u4e60.\u8fd9\u90e8\u5206\u5185\u5bb9\u7406\u89e3\u7684\u4e1c\u897f\u591a\uff0c\u64cd\u4f5c\u7684\u4e1c\u897f\u5c11\u3002\u5728\u8fd9\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u8bb2\u89e3\u56db\u4e2a\u4e1c\u897f\uff1a \u6301\u4e45\u5316\u7b80\u4ecb RDB AOF RDB\u4e0eAOF\u533a\u522b 5.1 \u6301\u4e45\u5316\u7b80\u4ecb \u00b6 5.1.1 \u573a\u666f-\u610f\u5916\u65ad\u7535 \u00b6 \u4e0d\u77e5\u9053\u5927\u5bb6\u6709\u6ca1\u6709\u9047\u89c1\u8fc7\uff0c\u5c31\u662f\u6b63\u5de5\u4f5c\u7684\u65f6\u5019\u505c\u7535\u4e86\uff0c\u5982\u679c\u4f60\u7528\u7684\u662f\u7b14\u8bb0\u672c\u7535\u8111\u8fd8\u597d\uff0c\u4f60\u6709\u7535\u6c60\uff0c\u4f46\u5982\u679c\u4f60\u7528\u7684\u662f\u53f0\u5f0f\u673a\u5462\uff0c\u90a3\u6050\u6015\u5c31\u6bd4\u8f83\u707e\u96be\u4e86\uff0c\u5047\u5982\u4f60\u73b0\u5728\u6b63\u5728\u5199\u4e00\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u6587\u6863\uff0c\u5982\u679c\u4f60\u8981\u4f7f\u7528\u7684\u662fword\uff0c\u8fd9\u79cd\u529e\u516c\u81ea\u52a8\u5316\u8f6f\u4ef6\u7684\u8bdd\uff0c\u4ed6\u4e00\u65e6\u9047\u5230\u505c\u7535\uff0c\u5176\u5b9e\u4f60\u4e0d\u7528\u62c5\u5fc3\uff0c\u56e0\u4e3a\u5b83\u4f1a\u7ed9\u4f60\u751f\u6210\u4e00\u4e9b\u5176\u4ed6\u7684\u6587\u4ef6\u3002 \u5176\u5b9e\u4ed6\u4eec\u90fd\u5728\u505a\u4e00\u4ef6\u4e8b\u513f\uff0c\u5e2e\u4f60\u81ea\u52a8\u6062\u590d\uff0c\u6709\u4e86\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f60\u524d\u9762\u7684\u4e1c\u897f\u5c31\u4e0d\u518d\u4e22\u4e86\u3002\u90a3\u4ec0\u4e48\u662f\u81ea\u52a8\u6062\u590d\u5462\uff1f\u4f60\u8981\u5148\u4e86\u89e3\u4ed6\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002 \u6211\u4eec\u8bf4\u81ea\u52a8\u6062\u590d\uff0c\u5176\u5b9e\u57fa\u4e8e\u7684\u4e00\u4e2a\u524d\u63d0\u5c31\u662f\u4ed6\u63d0\u524d\u628a\u4f60\u7684\u6570\u636e\u7ed9\u5b58\u8d77\u6765\u4e86\u3002\u4f60\u5e73\u5e38\u64cd\u4f5c\u7684\u6240\u6709\u4fe1\u606f\u90fd\u662f\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u800c\u6211\u4eec\u771f\u6b63\u7684\u4fe1\u606f\u662f\u4fdd\u5b58\u5728\u786c\u76d8\u4e2d\u7684\uff0c\u5185\u5b58\u4e2d\u7684\u4fe1\u606f\u65ad\u7535\u4ee5\u540e\u5c31\u6d88\u5931\u4e86\uff0c\u786c\u76d8\u4e2d\u7684\u4fe1\u606f\u65ad\u7535\u4ee5\u540e\u8fd8\u53ef\u4ee5\u4fdd\u7559\u4e0b\u6765\uff01 \u6211\u4eec\u5c06\u6587\u4ef6\u7531\u5185\u5b58\u4e2d\u4fdd\u5b58\u5230\u786c\u76d8\u4e2d\u7684\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6211\u4eec\u53eb\u505a\u6570\u636e\u4fdd\u5b58\uff0c\u4e5f\u5c31\u53eb\u505a\u6301\u4e45\u5316\u3002\u4f46\u662f\u628a\u5b83\u4fdd\u5b58\u4e0b\u6765\u4e0d\u662f\u4f60\u7684\u76ee\u7684\uff0c\u6700\u7ec8\u4f60\u8fd8\u8981\u628a\u5b83\u518d\u8bfb\u53d6\u51fa\u6765\uff0c\u5b83\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6211\u4eec\u53eb\u505a\u6570\u636e\u6062\u590d\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684word\u4e3a\u4ec0\u4e48\u65ad\u7535\u4ee5\u540e\u8fd8\u80fd\u591f\u7ed9\u4f60\u4fdd\u7559\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u6267\u884c\u4e86\u4e00\u4e2a\u81ea\u52a8\u5907\u4efd\u7684\u8fc7\u7a0b\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7\u81ea\u52a8\u7684\u5f62\u5f0f\uff0c\u628a\u4f60\u7684\u6570\u636e\u5b58\u50a8\u8d77\u6765\uff0c\u90a3\u4e48\u6709\u4e86\u8fd9\u79cd\u5f62\u5f0f\u4ee5\u540e\uff0c\u6211\u4eec\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u7531\u5185\u5b58\u5230\u786c\u76d8\u4e0a\u5b9e\u73b0\u4fdd\u5b58\u3002 5.1.2 \u4ec0\u4e48\u662f\u6301\u4e45\u5316 \u00b6 (1)\u4ec0\u4e48\u662f\u6301\u4e45\u5316 \u5229\u7528\u6c38\u4e45\u6027\u5b58\u50a8\u4ecb\u8d28\u5c06\u6570\u636e\u8fdb\u884c\u4fdd\u5b58\uff0c\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u5c06\u4fdd\u5b58\u7684\u6570\u636e\u8fdb\u884c\u6062\u590d\u7684\u5de5\u4f5c\u673a\u5236\u79f0\u4e3a\u6301\u4e45\u5316 \u3002 \u6301\u4e45\u5316\u7528\u4e8e\u9632\u6b62\u6570\u636e\u7684\u610f\u5916\u4e22\u5931\uff0c\u786e\u4fdd\u6570\u636e\u5b89\u5168\u6027\u3002 (2)\u6301\u4e45\u5316\u8fc7\u7a0b\u4fdd\u5b58\u4ec0\u4e48\uff1f \u6211\u4eec\u77e5\u9053\u4e00\u70b9\uff0c\u8ba1\u7b97\u673a\u4e2d\u7684\u6570\u636e\u5168\u90e8\u90fd\u662f\u4e8c\u8fdb\u5236\uff0c\u5982\u679c\u73b0\u5728\u6211\u8981\u4f60\u7ed9\u6211\u4fdd\u5b58\u4e00\u7ec4\u6570\u636e\u7684\u8bdd\uff0c\u4f60\u6709\u4ec0\u4e48\u6837\u7684\u65b9\u5f0f\u5462\uff0c\u5176\u5b9e\u6700\u7b80\u5355\u7684\u5c31\u662f\u73b0\u5728\u957f\u4ec0\u4e48\u6837\uff0c\u6211\u5c31\u8bb0\u4e0b\u6765\u5c31\u884c\u4e86\uff0c\u90a3\u4e48\u8fd9\u79cd\u662f\u8bb0\u5f55\u7eaf\u7cb9\u7684\u6570\u636e\uff0c\u4e5f\u53eb\u505a\u5feb\u7167\u5b58\u50a8\uff0c\u4e5f\u5c31\u662f\u5b83\u4fdd\u5b58\u7684\u662f\u67d0\u4e00\u65f6\u523b\u7684\u6570\u636e\u72b6\u6001\u3002 \u8fd8\u6709\u4e00\u79cd\u5f62\u5f0f\uff0c\u5b83\u4e0d\u8bb0\u5f55\u4f60\u7684\u6570\u636e\uff0c\u5b83\u8bb0\u5f55\u4f60\u6240\u6709\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u6bd4\u5982\u8bf4\u5927\u5bb6\u7528idea\u7684\u65f6\u5019\uff0c\u6709\u6ca1\u6709\u9047\u5230\u8fc7\u5199\u9519\u4e86ctrl+z\u64a4\u9500\uff0c\u7136\u540ectrl+y\u8fd8\u80fd\u6062\u590d\uff0c\u8fd9\u4e2a\u5730\u65b9\u5b83\u4e5f\u662f\u5728\u8bb0\u5f55\uff0c\u4f46\u662f\u8bb0\u5f55\u7684\u662f\u4f60\u6240\u6709\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u90a3\u6211\u60f3\u95ee\u4e00\u4e0b\uff0c\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u6211\u90fd\u7ed9\u4f60\u7559\u4e0b\u6765\u4e86\uff0c\u4f60\u8bf4\u6570\u636e\u8fd8\u4f1a\u4e22\u5417\uff1f\u80af\u5b9a\u4e0d\u4f1a\u4e22\uff0c\u56e0\u4e3a\u4f60\u6240\u6709\u7684\u64cd\u4f5c\u8fc7\u7a0b\u6211\u90fd\u4fdd\u5b58\u4e86\u3002\u8fd9\u79cd\u4fdd\u5b58\u64cd\u4f5c\u8fc7\u7a0b\u7684\u5b58\u50a8\uff0c\u7528\u4e13\u4e1a\u672f\u8bed\u6765\u8bf4\u53ef\u4ee5\u8bf4\u662f\u65e5\u5fd7\uff0c\u8fd9\u662f\u4e24\u79cd\u4e0d\u540c\u7684\u4fdd\u5b58\u6570\u636e\u7684\u5f62\u5f0f\u554a\u3002 \u603b\u7ed3\u4e00\u4e0b\uff1a \u7b2c\u4e00\u79cd\uff1a\u5c06\u5f53\u524d\u6570\u636e\u72b6\u6001\u8fdb\u884c\u4fdd\u5b58\uff0c\u5feb\u7167\u5f62\u5f0f\uff0c\u5b58\u50a8\u6570\u636e\u7ed3\u679c\uff0c\u5b58\u50a8\u683c\u5f0f\u7b80\u5355\uff0c\u5173\u6ce8\u70b9\u5728\u6570\u636e\u3002 \u7b2c\u4e8c\u79cd\uff1a\u5c06\u6570\u636e\u7684\u64cd\u4f5c\u8fc7\u7a0b\u8fdb\u884c\u4fdd\u5b58\uff0c\u65e5\u5fd7\u5f62\u5f0f\uff0c\u5b58\u50a8\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u5b58\u50a8\u683c\u5f0f\u590d\u6742\uff0c\u5173\u6ce8\u70b9\u5728\u6570\u636e\u7684\u64cd\u4f5c\u8fc7\u7a0b\u3002 5.2 RDB \u00b6 5.2.1 save\u6307\u4ee4 \u00b6 \u624b\u52a8\u6267\u884c\u4e00\u6b21\u4fdd\u5b58\u64cd\u4f5c save save\u6307\u4ee4\u76f8\u5173\u914d\u7f6e \u8bbe\u7f6e\u672c\u5730\u6570\u636e\u5e93\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u503c\u4e3a dump.rdb\uff0c\u901a\u5e38\u8bbe\u7f6e\u4e3adump-\u7aef\u53e3\u53f7.rdb dbfilename filename \u8bbe\u7f6e\u5b58\u50a8.rdb\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u901a\u5e38\u8bbe\u7f6e\u6210\u5b58\u50a8\u7a7a\u95f4\u8f83\u5927\u7684\u76ee\u5f55\u4e2d\uff0c\u76ee\u5f55\u540d\u79f0data dir path \u8bbe\u7f6e\u5b58\u50a8\u81f3\u672c\u5730\u6570\u636e\u5e93\u65f6\u662f\u5426\u538b\u7f29\u6570\u636e\uff0c\u9ed8\u8ba4yes\uff0c\u8bbe\u7f6e\u4e3ano\uff0c\u8282\u7701 CPU \u8fd0\u884c\u65f6\u95f4\uff0c\u4f46\u5b58\u50a8\u6587\u4ef6\u53d8\u5927 rdbcompression yes|no \u8bbe\u7f6e\u8bfb\u5199\u6587\u4ef6\u8fc7\u7a0b\u662f\u5426\u8fdb\u884cRDB\u683c\u5f0f\u6821\u9a8c\uff0c\u9ed8\u8ba4yes\uff0c\u8bbe\u7f6e\u4e3ano\uff0c\u8282\u7ea6\u8bfb\u519910%\u65f6\u95f4\u6d88\u8017\uff0c\u5355\u5b58\u5728\u6570\u636e\u635f\u574f\u7684\u98ce\u9669 rdbchecksum yes|no save\u6307\u4ee4\u5de5\u4f5c\u539f\u7406 \u9700\u8981\u6ce8\u610f\u4e00\u4e2a\u95ee\u9898\uff0c\u6765\u770b\u4e00\u4e0b\uff0c\u73b0\u5728\u6709\u56db\u4e2a\u5ba2\u6237\u7aef\u5404\u81ea\u8981\u6267\u884c\u4e00\u4e2a\u6307\u4ee4\uff0c\u628a\u8fd9\u4e9b\u6307\u4ee4\u53d1\u9001\u5230redis\u670d\u52a1\u5668\u540e\uff0c\u4ed6\u4eec\u6267\u884c\u6709\u4e00\u4e2a\u5148\u540e\u987a\u5e8f\u95ee\u9898\uff0c\u5047\u5b9a\u5c31\u662f\u6309\u71671234\u7684\u987a\u5e8f\u653e\u8fc7\u53bb\u7684\u8bdd\uff0c\u90a3\u4f1a\u662f\u4ec0\u4e48\u6837\u7684\uff1f \u8bb0\u5f97redis\u662f\u4e2a\u5355\u7ebf\u7a0b\u7684\u5de5\u4f5c\u6a21\u5f0f\uff0c\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\u961f\u5217\uff0c\u6240\u6709\u7684\u547d\u4ee4\u90fd\u4f1a\u8fdb\u5230\u8fd9\u4e2a\u961f\u5217\u91cc\u8fb9\uff0c\u5728\u8fd9\u513f\u6392\u961f\u6267\u884c\uff0c\u6267\u884c\u5b8c\u4e00\u4e2a\u6d88\u5931\u4e00\u4e2a\uff0c\u5f53\u6240\u6709\u7684\u547d\u4ee4\u90fd\u6267\u884c\u5b8c\u4e86\uff0cOK\uff0c\u7ed3\u679c\u8fbe\u5230\u4e86\u3002 \u4f46\u662f\u5982\u679c\u73b0\u5728\u6211\u4eec\u6267\u884c\u7684\u65f6\u5019save\u6307\u4ee4\u4fdd\u5b58\u7684\u6570\u636e\u91cf\u5f88\u5927\u4f1a\u662f\u4ec0\u4e48\u73b0\u8c61\u5462\uff1f \u4ed6\u4f1a\u975e\u5e38\u8017\u65f6\uff0c\u4ee5\u81f3\u4e8e\u5f71\u54cd\u5230\u5b83\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u540e\u9762\u7684\u6307\u4ee4\u90fd\u8981\u7b49\uff0c\u6240\u4ee5\u8bf4\u8fd9\u79cd\u6a21\u5f0f\u662f\u4e0d\u53cb\u597d\u7684\uff0c\u8fd9\u662fsave\u6307\u4ee4\u5bf9\u5e94\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u5f53cpu\u6267\u884c\u7684\u65f6\u5019\u4f1a\u963b\u585eredis\u670d\u52a1\u5668\uff0c\u76f4\u5230\u4ed6\u6267\u884c\u5b8c\u6bd5\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u4e0d\u5efa\u8bae\u5927\u5bb6\u5728\u7ebf\u4e0a\u73af\u5883\u7528save\u6307\u4ee4\u3002 5.2.2 bgsave\u6307\u4ee4 \u00b6 \u4e4b\u524d\u6211\u4eec\u8bb2\u5230\u4e86\u5f53save\u6307\u4ee4\u7684\u6570\u636e\u91cf\u8fc7\u5927\u65f6\uff0c\u5355\u7ebf\u7a0b\u6267\u884c\u65b9\u5f0f\u9020\u6210\u6548\u7387\u8fc7\u4f4e\uff0c\u90a3\u5e94\u8be5\u5982\u4f55\u5904\u7406\uff1f \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\uff1a bgsave \u6307\u4ee4\uff0cbg\u5176\u5b9e\u662fbackground\u7684\u610f\u601d\uff0c\u540e\u53f0\u6267\u884c\u7684\u610f\u601d \u624b\u52a8\u542f\u52a8\u540e\u53f0\u4fdd\u5b58\u64cd\u4f5c\uff0c\u4f46\u4e0d\u662f\u7acb\u5373\u6267\u884c bgsave bgsave\u6307\u4ee4\u76f8\u5173\u914d\u7f6e \u540e\u53f0\u5b58\u50a8\u8fc7\u7a0b\u4e2d\u5982\u679c\u51fa\u73b0\u9519\u8bef\u73b0\u8c61\uff0c\u662f\u5426\u505c\u6b62\u4fdd\u5b58\u64cd\u4f5c\uff0c\u9ed8\u8ba4yes stop-writes-on-bgsave-error yes|no \u5176 \u4ed6 dbfilename filename dir path rdbcompression yes|no rdbchecksum yes|no bgsave\u6307\u4ee4\u5de5\u4f5c\u539f\u7406 \u5f53\u6267\u884cbgsave\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u7aef\u53d1\u51fabgsave\u6307\u4ee4\u7ed9\u5230redis\u670d\u52a1\u5668\u3002\u6ce8\u610f\uff0c\u8fd9\u4e2a\u65f6\u5019\u670d\u52a1\u5668\u9a6c\u4e0a\u56de\u4e00\u4e2a\u7ed3\u679c\u544a\u8bc9\u5ba2\u6237\u7aef\u540e\u53f0\u5df2\u7ecf\u5f00\u59cb\u4e86\uff0c\u4e0e\u6b64\u540c\u65f6\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u4f7f\u7528Linux\u7684fork\u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8ba9\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\u53bb\u6267\u884csave\u76f8\u5173\u7684\u64cd\u4f5c\uff0c\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u60f3\u4e00\u4e0b\uff0c\u6211\u4eec\u4e3b\u8fdb\u7a0b\u4e00\u76f4\u5728\u5904\u7406\u6307\u4ee4\uff0c\u800c\u5b50\u8fdb\u7a0b\u5728\u6267\u884c\u540e\u53f0\u7684\u4fdd\u5b58\uff0c\u5b83\u4f1a\u4e0d\u4f1a\u5e72\u6270\u5230\u4e3b\u8fdb\u7a0b\u7684\u6267\u884c\u5417\uff1f \u7b54\u6848\u662f\u4e0d\u4f1a\uff0c\u6240\u4ee5\u8bf4\u4ed6\u624d\u662f\u4e3b\u6d41\u65b9\u6848\u3002\u5b50\u8fdb\u7a0b\u5f00\u59cb\u6267\u884c\u4e4b\u540e\uff0c\u5b83\u5c31\u4f1a\u521b\u5efa\u554aRDB\u6587\u4ef6\u628a\u5b83\u5b58\u8d77\u6765\uff0c\u64cd\u4f5c\u5b8c\u4ee5\u540e\u4ed6\u4f1a\u628a\u8fd9\u4e2a\u7ed3\u679c\u8fd4\u56de\uff0c\u4e5f\u5c31\u662f\u8bf4bgsave\u7684\u8fc7\u7a0b\u5206\u6210\u4e24\u4e2a\u8fc7\u7a0b\uff0c\u7b2c\u4e00\u4e2a\u662f\u670d\u52a1\u7aef\u62ff\u5230\u6307\u4ee4\u76f4\u63a5\u544a\u8bc9\u5ba2\u6237\u7aef\u5f00\u59cb\u6267\u884c\u4e86\uff1b\u53e6\u5916\u4e00\u4e2a\u8fc7\u7a0b\u662f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5728\u5b8c\u6210\u540e\u53f0\u7684\u4fdd\u5b58\u64cd\u4f5c\uff0c\u64cd\u4f5c\u5b8c\u4ee5\u540e\u56de\u4e00\u4e2a\u6d88\u606f\u3002 5.2.3 save\u914d\u7f6e\u81ea\u52a8\u6267\u884c \u00b6 \u8bbe\u7f6e\u81ea\u52a8\u6301\u4e45\u5316\u7684\u6761\u4ef6\uff0c\u6ee1\u8db3\u9650\u5b9a\u65f6\u95f4\u8303\u56f4\u5185key\u7684\u53d8\u5316\u6570\u91cf\u8fbe\u5230\u6307\u5b9a\u6570\u91cf\u5373\u8fdb\u884c\u6301\u4e45\u5316 save second changes \u53c2\u6570 second\uff1a\u76d1\u63a7\u65f6\u95f4\u8303\u56f4 changes\uff1a\u76d1\u63a7key\u7684\u53d8\u5316\u91cf \u8303\u4f8b\uff1a save 900 1 save 300 10 save 60 10000 \u5176\u4ed6\u76f8\u5173\u914d\u7f6e\uff1a dbfilename filename dir path rdbcompression yes|no rdbchecksum yes|no stop-writes-on-bgsave-error yes|no save\u914d\u7f6e\u5de5\u4f5c\u539f\u7406 5.2.4 RDB\u4e09\u79cd\u542f\u52a8\u65b9\u5f0f\u5bf9\u6bd4 \u00b6 \u65b9\u5f0f save\u6307\u4ee4 bgsave\u6307\u4ee4 \u8bfb\u5199 \u540c\u6b65 \u5f02\u6b65 \u963b\u585e\u5ba2\u6237\u7aef\u6307\u4ee4 \u662f \u5426 \u989d\u5916\u5185\u5b58\u6d88\u8017 \u5426 \u662f \u542f\u52a8\u65b0\u8fdb\u7a0b \u5426 \u662f RDB\u7279\u6b8a\u542f\u52a8\u5f62\u5f0f \u670d\u52a1\u5668\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u91cd\u542f debug reload \u5173\u95ed\u670d\u52a1\u5668\u65f6\u6307\u5b9a\u4fdd\u5b58\u6570\u636e shutdown save \u5168\u91cf\u590d\u5236\uff08\u5728\u4e3b\u4ece\u590d\u5236\u4e2d\u8be6\u7ec6\u8bb2\u89e3\uff09 RDB\u4f18\u70b9\uff1a RDB\u662f\u4e00\u4e2a\u7d27\u51d1\u538b\u7f29\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5b58\u50a8\u6548\u7387\u8f83\u9ad8 RDB\u5185\u90e8\u5b58\u50a8\u7684\u662fredis\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u7684\u6570\u636e\u5feb\u7167\uff0c\u975e\u5e38\u9002\u5408\u7528\u4e8e\u6570\u636e\u5907\u4efd\uff0c\u5168\u91cf\u590d\u5236\u7b49\u573a\u666f RDB\u6062\u590d\u6570\u636e\u7684\u901f\u5ea6\u8981\u6bd4AOF\u5feb\u5f88\u591a \u5e94\u7528\uff1a\u670d\u52a1\u5668\u4e2d\u6bcfX\u5c0f\u65f6\u6267\u884cbgsave\u5907\u4efd\uff0c\u5e76\u5c06RDB\u6587\u4ef6\u62f7\u8d1d\u5230\u8fdc\u7a0b\u673a\u5668\u4e2d\uff0c\u7528\u4e8e\u707e\u96be\u6062\u590d\u3002 RDB\u7f3a\u70b9 RDB\u65b9\u5f0f\u65e0\u8bba\u662f\u6267\u884c\u6307\u4ee4\u8fd8\u662f\u5229\u7528\u914d\u7f6e\uff0c\u65e0\u6cd5\u505a\u5230\u5b9e\u65f6\u6301\u4e45\u5316\uff0c\u5177\u6709\u8f83\u5927\u7684\u53ef\u80fd\u6027\u4e22\u5931\u6570\u636e bgsave\u6307\u4ee4\u6bcf\u6b21\u8fd0\u884c\u8981\u6267\u884cfork\u64cd\u4f5c\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u8981\u727a\u7272\u6389\u4e00\u4e9b\u6027\u80fd Redis\u7684\u4f17\u591a\u7248\u672c\u4e2d\u672a\u8fdb\u884cRDB\u6587\u4ef6\u683c\u5f0f\u7684\u7248\u672c\u7edf\u4e00\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u5404\u7248\u672c\u670d\u52a1\u4e4b\u95f4\u6570\u636e\u683c\u5f0f\u65e0\u6cd5\u517c\u5bb9\u73b0\u8c61 5.3 AOF \u00b6 \u4e3a\u4ec0\u4e48\u8981\u6709AOF,\u8fd9\u5f97\u4eceRDB\u7684\u5b58\u50a8\u7684\u5f0a\u7aef\u8bf4\u8d77\uff1a \u5b58\u50a8\u6570\u636e\u91cf\u8f83\u5927\uff0c\u6548\u7387\u8f83\u4f4e\uff0c\u57fa\u4e8e\u5feb\u7167\u601d\u60f3\uff0c\u6bcf\u6b21\u8bfb\u5199\u90fd\u662f\u5168\u90e8\u6570\u636e\uff0c\u5f53\u6570\u636e\u91cf\u5de8\u5927\u65f6\uff0c\u6548\u7387\u975e\u5e38\u4f4e \u5927\u6570\u636e\u91cf\u4e0b\u7684IO\u6027\u80fd\u8f83\u4f4e \u57fa\u4e8efork\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u5185\u5b58\u4ea7\u751f\u989d\u5916\u6d88\u8017 \u5b95\u673a\u5e26\u6765\u7684\u6570\u636e\u4e22\u5931\u98ce\u9669 \u90a3\u89e3\u51b3\u7684\u601d\u8def\u662f\u4ec0\u4e48\u5462\uff1f \u4e0d\u5199\u5168\u6570\u636e\uff0c\u4ec5\u8bb0\u5f55\u90e8\u5206\u6570\u636e \u964d\u4f4e\u533a\u5206\u6570\u636e\u662f\u5426\u6539\u53d8\u7684\u96be\u5ea6\uff0c\u6539\u8bb0\u5f55\u6570\u636e\u4e3a\u8bb0\u5f55\u64cd\u4f5c\u8fc7\u7a0b \u5bf9\u6240\u6709\u64cd\u4f5c\u5747\u8fdb\u884c\u8bb0\u5f55\uff0c\u6392\u9664\u4e22\u5931\u6570\u636e\u7684\u98ce\u9669 5.3.1 AOF\u6982\u5ff5 \u00b6 AOF (append only file)\u6301\u4e45\u5316\uff1a\u4ee5\u72ec\u7acb\u65e5\u5fd7\u7684\u65b9\u5f0f\u8bb0\u5f55\u6bcf\u6b21\u5199\u547d\u4ee4\uff0c\u91cd\u542f\u65f6\u518d\u91cd\u65b0\u6267\u884cAOF\u6587\u4ef6\u4e2d\u547d\u4ee4 \u8fbe\u5230\u6062\u590d\u6570\u636e\u7684\u76ee\u7684\u3002 \u4e0eRDB\u76f8\u6bd4\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u7531\u8bb0\u5f55\u6570\u636e\u6539\u4e3a\u8bb0\u5f55\u6570\u636e\u4ea7\u751f\u7684\u53d8\u5316 AOF\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u89e3\u51b3\u4e86\u6570\u636e\u6301\u4e45\u5316\u7684\u5b9e\u65f6\u6027\uff0c\u76ee\u524d\u5df2\u7ecf\u662fRedis\u6301\u4e45\u5316\u7684\u4e3b\u6d41\u65b9\u5f0f AOF\u5199\u6570\u636e\u8fc7\u7a0b \u542f\u52a8AOF\u76f8\u5173\u914d\u7f6e \u5f00\u542fAOF\u6301\u4e45\u5316\u529f\u80fd\uff0c\u9ed8\u8ba4no\uff0c\u5373\u4e0d\u5f00\u542f\u72b6\u6001 appendonly yes|no AOF\u6301\u4e45\u5316\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u6587\u4ef6\u540d\u4e3aappendonly.aof\uff0c\u5efa\u8bae\u914d\u7f6e\u4e3aappendonly-\u7aef\u53e3\u53f7.aof appendfilename filename AOF\u6301\u4e45\u5316\u6587\u4ef6\u4fdd\u5b58\u8def\u5f84\uff0c\u4e0eRDB\u6301\u4e45\u5316\u6587\u4ef6\u4fdd\u6301\u4e00\u81f4\u5373\u53ef dir AOF\u5199\u6570\u636e\u7b56\u7565\uff0c\u9ed8\u8ba4\u4e3aeverysec appendfsync always|everysec|no 5.3.2 AOF\u6267\u884c\u7b56\u7565 \u00b6 AOF\u5199\u6570\u636e\u4e09\u79cd\u7b56\u7565(appendfsync) always (\u6bcf\u6b21\uff09\uff1a\u6bcf\u6b21\u5199\u5165\u64cd\u4f5c\u5747\u540c\u6b65\u5230AOF\u6587\u4ef6\u4e2d\u6570\u636e\u96f6\u8bef\u5dee\uff0c\u6027\u80fd\u8f83\u4f4e\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002 everysec \uff08\u6bcf\u79d2\uff09\uff1a\u6bcf\u79d2\u5c06\u7f13\u51b2\u533a\u4e2d\u7684\u6307\u4ee4\u540c\u6b65\u5230AOF\u6587\u4ef6\u4e2d\uff0c\u5728\u7cfb\u7edf\u7a81\u7136\u5b95\u673a\u7684\u60c5\u51b5\u4e0b\u4e22\u59311\u79d2\u5185\u7684\u6570\u636e \u6570\u636e\u51c6\u786e\u6027\u8f83\u9ad8\uff0c\u6027\u80fd\u8f83\u9ad8\uff0c\u5efa\u8bae\u4f7f\u7528\uff0c\u4e5f\u662f\u9ed8\u8ba4\u914d\u7f6e no \uff08\u7cfb\u7edf\u63a7\u5236\uff09\uff1a\u7531\u64cd\u4f5c\u7cfb\u7edf\u63a7\u5236\u6bcf\u6b21\u540c\u6b65\u5230AOF\u6587\u4ef6\u7684\u5468\u671f\uff0c\u6574\u4f53\u8fc7\u7a0b\u4e0d\u53ef\u63a7 5.3.3 AOF\u91cd\u5199 \u00b6 \u573a\u666f\uff1aAOF\u5199\u6570\u636e\u9047\u5230\u7684\u95ee\u9898\uff0c\u5982\u679c\u8fde\u7eed\u6267\u884c\u5982\u4e0b\u6307\u4ee4\u8be5\u5982\u4f55\u5904\u7406 \u4ec0\u4e48\u53ebAOF\u91cd\u5199\uff1f \u968f\u7740\u547d\u4ee4\u4e0d\u65ad\u5199\u5165AOF\uff0c\u6587\u4ef6\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cRedis\u5f15\u5165\u4e86AOF\u91cd\u5199\u673a\u5236\u538b\u7f29\u6587\u4ef6\u4f53\u79ef\u3002AOF\u6587\u4ef6\u91cd \u5199\u662f\u5c06Redis\u8fdb\u7a0b\u5185\u7684\u6570\u636e\u8f6c\u5316\u4e3a\u5199\u547d\u4ee4\u540c\u6b65\u5230\u65b0AOF\u6587\u4ef6\u7684\u8fc7\u7a0b\u3002\u7b80\u5355\u8bf4\u5c31\u662f\u5c06\u5bf9\u540c\u4e00\u4e2a\u6570\u636e\u7684\u82e5\u5e72\u4e2a\u6761\u547d\u4ee4\u6267\u884c\u7ed3 \u679c\u8f6c\u5316\u6210\u6700\u7ec8\u7ed3\u679c\u6570\u636e\u5bf9\u5e94\u7684\u6307\u4ee4\u8fdb\u884c\u8bb0\u5f55\u3002 AOF\u91cd\u5199\u4f5c\u7528 \u964d\u4f4e\u78c1\u76d8\u5360\u7528\u91cf\uff0c\u63d0\u9ad8\u78c1\u76d8\u5229\u7528\u7387 \u63d0\u9ad8\u6301\u4e45\u5316\u6548\u7387\uff0c\u964d\u4f4e\u6301\u4e45\u5316\u5199\u65f6\u95f4\uff0c\u63d0\u9ad8IO\u6027\u80fd \u964d\u4f4e\u6570\u636e\u6062\u590d\u7528\u65f6\uff0c\u63d0\u9ad8\u6570\u636e\u6062\u590d\u6548\u7387 AOF\u91cd\u5199\u89c4\u5219 \u8fdb\u7a0b\u5185\u5177\u6709\u65f6\u6548\u6027\u7684\u6570\u636e\uff0c\u5e76\u4e14\u6570\u636e\u5df2\u8d85\u65f6\u5c06\u4e0d\u518d\u5199\u5165\u6587\u4ef6 \u975e\u5199\u5165\u7c7b\u7684\u65e0\u6548\u6307\u4ee4\u5c06\u88ab\u5ffd\u7565\uff0c\u53ea\u4fdd\u7559\u6700\u7ec8\u6570\u636e\u7684\u5199\u5165\u547d\u4ee4 \u5982del key1\u3001 hdel key2\u3001srem key3\u3001set key4 111\u3001set key4 222\u7b49 \u5982select\u6307\u4ee4\u867d\u7136\u4e0d\u66f4\u6539\u6570\u636e\uff0c\u4f46\u662f\u66f4\u6539\u4e86\u6570\u636e\u7684\u5b58\u50a8\u4f4d\u7f6e\uff0c\u6b64\u7c7b\u547d\u4ee4\u540c\u6837\u9700\u8981\u8bb0\u5f55 \u5bf9\u540c\u4e00\u6570\u636e\u7684\u591a\u6761\u5199\u547d\u4ee4\u5408\u5e76\u4e3a\u4e00\u6761\u547d\u4ee4 \u5982lpushlist1 a\u3001lpush list1 b\u3001lpush list1 c\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff1alpush list1 a b c\u3002 \u4e3a\u9632\u6b62\u6570\u636e\u91cf\u8fc7\u5927\u9020\u6210\u5ba2\u6237\u7aef\u7f13\u51b2\u533a\u6ea2\u51fa\uff0c\u5bf9list\u3001set\u3001hash\u3001zset\u7b49\u7c7b\u578b\uff0c\u6bcf\u6761\u6307\u4ee4\u6700\u591a\u5199\u516564\u4e2a\u5143\u7d20 AOF\u91cd\u5199\u65b9\u5f0f \u624b\u52a8\u91cd\u5199 bgrewriteaof \u624b\u52a8\u91cd\u5199\u539f\u7406\u5206\u6790\uff1a \u81ea\u52a8\u91cd\u5199 auto-aof-rewrite-min-size size auto-aof-rewrite-percentage percentage \u81ea\u52a8\u91cd\u5199\u89e6\u53d1\u6761\u4ef6\u8bbe\u7f6e auto-aof-rewrite-min-size size auto-aof-rewrite-percentage percent \u81ea\u52a8\u91cd\u5199\u89e6\u53d1\u6bd4\u5bf9\u53c2\u6570\uff08 \u8fd0\u884c\u6307\u4ee4info Persistence\u83b7\u53d6\u5177\u4f53\u4fe1\u606f \uff09 aof_current_size aof_base_size \u81ea\u52a8\u91cd\u5199\u89e6\u53d1\u6761\u4ef6\u516c\u5f0f\uff1a 5.3.4 AOF\u5de5\u4f5c\u6d41\u7a0b\u53ca\u91cd\u5199\u6d41\u7a0b \u00b6 5.4 RDB\u4e0eAOF\u533a\u522b \u00b6 5.4.1 RDB\u4e0eAOF\u5bf9\u6bd4\uff08\u4f18\u7f3a\u70b9\uff09 \u00b6 \u6301\u4e45\u5316\u65b9\u5f0f RDB AOF \u5360\u7528\u5b58\u50a8\u7a7a\u95f4 \u5c0f\uff08\u6570\u636e\u7ea7\uff1a\u538b\u7f29\uff09 \u5927\uff08\u6307\u4ee4\u7ea7\uff1a\u91cd\u5199\uff09 \u5b58\u50a8\u901f\u5ea6 \u6162 \u5feb \u6062\u590d\u901f\u5ea6 \u5feb \u6162 \u6570\u636e\u5b89\u5168\u6027 \u4f1a\u4e22\u5931\u6570\u636e \u4f9d\u636e\u7b56\u7565\u51b3\u5b9a \u8d44\u6e90\u6d88\u8017 \u9ad8/\u91cd\u91cf\u7ea7 \u4f4e/\u8f7b\u91cf\u7ea7 \u542f\u52a8\u4f18\u5148\u7ea7 \u4f4e \u9ad8 5.4.2 RDB\u4e0eAOF\u5e94\u7528\u573a\u666f \u00b6 RDB\u4e0eAOF\u7684\u9009\u62e9\u4e4b\u60d1 \u5bf9\u6570\u636e\u975e\u5e38\u654f\u611f\uff0c\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u7684AOF\u6301\u4e45\u5316\u65b9\u6848 AOF\u6301\u4e45\u5316\u7b56\u7565\u4f7f\u7528everysecond\uff0c\u6bcf\u79d2\u949ffsync\u4e00\u6b21\u3002\u8be5\u7b56\u7565redis\u4ecd\u53ef\u4ee5\u4fdd\u6301\u5f88\u597d\u7684\u5904\u7406\u6027\u80fd\uff0c\u5f53\u51fa \u73b0\u95ee\u9898\u65f6\uff0c\u6700\u591a\u4e22\u59310-1\u79d2\u5185\u7684\u6570\u636e\u3002 \u6ce8\u610f\uff1a\u7531\u4e8eAOF\u6587\u4ef6\u5b58\u50a8\u4f53\u79ef\u8f83\u5927\uff0c\u4e14\u6062\u590d\u901f\u5ea6\u8f83\u6162 \u6570\u636e\u5448\u73b0\u9636\u6bb5\u6709\u6548\u6027\uff0c\u5efa\u8bae\u4f7f\u7528RDB\u6301\u4e45\u5316\u65b9\u6848 \u6570\u636e\u53ef\u4ee5\u826f\u597d\u7684\u505a\u5230\u9636\u6bb5\u5185\u65e0\u4e22\u5931\uff08\u8be5\u9636\u6bb5\u662f\u5f00\u53d1\u8005\u6216\u8fd0\u7ef4\u4eba\u5458\u624b\u5de5\u7ef4\u62a4\u7684\uff09\uff0c\u4e14\u6062\u590d\u901f\u5ea6\u8f83\u5feb\uff0c\u9636\u6bb5 \u70b9\u6570\u636e\u6062\u590d\u901a\u5e38\u91c7\u7528RDB\u65b9\u6848 \u6ce8\u610f\uff1a\u5229\u7528RDB\u5b9e\u73b0\u7d27\u51d1\u7684\u6570\u636e\u6301\u4e45\u5316\u4f1a\u4f7fRedis\u964d\u7684\u5f88\u4f4e\uff0c\u614e\u91cd\u603b\u7ed3\uff1a \u7efc\u5408\u6bd4\u5bf9 RDB\u4e0eAOF\u7684\u9009\u62e9\u5b9e\u9645\u4e0a\u662f\u5728\u505a\u4e00\u79cd\u6743\u8861\uff0c\u6bcf\u79cd\u90fd\u6709\u5229\u6709\u5f0a \u5982\u4e0d\u80fd\u627f\u53d7\u6570\u5206\u949f\u4ee5\u5185\u7684\u6570\u636e\u4e22\u5931\uff0c\u5bf9\u4e1a\u52a1\u6570\u636e\u975e\u5e38\u654f\u611f\uff0c\u9009\u7528AOF \u5982\u80fd\u627f\u53d7\u6570\u5206\u949f\u4ee5\u5185\u7684\u6570\u636e\u4e22\u5931\uff0c\u4e14\u8ffd\u6c42\u5927\u6570\u636e\u96c6\u7684\u6062\u590d\u901f\u5ea6\uff0c\u9009\u7528RDB \u707e\u96be\u6062\u590d\u9009\u7528RDB \u53cc\u4fdd\u9669\u7b56\u7565\uff0c\u540c\u65f6\u5f00\u542f RDB\u548c AOF\uff0c\u91cd\u542f\u540e\uff0cRedis\u4f18\u5148\u4f7f\u7528 AOF \u6765\u6062\u590d\u6570\u636e\uff0c\u964d\u4f4e\u4e22\u5931\u6570\u636e\u7684\u91cf # \u5ba2\u6237\u7aef\u600e\u4e48\u8bbf\u95ee\u90fd\u884c bind 0 .0.0.0 port 6379 timeout 0 # \u540e\u53f0\u542f\u52a8 daemonize yes logfile \"log_6379.log\" dir /usr/local/redis/data # rdb \u65b9\u5f0f\u6587\u4ef6\u540d\u79f0 dbfilename \"dump6379.rdb\" # \u5b58\u50a8\u7b56\u7565 2s \u4e2d\u5185\u5982\u679c\u6709\u4e24\u4e2a \u4fee\u6539\u547d\u4ee4 \u5219\u6267\u884c\u5b58\u50a8 save 2 2 # aop \u914d\u7f6e appendonly yes appendfilename \"dump6379.aof\" appendfsync always # aof \u81ea\u52a8\u91cd\u5199 # \u6bcf4M \u6570\u636e \u91cd\u5199\u4e00\u6b21 auto-aof-rewrite-min-size 4mb # \u548c\u4e0a\u6b21\u5907\u4efd\u505a\u5bf9\u6bd4,\u5982\u679c \u8d85\u8fc7\u4e8610% \u5219\u91cd\u5199\u6587\u4ef6 auto-aof-rewrite-percentage 10 %","title":"day01"},{"location":"redis/day01/#1_redis","text":"","title":"1. Redis \u7b80\u4ecb"},{"location":"redis/day01/#redis","text":"\u672c\u8bfe\u7a0b\u6240\u793a\uff0c\u5747\u57fa\u4e8eCenter OS7\u5b89\u88c5Redis\u3002 0 ) \u5982\u679c wget \u547d\u4ee4\u627e\u4e0d\u5230 yum - y install wget 0 ) \u5982\u679cmake \u62a5\u9519 \u5b89\u88c5 c \u8bed\u8a00\u7f16\u8bd1\u73af\u5883 yum install gcc - c ++ (1)\u4e0b\u8f7dRedis \u4e0b\u8f7d\u5b89\u88c5\u5305\uff1a wget http://download.redis.io/releases/redis-5.0.0.tar.gz \u89e3\u538b\u5b89\u88c5\u5305\uff1a tar -xvf redis-5.0.0.tar.gz \u7f16\u8bd1\uff08\u5728\u89e3\u538b\u7684\u76ee\u5f55\u4e2d\u6267\u884c\uff09\uff1a make \u5b89\u88c5\uff08\u5728\u89e3\u538b\u7684\u76ee\u5f55\u4e2d\u6267\u884c\uff09\uff1a make install \uff082\uff09\u5b89\u88c5 Redis redis-server\uff0c\u670d\u52a1\u5668\u542f\u52a8\u547d\u4ee4 \u5ba2\u6237\u7aef\u542f\u52a8\u547d\u4ee4 redis-cli\uff0credis\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6 redis.conf\uff0cRDB\u6587\u4ef6\u68c0\u67e5\u5de5\u5177\uff08\u5feb\u7167\u6301\u4e45\u5316\u6587\u4ef6\uff09 redis-check-dump\uff0cAOF\u6587\u4ef6\u4fee\u590d\u5de5\u5177 redis-check-aof","title":"Redis \u7684\u4e0b\u8f7d\u4e0e\u5b89\u88c5"},{"location":"redis/day01/#redis_1","text":"","title":"Redis\u670d\u52a1\u5668\u542f\u52a8"},{"location":"redis/day01/#redis_2","text":"\u542f\u52a8\u670d\u52a1\u5668\u2014\u2014\u53c2\u6570\u542f\u52a8 redis-server [ --port port ] \u8303\u4f8b redis-server --port 6379 \u542f\u52a8\u670d\u52a1\u5668\u2014\u2014\u914d\u7f6e\u6587\u4ef6\u542f\u52a8 redis-server config_file_name \u8303\u4f8b redis-server redis.conf","title":"Redis\u670d\u52a1\u5668\u542f\u52a8"},{"location":"redis/day01/#redis_3","text":"\u542f\u52a8\u5ba2\u6237\u7aef redis-cli [ -h host ] [ -p port ] \u8303 \u4f8b redis-cli -h 61 .129.65.248 -p 6384 \u6ce8\u610f\uff1a\u670d\u52a1\u5668\u542f\u52a8\u6307\u5b9a\u7aef\u53e3\u4f7f\u7528\u7684\u662f--port\uff0c\u5ba2\u6237\u7aef\u542f\u52a8\u6307\u5b9a\u7aef\u53e3\u4f7f\u7528\u7684\u662f-p\u3002-\u7684\u6570\u91cf\u4e0d\u540c\u3002","title":"Redis\u5ba2\u6237\u7aef\u542f\u52a8"},{"location":"redis/day01/#redis_4","text":"\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u5b58\u50a8\u76ee\u5f55 mkdir conf \u521b\u5efa\u670d\u52a1\u5668\u6587\u4ef6\u5b58\u50a8\u76ee\u5f55\uff08\u5305\u542b\u65e5\u5fd7\u3001\u6570\u636e\u3001\u4e34\u65f6\u914d\u7f6e\u6587\u4ef6\u7b49\uff09 mkdir data \u521b\u5efa\u5feb\u901f\u8bbf\u95ee\u94fe\u63a5 ln -s redis-5.0.0 redis","title":"Redis\u57fa\u7840\u73af\u5883\u8bbe\u7f6e\u7ea6\u5b9a"},{"location":"redis/day01/#_1","text":"# \u67e5\u770b\u914d\u7f6e\u547d\u4ee4 cat redis.conf | grep -v '#' | grep -v '^$' # \u90a3\u4e9bip \u80fd\u8bbf\u95eeredis #bind 127.0.0.1 # \u7aef\u53e3\u53f7 port 6379 # \u8d85\u65f6\u65f6\u95f4 #timeout 0 # \u662f\u5426\u540e\u53f0\u542f\u52a8 daemonize yes # \u65e5\u5fd7\u6587\u4ef6 logfile \"log_6379.log\" # \u6570\u636e\u6587\u4ef6\u4f4d\u7f6e dir /usr/local/redis/data","title":"\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\u4e0e\u5e38\u7528\u914d\u7f6e"},{"location":"redis/day01/#_2","text":"\u8bbe\u7f6e\u670d\u52a1\u5668\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fd0\u884c\uff0c\u5f00\u542f\u540e\u670d\u52a1\u5668\u63a7\u5236\u53f0\u4e2d\u5c06\u6253\u5370\u670d\u52a1\u5668\u8fd0\u884c\u4fe1\u606f\uff08\u540c\u65e5\u5fd7\u5185\u5bb9\u76f8\u540c\uff09 daemonize yes | no \u7ed1\u5b9a\u4e3b\u673a\u5730\u5740 bind ip \u8bbe\u7f6e\u670d\u52a1\u5668\u7aef\u53e3 port port \u8bbe\u7f6e\u670d\u52a1\u5668\u6587\u4ef6\u4fdd\u5b58\u5730\u5740 dir path","title":"\u670d\u52a1\u5668\u7aef\u8bbe\u5b9a"},{"location":"redis/day01/#_3","text":"\u670d\u52a1\u5668\u5141\u8bb8\u5ba2\u6237\u7aef\u8fde\u63a5\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba40\uff0c\u8868\u793a\u65e0\u9650\u5236\u3002\u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u8fbe\u4e0a\u9650\u540e\uff0cRedis\u4f1a\u62d2\u7edd\u65b0\u7684\u8fde\u63a5 maxclients count \u5ba2\u6237\u7aef\u95f2\u7f6e\u7b49\u5f85\u6700\u5927\u65f6\u957f\uff0c\u8fbe\u5230\u6700\u5927\u503c\u540e\u5173\u95ed\u5bf9\u5e94\u8fde\u63a5\u3002\u5982\u9700\u5173\u95ed\u8be5\u529f\u80fd\uff0c\u8bbe\u7f6e\u4e3a 0 timeout seconds","title":"\u5ba2\u6237\u7aef\u914d\u7f6e"},{"location":"redis/day01/#_4","text":"\u8bbe\u7f6e\u670d\u52a1\u5668\u4ee5\u6307\u5b9a\u65e5\u5fd7\u8bb0\u5f55\u7ea7\u522b loglevel debug | verbose | notice | warning \u65e5\u5fd7\u8bb0\u5f55\u6587\u4ef6\u540d logfile filename \u6ce8\u610f\uff1a\u65e5\u5fd7\u7ea7\u522b\u5f00\u53d1\u671f\u8bbe\u7f6e\u4e3averbose\u5373\u53ef\uff0c\u751f\u4ea7\u73af\u5883\u4e2d\u914d\u7f6e\u4e3anotice\uff0c\u7b80\u5316\u65e5\u5fd7\u8f93\u51fa\u91cf\uff0c\u964d\u4f4e\u5199\u65e5\u5fd7IO\u7684\u9891\u5ea6\u3002","title":"\u65e5\u5fd7\u914d\u7f6e"},{"location":"redis/day01/#redis_5","text":"","title":"Redis\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#_5","text":"\u529f\u80fd\u6027\u547d\u4ee4 \u5e2e\u52a9\u4fe1\u606f\u67e5\u9605 \u9000\u51fa\u6307\u4ee4 \u6e05\u9664\u5c4f\u5e55\u4fe1\u606f","title":"\u547d\u4ee4\u884c\u6a21\u5f0f\u5de5\u5177\u4f7f\u7528\u601d\u8003"},{"location":"redis/day01/#_6","text":"\u8bbe\u7f6e key\uff0cvalue \u6570\u636e set key value \u8303\u4f8b set name itheima \u6839\u636e key \u67e5\u8be2\u5bf9\u5e94\u7684 value\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u8fd4\u56de\u7a7a\uff08nil\uff09 get key \u8303\u4f8b get name","title":"\u4fe1\u606f\u8bfb\u5199"},{"location":"redis/day01/#_7","text":"\u83b7\u53d6\u547d\u4ee4\u5e2e\u52a9\u6587\u6863 help [ command ] \u8303\u4f8b help set \u83b7\u53d6\u7ec4\u4e2d\u6240\u6709\u547d\u4ee4\u4fe1\u606f\u540d\u79f0 help [ @group-name ] \u8303\u4f8b help @string \u9000\u51fa\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\u6a21\u5f0f \u9000\u51fa\u5ba2\u6237\u7aef quit exit \u5feb\u6377\u952e Ctrl+C","title":"\u5e2e\u52a9\u4fe1\u606f"},{"location":"redis/day01/#164_redis","text":"\u5230\u8fd9\u91cc\uff0cRedis \u5165\u95e8\u7684\u76f8\u5173\u77e5\u8bc6\uff0c\u6211\u4eec\u5c31\u5168\u90e8\u5b66\u4e60\u5b8c\u4e86\uff0c\u518d\u6765\u56de\u987e\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u90e8\u5206\u6211\u4eec\u4e3b\u8981\u8bb2\u89e3\u4e86\u54ea\u4e9b\u5185\u5bb9\u5462\uff1f \u9996\u5148\uff0c\u6211\u4eec\u5bf9Redis\u8fdb\u884c\u4e86\u4e00\u4e2a\u7b80\u5355\u4ecb\u7ecd\uff0c\u5305\u62ecNoSQL\u7684\u6982\u5ff5\u3001Redis\u7684\u6982\u5ff5\u7b49\u3002 \u7136\u540e\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86Redis \u7684\u4e0b\u8f7d\u4e0e\u5b89\u88c5\u3002\u5305\u62ec\u4e0b\u8f7d\u4e0e\u5b89\u88c5\u3001\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u542f\u52a8\u3001\u4ee5\u53ca\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff083\u7c7b\uff09\u3002 \u6700\u540e\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86Redis \u7684\u57fa\u672c\u64cd\u4f5c\u3002\u5305\u62ec\u6570\u636e\u8bfb\u5199\u3001\u9000\u51fa\u4e0e\u5e2e\u52a9\u4fe1\u606f\u83b7\u53d6\u3002","title":"1.6.4  redis\u5165\u95e8\u603b\u7ed3"},{"location":"redis/day01/#2","text":"","title":"2. \u6570\u636e\u7c7b\u578b"},{"location":"redis/day01/#21_redis_5","text":"\u57fa\u4e8e\u4ee5\u4e0a\u6570\u636e\u7279\u5f81\u6211\u4eec\u8fdb\u884c\u5206\u6790\uff0c\u6700\u7ec8\u5f97\u51fa\u6765\u6211\u4eec\u7684Redis\u4e2d\u8981\u8bbe\u8ba15\u79cd \u6570\u636e\u7c7b\u578b\uff1a string\u3001hash\u3001list\u3001set\u3001sorted_set/zset\uff08\u5e94\u7528\u6027\u8f83\u4f4e\uff09","title":"2.1  Redis \u6570\u636e\u7c7b\u578b(5\u79cd\u5e38\u7528)"},{"location":"redis/day01/#22_string","text":"\u5728\u5b66\u4e60\u7b2c\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u4e4b\u524d\uff0c\u5148\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u4e00\u4e0b\uff0c\u5728\u968f\u540e\u8fd9\u90e8\u5206\u5185\u5bb9\u7684\u5b66\u4e60\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u6bcf\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u90fd\u5206\u6210\u4e09\u5757\u6765\u8bb2\uff1a\u9996\u5148\u662f\u8bb2\u4e0b\u5b83\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u63a5\u4e0b\u6765\u8bb2\u4e00\u4e9b\u5b83\u7684\u6269\u5c55\u64cd\u4f5c\uff0c\u6700\u540e\u6211\u4eec\u4f1a\u53bb\u505a\u4e00\u4e2a\u5c0f\u7684\u6848\u4f8b\u5206\u6790\u3002","title":"2.2  string\u6570\u636e\u7c7b\u578b"},{"location":"redis/day01/#221redis","text":"\u5728\u5b66\u4e60string\u8fd9\u4e2a\u6570\u636e\u5f62\u5f0f\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8981\u660e\u767dstring\u5230\u5e95\u662f\u4fee\u9970\u4ec0\u4e48\u7684\u3002\u6211\u4eec\u77e5\u9053redis \u81ea\u8eab\u662f\u4e00\u4e2a Map\uff0c\u5176\u4e2d\u6240\u6709\u7684\u6570\u636e\u90fd\u662f\u91c7\u7528 key : value \u7684\u5f62\u5f0f\u5b58\u50a8\u3002 \u5bf9\u4e8e\u8fd9\u79cd\u7ed3\u6784\u6765\u8bf4\uff0c\u6211\u4eec\u7528\u6765\u5b58\u50a8\u6570\u636e\u4e00\u5b9a\u662f\u4e00\u4e2a\u503c\u524d\u9762\u5bf9\u5e94\u4e00\u4e2a\u540d\u79f0\u3002\u6211\u4eec\u901a\u8fc7\u540d\u79f0\u6765\u8bbf\u95ee\u540e\u9762\u7684\u503c\u3002\u6309\u7167\u8fd9\u79cd\u5f62\u52bf\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u51fa\u6765\u6211\u4eec\u7684\u5b58\u50a8\u683c\u5f0f\u3002\u524d\u9762\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u79f0\u4e3akey\u3002\u540e\u9762\u7684\u4e00\u90e8\u5206\u79f0\u4e3avalue\uff0c\u800c\u6211\u4eec\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4ed6\u4e00\u5b9a\u662f\u4fee\u9970value\u7684\u3002 \u6570\u636e\u7c7b\u578b\u6307\u7684\u662f\u5b58\u50a8\u7684\u6570\u636e\u7684\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f value \u90e8\u5206\u7684\u7c7b\u578b\uff0ckey \u90e8\u5206\u6c38\u8fdc\u90fd\u662f\u5b57\u7b26\u4e32\u3002","title":"2.2.1Redis \u6570\u636e\u5b58\u50a8\u683c\u5f0f"},{"location":"redis/day01/#222_string","text":"\uff081\uff09\u5b58\u50a8\u7684\u6570\u636e\uff1a\u5355\u4e2a\u6570\u636e\uff0c\u6700\u7b80\u5355\u7684\u6570\u636e\u5b58\u50a8\u7c7b\u578b\uff0c\u4e5f\u662f\u6700\u5e38\u7528\u7684\u6570\u636e\u5b58\u50a8\u7c7b\u578b\u3002 string\uff0c\u4ed6\u5c31\u662f\u5b58\u4e00\u4e2a\u5b57\u7b26\u4e32\u513f\uff0c\u6ce8\u610f\u662fvalue\u90a3\u4e00\u90e8\u5206\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5b83\u662fredis\u4e2d\u6700\u57fa\u672c\u3001\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6570\u636e\u7684\u683c\u5f0f\u3002 \uff082\uff09\u5b58\u50a8\u6570\u636e\u7684\u683c\u5f0f\uff1a\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u4e00\u4e2a\u6570\u636e \u6bcf\u4e00\u4e2a\u7a7a\u95f4\u4e2d\u53ea\u80fd\u4fdd\u5b58\u4e00\u4e2a\u5b57\u7b26\u4e32\u4fe1\u606f\uff0c\u8fd9\u4e2a\u4fe1\u606f\u91cc\u8fb9\u5982\u679c\u662f\u5b58\u7684\u7eaf\u6570\u5b57\uff0c\u4ed6\u4e5f\u80fd\u5f53\u6570\u5b57\u4f7f\u7528\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u8fd9\u662f\u6211\u4eec\u7684\u6570\u636e\u7684\u5b58\u50a8\u7a7a\u95f4\u3002 \uff083\uff09\u5b58\u50a8\u5185\u5bb9\uff1a\u901a\u5e38\u4f7f\u7528\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u4ee5\u6574\u6570\u7684\u5f62\u5f0f\u5c55\u793a\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u6570\u5b57\u64cd\u4f5c\u4f7f\u7528. \u4e00\u4e2akey\u5bf9\u4e00\u4e2avalue\uff0c\u800c\u8fd9\u4e2aitheima\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684string\u7c7b\u578b\uff0c\u5f53\u7136\u5b83\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7eaf\u6570\u5b57\u7684\u683c\u5f0f\u3002","title":"2.2.2  string \u7c7b\u578b"},{"location":"redis/day01/#223_string","text":"\uff081\uff09\u57fa\u7840\u6307\u4ee4 \u6dfb\u52a0/\u4fee\u6539\u6570\u636e\u6dfb\u52a0/\u4fee\u6539\u6570\u636e set key value \u83b7\u53d6\u6570\u636e get key \u5220\u9664\u6570\u636e del key \u5224\u5b9a\u6027\u6dfb\u52a0\u6570\u636e setnx key value \u6dfb\u52a0/\u4fee\u6539\u591a\u4e2a\u6570\u636e mset key1 value1 key2 value2 \u2026 \u83b7\u53d6\u591a\u4e2a\u6570\u636e mget key1 key2 \u2026 \u83b7\u53d6\u6570\u636e\u5b57\u7b26\u4e2a\u6570\uff08\u5b57\u7b26\u4e32\u957f\u5ea6\uff09 strlen key \u8ffd\u52a0\u4fe1\u606f\u5230\u539f\u59cb\u4fe1\u606f\u540e\u90e8\uff08\u5982\u679c\u539f\u59cb\u4fe1\u606f\u5b58\u5728\u5c31\u8ffd\u52a0\uff0c\u5426\u5219\u65b0\u5efa\uff09 append key value \uff082\uff09\u5355\u6570\u636e\u64cd\u4f5c\u4e0e\u591a\u6570\u636e\u64cd\u4f5c\u7684\u9009\u62e9\u4e4b\u60d1 \u5373set \u4e0emset\u7684\u5173\u7cfb\u3002\u8fd9\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u6765\u8bf4\uff0c\u6ca1\u6709\u4ec0\u4e48\u4f60\u5e94\u8be5\u9009\u54ea\u4e2a\uff0c\u800c\u662f\u4ed6\u4eec\u81ea\u5df1\u7684\u7279\u5f81\u662f\u4ec0\u4e48\uff0c\u4f60\u8981\u6839\u636e\u8fd9\u4e2a\u7279\u5f81\u53bb\u6bd4\u5bf9\u4f60\u7684\u4e1a\u52a1\uff0c\u770b\u770b\u7a76\u7adf\u9002\u7528\u4e8e\u54ea\u4e2a\u3002 \u5047\u5982\u8bf4\u8fd9\u662f\u6211\u4eec\u73b0\u5728\u7684\u670d\u52a1\u5668\uff0c\u4ed6\u8981\u5411redis\u8981\u6570\u636e\u7684\u8bdd\uff0c\u5b83\u4f1a\u53d1\u51fa\u4e00\u6761\u6307\u4ee4\u3002\u90a3\u4e48\u5f53\u8fd9\u6761\u6307\u4ee4\u53d1\u8fc7\u6765\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u8bf4\u662f\u8fd9\u4e2aset\u6307\u4ee4\u8fc7\u6765\uff0c\u90a3\u4e48\u5b83\u4f1a\u628a\u8fd9\u4e2a\u7ed3\u679c\u8fd4\u56de\u7ed9\u4f60\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u8981\u601d\u8003\u8fd9\u91cc\u8fb9\u4e00\u5171\u7ecf\u8fc7\u4e86\u591a\u957f\u65f6\u95f4\u3002 \u9996\u5148\uff0c\u53d1\u9001set\u6307\u4ee4\u8981\u65f6\u95f4\uff0c\u8fd9\u662f\u7f51\u7edc\u7684\u4e00\u4e2a\u65f6\u95f4\uff0c\u63a5\u4e0b\u6765redis\u8981\u53bb\u8fd0\u884c\u8fd9\u4e2a\u6307\u4ee4\u8981\u6d88\u8017\u65f6\u95f4\uff0c\u6700\u7ec8\u628a\u8fd9\u4e2a\u7ed3\u679c\u8fd4\u56de\u7ed9\u4f60\u53c8\u6709\u4e00\u4e2a\u65f6\u95f4\uff0c\u8fd9\u4e2a\u65f6\u95f4\u53c8\u662f\u4e00\u4e2a\u7f51\u7edc\u7684\u65f6\u95f4\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u4e00\u4e2a\u6307\u4ee4\u53d1\u9001\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981\u6d88\u8017\u8fd9\u6837\u7684\u65f6\u95f4. \u4f46\u662f\u5982\u679c\u8bf4\u73b0\u5728\u4e0d\u662f\u4e00\u6761\u6307\u4ee4\u4e86\uff0c\u4f60\u8981\u53d13\u4e2aset\u7684\u8bdd\uff0c\u8fd8\u8981\u591a\u957f\u65f6\u95f4\u5462\uff1f\u5bf9\u5e94\u7684\u53d1\u9001\u65f6\u95f4\u8981\u4e583\u4e86\uff0c\u56e0\u4e3a\u8fd9\u662f\u4e09\u4e2a\u5355\u6761\u6307\u4ee4,\u800c\u8fd0\u884c\u7684\u64cd\u4f5c\u65f6\u95f4\u5462\uff0c\u5b83\u4e5f\u8981\u4e583\u4e86\uff0c\u4f46\u6700\u7ec8\u8fd4\u56de\u7684\u4e5f\u8981\u53d13\u6b21\uff0c\u6240\u4ee5\u8fd9\u8fb9\u4e5f\u8981\u4e583\u3002 \u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5355\u6307\u4ee4\u53d13\u6761\u5b83\u9700\u8981\u7684\u65f6\u95f4\uff0c\u5047\u5b9a\u4ed6\u4eec\u4e24\u4e2a\u4e00\u6837\uff0c\u662f6\u4e2a\u7f51\u7edc\u65f6\u95f4\u52a03\u4e2a\u5904\u7406\u65f6\u95f4\uff0c\u5982\u679c\u6211\u4eec\u628a\u5b83\u5408\u6210\u4e00\u4e2amset\u5462\uff0c\u6211\u4eec\u60f3\u4e00\u60f3\u3002 \u5047\u5982\u8bf4\u7528\u591a\u6307\u4ee4\u53d13\u4e2a\u6307\u4ee4\u7684\u8bdd\uff0c\u5176\u5b9e\u53ea\u9700\u8981\u53d1\u4e00\u6b21\u5c31\u884c\u4e86\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff0c\u591a\u6307\u4ee4\u53d13\u4e2a\u6307\u4ee4\u7684\u8bdd\uff0c\u5176\u5b9e\u5b83\u662f\u4e24\u4e2a\u7f51\u7edc\u65f6\u95f4\u52a0\u4e0a3\u4e2aredis\u7684\u64cd\u4f5c\u65f6\u95f4\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u5199\u4e00\u4e2a\u5c0f\u52a0\u53f7\u5462\uff0c\u5c31\u662f\u56e0\u4e3a\u6bd5\u7adf\u53d1\u7684\u4fe1\u606f\u91cf\u53d8\u5927\u4e86\uff0c\u6240\u4ee5\u7f51\u7edc\u65f6\u95f4\u6709\u53ef\u80fd\u4f1a\u53d8\u957f\u3002 \u90a3\u4e48\u901a\u8fc7\u8fd9\u5f20\u56fe\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u5355\u6307\u4ee4\u548c\u591a\u6307\u4ee4\u4ed6\u4eec\u7684\u5dee\u522b\u5c31\u5728\u4e8e\u4f60\u53d1\u9001\u7684\u6b21\u6570\u662f\u591a\u8fd8\u662f\u5c11\u3002\u5f53\u4f60\u5f71\u54cd\u7684\u6570\u636e\u6bd4\u8f83\u5c11\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u4ee5\u7528\u5355\u6307\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u7528\u591a\u6307\u4ee4\u3002\u4f46\u662f\u4e00\u65e6\u8fd9\u4e2a\u91cf\u5927\u4e86\uff0c\u4f60\u5c31\u8981\u9009\u62e9\u591a\u6307\u4ee4\u4e86\uff0c\u4ed6\u7684\u6548\u7387\u4f1a\u9ad8\u4e00\u4e9b\u3002","title":"2.2.3  string \u7c7b\u578b\u6570\u636e\u7684\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#23_string","text":"","title":"2.3  string \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#231_string","text":"\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00string\u7684\u6269\u5c55\u64cd\u4f5c\uff0c\u5206\u6210\u4e24\u5927\u5757\uff1a\u4e00\u5757\u662f\u5bf9\u6570\u5b57\u8fdb\u884c\u64cd\u4f5c\u7684\uff0c\u7b2c\u4e8c\u5757\u662f\u5bf9\u6211\u4eec\u7684key\u7684\u65f6\u95f4\u8fdb\u884c\u64cd\u4f5c\u7684\u3002 \u8bbe\u7f6e\u6570\u503c\u6570\u636e\u589e\u52a0\u6307\u5b9a\u8303\u56f4\u7684\u503c incr key incrby key increment incrbyfloat key increment \u8bbe\u7f6e\u6570\u503c\u6570\u636e\u51cf\u5c11\u6307\u5b9a\u8303\u56f4\u7684\u503c decr key decrby key increment \u8bbe\u7f6e\u6570\u636e\u5177\u6709\u6307\u5b9a\u7684\u751f\u547d\u5468\u671f setex key seconds value psetex key milliseconds value","title":"2.3.1  string \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#232_string","text":"(1)\u6570\u636e\u64cd\u4f5c\u4e0d\u6210\u529f\u7684\u53cd\u9988\u4e0e\u6570\u636e\u6b63\u5e38\u64cd\u4f5c\u4e4b\u95f4\u7684\u5dee\u5f02 \u8868\u793a\u8fd0\u884c\u7ed3\u679c\u662f\u5426\u6210\u529f (integer) 0 \u2192 false \u5931\u8d25 (integer) 1 \u2192 true \u6210\u529f \u8868\u793a\u8fd0\u884c\u7ed3\u679c\u503c (integer) 3 \u2192 3 3\u4e2a (integer) 1 \u2192 1 1\u4e2a (2)\u6570\u636e\u672a\u83b7\u53d6\u5230\u65f6\uff0c\u5bf9\u5e94\u7684\u6570\u636e\u4e3a\uff08nil\uff09\uff0c\u7b49\u540c\u4e8enull (3)\u6570\u636e\u6700\u5927\u5b58\u50a8\u91cf\uff1a512MB (4)string\u5728redis\u5185\u90e8\u5b58\u50a8\u9ed8\u8ba4\u5c31\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5f53\u9047\u5230\u589e\u51cf\u7c7b\u64cd\u4f5cincr\uff0cdecr\u65f6\u4f1a\u8f6c\u6210\u6570\u503c\u578b\u8fdb\u884c\u8ba1\u7b97 (5)\u6309\u6570\u503c\u8fdb\u884c\u64cd\u4f5c\u7684\u6570\u636e\uff0c\u5982\u679c\u539f\u59cb\u6570\u636e\u4e0d\u80fd\u8f6c\u6210\u6570\u503c\uff0c\u6216\u8d85\u8d8a\u4e86redis \u6570\u503c\u4e0a\u9650\u8303\u56f4\uff0c\u5c06\u62a5\u9519 9223372036854775807\uff08java\u4e2dLong\u578b\u6570\u636e\u6700\u5927\u503c\uff0cLong.MAX_VALUE\uff09 (6)redis\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u91c7\u7528\u5355\u7ebf\u7a0b\u5904\u7406\u6240\u6709\u4e1a\u52a1\uff0c\u547d\u4ee4\u662f\u4e00\u4e2a\u4e00\u4e2a\u6267\u884c\u7684\uff0c\u56e0\u6b64\u65e0\u9700\u8003\u8651\u5e76\u53d1\u5e26\u6765\u7684\u6570\u636e\u5f71\u54cd.","title":"2.3.2  string \u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u7684\u6ce8\u610f\u4e8b\u9879"},{"location":"redis/day01/#24stringkey","text":"","title":"2.4string\u5e94\u7528\u573a\u666f\u4e0ekey\u547d\u540d\u7ea6\u5b9a"},{"location":"redis/day01/#241","text":"\u5b83\u7684\u5e94\u7528\u573a\u666f\u5728\u4e8e\uff1a\u4e3b\u9875\u9ad8\u9891\u8bbf\u95ee\u4fe1\u606f\u663e\u793a\u63a7\u5236\uff0c\u4f8b\u5982\u65b0\u6d6a\u5fae\u535a\u5927V\u4e3b\u9875\u663e\u793a\u7c89\u4e1d\u6570\u4e0e\u5fae\u535a\u6570\u91cf\u3002 \u6211\u4eec\u6765\u601d\u8003\u4e00\u4e0b\uff1a\u8fd9\u4e9b\u4fe1\u606f\u662f\u4e0d\u662f\u4f60\u8fdb\u5165\u5927V\u7684\u9875\u9762\u513f\u4ee5\u540e\u5c31\u8981\u8bfb\u53d6\u8fd9\u5199\u4fe1\u606f\u7684\u554a\uff0c\u90a3\u8fd9\u79cd\u4fe1\u606f\u4e00\u5b9a\u8981\u5b58\u50a8\u5230\u6211\u4eec\u7684redis\u4e2d\uff0c\u56e0\u4e3a\u4ed6\u7684\u8bbf\u95ee\u91cf\u592a\u9ad8\u4e86\uff01\u90a3\u8fd9\u79cd\u6570\u636e\u5e94\u8be5\u600e\u4e48\u5b58\u5462\uff1f\u6211\u4eec\u6765\u4e00\u5757\u513f\u770b\u4e00\u4e0b\u65b9\u6848\uff01","title":"2.4.1  \u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#242","text":"\uff081\uff09\u5728redis\u4e2d\u4e3a\u5927V\u7528\u6237\u8bbe\u5b9a\u7528\u6237\u4fe1\u606f\uff0c\u4ee5\u7528\u6237\u4e3b\u952e\u548c\u5c5e\u6027\u503c\u4f5c\u4e3akey\uff0c\u540e\u53f0\u8bbe\u5b9a\u5b9a\u65f6\u5237\u65b0\u7b56\u7565\u5373\u53ef\u3002 eg: user:id:3506728370:fans \u2192 12210947 eg: user:id:3506728370:blogs \u2192 6164 eg: user:id:3506728370:focuses \u2192 83 \uff082\uff09\u4e5f\u53ef\u4ee5\u4f7f\u7528json\u683c\u5f0f\u4fdd\u5b58\u6570\u636e eg: user:id:3506728370 \u2192 {\u201cfans\u201d\uff1a12210947\uff0c\u201cblogs\u201d\uff1a6164\uff0c\u201c focuses \u201d\uff1a83 } \uff083\uff09 key \u7684\u8bbe\u7f6e\u7ea6\u5b9a \u6570\u636e\u5e93\u4e2d\u7684\u70ed\u70b9\u6570\u636ekey\u547d\u540d\u60ef\u4f8b \u8868\u540d \u4e3b\u952e\u540d \u4e3b\u952e\u503c \u5b57\u6bb5\u540d eg1\uff1a order id 29437595 name eg2\uff1a equip id 390472345 type eg3\uff1a news id 202004150 title","title":"2.4.2  \u89e3\u51b3\u65b9\u6848"},{"location":"redis/day01/#25_hash","text":"\u4e0b\u9762\u6211\u4eec\u6765\u5b66\u4e60\u7b2c\u4e8c\u4e2a\u6570\u636e\u7c7b\u578bhash\u3002","title":"2.5  hash\u7684\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#251","text":"\u5bf9\u8c61\u7c7b\u6570\u636e\u7684\u5b58\u50a8\u5982\u679c\u5177\u6709\u8f83\u9891\u7e41\u7684\u66f4\u65b0\u9700\u6c42\u64cd\u4f5c\u4f1a\u663e\u5f97\u7b28\u91cd\uff01 \u5728\u6b63\u5f0f\u5b66\u4e60\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e2a\u5173\u4e8e\u6570\u636e\u5b58\u50a8\u7684\u56f0\u60d1\uff1a \u6bd4\u5982\u8bf4\u524d\u9762\u6211\u4eec\u7528\u4ee5\u4e0a\u5f62\u5f0f\u5b58\u4e86\u6570\u636e\uff0c\u5982\u679c\u6211\u4eec\u7528\u5355\u6761\u53bb\u5b58\u7684\u8bdd\uff0c\u5b83\u5b58\u7684\u6761\u6570\u4f1a\u5f88\u591a\u3002\u4f46\u5982\u679c\u6211\u4eec\u7528json\u683c\u5f0f\uff0c\u5b83\u5b58\u4e00\u6761\u6570\u636e\u5c31\u591f\u4e86\u3002\u95ee\u9898\u6765\u4e86\uff0c\u5047\u5982\u8bf4\u73b0\u5728\u7c89\u4e1d\u6570\u91cf\u53d1\u751f\u53d8\u5316\u4e86\uff0c\u4f60\u8981\u628a\u6574\u4e2a\u503c\u90fd\u6539\u4e86\u3002\u4f46\u662f\u7528\u5355\u6761\u5b58\u7684\u8bdd\u5c31\u4e0d\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\uff0c\u4f60\u53ea\u9700\u8981\u6539\u5176\u4e2d\u4e00\u4e2a\u5c31\u884c\u4e86\u3002\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u60f3\uff0c\u6709\u6ca1\u6709\u4e00\u79cd\u65b0\u7684\u5b58\u50a8\u7ed3\u6784\uff0c\u80fd\u5e2e\u6211\u4eec\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\u3002 \u6211\u4eec\u4e00\u5757\u513f\u6765\u5206\u6790\u4e00\u4e0b\uff1a \u5982\u4e0a\u56fe\u6240\u793a\uff1a\u5355\u6761\u7684\u8bdd\u662f\u5bf9\u5e94\u7684\u6570\u636e\u5728\u540e\u9762\u653e\u7740\u3002\u4ed4\u7ec6\u89c2\u5bdf\uff1a\u6211\u4eec\u770b\u5de6\u8fb9\u662f\u4e0d\u662f\u957f\u5f97\u90fd\u4e00\u6a21\u4e00\u6837\u554a\uff0c\u90fd\u662f\u5bf9\u5e94\u7684\u8868\u540d\u3001ID\u7b49\u7684\u4e00\u7cfb\u5217\u7684\u4e1c\u897f\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u53f3\u8fb9\u7ea2\u6846\u4e2d\u7684\u8fd9\u4e2a\u533a\u57df\u7ed9\u4ed6\u5c01\u8d77\u6765\u3002 \u90a3\u5982\u679c\u8981\u662f\u8fd9\u6837\u7684\u5f62\u5f0f\u7684\u8bdd\uff0c\u5982\u4e0b\u56fe\uff0c\u6211\u4eec\u628a\u5b83\u4e00\u5408\u5e76\uff0c\u5e76\u628a\u53f3\u8fb9\u7684\u4e1c\u897f\u7ed9\u4ed6\u53d8\u6210\u8fd9\u4e2a\u683c\u5f0f\uff0c\u8fd9\u4e0d\u5c31\u884c\u4e86\u5417\uff1f \u8fd9\u4e2a\u56fe\u5176\u5b9e\u5927\u5bb6\u5e76\u4e0d\u964c\u751f\uff0c\u7b2c\u4e00\uff0c\u4f60\u524d\u9762\u5b66\u8fc7\u4e00\u4e2a\u4e1c\u897f\u53ebhashmap\u4e0d\u5c31\u8fd9\u683c\u5f0f\u5417\uff1f\u7b2c\u4e8c\uff0credis\u81ea\u8eab\u4e0d\u4e5f\u662f\u8fd9\u683c\u5f0f\u5417\uff1f\u90a3\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6ce8\u610f\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u8981\u8bb2\u7684\u7b2c\u4e8c\u79cd\u683c\u5f0f\uff0chash\u3002 \u5728\u53f3\u8fb9\u5bf9\u5e94\u7684\u503c\uff0c\u6211\u4eec\u5c31\u5b58\u5177\u4f53\u7684\u503c\uff0c\u90a3\u5de6\u8fb9\u513f\u8fd9\u5c31\u662f\u6211\u4eec\u7684key\u3002\u95ee\u9898\u6765\u4e86\uff0c\u90a3\u4e2d\u95f4\u7684\u8fd9\u4e00\u5757\u53eb\u4ec0\u4e48\u5462\uff1f\u8fd9\u4e2a\u4e1c\u897f\u6211\u4eec\u7ed9\u4ed6\u8d77\u4e2a\u540d\u513f\uff0c\u53eb\u505afield\u5b57\u6bb5\u3002\u90a3\u4e48\u53f3\u8fb9\u513f\u6574\u4f53\u8fd9\u5757\u513f\u7a7a\u95f4\u6211\u4eec\u5c31\u79f0\u4e3ahash\uff0c\u4e5f\u5c31\u662f\u8bf4hash\u662f\u5b58\u4e86\u4e00\u4e2akey value\u7684\u5b58\u50a8\u7a7a\u95f4\u3002","title":"2.5.1  \u6570\u636e\u5b58\u50a8\u7684\u56f0\u60d1"},{"location":"redis/day01/#252_hash","text":"\u65b0\u7684\u5b58\u50a8\u9700\u6c42\uff1a\u5bf9\u4e00\u7cfb\u5217\u5b58\u50a8\u7684\u6570\u636e\u8fdb\u884c\u7f16\u7ec4\uff0c\u65b9\u4fbf\u7ba1\u7406\uff0c\u5178\u578b\u5e94\u7528\u5b58\u50a8\u5bf9\u8c61\u4fe1\u606f \u9700\u8981\u7684\u5b58\u50a8\u7ed3\u6784\uff1a\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u591a\u4e2a\u952e\u503c\u5bf9\u6570\u636e hash\u7c7b\u578b\uff1a\u5e95\u5c42\u4f7f\u7528\u54c8\u5e0c\u8868\u7ed3\u6784\u5b9e\u73b0\u6570\u636e\u5b58\u50a8 \u5982\u4e0a\u56fe\u6240\u793a\uff0c\u8fd9\u79cd\u7ed3\u6784\u53eb\u505ahash\uff0c\u5de6\u8fb9\u4e00\u4e2akey\uff0c\u5bf9\u53f3\u8fb9\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u3002\u8fd9\u91cc\u8981\u660e\u786e\u4e00\u70b9\uff0c\u53f3\u8fb9\u8fd9\u5757\u513f\u5b58\u50a8\u7a7a\u95f4\u53ebhash\uff0c\u4e5f\u5c31\u662f\u8bf4hash\u662f\u6307\u7684\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\uff0c\u4ed6\u6307\u7684\u4e0d\u662f\u4e00\u4e2a\u6570\u636e\uff0c\u662f\u8fd9\u91cc\u8fb9\u7684\u4e00\u5806\u6570\u636e\uff0c\u90a3\u4e48\u5b83\u5e95\u5c42\u5462\uff0c\u662f\u7528hash\u8868\u7684\u7ed3\u6784\u6765\u5b9e\u73b0\u7684\u3002 \u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a \u5982\u679cfield\u6570\u91cf\u8f83\u5c11\uff0c\u5b58\u50a8\u7ed3\u6784\u4f18\u5316\u4e3a\u7c7b\u6570\u7ec4\u7ed3\u6784 \u5982\u679cfield\u6570\u91cf\u8f83\u591a\uff0c\u5b58\u50a8\u7ed3\u6784\u4f7f\u7528HashMap\u7ed3\u6784","title":"2.5.2  hash \u7c7b\u578b"},{"location":"redis/day01/#253_hash","text":"\u6dfb\u52a0/\u4fee\u6539\u6570\u636e hset key field value \u83b7\u53d6\u6570\u636e hget key field hgetall key \u5220\u9664\u6570\u636e hdel key field1 [ field2 ] \u8bbe\u7f6efield\u7684\u503c\uff0c\u5982\u679c\u8be5field\u5b58\u5728\u5219\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c hsetnx key field value \u6dfb\u52a0/\u4fee\u6539\u591a\u4e2a\u6570\u636e hmset key field1 value1 field2 value2 \u2026 \u83b7\u53d6\u591a\u4e2a\u6570\u636e hmget key field1 field2 \u2026 \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u5b57\u6bb5\u7684\u6570\u91cf hlen key \u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7684\u5b57\u6bb5 hexists key field","title":"2.5.3  hash \u7c7b\u578b\u6570\u636e\u7684\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#26_hash","text":"\u5728\u770b\u5b8chash\u7684\u57fa\u672c\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u518d\u6765\u770b\u4ed6\u7684\u62d3\u5c55\u64cd\u4f5c\uff0c\u4ed6\u7684\u62d3\u5c55\u64cd\u4f5c\u76f8\u5bf9\u6bd4\u8f83\u7b80\u5355\uff1a","title":"2.6  hash\u7684\u62d3\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#261_hash","text":"\u83b7\u53d6\u54c8\u5e0c\u8868\u4e2d\u6240\u6709\u7684\u5b57\u6bb5\u540d\u6216\u5b57\u6bb5\u503c hkeys key hvals key \u8bbe\u7f6e\u6307\u5b9a\u5b57\u6bb5\u7684\u6570\u503c\u6570\u636e\u589e\u52a0\u6307\u5b9a\u8303\u56f4\u7684\u503c hincrby key field increment hincrbyfloat key field increment","title":"2.6.1  hash \u7c7b\u578b\u6570\u636e\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#262_hash","text":"(1)hash\u7c7b\u578b\u4e2dvalue\u53ea\u80fd\u5b58\u50a8\u5b57\u7b26\u4e32\uff0c\u4e0d\u5141\u8bb8\u5b58\u50a8\u5176\u4ed6\u6570\u636e\u7c7b\u578b\uff0c\u4e0d\u5b58\u5728\u5d4c\u5957\u73b0\u8c61\u3002\u5982\u679c\u6570\u636e\u672a\u83b7\u53d6\u5230\uff0c\u5bf9\u5e94\u7684\u503c\u4e3a\uff08nil\uff09\u3002 (2\uff09\u6bcf\u4e2a hash \u53ef\u4ee5\u5b58\u50a8 2^32 - 1 \u4e2a\u952e\u503c\u5bf9 hash\u7c7b\u578b\u5341\u5206\u8d34\u8fd1\u5bf9\u8c61\u7684\u6570\u636e\u5b58\u50a8\u5f62\u5f0f\uff0c\u5e76\u4e14\u53ef\u4ee5\u7075\u6d3b\u6dfb\u52a0\u5220\u9664\u5bf9\u8c61\u5c5e\u6027\u3002\u4f46hash\u8bbe\u8ba1\u521d\u8877\u4e0d\u662f\u4e3a\u4e86\u5b58\u50a8\u5927\u91cf\u5bf9\u8c61\u800c\u8bbe\u8ba1 \u7684\uff0c\u5207\u8bb0\u4e0d\u53ef\u6ee5\u7528\uff0c\u66f4\u4e0d\u53ef\u4ee5\u5c06hash\u4f5c\u4e3a\u5bf9\u8c61\u5217\u8868\u4f7f\u7528\u3002 (3)hgetall \u64cd\u4f5c\u53ef\u4ee5\u83b7\u53d6\u5168\u90e8\u5c5e\u6027\uff0c\u5982\u679c\u5185\u90e8field\u8fc7\u591a\uff0c\u904d\u5386\u6574\u4f53\u6570\u636e\u6548\u7387\u5c31\u5f88\u4f1a\u4f4e\uff0c\u6709\u53ef\u80fd\u6210\u4e3a\u6570\u636e\u8bbf\u95ee\u74f6\u9888\u3002","title":"2.6.2  hash\u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u7684\u6ce8\u610f\u4e8b\u9879"},{"location":"redis/day01/#27_hash","text":"","title":"2.7  hash\u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#271","text":"\u53cc11\u6d3b\u52a8\u65e5\uff0c\u9500\u552e\u624b\u673a\u5145\u503c\u5361\u7684\u5546\u5bb6\u5bf9\u79fb\u52a8\u3001\u8054\u901a\u3001\u7535\u4fe1\u768430\u5143\u300150\u5143\u3001100\u5143\u5546\u54c1\u63a8\u51fa\u62a2\u8d2d\u6d3b\u52a8\uff0c\u6bcf\u79cd\u5546\u54c1\u62a2\u8d2d\u4e0a\u96501000 \u5f20\u3002 \u4e5f\u5c31\u662f\u5546\u5bb6\u6709\u4e86\uff0c\u5546\u54c1\u6709\u4e86\uff0c\u6570\u91cf\u6709\u4e86\u3002\u6700\u7ec8\u6211\u4eec\u7684\u7528\u6237\u4e70\u4e1c\u897f\u5c31\u662f\u5728\u6539\u53d8\u8fd9\u4e2a\u6570\u91cf\u3002\u90a3\u4f60\u8bf4\u8fd9\u4e2a\u7ed3\u6784\u5e94\u8be5\u600e\u4e48\u5b58\u5462\uff1f\u5bf9\u5e94\u7684\u5546\u5bb6\u7684ID\u4f5c\u4e3akey\uff0c\u7136\u540e\u8fd9\u4e9b\u5145\u503c\u5361\u7684ID\u4f5c\u4e3afield\uff0c\u6700\u540e\u8fd9\u4e9b\u6570\u91cf\u4f5c\u4e3avalue\u3002\u800c\u6211\u4eec\u6240\u8c13\u7684\u64cd\u4f5c\u662f\u5176\u5b9e\u5c31\u662fincrea\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u53ea\u4e0d\u8fc7\u4f60\u4f20\u8d1f\u503c\u5c31\u884c\u4e86\u3002\u770b\u4e00\u770b\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6848\uff1a","title":"2.7.1  \u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#272","text":"\u4ee5\u5546\u5bb6id\u4f5c\u4e3akey \u5c06\u53c2\u4e0e\u62a2\u8d2d\u7684\u5546\u54c1id\u4f5c\u4e3afield \u5c06\u53c2\u4e0e\u62a2\u8d2d\u7684\u5546\u54c1\u6570\u91cf\u4f5c\u4e3a\u5bf9\u5e94\u7684value \u62a2\u8d2d\u65f6\u4f7f\u7528\u964d\u503c\u7684\u65b9\u5f0f\u63a7\u5236\u4ea7\u54c1\u6570\u91cf \u6ce8\u610f\uff1a\u5b9e\u9645\u4e1a\u52a1\u4e2d\u8fd8\u6709\u8d85\u5356\u7b49\u5b9e\u9645\u95ee\u9898\uff0c\u8fd9\u91cc\u4e0d\u505a\u8ba8\u8bba","title":"2.7.2  \u89e3\u51b3\u65b9\u6848"},{"location":"redis/day01/#28_list","text":"\u524d\u9762\u6211\u4eec\u5b58\u6570\u636e\u7684\u65f6\u5019\u5462\uff0c\u5355\u4e2a\u6570\u636e\u4e5f\u80fd\u5b58\uff0c\u591a\u4e2a\u6570\u636e\u4e5f\u80fd\u5b58\uff0c\u4f46\u662f\u8fd9\u91cc\u9762\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5b58\u591a\u4e2a\u6570\u636e\u7528hash\u7684\u65f6\u5019\u5b83\u662f\u6ca1\u6709\u987a\u5e8f\u7684\u3002\u6211\u4eec\u5e73\u65f6\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\u6570\u636e\u5f88\u591a\u60c5\u51b5\u4e0b\u90fd\u662f\u6709\u987a\u5e8f\u7684\uff0c\u90a3\u6709\u6ca1\u6709\u4e00\u79cd\u80fd\u591f\u7528\u6765\u5b58\u50a8\u5e26\u6709\u987a\u5e8f\u7684\u8fd9\u79cd\u6570\u636e\u6a21\u578b\u5462\uff0clist\u5c31\u4e13\u95e8\u6765\u5e72\u8fd9\u4e8b\u513f\u3002","title":"2.8  list\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#281_list","text":"\u6570\u636e\u5b58\u50a8\u9700\u6c42\uff1a\u5b58\u50a8\u591a\u4e2a\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u5165\u5b58\u50a8\u7a7a\u95f4\u7684\u987a\u5e8f\u8fdb\u884c\u533a\u5206 \u9700\u8981\u7684\u5b58\u50a8\u7ed3\u6784\uff1a\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u591a\u4e2a\u6570\u636e\uff0c\u4e14\u901a\u8fc7\u6570\u636e\u53ef\u4ee5\u4f53\u73b0\u8fdb\u5165\u987a\u5e8f list\u7c7b\u578b\uff1a\u4fdd\u5b58\u591a\u4e2a\u6570\u636e\uff0c\u5e95\u5c42\u4f7f\u7528\u53cc\u5411\u94fe\u8868\u5b58\u50a8\u7ed3\u6784\u5b9e\u73b0 \u5148\u6765\u901a\u8fc7\u4e00\u5f20\u56fe\uff0c\u56de\u5fc6\u4e00\u4e0b\u987a\u5e8f\u8868\u3001\u94fe\u8868\u3001\u53cc\u5411\u94fe\u8868\u3002 list\u5bf9\u5e94\u7684\u5b58\u50a8\u7ed3\u6784\u662f\u4ec0\u4e48\u5462\uff1f\u91cc\u8fb9\u5b58\u7684\u8fd9\u4e2a\u4e1c\u897f\u662f\u4e2a\u5217\u8868\uff0c\u4ed6\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u540d\u79f0\u3002\u5c31\u662fkey\u5b58\u4e00\u4e2alist\u7684\u8fd9\u6837\u7ed3\u6784\u3002\u5bf9\u5e94\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u4f60\u5176\u5b9e\u662f\u53ef\u4ee5\u60f3\u5230\u7684\u3002 \u6765\u770b\u4e00\u4e0b\uff0c\u56e0\u4e3a\u5b83\u662f\u53cc\u5411\u7684\uff0c\u6240\u4ee5\u4ed6\u5de6\u8fb9\u53f3\u8fb9\u90fd\u80fd\u64cd\u4f5c\uff0c\u5b83\u5bf9\u5e94\u7684\u64cd\u4f5c\u7ed3\u6784\u4e24\u8fb9\u90fd\u80fd\u8fdb\u6570\u636e\u3002\u8fd9\u5c31\u662f\u94fe\u8868\u7684\u4e00\u4e2a\u5b58\u50a8\u7ed3\u6784\u3002\u5f80\u5916\u62ff\u6570\u636e\u7684\u65f6\u5019\u600e\u4e48\u62ff\u5462\uff1f\u901a\u5e38\u662f\u4ece\u4e00\u7aef\u62ff\uff0c\u5f53\u7136\u53e6\u4e00\u7aef\u4e5f\u80fd\u62ff\u3002\u5982\u679c\u4e24\u7aef\u90fd\u80fd\u62ff\u7684\u8bdd\uff0c\u8fd9\u5c31\u662f\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u4e24\u8fb9\u513f\u90fd\u80fd\u64cd\u4f5c\u3002\u5982\u679c\u53ea\u80fd\u4ece\u4e00\u7aef\u8fdb\u4e00\u7aef\u51fa\uff0c\u8fd9\u4e2a\u6a21\u578b\u54b1\u4eec\u524d\u9762\u4e86\u89e3\u8fc7\uff0c\u53eb\u505a\u6808\u3002","title":"2.8.1  list \u7c7b\u578b"},{"location":"redis/day01/#282_list","text":"\u6700\u540e\u770b\u4e00\u4e0b\u4ed6\u7684\u57fa\u672c\u64cd\u4f5c \u6dfb\u52a0/\u4fee\u6539\u6570\u636e lpush key value1 [ value2 ] \u2026\u2026 rpush key value1 [ value2 ] \u2026\u2026 \u83b7\u53d6\u6570\u636e lrange key start stop lindex key index llen key \u83b7\u53d6\u5e76\u79fb\u9664\u6570\u636e lpop key rpop key","title":"2.8.2 list \u7c7b\u578b\u6570\u636e\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#29_list","text":"","title":"2.9  list\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#291_list","text":"\u79fb\u9664\u6307\u5b9a\u6570\u636e lrem key count value \u89c4\u5b9a\u65f6\u95f4\u5185\u83b7\u53d6\u5e76\u79fb\u9664\u6570\u636e blpop key1 [ key2 ] timeout brpop key1 [ key2 ] timeout brpoplpush source destination timeout","title":"2.9.1  list \u7c7b\u578b\u6570\u636e\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#292_list","text":"\uff081\uff09list\u4e2d\u4fdd\u5b58\u7684\u6570\u636e\u90fd\u662fstring\u7c7b\u578b\u7684\uff0c\u6570\u636e\u603b\u5bb9\u91cf\u662f\u6709\u9650\u7684\uff0c\u6700\u591a2^32 - 1 \u4e2a\u5143\u7d20(4294967295)\u3002 \uff082\uff09list\u5177\u6709\u7d22\u5f15\u7684\u6982\u5ff5\uff0c\u4f46\u662f\u64cd\u4f5c\u6570\u636e\u65f6\u901a\u5e38\u4ee5\u961f\u5217\u7684\u5f62\u5f0f\u8fdb\u884c\u5165\u961f\u51fa\u961f\u64cd\u4f5c\uff0c\u6216\u4ee5\u6808\u7684\u5f62\u5f0f\u8fdb\u884c\u5165\u6808\u51fa\u6808\u64cd\u4f5c \uff083\uff09\u83b7\u53d6\u5168\u90e8\u6570\u636e\u64cd\u4f5c\u7ed3\u675f\u7d22\u5f15\u8bbe\u7f6e\u4e3a-1 \uff084\uff09list\u53ef\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u9875\u64cd\u4f5c\uff0c\u901a\u5e38\u7b2c\u4e00\u9875\u7684\u4fe1\u606f\u6765\u81ea\u4e8elist\uff0c\u7b2c2\u9875\u53ca\u66f4\u591a\u7684\u4fe1\u606f\u901a\u8fc7\u6570\u636e\u5e93\u7684\u5f62\u5f0f\u52a0\u8f7d","title":"2.9.2  list \u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u6ce8\u610f\u4e8b\u9879"},{"location":"redis/day01/#210_list","text":"","title":"2.10 list \u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#2101","text":"\u4f01\u4e1a\u8fd0\u8425\u8fc7\u7a0b\u4e2d\uff0c\u7cfb\u7edf\u5c06\u4ea7\u751f\u51fa\u5927\u91cf\u7684\u8fd0\u8425\u6570\u636e\uff0c\u5982\u4f55\u4fdd\u969c\u591a\u53f0\u670d\u52a1\u5668\u64cd\u4f5c\u65e5\u5fd7\u7684\u7edf\u4e00\u987a\u5e8f\u8f93\u51fa\uff1f \u5047\u5982\u73b0\u5728\u4f60\u6709\u591a\u53f0\u670d\u52a1\u5668\uff0c\u6bcf\u4e00\u53f0\u670d\u52a1\u5668\u90fd\u4f1a\u4ea7\u751f\u5b83\u7684\u65e5\u5fd7\uff0c\u5047\u8bbe\u4f60\u662f\u4e00\u4e2a\u8fd0\u7ef4\u4eba\u5458\uff0c\u4f60\u60f3\u770b\u5b83\u7684\u64cd\u4f5c\u65e5\u5fd7\uff0c\u4f60\u600e\u4e48\u770b\u5462\uff1f\u6253\u5f00A\u673a\u5668\u7684\u65e5\u5fd7\u770b\u4e00\u770b\uff0c\u6253\u5f00B\u673a\u5668\u7684\u65e5\u5fd7\u518d\u770b\u4e00\u770b\u5417\uff1f\u8fd9\u6837\u7684\u8bdd\u4f60\u4f1a\u53ef\u80fd\u4f1a\u75af\u6389\u7684\uff01\u56e0\u4e3a\u5de6\u8fb9\u770b\u7684\u6709\u53ef\u80fd\u5b83\u7684\u65f6\u95f4\u662f11:01\uff0c\u53f3\u8fb911:02\uff0c\u7136\u540e\u518d\u770b\u5de6\u8fb911:03\uff0c\u5b83\u4eec\u672c\u8eab\u662f\u8fde\u7eed\u7684\uff0c\u4f46\u662f\u4f60\u5728\u770b\u7684\u65f6\u5019\u5c31\u5206\u6210\u56db\u4e2a\u6587\u4ef6\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f60\u770b\u8d77\u6765\u5c31\u4f1a\u5f88\u9ebb\u70e6\u3002\u80fd\u4e0d\u80fd\u628a\u4ed6\u4eec\u5408\u5e76\u5462\uff1f\u7b54\u6848\u662f\u53ef\u4ee5\u7684\uff01\u600e\u4e48\u505a\u5462\uff1f\u5efa\u7acb\u8d77redis\u670d\u52a1\u5668\u3002\u5f53\u4ed6\u4eec\u9700\u8981\u8bb0\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u8bb0\u5728\u54ea\u513f,\u5168\u90e8\u53d1\u7ed9redis\u3002\u7b49\u5230\u4f60\u60f3\u770b\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u670d\u52a1\u5668\u8bbf\u95eeredis\u83b7\u53d6\u65e5\u5fd7\u3002\u7136\u540e\u5f97\u5230\u4ee5\u540e\uff0c\u5c31\u4f1a\u5f97\u5230\u4e00\u4e2a\u5b8c\u6574\u7684\u65e5\u5fd7\u4fe1\u606f\u3002\u90a3\u4e48\u8fd9\u91cc\u9762\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u65e5\u5fd7\u4e86\uff0c\u4f9d\u9760\u4ec0\u4e48\u6765\u5b9e\u73b0\u5462\uff1f\u5c31\u4f9d\u9760\u6211\u4eec\u7684list\u7684\u6a21\u578b\u7684\u987a\u5e8f\u6765\u5b9e\u73b0\u3002\u8fdb\u6765\u4e00\u7ec4\u6570\u636e\u5c31\u5f80\u91cc\u52a0\uff0c\u8c01\u5148\u8fdb\u6765\u8c01\u5148\u52a0\u8fdb\u53bb\uff0c\u5b83\u662f\u6709\u4e00\u5b9a\u7684\u987a\u5e8f\u7684\u3002","title":"2.10.1  \u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#2102","text":"\u4f9d\u8d56list\u7684\u6570\u636e\u5177\u6709\u987a\u5e8f\u7684\u7279\u5f81\u5bf9\u4fe1\u606f\u8fdb\u884c\u7ba1\u7406 \u4f7f\u7528\u961f\u5217\u6a21\u578b\u89e3\u51b3\u591a\u8def\u4fe1\u606f\u6c47\u603b\u5408\u5e76\u7684\u95ee\u9898 \u4f7f\u7528\u6808\u6a21\u578b\u89e3\u51b3\u6700\u65b0\u6d88\u606f\u7684\u95ee\u9898","title":"2.10.2  \u89e3\u51b3\u65b9\u6848"},{"location":"redis/day01/#211_set","text":"","title":"2.11  set \u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#2111_set","text":"\u65b0\u7684\u5b58\u50a8\u9700\u6c42\uff1a\u5b58\u50a8\u5927\u91cf\u7684\u6570\u636e\uff0c\u5728\u67e5\u8be2\u65b9\u9762\u63d0\u4f9b\u66f4\u9ad8\u7684\u6548\u7387 \u9700\u8981\u7684\u5b58\u50a8\u7ed3\u6784\uff1a\u80fd\u591f\u4fdd\u5b58\u5927\u91cf\u7684\u6570\u636e\uff0c\u9ad8\u6548\u7684\u5185\u90e8\u5b58\u50a8\u673a\u5236\uff0c\u4fbf\u4e8e\u67e5\u8be2 set\u7c7b\u578b\uff1a\u4e0ehash\u5b58\u50a8\u7ed3\u6784\u5b8c\u5168\u76f8\u540c\uff0c\u4ec5\u5b58\u50a8\u952e\uff0c\u4e0d\u5b58\u50a8\u503c\uff08nil\uff09\uff0c\u5e76\u4e14\u503c\u662f\u4e0d\u5141\u8bb8\u91cd\u590d\u7684 \u901a\u8fc7\u8fd9\u4e2a\u540d\u79f0\uff0c\u5927\u5bb6\u4e5f\u57fa\u672c\u4e0a\u80fd\u591f\u8ba4\u8bc6\u5230\u548c\u6211\u4eecJava\u4e2d\u7684set\u5b8c\u5168\u4e00\u6837\u3002\u6211\u4eec\u73b0\u5728\u8981\u5b58\u50a8\u5927\u91cf\u7684\u6570\u636e\uff0c\u5e76\u4e14\u8981\u6c42\u63d0\u9ad8\u5b83\u7684\u67e5\u8be2\u6548\u7387\u3002\u7528list\u8fd9\u79cd\u94fe\u8868\u5f62\u5f0f\uff0c\u5b83\u7684\u67e5\u8be2\u6548\u7387\u662f\u4e0d\u9ad8\u7684\uff0c\u90a3\u600e\u4e48\u529e\u5462\uff1f\u8fd9\u65f6\u5019\u6211\u4eec\u5c31\u60f3\uff0c\u6709\u6ca1\u6709\u9ad8\u6548\u7684\u5b58\u50a8\u673a\u5236\u3002\u5176\u5b9e\u524d\u9762\u54b1\u8bb2Java\u7684\u65f6\u5019\u8bf4\u8fc7hash\u8868\u7684\u7ed3\u6784\u5c31\u975e\u5e38\u7684\u597d\uff0c\u4f46\u662f\u8fd9\u91cc\u8fb9\u6211\u4eec\u5df2\u7ecf\u6709hash\u4e86\uff0c\u4ed6\u505a\u4e86\u8fd9\u4e48\u4e00\u4e2a\u8bbe\u5b9a\uff0c\u5e72\u561b\u5462\uff0c\u4ed6\u628ahash\u7684\u5b58\u50a8\u7a7a\u95f4\u7ed9\u6539\u4e00\u4e0b\uff0c\u53f3\u8fb9\u4f60\u539f\u6765\u5b58\u6570\u636e\u6539\u6389,\u5168\u90e8\u5b58\u7a7a\uff0c\u90a3\u4f60\u8bf4\u6570\u636e\u653e\u54ea\u513f\u4e86\uff1f\u653e\u5230\u539f\u6765\u7684filed\u7684\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u5728\u8fd9\u91cc\u8fb9\u5b58\u771f\u6b63\u7684\u503c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6a21\u578b\u5c31\u662f\u6211\u4eec\u7684set \u6a21\u578b\u3002 set\u7c7b\u578b\uff1a\u4e0ehash\u5b58\u50a8\u7ed3\u6784\u5b8c\u5168\u76f8\u540c\uff0c\u4ec5\u5b58\u50a8\u952e\uff0c\u4e0d\u5b58\u50a8\u503c\uff08nil\uff09\uff0c\u5e76\u4e14\u503c\u662f\u4e0d\u5141\u8bb8\u91cd\u590d\u7684\u3002 \u770b\u4e00\u4e0b\u5b83\u7684\u6574\u4e2a\u7ed3\u6784\uff1a","title":"2.11.1 set\u7c7b\u578b"},{"location":"redis/day01/#2112_set","text":"\u6dfb\u52a0\u6570\u636e sadd key member1 [ member2 ] \u83b7\u53d6\u5168\u90e8\u6570\u636e smembers key \u5220\u9664\u6570\u636e srem key member1 [ member2 ] \u83b7\u53d6\u96c6\u5408\u6570\u636e\u603b\u91cf scard key \u5224\u65ad\u96c6\u5408\u4e2d\u662f\u5426\u5305\u542b\u6307\u5b9a\u6570\u636e sismember key member \u968f\u673a\u83b7\u53d6\u96c6\u5408\u4e2d\u6307\u5b9a\u6570\u91cf\u7684\u6570\u636e srandmember key [ count ] \u968f\u673a\u83b7\u53d6\u96c6\u4e2d\u7684\u67d0\u4e2a\u6570\u636e\u5e76\u5c06\u8be5\u6570\u636e\u79fb\u9664\u96c6\u5408 spop key [ count ]","title":"2.11.2 set\u7c7b\u578b\u6570\u636e\u7684\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#212_set","text":"","title":"2.12  set \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#2121_set","text":"\u6c42\u4e24\u4e2a\u96c6\u5408\u7684\u4ea4\u3001\u5e76\u3001\u5dee\u96c6 sinter key1 [key2 \u2026] sunion key1 [key2 \u2026] sdiff key1 [key2 \u2026] \u6c42\u4e24\u4e2a\u96c6\u5408\u7684\u4ea4\u3001\u5e76\u3001\u5dee\u96c6\u5e76\u5b58\u50a8\u5230\u6307\u5b9a\u96c6\u5408\u4e2d sinterstore destination key1 [key2 \u2026] sunionstore destination key1 [key2 \u2026] sdiffstore destination key1 [key2 \u2026] \u5c06\u6307\u5b9a\u6570\u636e\u4ece\u539f\u59cb\u96c6\u5408\u4e2d\u79fb\u52a8\u5230\u76ee\u6807\u96c6\u5408\u4e2d smove source destination member \u901a\u8fc7\u4e0b\u9762\u4e00\u5f20\u56fe\u56de\u5fc6\u4e00\u4e0b\u4ea4\u3001\u5e76\u3001\u5dee","title":"2.12.1  set \u7c7b\u578b\u6570\u636e\u7684\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#2122_set","text":"set \u7c7b\u578b\u4e0d\u5141\u8bb8\u6570\u636e\u91cd\u590d\uff0c\u5982\u679c\u6dfb\u52a0\u7684\u6570\u636e\u5728 set \u4e2d\u5df2\u7ecf\u5b58\u5728\uff0c\u5c06\u53ea\u4fdd\u7559\u4e00\u4efd\u3002 set \u867d\u7136\u4e0ehash\u7684\u5b58\u50a8\u7ed3\u6784\u76f8\u540c\uff0c\u4f46\u662f\u65e0\u6cd5\u542f\u7528hash\u4e2d\u5b58\u50a8\u503c\u7684\u7a7a\u95f4\u3002","title":"2.12.2  set \u7c7b\u578b\u6570\u636e\u64cd\u4f5c\u7684\u6ce8\u610f\u4e8b\u9879"},{"location":"redis/day01/#213_set","text":"","title":"2.13  set\u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#2131_set","text":"\uff081\uff09\u9ed1\u540d\u5355 \u8d44\u8baf\u7c7b\u4fe1\u606f\u7c7b\u7f51\u7ad9\u8ffd\u6c42\u9ad8\u8bbf\u95ee\u91cf\uff0c\u4f46\u662f\u7531\u4e8e\u5176\u4fe1\u606f\u7684\u4ef7\u503c\uff0c\u5f80\u5f80\u5bb9\u6613\u88ab\u4e0d\u6cd5\u5206\u5b50\u5229\u7528\uff0c\u901a\u8fc7\u722c\u866b\u6280\u672f\uff0c \u5feb\u901f\u83b7\u53d6\u4fe1\u606f\uff0c\u4e2a\u522b\u7279\u79cd\u884c\u4e1a\u7f51\u7ad9\u4fe1\u606f\u901a\u8fc7\u722c\u866b\u83b7\u53d6\u5206\u6790\u540e\uff0c\u53ef\u4ee5\u8f6c\u6362\u6210\u5546\u4e1a\u673a\u5bc6\u8fdb\u884c\u51fa\u552e\u3002\u4f8b\u5982\u7b2c\u4e09\u65b9\u706b \u8f66\u7968\u3001\u673a\u7968\u3001\u9152\u5e97\u5237\u7968\u4ee3\u8d2d\u8f6f\u4ef6\uff0c\u7535\u5546\u5237\u8bc4\u8bba\u3001\u5237\u597d\u8bc4\u3002 \u540c\u65f6\u722c\u866b\u5e26\u6765\u7684\u4f2a\u6d41\u91cf\u4e5f\u4f1a\u7ed9\u7ecf\u8425\u8005\u5e26\u6765\u9519\u89c9\uff0c\u4ea7\u751f\u9519\u8bef\u7684\u51b3\u7b56\uff0c\u6709\u6548\u907f\u514d\u7f51\u7ad9\u88ab\u722c\u866b\u53cd\u590d\u722c\u53d6\u6210\u4e3a\u6bcf\u4e2a\u7f51\u7ad9\u90fd\u8981\u8003\u8651\u7684\u57fa\u672c\u95ee\u9898\u3002\u5728\u57fa\u4e8e\u6280\u672f\u5c42\u9762\u533a\u5206\u51fa\u722c\u866b\u7528\u6237\u540e\uff0c\u9700\u8981\u5c06\u6b64\u7c7b\u7528\u6237\u8fdb\u884c\u6709\u6548\u7684\u5c4f\u853d\uff0c\u8fd9\u5c31\u662f\u9ed1\u540d\u5355\u7684\u5178\u578b\u5e94\u7528\u3002 ps:\u4e0d\u662f\u8bf4\u722c\u866b\u4e00\u5b9a\u505a\u6467\u6bc1\u6027\u7684\u5de5\u4f5c\uff0c\u6709\u4e9b\u5c0f\u578b\u7f51\u7ad9\u9700\u8981\u722c\u866b\u4e3a\u5176\u5e26\u6765\u4e00\u4e9b\u6d41\u91cf\u3002 \uff082\uff09\u767d\u540d\u5355 \u5bf9\u4e8e\u5b89\u5168\u6027\u66f4\u9ad8\u7684\u5e94\u7528\u8bbf\u95ee\uff0c\u4ec5\u4ec5\u9760\u9ed1\u540d\u5355\u662f\u4e0d\u80fd\u89e3\u51b3\u5b89\u5168\u95ee\u9898\u7684\uff0c\u6b64\u65f6\u9700\u8981\u8bbe\u5b9a\u53ef\u8bbf\u95ee\u7684\u7528\u6237\u7fa4\u4f53\uff0c \u4f9d\u8d56\u767d\u540d\u5355\u505a\u66f4\u4e3a\u82db\u523b\u7684\u8bbf\u95ee\u9a8c\u8bc1\u3002","title":"2.13.1  set\u5e94\u7528\u573a\u666f"},{"location":"redis/day01/#2132","text":"\u57fa\u4e8e\u7ecf\u8425\u6218\u7565\u8bbe\u5b9a\u95ee\u9898\u7528\u6237\u53d1\u73b0\u3001\u9274\u522b\u89c4\u5219 \u5468\u671f\u6027\u66f4\u65b0\u6ee1\u8db3\u89c4\u5219\u7684\u7528\u6237\u9ed1\u540d\u5355\uff0c\u52a0\u5165set\u96c6\u5408 \u7528\u6237\u884c\u4e3a\u4fe1\u606f\u8fbe\u5230\u540e\u4e0e\u9ed1\u540d\u5355\u8fdb\u884c\u6bd4\u5bf9\uff0c\u786e\u8ba4\u884c\u4e3a\u53bb\u5411 \u9ed1\u540d\u5355\u8fc7\u6ee4IP\u5730\u5740\uff1a\u5e94\u7528\u4e8e\u5f00\u653e\u6e38\u5ba2\u8bbf\u95ee\u6743\u9650\u7684\u4fe1\u606f\u6e90 \u9ed1\u540d\u5355\u8fc7\u6ee4\u8bbe\u5907\u4fe1\u606f\uff1a\u5e94\u7528\u4e8e\u9650\u5b9a\u8bbf\u95ee\u8bbe\u5907\u7684\u4fe1\u606f\u6e90 \u9ed1\u540d\u5355\u8fc7\u6ee4\u7528\u6237\uff1a\u5e94\u7528\u4e8e\u57fa\u4e8e\u8bbf\u95ee\u6743\u9650\u7684\u4fe1\u606f\u6e90","title":"2.13.2  \u89e3\u51b3\u65b9\u6848"},{"location":"redis/day01/#214","text":"","title":"2.14  \u5b9e\u8df5\u6848\u4f8b"},{"location":"redis/day01/#2141","text":"\u4f7f\u7528\u5fae\u4fe1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5f53\u5fae\u4fe1\u63a5\u6536\u6d88\u606f\u540e\uff0c\u4f1a\u9ed8\u8ba4\u5c06\u6700\u8fd1\u63a5\u6536\u7684\u6d88\u606f\u7f6e\u9876\uff0c\u5f53\u591a\u4e2a\u597d\u53cb\u53ca\u5173\u6ce8\u7684\u8ba2\u9605\u53f7\u540c\u65f6\u53d1 \u9001\u6d88\u606f\u65f6\uff0c\u8be5\u6392\u5e8f\u4f1a\u4e0d\u505c\u7684\u8fdb\u884c\u4ea4\u66ff\u3002\u540c\u65f6\u8fd8\u53ef\u4ee5\u5c06\u91cd\u8981\u7684\u4f1a\u8bdd\u8bbe\u7f6e\u4e3a\u7f6e\u9876\u3002\u4e00\u65e6\u7528\u6237\u79bb\u7ebf\u540e\uff0c\u518d\u6b21\u6253\u5f00\u5fae\u4fe1\u65f6\uff0c\u6d88\u606f\u8be5\u6309\u7167\u4ec0\u4e48\u6837\u7684\u987a\u5e8f\u663e\u793a\u3002 \u6211\u4eec\u5206\u6790\u4e00\u4e0b\uff1a 100\u8fd9\u53f0\u624b\u673a\u4ee3\u8868\u4f60\u3002\u800c200\u3001300\u3001400\u8fd9\u4e09\u53f0\u4ee3\u8868\u4f60\u597d\u53cb\u7684\u624b\u673a\u3002\u5728\u8fd9\u91cc\u6709\u4e00\u4e9b\u4e1c\u897f\u9700\u8981\u4ea4\u4ee3\u4e00\u4e0b\uff0c\u56e0\u4e3a\u6211\u4eec\u6bcf\u4e2a\u4eba\u7684\u90fd\u4f1a\u5bf9\u81ea\u5df1\u7684\u5fae\u4fe1\u4e2d\u7684\u4e00\u4e9b\u6bd4\u8f83\u91cd\u8981\u7684\u4eba\u8bbe\u7f6e\u4f1a\u8bdd\u7f6e\u9876\uff0c\u5c06\u4ed6\u7684\u90a3\u6761\u5bf9\u8bdd\u653e\u5728\u6700\u4e0a\u9762\u3002\u6211\u4eec\u5047\u5b9a\u8fd9\u4e2a\u4eba\u6709\u4e24\u4e2a\u4f1a\u8bdd\u7f6e\u9876\u7684\u597d\u53cb\uff0c\u5206\u522b\u662f400\u548c500\uff0c\u800c\u8fd9\u91cc\u8fb9\u5c31\u5305\u542b400. \u4e0b\u9762\u5462\uff0c\u6211\u4eec\u5c31\u6765\u53d1\u8fd9\u4e2a\u6d88\u606f\uff0c\u7b2c\u4e00\u4e2a\u53d1\u6d88\u606f\u7684\u662f300\uff0c\u4ed6\u53d1\u4e86\u4e2a\u6d88\u606f\u7ed9100\u3002\u53d1\u5b8c\u4ee5\u540e\uff0c\u8fd9\u4e2a\u4e1c\u897f\u5e94\u8be5\u600e\u4e48\u5b58\u50a8\u5462\uff1f\u5728\u8fd9\u91cc\u9762\u4e00\u5b9a\u8981\u5206\u5f00\uff0c\u8bb0\u5f55\u7f6e\u9876\u7684\u8fd9\u4e9b\u4eba\u7684\u4f1a\u8bdd\uff0c\u5bf9\u5e94\u7684\u4f1a\u8bdd\u663e\u793a\u987a\u5e8f\u548c\u975e\u7f6e\u9876\u7684\u4e00\u5b9a\u8981\u5206\u4e24\u3002 \u8fd9\u91cc\u9762\u6211\u4eec\u521b\u5efa\u4e24\u4e2a\u6a21\u578b\uff0c\u4e00\u4e2a\u662f\u666e\u901a\u7684\uff0c\u4e00\u4e2a\u662f\u7f6e\u9876\u7684\uff0c\u800c\u4e0a\u9762\u7684\u8fd9\u4e2a\u7f6e\u9876\u7684\u7528\u6237\u5462\uff0c\u6211\u4eec\u7528set\u6765\u5b58\u50a8\uff0c\u56e0\u4e3a\u4e0d\u91cd\u590d\u3002\u800c\u4e0b\u9762\u8fd9\u4e9b\u56e0\u4e3a\u6709\u987a\u5e8f\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u7528list\u53bb\u5b58\u50a8,\u4e0d\u7136\u4f60\u600e\u4e48\u8868\u8fbe\u987a\u5e8f\u5462\uff1f \u90a3\u5f53300\u53d1\u7ed9\u6d88\u606f\u7ed9100\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5148\u5224\u5b9a\u4f60\u5728\u7f6e\u9876\u4eba\u7fa4\u4e2d\u5417\uff1f\u4e0d\u5728,\u90a3\u597d\uff0c300\u7684\u6d88\u606f\u5bf9\u5e94\u7684\u987a\u5e8f\u5c31\u5e94\u8be5\u653e\u5728\u666e\u901a\u7684\u5217\u8868\u91cc\u8fb9\u3002\u800c\u5728\u8fd9\u91cc\u8fb9\uff0c\u6211\u4eec\u628a300\u52a0\u8fdb\u53bb\u3002\u7b2c\u4e00\u4e2a\u6570\u636e\u4e5f\u5c31\u662f\u73b0\u5728300\u3002 \u63a5\u4e0b\u6765400\uff0c\u53d1\u4e86\u4e2a\u6d88\u606f\u3002\u5224\u65ad\u4e00\u4e0b\uff0c\u4ed6\u662f\u9700\u8981\u7f6e\u9876\u7684\uff0c\u6240\u4ee5400\u5c06\u8fdb\u5165list\u7684\u7f6e\u9876\u91cc\u8fb9\u653e\u7740\u3002\u5f53\u524d\u8fd8\u6ca1\u6709\u7279\u6b8a\u7684\u5730\u65b9\u3002 \u518d\u6765200\u53d1\u6d88\u606f\u4e86\uff0c\u548c\u521a\u624d\u7684\u5224\u5b9a\u65b9\u6cd5\u4e00\u6837\uff0c\u5148\u770b\u5728\u4e0d\u5728\u7f6e\u9876\u91cc\uff0c\u4e0d\u5728\u7684\u8bdd\u8fdb\u666e\u901a\uff0c\u7136\u540e\u5728\u666e\u901a\u91cc\u8fb9\u628a200\u52a0\u5165\u5c31\u884c\u4e86\uff0cOK\uff0c\u5230\u8fd9\u91cc\u76ee\u524d\u8fd8\u6ca1\u6709\u987a\u5e8f\u53d8\u5316\u3002 \u63a5\u4e0b\u6765200\u53c8\u53d1\u6d88\u606f\u8fc7\u6765\uff0c\u540c\u4e00\u4e2a\u4eba\u7ed9\u4f60\u8fde\u53d1\u4e86\u4e24\u6761\uff0c\u90a3\u8fd9\u4e2a\u65f6\u5019200\u7684\u6d88\u606f\u5230\u8fbe\u4ee5\u540e\uff0c\u5148\u5224\u65ad\u662f\u5426\u5728\u7f6e\u9876\u8303\u56f4\uff0c\u4e0d\u5728\uff0c\u63a5\u4e0b\u6765\u4ed6\u8981\u653e\u5728list\u666e\u901a\u4e2d\uff0c\u8fd9\u91cc\u4f60\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u56e0\u4e3a\u8fd9\u91cc\u8fb9\u5df2\u7ecf\u6709200\uff0c\u6240\u4ee5\u8fdb\u6765\u4ee5\u540e\u5148\u5e72\u4e00\u4ef6\u4e8b\u513f\uff0c\u628a200\u6740\u6389\uff0c\u6ca1\u6709200\uff0c\u7136\u540e\u518d\u628a200\u52a0\u8fdb\u6765\uff0c\u90a3\u4f60\u60f3\u4e00\u4e0b\uff0c\u73b0\u5728\u8fd9\u4e2a\u4f4d\u7f6e\u987a\u5e8f\u662f\u4ec0\u4e48\u5462\uff1f\u5c31\u662f\u65b0\u7684\u90fd\u5728\u53f3\u8fb9\uff0c\u5bf9\u4e0d\u5bf9\uff1f \u8fd8\u8bb0\u5f97\u6211\u4eec\u8bf4list\u6a21\u578b\uff0c\u5982\u679c\u662f\u4e00\u4e2a\u53cc\u7aef\u961f\u5217\uff0c\u5b83\u662f\u53ef\u4ee5\u4e24\u5934\u8fdb\u4e24\u5934\u51fa\u3002\u5f53\u7136\u6211\u4eec\u53cc\u7aef\u4ece\u4e00\u5934\u8fdb\u4e00\u5934\u51fa\uff0c\u8fd9\u5c31\u662f\u6808\u6a21\u578b\uff0c\u73b0\u5728\u54b1\u4eec\u8fd0\u7528\u7684\u5c31\u662flist\u6a21\u578b\u4e2d\u7684\u6808\u6a21\u578b\u3002 \u73b0\u5728300\u53d1\u6d88\u606f\uff0c\u5148\u5224\u5b9a\u4ed6\u5728\u4e0d\u5728\uff0c\u4e0d\u5728\uff0c\u7528\u666e\u901a\u7684\u961f\u5217\uff0c\u63a5\u4e0b\u6765\u6309\u7167\u521a\u624d\u7684\u64cd\u4f5c\uff0c\u4e0d\u7ba1\u4f60\u91cc\u8fb9\u539f\u6765\u6709\u6ca1\u6709300\uff0c\u6211\u5148\u628a300\u6740\u6389\uff0c\u6ca1\u4e86\uff0c200\u81ea\u7136\u5c31\u586b\u5230300\u7684\u4f4d\u7f6e\u4e86\uff0c\u4ed6\u73b0\u5728\u662flist\u91cc\u9762\u552f\u4e00\u4e00\u4e2a\uff0c\u7136\u540e\u8ba9300\u8fdb\u6765\uff0c\u6ce8\u610f\u662f\u4ece\u53f3\u4fa7\u8fdb\u6765\u7684\uff0c\u90a3\u4e48\u73b0\u5728300\u5c31\u662f\u6700\u65b0\u7684\u3002 \u90a3\u4e48\u5230\u8fd9\u91cc\u5462\uff0c\u6211\u4eec\u8ba9100\u6765\u8bfb\u53d6\u6d88\u606f\u3002\u4f60\u89c9\u5f97\u8fd9\u4e2a\u6d88\u606f\u987a\u5e8f\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u7684\uff1f\u9996\u5148\u7f6e\u9876\u7684400\u6709\u4e00\u4e2a\uff0c\u4ed6\u8dd1\u5728\u6700\u4e0a\u9762\uff0c\u7136\u540elist\u666e\u901a\u5982\u679c\u51fa\u6765\u7684\u8bdd\uff0c300\u662f\u6700\u65b0\u7684\u6d88\u606f\uff0c\u800c200\u5728\u4ed6\u540e\u9762\u7684\u3002\u7528\u8fd9\u79cd\u5f62\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u505a\u51fa\u6765\u4ed6\u7684\u6d88\u606f\u987a\u5e8f\u6765\u3002","title":"2.14.1\u4e1a\u52a1\u573a\u666f"},{"location":"redis/day01/#2142","text":"\u770b\u4e00\u4e0b\u6700\u7ec8\u7684\u89e3\u51b3\u65b9\u6848\uff1a \u4f9d\u8d56list\u7684\u6570\u636e\u5177\u6709\u987a\u5e8f\u7684\u7279\u5f81\u5bf9\u6d88\u606f\u8fdb\u884c\u7ba1\u7406\uff0c\u5c06list\u7ed3\u6784\u4f5c\u4e3a\u6808\u4f7f\u7528 \u7f6e\u9876\u4e0e\u666e\u901a\u4f1a\u8bdd\u5206\u522b\u521b\u5efa\u72ec\u7acb\u7684list\u5206\u522b\u7ba1\u7406 \u5f53\u67d0\u4e2alist\u4e2d\u63a5\u6536\u5230\u7528\u6237\u6d88\u606f\u540e\uff0c\u5c06\u6d88\u606f\u53d1\u9001\u65b9\u7684id\u4ecelist\u7684\u4e00\u4fa7\u52a0\u5165list\uff08\u6b64\u5904\u8bbe\u5b9a\u5de6\u4fa7\uff09 \u591a\u4e2a\u76f8\u540cid\u53d1\u51fa\u7684\u6d88\u606f\u53cd\u590d\u5165\u6808\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u5728\u5165\u6808\u4e4b\u524d\u65e0\u8bba\u662f\u5426\u5177\u6709\u5f53\u524did\u5bf9\u5e94\u7684\u6d88\u606f\uff0c\u5148\u5220\u9664\u5bf9\u5e94id \u63a8\u9001\u6d88\u606f\u65f6\u5148\u63a8\u9001\u7f6e\u9876\u4f1a\u8bddlist\uff0c\u518d\u63a8\u9001\u666e\u901a\u4f1a\u8bddlist\uff0c\u63a8\u9001\u5b8c\u6210\u7684list\u6e05\u9664\u6240\u6709\u6570\u636e \u6d88\u606f\u7684\u6570\u91cf\uff0c\u4e5f\u5c31\u662f\u5fae\u4fe1\u7528\u6237\u5bf9\u8bdd\u6570\u91cf\u91c7\u7528\u8ba1\u6570\u5668\u7684\u601d\u60f3\u53e6\u884c\u8bb0\u5f55\uff0c\u4f34\u968flist\u64cd\u4f5c\u540c\u6b65\u66f4\u65b0","title":"2.14.2  \u89e3\u51b3\u65b9\u6848"},{"location":"redis/day01/#2143","text":"\u603b\u7ed3\u4e00\u4e0b\uff0c\u5728\u6574\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u4e86\u54ea\u4e9b\u5185\u5bb9\uff1a \u9996\u5148\u6211\u4eec\u4e86\u89e3\u4e86\u4e00\u4e0b\u6570\u636e\u7c7b\u578b\uff0c\u63a5\u4e0b\u6765\u9488\u5bf9\u7740\u6211\u4eec\u8981\u5b66\u4e60\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fdb\u884c\u9010\u4e00\u8bb2\u89e3\u4e86string\u3001hash\u3001list\u3001set\u7b49\uff0c\u6700\u540e\u901a\u8fc7\u4e00\u4e2a\u6848\u4f8b\u603b\u7ed3\u4e86\u4e00\u4e0b\u524d\u9762\u7684\u6570\u636e\u7c7b\u578b\u7684\u4f7f\u7528\u573a\u666f\u3002","title":"2.14.3  \u6570\u636e\u7c7b\u578b\u603b\u7ed3"},{"location":"redis/day01/#3","text":"\u5728\u8fd9\u90e8\u5206\u4e2d\u5462\uff0c\u6211\u4eec\u5bb6\u5b66\u4e60\u4e24\u4e2a\u77e5\u8bc6\uff0c\u7b2c\u4e00\u4e2a\u662fkey\u7684\u5e38\u7528\u6307\u4ee4\uff0c\u7b2c\u4e8c\u4e2a\u662f\u6570\u636e\u5e93\u7684\u5e38\u7528\u6307\u4ee4\u3002\u548c\u524d\u9762\u6211\u4eec\u5b66\u6570\u636e\u7c7b\u578b\u505a\u4e00\u4e0b\u533a\u5206\uff0c\u524d\u9762\u4f60\u5b66\u7684\u90a3\u4e9b\u6307\u4ee4\u5462\uff0c\u90fd\u662f\u9488\u5bf9\u67d0\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u64cd\u4f5c\u7684\uff0c\u73b0\u5728\u5b66\u7684\u90fd\u662f\u5bf9\u6240\u6709\u7684\u64cd\u4f5c\u7684\uff0c\u6765\u770b\u4e00\u4e0b\uff0c\u6211\u4eec\u5728\u5b66\u4e60Key\u7684\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5148\u60f3\u4e00\u4e0b\u7684\u64cd\u4f5c\u6211\u4eec\u5e94\u8be5\u5b66\u54ea\u4e9b\u4e1c\u897f:","title":"3. \u5e38\u7528\u6307\u4ee4"},{"location":"redis/day01/#31_key","text":"","title":"3.1  key \u64cd\u4f5c\u5206\u6790"},{"location":"redis/day01/#311_key","text":"key\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u901a\u8fc7key\u83b7\u53d6redis\u4e2d\u4fdd\u5b58\u7684\u6570\u636e \u5bf9\u4e8ekey\u81ea\u8eab\u72b6\u6001\u7684\u76f8\u5173\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u5220\u9664\uff0c\u5224\u5b9a\u5b58\u5728\uff0c\u83b7\u53d6\u7c7b\u578b\u7b49 \u5bf9\u4e8ekey\u6709\u6548\u6027\u63a7\u5236\u76f8\u5173\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u6709\u6548\u671f\u8bbe\u5b9a\uff0c\u5224\u5b9a\u662f\u5426\u6709\u6548\uff0c\u6709\u6548\u72b6\u6001\u7684\u5207\u6362\u7b49 \u5bf9\u4e8ekey\u5feb\u901f\u67e5\u8be2\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u6309\u6307\u5b9a\u7b56\u7565\u67e5\u8be2key","title":"3.1.1  key\u5e94\u8be5\u8bbe\u8ba1\u54ea\u4e9b\u64cd\u4f5c\uff1f"},{"location":"redis/day01/#312_key","text":"\u5220\u9664\u6307\u5b9akey del key \u83b7\u53d6key\u662f\u5426\u5b58\u5728 exists key \u83b7\u53d6key\u7684\u7c7b\u578b type key 3.1.3 \u62d3\u5c55\u64cd\u4f5c \u6392\u5e8f sort \u6539\u540d rename key newkey renamenx key newkey","title":"3.1.2  key \u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#313_key","text":"\u4e3a\u6307\u5b9akey\u8bbe\u7f6e\u6709\u6548\u671f expire key seconds pexpire key milliseconds expireat key timestamp pexpireat key milliseconds-timestamp \u83b7\u53d6key\u7684\u6709\u6548\u65f6\u95f4 ttl key pttl key \u5207\u6362key\u4ece\u65f6\u6548\u6027\u8f6c\u6362\u4e3a\u6c38\u4e45\u6027 persist key","title":"3.1.3  key \u6269\u5c55\u64cd\u4f5c\uff08\u65f6\u6548\u6027\u63a7\u5236\uff09"},{"location":"redis/day01/#314_key","text":"\u67e5\u8be2key keys pattern \u67e5\u8be2\u6a21\u5f0f\u89c4\u5219 *\u5339\u914d\u4efb\u610f\u6570\u91cf\u7684\u4efb\u610f\u7b26\u53f7 ? \u914d\u5408\u4e00\u4e2a\u4efb\u610f\u7b26\u53f7 [] \u5339\u914d\u4e00\u4e2a\u6307\u5b9a\u7b26\u53f7 keys * keys \u67e5\u8be2\u6240\u6709 it* keys \u67e5\u8be2\u6240\u6709\u4ee5it\u5f00\u5934 *heima \u67e5\u8be2\u6240\u6709\u4ee5heima\u7ed3\u5c3e keys ??heima \u67e5\u8be2\u6240\u6709\u524d\u9762\u4e24\u4e2a\u5b57\u7b26\u4efb\u610f\uff0c\u540e\u9762\u4ee5heima\u7ed3\u5c3e \u67e5\u8be2\u6240\u6709\u4ee5 keys user:? user:\u5f00\u5934\uff0c\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4efb\u610f keys u [ st ] er:1 \u67e5\u8be2\u6240\u6709\u4ee5u\u5f00\u5934\uff0c\u4ee5er:1\u7ed3\u5c3e\uff0c\u4e2d\u95f4\u5305\u542b\u4e00\u4e2a\u5b57\u6bcd\uff0cs\u6216t","title":"3.1.4  key \u6269\u5c55\u64cd\u4f5c\uff08\u67e5\u8be2\u6a21\u5f0f\uff09"},{"location":"redis/day01/#32","text":"","title":"3.2  \u6570\u636e\u5e93\u6307\u4ee4"},{"location":"redis/day01/#321_key","text":"\u5728\u8fd9\u4e2a\u5730\u65b9\u6211\u4eec\u6765\u8bb2\u4e00\u4e0b\u6570\u636e\u5e93\u7684\u5e38\u7528\u6307\u4ee4\uff0c\u5728\u8bb2\u8fd9\u4e2a\u4e1c\u897f\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a \u5047\u5982\u8bf4\u4f60\u4eec\u5341\u4e2a\u4eba\u540c\u65f6\u64cd\u4f5credis\uff0c\u4f1a\u4e0d\u4f1a\u51fa\u73b0key\u540d\u5b57\u547d\u540d\u51b2\u7a81\u7684\u95ee\u9898\u3002 \u4e00\u5b9a\u4f1a\uff0c\u4e3a\u4ec0\u4e48?\u56e0\u4e3a\u4f60\u7684key\u662f\u7531\u7a0b\u5e8f\u800c\u5b9a\u4e49\u7684\u3002\u4f60\u60f3\u5199\u4ec0\u4e48\u5199\u4ec0\u4e48\uff0c\u90a3\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u4e2d\u5927\u5bb6\u90fd\u5728\u4e0d\u505c\u7684\u52a0\uff0c\u65e9\u665a\u6709\u4e00\u5929\u4ed6\u4f1a\u51b2\u7a81\u7684\u3002 redis\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u4f34\u968f\u7740\u64cd\u4f5c\u6570\u636e\u91cf\u7684\u589e\u52a0\uff0c\u4f1a\u51fa\u73b0\u5927\u91cf\u7684\u6570\u636e\u4ee5\u53ca\u5bf9\u5e94\u7684key\u3002 \u90a3\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u8981\u4e0d\u8981\u89e3\u51b3\uff1f\u8981\uff01\u600e\u4e48\u89e3\u51b3\u5462\uff1f\u6211\u4eec\u6700\u597d\u628a\u6570\u636e\u8fdb\u884c\u4e00\u4e2a\u5206\u7c7b\uff0c\u9664\u4e86\u547d\u540d\u89c4\u8303\u6211\u4eec\u505a\u7edf\u4e00\u4ee5\u5916\uff0c\u5982\u679c\u8fd8\u80fd\u628a\u5b83\u5206\u5f00\uff0c\u8fd9\u6837\u662f\u4e0d\u662f\u51b2\u7a81\u7684\u673a\u7387\u5c31\u4f1a\u5c0f\u4e00\u4e9b\u4e86\uff0c\u8fd9\u5c31\u662f\u54b1\u4eec\u4e0b\u9762\u8981\u8bf4\u7684\u89e3\u51b3\u65b9\u6848\uff01","title":"3.2.1  key \u7684\u91cd\u590d\u95ee\u9898"},{"location":"redis/day01/#322","text":"redis\u4e3a\u6bcf\u4e2a\u670d\u52a1\u63d0\u4f9b\u670916\u4e2a\u6570\u636e\u5e93\uff0c\u7f16\u53f7\u4ece0\u523015 \u6bcf\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u6570\u636e\u76f8\u4e92\u72ec\u7acb \u5728\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u4e2d\u5212\u51fa\u4e00\u5757\u533a\u57df\uff0c\u8bf4\u4ed6\u5c31\u662f\u51e0\uff0c\u4f60\u5c31\u7528\u51e0\u90a3\u5757\uff0c\u540c\u65f6\uff0c\u5176\u4ed6\u7684\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u8fdb\u884c\u5b9a\u4e49\uff0c\u4e00\u5171\u662f16\u4e2a\uff0c\u8fd9\u91cc\u8fb9\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u4ed6\u4eec\u8fd916\u4e2a\u5171\u7528redis\u7684\u5185\u5b58\u3002\u6ca1\u6709\u8bf4\u8c01\u5927\u8c01\u5c0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6570\u5b57\u53ea\u662f\u4ee3\u8868\u4e86\u4e00\u5757\u513f\u533a\u57df\uff0c\u533a\u57df\u5177\u4f53\u591a\u5927\u672a\u77e5\u3002\u8fd9\u662f\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u5206\u533a\u7684\u4e00\u4e2a\u7b56\u7565\uff01","title":"3.2.2  \u89e3\u51b3\u65b9\u6848"},{"location":"redis/day01/#323","text":"\u5207\u6362\u6570\u636e\u5e93 select index \u5176\u4ed6\u64cd\u4f5c ping","title":"3.2.3   \u6570\u636e\u5e93\u7684\u57fa\u672c\u64cd\u4f5c"},{"location":"redis/day01/#324","text":"\u6570\u636e\u79fb\u52a8 move key db \u6570\u636e\u603b\u91cf dbsize \u6570\u636e\u6e05\u9664 flushdb flushall","title":"3.2.4  \u6570\u636e\u5e93\u6269\u5c55\u64cd\u4f5c"},{"location":"redis/day01/#4_jedis","text":"\u5728\u5b66\u4e60\u5b8credis\u540e\uff0c\u6211\u4eec\u73b0\u5728\u5c31\u8981\u7528Java\u6765\u8fde\u63a5redis\u4e86\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u7684\u8fd9\u4e00\u7ae0\u8981\u5b66\u7684Jedis\u4e86\u3002\u5728\u8fd9\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u4e3b\u8981\u8bb2\u89e3\u4ee5\u4e0b3\u4e2a\u5185\u5bb9\uff1a HelloWorld\uff08Jedis\u7248\uff09 Jedis\u7b80\u6613\u5de5\u5177\u7c7b\u5f00\u53d1 \u53ef\u89c6\u5316\u5ba2\u6237\u7aef","title":"4. Jedis"},{"location":"redis/day01/#41_jedis","text":"","title":"4.1  Jedis\u7b80\u4ecb"},{"location":"redis/day01/#411_redis","text":"\u5bf9\u4e8e\u6211\u4eec\u73b0\u5728\u7684\u6570\u636e\u6765\u8bf4\uff0c\u5b83\u662f\u5728\u6211\u4eec\u7684redis\u4e2d\uff0c\u800c\u6700\u7ec8\u6211\u4eec\u662f\u8981\u505a\u7a0b\u5e8f\u3002\u90a3\u4e48\u7a0b\u5e8f\u5c31\u8981\u548c\u6211\u4eec\u7684redis\u8fdb\u884c\u8fde\u63a5\u3002\u5e72\u4ec0\u4e48\u4e8b\u60c5\u5462\uff1f\u4e24\u4ef6\u4e8b\uff1a\u7a0b\u5e8f\u4e2d\u6709\u6570\u636e\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8981\u628a\u8fd9\u4e9b\u6570\u636e\u5168\u90e8\u4ea4\u7ed9redis\u7ba1\u7406\u3002\u540c\u65f6\uff0credis\u4e2d\u7684\u6570\u636e\u8fd8\u80fd\u53d6\u51fa\u6765\uff0c\u56de\u5230\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u90a3\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u5728Java\u4e0eredis\u4e4b\u95f4\u6253\u4ea4\u9053\u7684\u8fd9\u4e2a\u4e1c\u897f\u5c31\u53eb\u505aJedis.\u7b80\u5355\u8bf4\uff0cJedis\u5c31\u662f\u63d0\u4f9b\u4e86Java\u4e0eredis\u7684\u8fde\u63a5\u670d\u52a1\u7684\uff0c\u91cc\u8fb9\u6709\u5404\u79cd\u5404\u6837\u7684API\u63a5\u53e3\uff0c\u4f60\u53ef\u4ee5\u53bb\u8c03\u7528\u5b83\u3002 \u9664\u4e86Jedis\u5916\uff0c\u8fd8\u6709\u6ca1\u6709\u5176\u4ed6\u7684\u8fd9\u79cd\u8fde\u63a5\u670d\u52a1\u5462\uff1f\u5176\u5b9e\u8fd8\u6709\u5f88\u591a\uff0c\u4e86\u89e3\u4e00\u4e0b\uff1a Java\u8bed\u8a00\u8fde\u63a5redis\u670d\u52a1 Jedis\uff08SpringData\u3001Redis \u3001 Lettuce\uff09 \u5176\u5b83\u8bed\u8a00\uff1aC \u3001C++ \u3001C# \u3001Erlang\u3001Lua \u3001Objective-C \u3001Perl \u3001PHP \u3001Python \u3001Ruby \u3001Scala","title":"4.1.1  \u7f16\u7a0b\u8bed\u8a00\u4e0eredis"},{"location":"redis/day01/#412","text":"(1)jar\u5305\u5bfc\u5165 \u4e0b\u8f7d\u5730\u5740\uff1ahttps://mvnrepository.com/artifact/redis.clients/jedis \u57fa\u4e8emaven <dependency> <groupId> redis.clients </groupId> <artifactId> jedis </artifactId> <version> 2.9.0 </version> </dependency> (2)\u5ba2\u6237\u7aef\u8fde\u63a5redis \u8fde\u63a5redis Jedis jedis = new Jedis(\"localhost\", 6379); \u64cd\u4f5credis jedis.set(\"name\", \"itheima\"); jedis.get(\"name\"); \u5173\u95edredis\u8fde\u63a5 jedis.close(); API\u6587\u6863 http://xetorthio.github.io/jedis/","title":"4.1.2  \u51c6\u5907\u5de5\u4f5c"},{"location":"redis/day01/#413","text":"\u521b\u5efa\uff1acom.itheima.JedisTest public class JedisTest { public static void main ( String [] args ) { //1.\u83b7\u53d6\u8fde\u63a5\u5bf9\u8c61 Jedis jedis = new Jedis ( \"192.168.40.130\" , 6379 ); //2.\u6267\u884c\u64cd\u4f5c jedis . set ( \"age\" , \"39\" ); String hello = jedis . get ( \"hello\" ); System . out . println ( hello ); jedis . lpush ( \"list1\" , \"a\" , \"b\" , \"c\" , \"d\" ); List < String > list1 = jedis . lrange ( \"list1\" , 0 , - 1 ); for ( String s : list1 ) { System . out . println ( s ); } jedis . sadd ( \"set1\" , \"abc\" , \"abc\" , \"def\" , \"poi\" , \"cba\" ); Long len = jedis . scard ( \"set1\" ); System . out . println ( len ); //3.\u5173\u95ed\u8fde\u63a5 jedis . close (); } }","title":"4.1.3 \u4ee3\u7801\u5b9e\u73b0"},{"location":"redis/day01/#42_jedis","text":"\u524d\u9762\u6211\u4eec\u505a\u7684\u7a0b\u5e8f\u8fd8\u662f\u6709\u70b9\u513f\u5c0f\u95ee\u9898\uff0c\u5c31\u662f\u6211\u4eec\u7684Jedis\u5bf9\u8c61\u7684\u7ba1\u7406\u662f\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u7684\uff0c\u771f\u5b9e\u4f01\u4e1a\u5f00\u53d1\u4e2d\u662f\u4e0d\u53ef\u80fd\u8ba9\u4f60\u53bbnew\u4e00\u4e2a\u7684\uff0c\u90a3\u63a5\u4e0b\u6765\u54b1\u4eec\u5c31\u8981\u505a\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u505a\u4e00\u4e2a\u521b\u5efaJedis\u7684\u8fd9\u6837\u7684\u4e00\u4e2a\u5de5\u5177\u3002","title":"4.2  Jedis\u7b80\u6613\u5de5\u5177\u7c7b\u5f00\u53d1"},{"location":"redis/day01/#421","text":"JedisPool\uff1aJedis\u63d0\u4f9b\u7684\u8fde\u63a5\u6c60\u6280\u672f poolConfig:\u8fde\u63a5\u6c60\u914d\u7f6e\u5bf9\u8c61 host:redis\u670d\u52a1\u5730\u5740 port:redis\u670d\u52a1\u7aef\u53e3\u53f7 JedisPool\u7684\u6784\u9020\u5668\u5982\u4e0b\uff1a public JedisPool ( GenericObjectPoolConfig poolConfig , String host , int port ) { this ( poolConfig , host , port , 2000 , ( String ) null , 0 , ( String ) null ); }","title":"4.2.1  \u57fa\u4e8e\u8fde\u63a5\u6c60\u83b7\u53d6\u8fde\u63a5"},{"location":"redis/day01/#422","text":"\u521b\u5efajedis\u7684\u914d\u7f6e\u6587\u4ef6\uff1ajedis.properties jedis.host = 192.168.40.130 jedis.port = 6379 jedis.maxTotal = 50 jedis.maxIdle = 10","title":"4.2.2  \u5c01\u88c5\u8fde\u63a5\u53c2\u6570"},{"location":"redis/day01/#423","text":"\u521b\u5efaJedisUtils\uff1acom.itheima.util.JedisUtils\uff0c\u4f7f\u7528\u9759\u6001\u4ee3\u7801\u5757\u521d\u59cb\u5316\u8d44\u6e90 public class JedisUtils { private static int maxTotal ; private static int maxIdel ; private static String host ; private static int port ; private static JedisPoolConfig jpc ; private static JedisPool jp ; static { ResourceBundle bundle = ResourceBundle . getBundle ( \"redis\" ); maxTotal = Integer . parseInt ( bundle . getString ( \"redis.maxTotal\" )); maxIdel = Integer . parseInt ( bundle . getString ( \"redis.maxIdel\" )); host = bundle . getString ( \"redis.host\" ); port = Integer . parseInt ( bundle . getString ( \"redis.port\" )); //Jedis\u8fde\u63a5\u6c60\u914d\u7f6e jpc = new JedisPoolConfig (); jpc . setMaxTotal ( maxTotal ); jpc . setMaxIdle ( maxIdel ); jp = new JedisPool ( jpc , host , port ); } }","title":"4.2.3  \u52a0\u8f7d\u914d\u7f6e\u4fe1\u606f"},{"location":"redis/day01/#424","text":"\u5bf9\u5916\u8bbf\u95ee\u63a5\u53e3\uff0c\u63d0\u4f9bjedis\u8fde\u63a5\u5bf9\u8c61\uff0c\u8fde\u63a5\u4ece\u8fde\u63a5\u6c60\u83b7\u53d6\uff0c\u5728JedisUtils\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u83b7\u53d6jedis\u7684\u65b9\u6cd5\uff1agetJedis public static Jedis getJedis (){ Jedis jedis = jedisPool . getResource (); return jedis ; }","title":"4.2.4  \u83b7\u53d6\u8fde\u63a5"},{"location":"redis/day01/#43","text":"4.3.1 Redis Desktop Manager","title":"4.3  \u53ef\u89c6\u5316\u5ba2\u6237\u7aef"},{"location":"redis/day01/#5","text":"\u4e0b\u9762\u5462\uff0c\u8fdb\u5165\u5230\u6301\u4e45\u5316\u7684\u5b66\u4e60.\u8fd9\u90e8\u5206\u5185\u5bb9\u7406\u89e3\u7684\u4e1c\u897f\u591a\uff0c\u64cd\u4f5c\u7684\u4e1c\u897f\u5c11\u3002\u5728\u8fd9\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u8bb2\u89e3\u56db\u4e2a\u4e1c\u897f\uff1a \u6301\u4e45\u5316\u7b80\u4ecb RDB AOF RDB\u4e0eAOF\u533a\u522b","title":"5. \u6301\u4e45\u5316"},{"location":"redis/day01/#51","text":"","title":"5.1  \u6301\u4e45\u5316\u7b80\u4ecb"},{"location":"redis/day01/#511_-","text":"\u4e0d\u77e5\u9053\u5927\u5bb6\u6709\u6ca1\u6709\u9047\u89c1\u8fc7\uff0c\u5c31\u662f\u6b63\u5de5\u4f5c\u7684\u65f6\u5019\u505c\u7535\u4e86\uff0c\u5982\u679c\u4f60\u7528\u7684\u662f\u7b14\u8bb0\u672c\u7535\u8111\u8fd8\u597d\uff0c\u4f60\u6709\u7535\u6c60\uff0c\u4f46\u5982\u679c\u4f60\u7528\u7684\u662f\u53f0\u5f0f\u673a\u5462\uff0c\u90a3\u6050\u6015\u5c31\u6bd4\u8f83\u707e\u96be\u4e86\uff0c\u5047\u5982\u4f60\u73b0\u5728\u6b63\u5728\u5199\u4e00\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u6587\u6863\uff0c\u5982\u679c\u4f60\u8981\u4f7f\u7528\u7684\u662fword\uff0c\u8fd9\u79cd\u529e\u516c\u81ea\u52a8\u5316\u8f6f\u4ef6\u7684\u8bdd\uff0c\u4ed6\u4e00\u65e6\u9047\u5230\u505c\u7535\uff0c\u5176\u5b9e\u4f60\u4e0d\u7528\u62c5\u5fc3\uff0c\u56e0\u4e3a\u5b83\u4f1a\u7ed9\u4f60\u751f\u6210\u4e00\u4e9b\u5176\u4ed6\u7684\u6587\u4ef6\u3002 \u5176\u5b9e\u4ed6\u4eec\u90fd\u5728\u505a\u4e00\u4ef6\u4e8b\u513f\uff0c\u5e2e\u4f60\u81ea\u52a8\u6062\u590d\uff0c\u6709\u4e86\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f60\u524d\u9762\u7684\u4e1c\u897f\u5c31\u4e0d\u518d\u4e22\u4e86\u3002\u90a3\u4ec0\u4e48\u662f\u81ea\u52a8\u6062\u590d\u5462\uff1f\u4f60\u8981\u5148\u4e86\u89e3\u4ed6\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002 \u6211\u4eec\u8bf4\u81ea\u52a8\u6062\u590d\uff0c\u5176\u5b9e\u57fa\u4e8e\u7684\u4e00\u4e2a\u524d\u63d0\u5c31\u662f\u4ed6\u63d0\u524d\u628a\u4f60\u7684\u6570\u636e\u7ed9\u5b58\u8d77\u6765\u4e86\u3002\u4f60\u5e73\u5e38\u64cd\u4f5c\u7684\u6240\u6709\u4fe1\u606f\u90fd\u662f\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u800c\u6211\u4eec\u771f\u6b63\u7684\u4fe1\u606f\u662f\u4fdd\u5b58\u5728\u786c\u76d8\u4e2d\u7684\uff0c\u5185\u5b58\u4e2d\u7684\u4fe1\u606f\u65ad\u7535\u4ee5\u540e\u5c31\u6d88\u5931\u4e86\uff0c\u786c\u76d8\u4e2d\u7684\u4fe1\u606f\u65ad\u7535\u4ee5\u540e\u8fd8\u53ef\u4ee5\u4fdd\u7559\u4e0b\u6765\uff01 \u6211\u4eec\u5c06\u6587\u4ef6\u7531\u5185\u5b58\u4e2d\u4fdd\u5b58\u5230\u786c\u76d8\u4e2d\u7684\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6211\u4eec\u53eb\u505a\u6570\u636e\u4fdd\u5b58\uff0c\u4e5f\u5c31\u53eb\u505a\u6301\u4e45\u5316\u3002\u4f46\u662f\u628a\u5b83\u4fdd\u5b58\u4e0b\u6765\u4e0d\u662f\u4f60\u7684\u76ee\u7684\uff0c\u6700\u7ec8\u4f60\u8fd8\u8981\u628a\u5b83\u518d\u8bfb\u53d6\u51fa\u6765\uff0c\u5b83\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u6211\u4eec\u53eb\u505a\u6570\u636e\u6062\u590d\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684word\u4e3a\u4ec0\u4e48\u65ad\u7535\u4ee5\u540e\u8fd8\u80fd\u591f\u7ed9\u4f60\u4fdd\u7559\u6587\u4ef6\uff0c\u56e0\u4e3a\u5b83\u6267\u884c\u4e86\u4e00\u4e2a\u81ea\u52a8\u5907\u4efd\u7684\u8fc7\u7a0b\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7\u81ea\u52a8\u7684\u5f62\u5f0f\uff0c\u628a\u4f60\u7684\u6570\u636e\u5b58\u50a8\u8d77\u6765\uff0c\u90a3\u4e48\u6709\u4e86\u8fd9\u79cd\u5f62\u5f0f\u4ee5\u540e\uff0c\u6211\u4eec\u7684\u6570\u636e\u5c31\u53ef\u4ee5\u7531\u5185\u5b58\u5230\u786c\u76d8\u4e0a\u5b9e\u73b0\u4fdd\u5b58\u3002","title":"5.1.1  \u573a\u666f-\u610f\u5916\u65ad\u7535"},{"location":"redis/day01/#512","text":"(1)\u4ec0\u4e48\u662f\u6301\u4e45\u5316 \u5229\u7528\u6c38\u4e45\u6027\u5b58\u50a8\u4ecb\u8d28\u5c06\u6570\u636e\u8fdb\u884c\u4fdd\u5b58\uff0c\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u5c06\u4fdd\u5b58\u7684\u6570\u636e\u8fdb\u884c\u6062\u590d\u7684\u5de5\u4f5c\u673a\u5236\u79f0\u4e3a\u6301\u4e45\u5316 \u3002 \u6301\u4e45\u5316\u7528\u4e8e\u9632\u6b62\u6570\u636e\u7684\u610f\u5916\u4e22\u5931\uff0c\u786e\u4fdd\u6570\u636e\u5b89\u5168\u6027\u3002 (2)\u6301\u4e45\u5316\u8fc7\u7a0b\u4fdd\u5b58\u4ec0\u4e48\uff1f \u6211\u4eec\u77e5\u9053\u4e00\u70b9\uff0c\u8ba1\u7b97\u673a\u4e2d\u7684\u6570\u636e\u5168\u90e8\u90fd\u662f\u4e8c\u8fdb\u5236\uff0c\u5982\u679c\u73b0\u5728\u6211\u8981\u4f60\u7ed9\u6211\u4fdd\u5b58\u4e00\u7ec4\u6570\u636e\u7684\u8bdd\uff0c\u4f60\u6709\u4ec0\u4e48\u6837\u7684\u65b9\u5f0f\u5462\uff0c\u5176\u5b9e\u6700\u7b80\u5355\u7684\u5c31\u662f\u73b0\u5728\u957f\u4ec0\u4e48\u6837\uff0c\u6211\u5c31\u8bb0\u4e0b\u6765\u5c31\u884c\u4e86\uff0c\u90a3\u4e48\u8fd9\u79cd\u662f\u8bb0\u5f55\u7eaf\u7cb9\u7684\u6570\u636e\uff0c\u4e5f\u53eb\u505a\u5feb\u7167\u5b58\u50a8\uff0c\u4e5f\u5c31\u662f\u5b83\u4fdd\u5b58\u7684\u662f\u67d0\u4e00\u65f6\u523b\u7684\u6570\u636e\u72b6\u6001\u3002 \u8fd8\u6709\u4e00\u79cd\u5f62\u5f0f\uff0c\u5b83\u4e0d\u8bb0\u5f55\u4f60\u7684\u6570\u636e\uff0c\u5b83\u8bb0\u5f55\u4f60\u6240\u6709\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u6bd4\u5982\u8bf4\u5927\u5bb6\u7528idea\u7684\u65f6\u5019\uff0c\u6709\u6ca1\u6709\u9047\u5230\u8fc7\u5199\u9519\u4e86ctrl+z\u64a4\u9500\uff0c\u7136\u540ectrl+y\u8fd8\u80fd\u6062\u590d\uff0c\u8fd9\u4e2a\u5730\u65b9\u5b83\u4e5f\u662f\u5728\u8bb0\u5f55\uff0c\u4f46\u662f\u8bb0\u5f55\u7684\u662f\u4f60\u6240\u6709\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u90a3\u6211\u60f3\u95ee\u4e00\u4e0b\uff0c\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u6211\u90fd\u7ed9\u4f60\u7559\u4e0b\u6765\u4e86\uff0c\u4f60\u8bf4\u6570\u636e\u8fd8\u4f1a\u4e22\u5417\uff1f\u80af\u5b9a\u4e0d\u4f1a\u4e22\uff0c\u56e0\u4e3a\u4f60\u6240\u6709\u7684\u64cd\u4f5c\u8fc7\u7a0b\u6211\u90fd\u4fdd\u5b58\u4e86\u3002\u8fd9\u79cd\u4fdd\u5b58\u64cd\u4f5c\u8fc7\u7a0b\u7684\u5b58\u50a8\uff0c\u7528\u4e13\u4e1a\u672f\u8bed\u6765\u8bf4\u53ef\u4ee5\u8bf4\u662f\u65e5\u5fd7\uff0c\u8fd9\u662f\u4e24\u79cd\u4e0d\u540c\u7684\u4fdd\u5b58\u6570\u636e\u7684\u5f62\u5f0f\u554a\u3002 \u603b\u7ed3\u4e00\u4e0b\uff1a \u7b2c\u4e00\u79cd\uff1a\u5c06\u5f53\u524d\u6570\u636e\u72b6\u6001\u8fdb\u884c\u4fdd\u5b58\uff0c\u5feb\u7167\u5f62\u5f0f\uff0c\u5b58\u50a8\u6570\u636e\u7ed3\u679c\uff0c\u5b58\u50a8\u683c\u5f0f\u7b80\u5355\uff0c\u5173\u6ce8\u70b9\u5728\u6570\u636e\u3002 \u7b2c\u4e8c\u79cd\uff1a\u5c06\u6570\u636e\u7684\u64cd\u4f5c\u8fc7\u7a0b\u8fdb\u884c\u4fdd\u5b58\uff0c\u65e5\u5fd7\u5f62\u5f0f\uff0c\u5b58\u50a8\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u5b58\u50a8\u683c\u5f0f\u590d\u6742\uff0c\u5173\u6ce8\u70b9\u5728\u6570\u636e\u7684\u64cd\u4f5c\u8fc7\u7a0b\u3002","title":"5.1.2  \u4ec0\u4e48\u662f\u6301\u4e45\u5316"},{"location":"redis/day01/#52_rdb","text":"","title":"5.2  RDB"},{"location":"redis/day01/#521_save","text":"\u624b\u52a8\u6267\u884c\u4e00\u6b21\u4fdd\u5b58\u64cd\u4f5c save save\u6307\u4ee4\u76f8\u5173\u914d\u7f6e \u8bbe\u7f6e\u672c\u5730\u6570\u636e\u5e93\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u503c\u4e3a dump.rdb\uff0c\u901a\u5e38\u8bbe\u7f6e\u4e3adump-\u7aef\u53e3\u53f7.rdb dbfilename filename \u8bbe\u7f6e\u5b58\u50a8.rdb\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u901a\u5e38\u8bbe\u7f6e\u6210\u5b58\u50a8\u7a7a\u95f4\u8f83\u5927\u7684\u76ee\u5f55\u4e2d\uff0c\u76ee\u5f55\u540d\u79f0data dir path \u8bbe\u7f6e\u5b58\u50a8\u81f3\u672c\u5730\u6570\u636e\u5e93\u65f6\u662f\u5426\u538b\u7f29\u6570\u636e\uff0c\u9ed8\u8ba4yes\uff0c\u8bbe\u7f6e\u4e3ano\uff0c\u8282\u7701 CPU \u8fd0\u884c\u65f6\u95f4\uff0c\u4f46\u5b58\u50a8\u6587\u4ef6\u53d8\u5927 rdbcompression yes|no \u8bbe\u7f6e\u8bfb\u5199\u6587\u4ef6\u8fc7\u7a0b\u662f\u5426\u8fdb\u884cRDB\u683c\u5f0f\u6821\u9a8c\uff0c\u9ed8\u8ba4yes\uff0c\u8bbe\u7f6e\u4e3ano\uff0c\u8282\u7ea6\u8bfb\u519910%\u65f6\u95f4\u6d88\u8017\uff0c\u5355\u5b58\u5728\u6570\u636e\u635f\u574f\u7684\u98ce\u9669 rdbchecksum yes|no save\u6307\u4ee4\u5de5\u4f5c\u539f\u7406 \u9700\u8981\u6ce8\u610f\u4e00\u4e2a\u95ee\u9898\uff0c\u6765\u770b\u4e00\u4e0b\uff0c\u73b0\u5728\u6709\u56db\u4e2a\u5ba2\u6237\u7aef\u5404\u81ea\u8981\u6267\u884c\u4e00\u4e2a\u6307\u4ee4\uff0c\u628a\u8fd9\u4e9b\u6307\u4ee4\u53d1\u9001\u5230redis\u670d\u52a1\u5668\u540e\uff0c\u4ed6\u4eec\u6267\u884c\u6709\u4e00\u4e2a\u5148\u540e\u987a\u5e8f\u95ee\u9898\uff0c\u5047\u5b9a\u5c31\u662f\u6309\u71671234\u7684\u987a\u5e8f\u653e\u8fc7\u53bb\u7684\u8bdd\uff0c\u90a3\u4f1a\u662f\u4ec0\u4e48\u6837\u7684\uff1f \u8bb0\u5f97redis\u662f\u4e2a\u5355\u7ebf\u7a0b\u7684\u5de5\u4f5c\u6a21\u5f0f\uff0c\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\u961f\u5217\uff0c\u6240\u6709\u7684\u547d\u4ee4\u90fd\u4f1a\u8fdb\u5230\u8fd9\u4e2a\u961f\u5217\u91cc\u8fb9\uff0c\u5728\u8fd9\u513f\u6392\u961f\u6267\u884c\uff0c\u6267\u884c\u5b8c\u4e00\u4e2a\u6d88\u5931\u4e00\u4e2a\uff0c\u5f53\u6240\u6709\u7684\u547d\u4ee4\u90fd\u6267\u884c\u5b8c\u4e86\uff0cOK\uff0c\u7ed3\u679c\u8fbe\u5230\u4e86\u3002 \u4f46\u662f\u5982\u679c\u73b0\u5728\u6211\u4eec\u6267\u884c\u7684\u65f6\u5019save\u6307\u4ee4\u4fdd\u5b58\u7684\u6570\u636e\u91cf\u5f88\u5927\u4f1a\u662f\u4ec0\u4e48\u73b0\u8c61\u5462\uff1f \u4ed6\u4f1a\u975e\u5e38\u8017\u65f6\uff0c\u4ee5\u81f3\u4e8e\u5f71\u54cd\u5230\u5b83\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u540e\u9762\u7684\u6307\u4ee4\u90fd\u8981\u7b49\uff0c\u6240\u4ee5\u8bf4\u8fd9\u79cd\u6a21\u5f0f\u662f\u4e0d\u53cb\u597d\u7684\uff0c\u8fd9\u662fsave\u6307\u4ee4\u5bf9\u5e94\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u5f53cpu\u6267\u884c\u7684\u65f6\u5019\u4f1a\u963b\u585eredis\u670d\u52a1\u5668\uff0c\u76f4\u5230\u4ed6\u6267\u884c\u5b8c\u6bd5\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u4e0d\u5efa\u8bae\u5927\u5bb6\u5728\u7ebf\u4e0a\u73af\u5883\u7528save\u6307\u4ee4\u3002","title":"5.2.1  save\u6307\u4ee4"},{"location":"redis/day01/#522_bgsave","text":"\u4e4b\u524d\u6211\u4eec\u8bb2\u5230\u4e86\u5f53save\u6307\u4ee4\u7684\u6570\u636e\u91cf\u8fc7\u5927\u65f6\uff0c\u5355\u7ebf\u7a0b\u6267\u884c\u65b9\u5f0f\u9020\u6210\u6548\u7387\u8fc7\u4f4e\uff0c\u90a3\u5e94\u8be5\u5982\u4f55\u5904\u7406\uff1f \u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\uff1a bgsave \u6307\u4ee4\uff0cbg\u5176\u5b9e\u662fbackground\u7684\u610f\u601d\uff0c\u540e\u53f0\u6267\u884c\u7684\u610f\u601d \u624b\u52a8\u542f\u52a8\u540e\u53f0\u4fdd\u5b58\u64cd\u4f5c\uff0c\u4f46\u4e0d\u662f\u7acb\u5373\u6267\u884c bgsave bgsave\u6307\u4ee4\u76f8\u5173\u914d\u7f6e \u540e\u53f0\u5b58\u50a8\u8fc7\u7a0b\u4e2d\u5982\u679c\u51fa\u73b0\u9519\u8bef\u73b0\u8c61\uff0c\u662f\u5426\u505c\u6b62\u4fdd\u5b58\u64cd\u4f5c\uff0c\u9ed8\u8ba4yes stop-writes-on-bgsave-error yes|no \u5176 \u4ed6 dbfilename filename dir path rdbcompression yes|no rdbchecksum yes|no bgsave\u6307\u4ee4\u5de5\u4f5c\u539f\u7406 \u5f53\u6267\u884cbgsave\u7684\u65f6\u5019\uff0c\u5ba2\u6237\u7aef\u53d1\u51fabgsave\u6307\u4ee4\u7ed9\u5230redis\u670d\u52a1\u5668\u3002\u6ce8\u610f\uff0c\u8fd9\u4e2a\u65f6\u5019\u670d\u52a1\u5668\u9a6c\u4e0a\u56de\u4e00\u4e2a\u7ed3\u679c\u544a\u8bc9\u5ba2\u6237\u7aef\u540e\u53f0\u5df2\u7ecf\u5f00\u59cb\u4e86\uff0c\u4e0e\u6b64\u540c\u65f6\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u4f7f\u7528Linux\u7684fork\u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u8ba9\u8fd9\u4e2a\u5b50\u8fdb\u7a0b\u53bb\u6267\u884csave\u76f8\u5173\u7684\u64cd\u4f5c\uff0c\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u60f3\u4e00\u4e0b\uff0c\u6211\u4eec\u4e3b\u8fdb\u7a0b\u4e00\u76f4\u5728\u5904\u7406\u6307\u4ee4\uff0c\u800c\u5b50\u8fdb\u7a0b\u5728\u6267\u884c\u540e\u53f0\u7684\u4fdd\u5b58\uff0c\u5b83\u4f1a\u4e0d\u4f1a\u5e72\u6270\u5230\u4e3b\u8fdb\u7a0b\u7684\u6267\u884c\u5417\uff1f \u7b54\u6848\u662f\u4e0d\u4f1a\uff0c\u6240\u4ee5\u8bf4\u4ed6\u624d\u662f\u4e3b\u6d41\u65b9\u6848\u3002\u5b50\u8fdb\u7a0b\u5f00\u59cb\u6267\u884c\u4e4b\u540e\uff0c\u5b83\u5c31\u4f1a\u521b\u5efa\u554aRDB\u6587\u4ef6\u628a\u5b83\u5b58\u8d77\u6765\uff0c\u64cd\u4f5c\u5b8c\u4ee5\u540e\u4ed6\u4f1a\u628a\u8fd9\u4e2a\u7ed3\u679c\u8fd4\u56de\uff0c\u4e5f\u5c31\u662f\u8bf4bgsave\u7684\u8fc7\u7a0b\u5206\u6210\u4e24\u4e2a\u8fc7\u7a0b\uff0c\u7b2c\u4e00\u4e2a\u662f\u670d\u52a1\u7aef\u62ff\u5230\u6307\u4ee4\u76f4\u63a5\u544a\u8bc9\u5ba2\u6237\u7aef\u5f00\u59cb\u6267\u884c\u4e86\uff1b\u53e6\u5916\u4e00\u4e2a\u8fc7\u7a0b\u662f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u5728\u5b8c\u6210\u540e\u53f0\u7684\u4fdd\u5b58\u64cd\u4f5c\uff0c\u64cd\u4f5c\u5b8c\u4ee5\u540e\u56de\u4e00\u4e2a\u6d88\u606f\u3002","title":"5.2.2  bgsave\u6307\u4ee4"},{"location":"redis/day01/#523_save","text":"\u8bbe\u7f6e\u81ea\u52a8\u6301\u4e45\u5316\u7684\u6761\u4ef6\uff0c\u6ee1\u8db3\u9650\u5b9a\u65f6\u95f4\u8303\u56f4\u5185key\u7684\u53d8\u5316\u6570\u91cf\u8fbe\u5230\u6307\u5b9a\u6570\u91cf\u5373\u8fdb\u884c\u6301\u4e45\u5316 save second changes \u53c2\u6570 second\uff1a\u76d1\u63a7\u65f6\u95f4\u8303\u56f4 changes\uff1a\u76d1\u63a7key\u7684\u53d8\u5316\u91cf \u8303\u4f8b\uff1a save 900 1 save 300 10 save 60 10000 \u5176\u4ed6\u76f8\u5173\u914d\u7f6e\uff1a dbfilename filename dir path rdbcompression yes|no rdbchecksum yes|no stop-writes-on-bgsave-error yes|no save\u914d\u7f6e\u5de5\u4f5c\u539f\u7406","title":"5.2.3 save\u914d\u7f6e\u81ea\u52a8\u6267\u884c"},{"location":"redis/day01/#524_rdb","text":"\u65b9\u5f0f save\u6307\u4ee4 bgsave\u6307\u4ee4 \u8bfb\u5199 \u540c\u6b65 \u5f02\u6b65 \u963b\u585e\u5ba2\u6237\u7aef\u6307\u4ee4 \u662f \u5426 \u989d\u5916\u5185\u5b58\u6d88\u8017 \u5426 \u662f \u542f\u52a8\u65b0\u8fdb\u7a0b \u5426 \u662f RDB\u7279\u6b8a\u542f\u52a8\u5f62\u5f0f \u670d\u52a1\u5668\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u91cd\u542f debug reload \u5173\u95ed\u670d\u52a1\u5668\u65f6\u6307\u5b9a\u4fdd\u5b58\u6570\u636e shutdown save \u5168\u91cf\u590d\u5236\uff08\u5728\u4e3b\u4ece\u590d\u5236\u4e2d\u8be6\u7ec6\u8bb2\u89e3\uff09 RDB\u4f18\u70b9\uff1a RDB\u662f\u4e00\u4e2a\u7d27\u51d1\u538b\u7f29\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5b58\u50a8\u6548\u7387\u8f83\u9ad8 RDB\u5185\u90e8\u5b58\u50a8\u7684\u662fredis\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u7684\u6570\u636e\u5feb\u7167\uff0c\u975e\u5e38\u9002\u5408\u7528\u4e8e\u6570\u636e\u5907\u4efd\uff0c\u5168\u91cf\u590d\u5236\u7b49\u573a\u666f RDB\u6062\u590d\u6570\u636e\u7684\u901f\u5ea6\u8981\u6bd4AOF\u5feb\u5f88\u591a \u5e94\u7528\uff1a\u670d\u52a1\u5668\u4e2d\u6bcfX\u5c0f\u65f6\u6267\u884cbgsave\u5907\u4efd\uff0c\u5e76\u5c06RDB\u6587\u4ef6\u62f7\u8d1d\u5230\u8fdc\u7a0b\u673a\u5668\u4e2d\uff0c\u7528\u4e8e\u707e\u96be\u6062\u590d\u3002 RDB\u7f3a\u70b9 RDB\u65b9\u5f0f\u65e0\u8bba\u662f\u6267\u884c\u6307\u4ee4\u8fd8\u662f\u5229\u7528\u914d\u7f6e\uff0c\u65e0\u6cd5\u505a\u5230\u5b9e\u65f6\u6301\u4e45\u5316\uff0c\u5177\u6709\u8f83\u5927\u7684\u53ef\u80fd\u6027\u4e22\u5931\u6570\u636e bgsave\u6307\u4ee4\u6bcf\u6b21\u8fd0\u884c\u8981\u6267\u884cfork\u64cd\u4f5c\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u8981\u727a\u7272\u6389\u4e00\u4e9b\u6027\u80fd Redis\u7684\u4f17\u591a\u7248\u672c\u4e2d\u672a\u8fdb\u884cRDB\u6587\u4ef6\u683c\u5f0f\u7684\u7248\u672c\u7edf\u4e00\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u5404\u7248\u672c\u670d\u52a1\u4e4b\u95f4\u6570\u636e\u683c\u5f0f\u65e0\u6cd5\u517c\u5bb9\u73b0\u8c61","title":"5.2.4 RDB\u4e09\u79cd\u542f\u52a8\u65b9\u5f0f\u5bf9\u6bd4"},{"location":"redis/day01/#53_aof","text":"\u4e3a\u4ec0\u4e48\u8981\u6709AOF,\u8fd9\u5f97\u4eceRDB\u7684\u5b58\u50a8\u7684\u5f0a\u7aef\u8bf4\u8d77\uff1a \u5b58\u50a8\u6570\u636e\u91cf\u8f83\u5927\uff0c\u6548\u7387\u8f83\u4f4e\uff0c\u57fa\u4e8e\u5feb\u7167\u601d\u60f3\uff0c\u6bcf\u6b21\u8bfb\u5199\u90fd\u662f\u5168\u90e8\u6570\u636e\uff0c\u5f53\u6570\u636e\u91cf\u5de8\u5927\u65f6\uff0c\u6548\u7387\u975e\u5e38\u4f4e \u5927\u6570\u636e\u91cf\u4e0b\u7684IO\u6027\u80fd\u8f83\u4f4e \u57fa\u4e8efork\u521b\u5efa\u5b50\u8fdb\u7a0b\uff0c\u5185\u5b58\u4ea7\u751f\u989d\u5916\u6d88\u8017 \u5b95\u673a\u5e26\u6765\u7684\u6570\u636e\u4e22\u5931\u98ce\u9669 \u90a3\u89e3\u51b3\u7684\u601d\u8def\u662f\u4ec0\u4e48\u5462\uff1f \u4e0d\u5199\u5168\u6570\u636e\uff0c\u4ec5\u8bb0\u5f55\u90e8\u5206\u6570\u636e \u964d\u4f4e\u533a\u5206\u6570\u636e\u662f\u5426\u6539\u53d8\u7684\u96be\u5ea6\uff0c\u6539\u8bb0\u5f55\u6570\u636e\u4e3a\u8bb0\u5f55\u64cd\u4f5c\u8fc7\u7a0b \u5bf9\u6240\u6709\u64cd\u4f5c\u5747\u8fdb\u884c\u8bb0\u5f55\uff0c\u6392\u9664\u4e22\u5931\u6570\u636e\u7684\u98ce\u9669","title":"5.3  AOF"},{"location":"redis/day01/#531_aof","text":"AOF (append only file)\u6301\u4e45\u5316\uff1a\u4ee5\u72ec\u7acb\u65e5\u5fd7\u7684\u65b9\u5f0f\u8bb0\u5f55\u6bcf\u6b21\u5199\u547d\u4ee4\uff0c\u91cd\u542f\u65f6\u518d\u91cd\u65b0\u6267\u884cAOF\u6587\u4ef6\u4e2d\u547d\u4ee4 \u8fbe\u5230\u6062\u590d\u6570\u636e\u7684\u76ee\u7684\u3002 \u4e0eRDB\u76f8\u6bd4\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u7531\u8bb0\u5f55\u6570\u636e\u6539\u4e3a\u8bb0\u5f55\u6570\u636e\u4ea7\u751f\u7684\u53d8\u5316 AOF\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u89e3\u51b3\u4e86\u6570\u636e\u6301\u4e45\u5316\u7684\u5b9e\u65f6\u6027\uff0c\u76ee\u524d\u5df2\u7ecf\u662fRedis\u6301\u4e45\u5316\u7684\u4e3b\u6d41\u65b9\u5f0f AOF\u5199\u6570\u636e\u8fc7\u7a0b \u542f\u52a8AOF\u76f8\u5173\u914d\u7f6e \u5f00\u542fAOF\u6301\u4e45\u5316\u529f\u80fd\uff0c\u9ed8\u8ba4no\uff0c\u5373\u4e0d\u5f00\u542f\u72b6\u6001 appendonly yes|no AOF\u6301\u4e45\u5316\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u6587\u4ef6\u540d\u4e3aappendonly.aof\uff0c\u5efa\u8bae\u914d\u7f6e\u4e3aappendonly-\u7aef\u53e3\u53f7.aof appendfilename filename AOF\u6301\u4e45\u5316\u6587\u4ef6\u4fdd\u5b58\u8def\u5f84\uff0c\u4e0eRDB\u6301\u4e45\u5316\u6587\u4ef6\u4fdd\u6301\u4e00\u81f4\u5373\u53ef dir AOF\u5199\u6570\u636e\u7b56\u7565\uff0c\u9ed8\u8ba4\u4e3aeverysec appendfsync always|everysec|no","title":"5.3.1 AOF\u6982\u5ff5"},{"location":"redis/day01/#532_aof","text":"AOF\u5199\u6570\u636e\u4e09\u79cd\u7b56\u7565(appendfsync) always (\u6bcf\u6b21\uff09\uff1a\u6bcf\u6b21\u5199\u5165\u64cd\u4f5c\u5747\u540c\u6b65\u5230AOF\u6587\u4ef6\u4e2d\u6570\u636e\u96f6\u8bef\u5dee\uff0c\u6027\u80fd\u8f83\u4f4e\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002 everysec \uff08\u6bcf\u79d2\uff09\uff1a\u6bcf\u79d2\u5c06\u7f13\u51b2\u533a\u4e2d\u7684\u6307\u4ee4\u540c\u6b65\u5230AOF\u6587\u4ef6\u4e2d\uff0c\u5728\u7cfb\u7edf\u7a81\u7136\u5b95\u673a\u7684\u60c5\u51b5\u4e0b\u4e22\u59311\u79d2\u5185\u7684\u6570\u636e \u6570\u636e\u51c6\u786e\u6027\u8f83\u9ad8\uff0c\u6027\u80fd\u8f83\u9ad8\uff0c\u5efa\u8bae\u4f7f\u7528\uff0c\u4e5f\u662f\u9ed8\u8ba4\u914d\u7f6e no \uff08\u7cfb\u7edf\u63a7\u5236\uff09\uff1a\u7531\u64cd\u4f5c\u7cfb\u7edf\u63a7\u5236\u6bcf\u6b21\u540c\u6b65\u5230AOF\u6587\u4ef6\u7684\u5468\u671f\uff0c\u6574\u4f53\u8fc7\u7a0b\u4e0d\u53ef\u63a7","title":"5.3.2 AOF\u6267\u884c\u7b56\u7565"},{"location":"redis/day01/#533_aof","text":"\u573a\u666f\uff1aAOF\u5199\u6570\u636e\u9047\u5230\u7684\u95ee\u9898\uff0c\u5982\u679c\u8fde\u7eed\u6267\u884c\u5982\u4e0b\u6307\u4ee4\u8be5\u5982\u4f55\u5904\u7406 \u4ec0\u4e48\u53ebAOF\u91cd\u5199\uff1f \u968f\u7740\u547d\u4ee4\u4e0d\u65ad\u5199\u5165AOF\uff0c\u6587\u4ef6\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cRedis\u5f15\u5165\u4e86AOF\u91cd\u5199\u673a\u5236\u538b\u7f29\u6587\u4ef6\u4f53\u79ef\u3002AOF\u6587\u4ef6\u91cd \u5199\u662f\u5c06Redis\u8fdb\u7a0b\u5185\u7684\u6570\u636e\u8f6c\u5316\u4e3a\u5199\u547d\u4ee4\u540c\u6b65\u5230\u65b0AOF\u6587\u4ef6\u7684\u8fc7\u7a0b\u3002\u7b80\u5355\u8bf4\u5c31\u662f\u5c06\u5bf9\u540c\u4e00\u4e2a\u6570\u636e\u7684\u82e5\u5e72\u4e2a\u6761\u547d\u4ee4\u6267\u884c\u7ed3 \u679c\u8f6c\u5316\u6210\u6700\u7ec8\u7ed3\u679c\u6570\u636e\u5bf9\u5e94\u7684\u6307\u4ee4\u8fdb\u884c\u8bb0\u5f55\u3002 AOF\u91cd\u5199\u4f5c\u7528 \u964d\u4f4e\u78c1\u76d8\u5360\u7528\u91cf\uff0c\u63d0\u9ad8\u78c1\u76d8\u5229\u7528\u7387 \u63d0\u9ad8\u6301\u4e45\u5316\u6548\u7387\uff0c\u964d\u4f4e\u6301\u4e45\u5316\u5199\u65f6\u95f4\uff0c\u63d0\u9ad8IO\u6027\u80fd \u964d\u4f4e\u6570\u636e\u6062\u590d\u7528\u65f6\uff0c\u63d0\u9ad8\u6570\u636e\u6062\u590d\u6548\u7387 AOF\u91cd\u5199\u89c4\u5219 \u8fdb\u7a0b\u5185\u5177\u6709\u65f6\u6548\u6027\u7684\u6570\u636e\uff0c\u5e76\u4e14\u6570\u636e\u5df2\u8d85\u65f6\u5c06\u4e0d\u518d\u5199\u5165\u6587\u4ef6 \u975e\u5199\u5165\u7c7b\u7684\u65e0\u6548\u6307\u4ee4\u5c06\u88ab\u5ffd\u7565\uff0c\u53ea\u4fdd\u7559\u6700\u7ec8\u6570\u636e\u7684\u5199\u5165\u547d\u4ee4 \u5982del key1\u3001 hdel key2\u3001srem key3\u3001set key4 111\u3001set key4 222\u7b49 \u5982select\u6307\u4ee4\u867d\u7136\u4e0d\u66f4\u6539\u6570\u636e\uff0c\u4f46\u662f\u66f4\u6539\u4e86\u6570\u636e\u7684\u5b58\u50a8\u4f4d\u7f6e\uff0c\u6b64\u7c7b\u547d\u4ee4\u540c\u6837\u9700\u8981\u8bb0\u5f55 \u5bf9\u540c\u4e00\u6570\u636e\u7684\u591a\u6761\u5199\u547d\u4ee4\u5408\u5e76\u4e3a\u4e00\u6761\u547d\u4ee4 \u5982lpushlist1 a\u3001lpush list1 b\u3001lpush list1 c\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff1alpush list1 a b c\u3002 \u4e3a\u9632\u6b62\u6570\u636e\u91cf\u8fc7\u5927\u9020\u6210\u5ba2\u6237\u7aef\u7f13\u51b2\u533a\u6ea2\u51fa\uff0c\u5bf9list\u3001set\u3001hash\u3001zset\u7b49\u7c7b\u578b\uff0c\u6bcf\u6761\u6307\u4ee4\u6700\u591a\u5199\u516564\u4e2a\u5143\u7d20 AOF\u91cd\u5199\u65b9\u5f0f \u624b\u52a8\u91cd\u5199 bgrewriteaof \u624b\u52a8\u91cd\u5199\u539f\u7406\u5206\u6790\uff1a \u81ea\u52a8\u91cd\u5199 auto-aof-rewrite-min-size size auto-aof-rewrite-percentage percentage \u81ea\u52a8\u91cd\u5199\u89e6\u53d1\u6761\u4ef6\u8bbe\u7f6e auto-aof-rewrite-min-size size auto-aof-rewrite-percentage percent \u81ea\u52a8\u91cd\u5199\u89e6\u53d1\u6bd4\u5bf9\u53c2\u6570\uff08 \u8fd0\u884c\u6307\u4ee4info Persistence\u83b7\u53d6\u5177\u4f53\u4fe1\u606f \uff09 aof_current_size aof_base_size \u81ea\u52a8\u91cd\u5199\u89e6\u53d1\u6761\u4ef6\u516c\u5f0f\uff1a","title":"5.3.3 AOF\u91cd\u5199"},{"location":"redis/day01/#534_aof","text":"","title":"5.3.4 AOF\u5de5\u4f5c\u6d41\u7a0b\u53ca\u91cd\u5199\u6d41\u7a0b"},{"location":"redis/day01/#54_rdbaof","text":"","title":"5.4  RDB\u4e0eAOF\u533a\u522b"},{"location":"redis/day01/#541_rdbaof","text":"\u6301\u4e45\u5316\u65b9\u5f0f RDB AOF \u5360\u7528\u5b58\u50a8\u7a7a\u95f4 \u5c0f\uff08\u6570\u636e\u7ea7\uff1a\u538b\u7f29\uff09 \u5927\uff08\u6307\u4ee4\u7ea7\uff1a\u91cd\u5199\uff09 \u5b58\u50a8\u901f\u5ea6 \u6162 \u5feb \u6062\u590d\u901f\u5ea6 \u5feb \u6162 \u6570\u636e\u5b89\u5168\u6027 \u4f1a\u4e22\u5931\u6570\u636e \u4f9d\u636e\u7b56\u7565\u51b3\u5b9a \u8d44\u6e90\u6d88\u8017 \u9ad8/\u91cd\u91cf\u7ea7 \u4f4e/\u8f7b\u91cf\u7ea7 \u542f\u52a8\u4f18\u5148\u7ea7 \u4f4e \u9ad8","title":"5.4.1 RDB\u4e0eAOF\u5bf9\u6bd4\uff08\u4f18\u7f3a\u70b9\uff09"},{"location":"redis/day01/#542_rdbaof","text":"RDB\u4e0eAOF\u7684\u9009\u62e9\u4e4b\u60d1 \u5bf9\u6570\u636e\u975e\u5e38\u654f\u611f\uff0c\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u7684AOF\u6301\u4e45\u5316\u65b9\u6848 AOF\u6301\u4e45\u5316\u7b56\u7565\u4f7f\u7528everysecond\uff0c\u6bcf\u79d2\u949ffsync\u4e00\u6b21\u3002\u8be5\u7b56\u7565redis\u4ecd\u53ef\u4ee5\u4fdd\u6301\u5f88\u597d\u7684\u5904\u7406\u6027\u80fd\uff0c\u5f53\u51fa \u73b0\u95ee\u9898\u65f6\uff0c\u6700\u591a\u4e22\u59310-1\u79d2\u5185\u7684\u6570\u636e\u3002 \u6ce8\u610f\uff1a\u7531\u4e8eAOF\u6587\u4ef6\u5b58\u50a8\u4f53\u79ef\u8f83\u5927\uff0c\u4e14\u6062\u590d\u901f\u5ea6\u8f83\u6162 \u6570\u636e\u5448\u73b0\u9636\u6bb5\u6709\u6548\u6027\uff0c\u5efa\u8bae\u4f7f\u7528RDB\u6301\u4e45\u5316\u65b9\u6848 \u6570\u636e\u53ef\u4ee5\u826f\u597d\u7684\u505a\u5230\u9636\u6bb5\u5185\u65e0\u4e22\u5931\uff08\u8be5\u9636\u6bb5\u662f\u5f00\u53d1\u8005\u6216\u8fd0\u7ef4\u4eba\u5458\u624b\u5de5\u7ef4\u62a4\u7684\uff09\uff0c\u4e14\u6062\u590d\u901f\u5ea6\u8f83\u5feb\uff0c\u9636\u6bb5 \u70b9\u6570\u636e\u6062\u590d\u901a\u5e38\u91c7\u7528RDB\u65b9\u6848 \u6ce8\u610f\uff1a\u5229\u7528RDB\u5b9e\u73b0\u7d27\u51d1\u7684\u6570\u636e\u6301\u4e45\u5316\u4f1a\u4f7fRedis\u964d\u7684\u5f88\u4f4e\uff0c\u614e\u91cd\u603b\u7ed3\uff1a \u7efc\u5408\u6bd4\u5bf9 RDB\u4e0eAOF\u7684\u9009\u62e9\u5b9e\u9645\u4e0a\u662f\u5728\u505a\u4e00\u79cd\u6743\u8861\uff0c\u6bcf\u79cd\u90fd\u6709\u5229\u6709\u5f0a \u5982\u4e0d\u80fd\u627f\u53d7\u6570\u5206\u949f\u4ee5\u5185\u7684\u6570\u636e\u4e22\u5931\uff0c\u5bf9\u4e1a\u52a1\u6570\u636e\u975e\u5e38\u654f\u611f\uff0c\u9009\u7528AOF \u5982\u80fd\u627f\u53d7\u6570\u5206\u949f\u4ee5\u5185\u7684\u6570\u636e\u4e22\u5931\uff0c\u4e14\u8ffd\u6c42\u5927\u6570\u636e\u96c6\u7684\u6062\u590d\u901f\u5ea6\uff0c\u9009\u7528RDB \u707e\u96be\u6062\u590d\u9009\u7528RDB \u53cc\u4fdd\u9669\u7b56\u7565\uff0c\u540c\u65f6\u5f00\u542f RDB\u548c AOF\uff0c\u91cd\u542f\u540e\uff0cRedis\u4f18\u5148\u4f7f\u7528 AOF \u6765\u6062\u590d\u6570\u636e\uff0c\u964d\u4f4e\u4e22\u5931\u6570\u636e\u7684\u91cf # \u5ba2\u6237\u7aef\u600e\u4e48\u8bbf\u95ee\u90fd\u884c bind 0 .0.0.0 port 6379 timeout 0 # \u540e\u53f0\u542f\u52a8 daemonize yes logfile \"log_6379.log\" dir /usr/local/redis/data # rdb \u65b9\u5f0f\u6587\u4ef6\u540d\u79f0 dbfilename \"dump6379.rdb\" # \u5b58\u50a8\u7b56\u7565 2s \u4e2d\u5185\u5982\u679c\u6709\u4e24\u4e2a \u4fee\u6539\u547d\u4ee4 \u5219\u6267\u884c\u5b58\u50a8 save 2 2 # aop \u914d\u7f6e appendonly yes appendfilename \"dump6379.aof\" appendfsync always # aof \u81ea\u52a8\u91cd\u5199 # \u6bcf4M \u6570\u636e \u91cd\u5199\u4e00\u6b21 auto-aof-rewrite-min-size 4mb # \u548c\u4e0a\u6b21\u5907\u4efd\u505a\u5bf9\u6bd4,\u5982\u679c \u8d85\u8fc7\u4e8610% \u5219\u91cd\u5199\u6587\u4ef6 auto-aof-rewrite-percentage 10 %","title":"5.4.2 RDB\u4e0eAOF\u5e94\u7528\u573a\u666f"},{"location":"redis/day02/","text":"\u5b66\u4e60\u76ee\u6807 \u00b6 \u76ee\u68071\uff1a\u80fd\u591f\u8bf4\u51faredis\u4e2d\u7684\u6570\u636e\u5220\u9664\u7b56\u4e0e\u7565\u6dd8\u6c70\u7b56\u7565 \u76ee\u68072\uff1a\u80fd\u591f\u8bf4\u51fa\u4e3b\u4ece\u590d\u5236\u7684\u6982\u5ff5\uff0c\u5de5\u4f5c\u6d41\u7a0b\u4ee5\u53ca\u573a\u666f\u95ee\u9898\u53ca\u89e3\u51b3\u65b9\u6848 \u76ee\u68073\uff1a\u80fd\u591f\u8bf4\u51fa\u54e8\u5175\u7684\u4f5c\u7528\u4ee5\u53ca\u5de5\u4f5c\u539f\u7406\uff0c\u4ee5\u53ca\u5982\u4f55\u542f\u7528\u54e8\u5175 \u76ee\u68074\uff1a\u80fd\u591f\u8bf4\u51fa\u96c6\u7fa4\u7684\u67b6\u6784\u8bbe\u8ba1\uff0c\u5b8c\u6210\u96c6\u7fa4\u7684\u642d\u5efa \u76ee\u68075\uff1a\u80fd\u591f\u8bf4\u51fa\u7f13\u5b58\u9884\u70ed\uff0c\u96ea\u5d29\uff0c\u51fb\u7a7f\uff0c\u7a7f\u900f\u7684\u6982\u5ff5\uff0c\u80fd\u8bf4\u51faredis\u7684\u76f8\u5173\u76d1\u63a7\u6307\u6807 1.\u6570\u636e\u5220\u9664\u4e0e\u6dd8\u6c70\u7b56\u7565 \u00b6 1.1 \u8fc7\u671f\u6570\u636e \u00b6 1.1.1 Redis\u4e2d\u7684\u6570\u636e\u7279\u5f81 \u00b6 Redis\u662f\u4e00\u79cd\u5185\u5b58\u7ea7\u6570\u636e\u5e93\uff0c\u6240\u6709\u6570\u636e\u5747\u5b58\u653e\u5728\u5185\u5b58\u4e2d\uff0c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u53ef\u4ee5\u901a\u8fc7TTL\u6307\u4ee4\u83b7\u53d6\u5176\u72b6\u6001 TTL\u8fd4\u56de\u7684\u503c\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\u6b63\u6570\uff0c-1\uff0c-2 \u6b63\u6570 \uff1a\u4ee3\u8868\u8be5\u6570\u636e\u5728\u5185\u5b58\u4e2d\u8fd8\u80fd\u5b58\u6d3b\u7684\u65f6\u95f4 -1 \uff1a\u6c38\u4e45\u6709\u6548\u7684\u6570\u636e 2 \uff1a\u5df2\u7ecf\u8fc7\u671f\u7684\u6570\u636e \u6216\u88ab\u5220\u9664\u7684\u6570\u636e \u6216 \u672a\u5b9a\u4e49\u7684\u6570\u636e \u5220\u9664\u7b56\u7565\u5c31\u662f\u9488\u5bf9\u5df2\u8fc7\u671f\u6570\u636e\u7684\u5904\u7406\u7b56\u7565 \uff0c\u5df2\u8fc7\u671f\u7684\u6570\u636e\u662f\u771f\u7684\u5c31\u7acb\u5373\u5220\u9664\u4e86\u5417\uff1f\u5176\u5b9e\u4e5f\u4e0d\u662f\uff0c\u6211\u4eec\u4f1a\u6709\u591a\u79cd\u5220\u9664\u7b56\u7565\uff0c\u662f\u5206\u60c5\u51b5\u7684\uff0c\u5728\u4e0d\u540c\u7684\u573a\u666f\u4e0b\u4f7f\u7528\u4e0d\u540c\u7684\u5220\u9664\u65b9\u5f0f\u4f1a\u6709\u4e0d\u540c\u6548\u679c\uff0c\u8fd9\u4e5f\u6b63\u662f\u6211\u4eec\u8981\u5c06\u7684\u6570\u636e\u7684\u5220\u9664\u7b56\u7565\u7684\u95ee\u9898 1.1.2 \u65f6\u6548\u6027\u6570\u636e\u7684\u5b58\u50a8\u7ed3\u6784 \u00b6 \u5728Redis\u4e2d\uff0c\u5982\u4f55\u7ed9\u6570\u636e\u8bbe\u7f6e\u5b83\u7684\u5931\u6548\u5468\u671f\u5462\uff1f\u6570\u636e\u7684\u65f6\u6548\u5728redis\u4e2d\u5982\u4f55\u5b58\u50a8\u5462\uff1f \u8fc7\u671f\u6570\u636e\u662f\u4e00\u5757\u72ec\u7acb\u7684\u5b58\u50a8\u7a7a\u95f4\uff0cHash\u7ed3\u6784\uff0cfield\u662f\u5185\u5b58\u5730\u5740\uff0cvalue\u662f\u8fc7\u671f\u65f6\u95f4\uff0c\u4fdd\u5b58\u4e86\u6240\u6709key\u7684\u8fc7\u671f\u63cf\u8ff0\uff0c\u5728\u6700\u7ec8\u8fdb\u884c\u8fc7\u671f\u5904\u7406\u7684\u65f6\u5019\uff0c\u5bf9\u8be5\u7a7a\u95f4\u7684\u6570\u636e\u8fdb\u884c\u68c0\u6d4b\uff0c \u5f53\u65f6\u95f4\u5230\u671f\u4e4b\u540e\u901a\u8fc7field\u627e\u5230\u5185\u5b58\u8be5\u5730\u5740\u5904\u7684\u6570\u636e\uff0c\u7136\u540e\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\u3002 1.2 \u6570\u636e\u5220\u9664\u7b56\u7565 \u00b6 1.2.1 \u6570\u636e\u5220\u9664\u7b56\u7565\u7684\u76ee\u6807 \u00b6 \u5728\u5185\u5b58\u5360\u7528\u4e0eCPU\u5360\u7528\u4e4b\u95f4\u5bfb\u627e\u4e00\u79cd\u5e73\u8861\uff0c\u987e\u6b64\u5931\u5f7c\u90fd\u4f1a\u9020\u6210\u6574\u4f53redis\u6027\u80fd\u7684\u4e0b\u964d\uff0c\u751a\u81f3\u5f15\u53d1\u670d\u52a1\u5668\u5b95\u673a\u6216 \u5185\u5b58\u6cc4\u9732 \u9488\u5bf9\u8fc7\u671f\u6570\u636e\u8981\u8fdb\u884c\u5220\u9664\u7684\u65f6\u5019\u90fd\u6709\u54ea\u4e9b\u5220\u9664\u7b56\u7565\u5462\uff1f 1.\u5b9a\u65f6\u5220\u9664 2.\u60f0\u6027\u5220\u9664 3.\u5b9a\u671f\u5220\u9664 1.2.2 \u5b9a\u65f6\u5220\u9664 \u00b6 \u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5f53key\u8bbe\u7f6e\u6709\u8fc7\u671f\u65f6\u95f4\uff0c\u4e14\u8fc7\u671f\u65f6\u95f4\u5230\u8fbe\u65f6\uff0c\u7531\u5b9a\u65f6\u5668\u4efb\u52a1\u7acb\u5373\u6267\u884c\u5bf9\u952e\u7684\u5220\u9664\u64cd\u4f5c \u4f18\u70b9 \uff1a\u8282\u7ea6\u5185\u5b58\uff0c\u5230\u65f6\u5c31\u5220\u9664\uff0c\u5feb\u901f\u91ca\u653e\u6389\u4e0d\u5fc5\u8981\u7684\u5185\u5b58\u5360\u7528 \u7f3a\u70b9 \uff1aCPU\u538b\u529b\u5f88\u5927\uff0c\u65e0\u8bbaCPU\u6b64\u65f6\u8d1f\u8f7d\u91cf\u591a\u9ad8\uff0c\u5747\u5360\u7528CPU\uff0c\u4f1a\u5f71\u54cdredis\u670d\u52a1\u5668\u54cd\u5e94\u65f6\u95f4\u548c\u6307\u4ee4\u541e\u5410\u91cf \u603b\u7ed3 \uff1a\u7528\u5904\u7406\u5668\u6027\u80fd\u6362\u53d6\u5b58\u50a8\u7a7a\u95f4\uff08\u62ff\u65f6\u95f4\u6362\u7a7a\u95f4\uff09 1.2.3 \u60f0\u6027\u5220\u9664 \u00b6 \u6570\u636e\u5230\u8fbe\u8fc7\u671f\u65f6\u95f4\uff0c\u4e0d\u505a\u5904\u7406\u3002\u7b49\u4e0b\u6b21\u8bbf\u95ee\u8be5\u6570\u636e\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5224\u65ad \u5982\u679c\u672a\u8fc7\u671f\uff0c\u8fd4\u56de\u6570\u636e \u53d1\u73b0\u5df2\u8fc7\u671f\uff0c\u5220\u9664\uff0c\u8fd4\u56de\u4e0d\u5b58\u5728 \u4f18\u70b9 \uff1a\u8282\u7ea6CPU\u6027\u80fd\uff0c\u53d1\u73b0\u5fc5\u987b\u5220\u9664\u7684\u65f6\u5019\u624d\u5220\u9664 \u7f3a\u70b9 \uff1a\u5185\u5b58\u538b\u529b\u5f88\u5927\uff0c\u51fa\u73b0\u957f\u671f\u5360\u7528\u5185\u5b58\u7684\u6570\u636e \u603b\u7ed3 \uff1a\u7528\u5b58\u50a8\u7a7a\u95f4\u6362\u53d6\u5904\u7406\u5668\u6027\u80fd\uff08\u62ff\u65f6\u95f4\u6362\u7a7a\u95f4\uff09 1.2.4 \u5b9a\u671f\u5220\u9664 \u00b6 \u5b9a\u65f6\u5220\u9664\u548c\u60f0\u6027\u5220\u9664\u8fd9\u4e24\u79cd\u65b9\u6848\u90fd\u662f\u8d70\u7684\u6781\u7aef\uff0c\u90a3\u6709\u6ca1\u6709\u6298\u4e2d\u65b9\u6848\uff1f \u6211\u4eec\u6765\u8bb2redis\u7684\u5b9a\u671f\u5220\u9664\u65b9\u6848\uff1a Redis\u542f\u52a8\u670d\u52a1\u5668\u521d\u59cb\u5316\u65f6\uff0c\u8bfb\u53d6\u914d\u7f6eserver.hz\u7684\u503c\uff0c\u9ed8\u8ba4\u4e3a10 \u6bcf\u79d2\u949f\u6267\u884cserver.hz\u6b21 serverCron() --------> databasesCron() ---------> activeExpireCycle() activeExpireCycle() \u5bf9\u6bcf\u4e2aexpires[*]\u9010\u4e00\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bcf\u6b21\u6267\u884c\u8017\u65f6\uff1a250ms/server.hz \u5bf9\u67d0\u4e2aexpires[*]\u68c0\u6d4b\u65f6\uff0c\u968f\u673a\u6311\u9009W\u4e2akey\u68c0\u6d4b \u5982\u679ckey\u8d85\u65f6\uff0c\u5220\u9664key \u5982\u679c\u4e00\u8f6e\u4e2d\u5220\u9664\u7684key\u7684\u6570\u91cf>W*25%\uff0c\u5faa\u73af\u8be5\u8fc7\u7a0b \u5982\u679c\u4e00\u8f6e\u4e2d\u5220\u9664\u7684key\u7684\u6570\u91cf\u2264W*25%\uff0c\u68c0\u67e5\u4e0b\u4e00\u4e2aexpires[*]\uff0c0-15\u5faa\u73af W\u53d6\u503c=ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP\u5c5e\u6027\u503c \u53c2\u6570current_db\u7528\u4e8e\u8bb0\u5f55 activeExpireCycle() \u8fdb\u5165\u54ea\u4e2aexpires[*] \u6267\u884c \u5982\u679cactiveExpireCycle()\u6267\u884c\u65f6\u95f4\u5230\u671f\uff0c\u4e0b\u6b21\u4ececurrent_db\u7ee7\u7eed\u5411\u4e0b\u6267\u884c \u603b\u7684\u6765\u8bf4\uff1a\u5b9a\u671f\u5220\u9664\u5c31\u662f\u5468\u671f\u6027\u8f6e\u8be2redis\u5e93\u4e2d\u7684\u65f6\u6548\u6027\u6570\u636e\uff0c\u91c7\u7528\u968f\u673a\u62bd\u53d6\u7684\u7b56\u7565\uff0c\u5229\u7528\u8fc7\u671f\u6570\u636e\u5360\u6bd4\u7684\u65b9\u5f0f\u63a7\u5236\u5220\u9664\u9891\u5ea6 \u7279\u70b91 \uff1aCPU\u6027\u80fd\u5360\u7528\u8bbe\u7f6e\u6709\u5cf0\u503c\uff0c\u68c0\u6d4b\u9891\u5ea6\u53ef\u81ea\u5b9a\u4e49\u8bbe\u7f6e \u7279\u70b92 \uff1a\u5185\u5b58\u538b\u529b\u4e0d\u662f\u5f88\u5927\uff0c\u957f\u671f\u5360\u7528\u5185\u5b58\u7684\u51b7\u6570\u636e\u4f1a\u88ab\u6301\u7eed\u6e05\u7406 \u603b\u7ed3 \uff1a\u5468\u671f\u6027\u62bd\u67e5\u5b58\u50a8\u7a7a\u95f4\uff08\u968f\u673a\u62bd\u67e5\uff0c\u91cd\u70b9\u62bd\u67e5\uff09 1.2.5 \u5220\u9664\u7b56\u7565\u5bf9\u6bd4 \u00b6 1\uff1a\u5b9a\u65f6\u5220\u9664\uff1a \u8282\u7ea6\u5185\u5b58\uff0c\u65e0\u5360\u7528, \u4e0d\u5206\u65f6\u6bb5\u5360\u7528CPU\u8d44\u6e90\uff0c\u9891\u5ea6\u9ad8, \u62ff\u65f6\u95f4\u6362\u7a7a\u95f4 2\uff1a\u60f0\u6027\u5220\u9664\uff1a \u5185\u5b58\u5360\u7528\u4e25\u91cd \u5ef6\u65f6\u6267\u884c\uff0cCPU\u5229\u7528\u7387\u9ad8 \u62ff\u7a7a\u95f4\u6362\u65f6\u95f4 3\uff1a\u5b9a\u671f\u5220\u9664\uff1a \u5185\u5b58\u5b9a\u671f\u968f\u673a\u6e05\u7406 \u6bcf\u79d2\u82b1\u8d39\u56fa\u5b9a\u7684CPU\u8d44\u6e90\u7ef4\u62a4\u5185\u5b58 \u968f\u673a\u62bd\u67e5\uff0c\u91cd\u70b9\u62bd\u67e5 1.3 \u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff08\u9010\u51fa\u7b97\u6cd5\uff09 \u00b6 1.3.1 \u6dd8\u6c70\u7b56\u7565\u6982\u8ff0 \u00b6 \u4ec0\u4e48\u53eb\u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff1f\u4ec0\u4e48\u6837\u7684\u5e94\u7528\u573a\u666f\u9700\u8981\u7528\u5230\u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff1f \u5f53\u65b0\u6570\u636e\u8fdb\u5165redis\u65f6\uff0c\u5982\u679c\u5185\u5b58\u4e0d\u8db3\u600e\u4e48\u529e\uff1f\u5728\u6267\u884c\u6bcf\u4e00\u4e2a\u547d\u4ee4\u524d\uff0c\u4f1a\u8c03\u7528 freeMemoryIfNeeded() \u68c0\u6d4b\u5185\u5b58\u662f\u5426\u5145\u8db3\u3002\u5982\u679c\u5185\u5b58\u4e0d\u6ee1\u8db3\u65b0 \u52a0\u5165\u6570\u636e\u7684\u6700\u4f4e\u5b58\u50a8\u8981\u6c42\uff0credis\u8981\u4e34\u65f6\u5220\u9664\u4e00\u4e9b\u6570\u636e\u4e3a\u5f53\u524d\u6307\u4ee4\u6e05\u7406\u5b58\u50a8\u7a7a\u95f4\u3002\u6e05\u7406\u6570\u636e\u7684\u7b56\u7565\u79f0\u4e3a\u9010\u51fa\u7b97\u6cd5\u3002 \u6ce8\u610f\uff1a\u9010\u51fa\u6570\u636e\u7684\u8fc7\u7a0b\u4e0d\u662f100%\u80fd\u591f\u6e05\u7406\u51fa\u8db3\u591f\u7684\u53ef\u4f7f\u7528\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5982\u679c\u4e0d\u6210\u529f\u5219\u53cd\u590d\u6267\u884c\u3002\u5f53\u5bf9\u6240\u6709\u6570\u636e\u5c1d\u8bd5\u5b8c\u6bd5\uff0c \u5982\u4e0d\u80fd\u8fbe\u5230\u5185\u5b58\u6e05\u7406\u7684\u8981\u6c42\uff0c\u5c06\u51fa\u73b0\u9519\u8bef\u4fe1\u606f\u5982\u4e0b ( error ) OOM command not allowed when used memory > 'maxmemory' 1.3.2 \u7b56\u7565\u914d\u7f6e \u00b6 \u5f71\u54cd\u6570\u636e\u6dd8\u6c70\u7684\u76f8\u5173\u914d\u7f6e\u5982\u4e0b\uff1a 1\uff1a\u6700\u5927\u53ef\u4f7f\u7528\u5185\u5b58\uff0c\u5373\u5360\u7528\u7269\u7406\u5185\u5b58\u7684\u6bd4\u4f8b\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8868\u793a\u4e0d\u9650\u5236\u3002\u751f\u4ea7\u73af\u5883\u4e2d\u6839\u636e\u9700\u6c42\u8bbe\u5b9a\uff0c\u901a\u5e38\u8bbe\u7f6e\u572850%\u4ee5\u4e0a maxmemory ?mb 2\uff1a\u6bcf\u6b21\u9009\u53d6\u5f85\u5220\u9664\u6570\u636e\u7684\u4e2a\u6570\uff0c\u91c7\u7528\u968f\u673a\u83b7\u53d6\u6570\u636e\u7684\u65b9\u5f0f\u4f5c\u4e3a\u5f85\u68c0\u6d4b\u5220\u9664\u6570\u636e maxmemory-samples count 3\uff1a\u5bf9\u6570\u636e\u8fdb\u884c\u5220\u9664\u7684\u9009\u62e9\u7b56\u7565 maxmemory-policy policy \u90a3\u6570\u636e\u5220\u9664\u7684\u7b56\u7565policy\u5230\u5e95\u6709\u51e0\u79cd\u5462\uff1f\u4e00\u5171\u662f 3\u7c7b8\u79cd \u7b2c\u4e00\u7c7b \uff1a\u68c0\u6d4b\u6613\u5931\u6570\u636e\uff08\u53ef\u80fd\u4f1a\u8fc7\u671f\u7684\u6570\u636e\u96c6server.db[i].expires \uff09 volatile-lru\uff1a\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70 volatile-lfu\uff1a\u6311\u9009\u6700\u8fd1\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\u6dd8\u6c70 volatile-ttl\uff1a\u6311\u9009\u5c06\u8981\u8fc7\u671f\u7684\u6570\u636e\u6dd8\u6c70 volatile-random\uff1a\u4efb\u610f\u9009\u62e9\u6570\u636e\u6dd8\u6c70 \u7b2c\u4e8c\u7c7b \uff1a\u68c0\u6d4b\u5168\u5e93\u6570\u636e\uff08\u6240\u6709\u6570\u636e\u96c6server.db[i].dict \uff09 allkeys-lru\uff1a\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70 allkeLyRs-lfu\uff1a\uff1a\u6311\u9009\u6700\u8fd1\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\u6dd8\u6c70 allkeys-random\uff1a\u4efb\u610f\u9009\u62e9\u6570\u636e\u6dd8\u6c70\uff0c\u76f8\u5f53\u4e8e\u968f\u673a \u7b2c\u4e09\u7c7b \uff1a\u653e\u5f03\u6570\u636e\u9a71\u9010 no-enviction\uff08\u9a71\u9010\uff09\uff1a\u7981\u6b62\u9a71\u9010\u6570\u636e(redis4.0\u4e2d\u9ed8\u8ba4\u7b56\u7565)\uff0c\u4f1a\u5f15\u53d1OOM(Out Of Memory) \u6ce8\u610f\uff1a\u8fd9\u4e9b\u7b56\u7565\u662f\u914d\u7f6e\u5230\u54ea\u4e2a\u5c5e\u6027\u4e0a\uff1f\u600e\u4e48\u914d\u7f6e\uff1f\u5982\u4e0b\u6240\u793a maxmemory-policy volatile-lru \u6570\u636e\u6dd8\u6c70\u7b56\u7565\u914d\u7f6e\u4f9d\u636e \u4f7f\u7528INFO\u547d\u4ee4\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f\uff0c\u67e5\u8be2\u7f13\u5b58 hit \u548c miss \u7684\u6b21\u6570\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u8c03\u4f18Redis\u914d\u7f6e 2.\u4e3b\u4ece\u590d\u5236 \u00b6 2.1 \u4e3b\u4ece\u590d\u5236\u7b80\u4ecb \u00b6 2.1.1 \u9ad8\u53ef\u7528 \u00b6 \u9996\u5148\u6211\u4eec\u8981\u7406\u89e3\u4e92\u8054\u7f51\u5e94\u7528\u56e0\u4e3a\u5176\u72ec\u6709\u7684\u7279\u6027\u6211\u4eec\u6f14\u5316\u51fa\u7684 \u4e09\u9ad8 \u67b6\u6784 \u9ad8\u5e76\u53d1 \u5e94\u7528\u8981\u63d0\u4f9b\u67d0\u4e00\u4e1a\u52a1\u8981\u80fd\u652f\u6301\u5f88\u591a\u5ba2\u6237\u7aef\u540c\u65f6\u8bbf\u95ee\u7684\u80fd\u529b\uff0c\u6211\u4eec\u79f0\u4e3a\u5e76\u53d1\uff0c\u9ad8\u5e76\u53d1\u610f\u601d\u5c31\u5f88\u660e\u786e\u4e86 \u9ad8\u6027\u80fd \u6027\u80fd\u5e26\u7ed9\u6211\u4eec\u6700\u76f4\u89c2\u7684\u611f\u53d7\u5c31\u662f\uff1a\u901f\u5ea6\u5feb\uff0c\u65f6\u95f4\u77ed \u9ad8\u53ef\u7528 \u53ef\u7528\u6027 \uff1a\u4e00\u5e74\u4e2d\u5e94\u7528\u670d\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u65f6\u95f4\u5360\u5168\u5e74\u65f6\u95f4\u7684\u767e\u5206\u6bd4\uff0c\u5982\u4e0b\u56fe\uff1a\u8868\u793a\u4e86\u5e94\u7528\u670d\u52a1\u5728\u5168\u5e74\u5b95\u673a\u7684\u65f6\u95f4 \u6211\u4eec\u628a\u8fd9\u4e9b\u65f6\u95f4\u52a0\u5728\u4e00\u8d77\u5c31\u662f\u5168\u5e74\u5e94\u7528\u670d\u52a1\u4e0d\u53ef\u7528\u7684\u65f6\u95f4\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5e94\u7528\u670d\u52a1\u5168\u5e74\u53ef\u7528\u7684\u65f6\u95f4 4\u5c0f\u65f627\u520615\u79d2+11\u520636\u79d2+2\u520616\u79d2=4\u5c0f\u65f641\u52067\u79d2=16867\u79d2 1\u5e74=365 24 60*60=31536000\u79d2 \u53ef\u7528\u6027=\uff0831536000-16867\uff09/31536000*100%=99.9465151% \u4e1a\u754c\u53ef\u7528\u6027\u76ee\u6807 5\u4e2a9\uff0c\u537399.999% \uff0c\u5373\u670d\u52a1\u5668\u5e74\u5b95\u673a\u65f6\u957f\u4f4e\u4e8e315\u79d2\uff0c\u7ea65.25\u5206\u949f 2.1.2 \u4e3b\u4ece\u590d\u5236\u6982\u5ff5 \u00b6 \u77e5\u9053\u4e86\u4e09\u9ad8\u7684\u6982\u5ff5\u4e4b\u540e\uff0c\u6211\u4eec\u60f3\uff1a\u4f60\u7684\u201cRedis\u201d\u662f\u5426\u9ad8\u53ef\u7528\uff1f\u90a3\u6211\u4eec\u8981\u6765\u5206\u6790\u5355\u673aredis\u7684\u98ce\u9669\u4e0e\u95ee\u9898 \u95ee\u98981.\u673a\u5668\u6545\u969c \u73b0\u8c61\uff1a\u786c\u76d8\u6545\u969c\u3001\u7cfb\u7edf\u5d29\u6e83 \u672c\u8d28\uff1a\u6570\u636e\u4e22\u5931\uff0c\u5f88\u53ef\u80fd\u5bf9\u4e1a\u52a1\u9020\u6210\u707e\u96be\u6027\u6253\u51fb \u7ed3\u8bba\uff1a\u57fa\u672c\u4e0a\u4f1a\u653e\u5f03\u4f7f\u7528redis. \u95ee\u98982.\u5bb9\u91cf\u74f6\u9888 \u73b0\u8c61\uff1a\u5185\u5b58\u4e0d\u8db3\uff0c\u4ece16G\u5347\u7ea7\u523064G\uff0c\u4ece64G\u5347\u7ea7\u5230128G\uff0c\u65e0\u9650\u5347\u7ea7\u5185\u5b58 \u672c\u8d28\uff1a\u7a77\uff0c\u786c\u4ef6\u6761\u4ef6\u8ddf\u4e0d\u4e0a \u7ed3\u8bba\uff1a\u653e\u5f03\u4f7f\u7528redis \u7ed3\u8bba\uff1a \u4e3a\u4e86\u907f\u514d\u5355\u70b9Redis\u670d\u52a1\u5668\u6545\u969c\uff0c\u51c6\u5907\u591a\u53f0\u670d\u52a1\u5668\uff0c\u4e92\u76f8\u8fde\u901a\u3002\u5c06\u6570\u636e\u590d\u5236\u591a\u4e2a\u526f\u672c\u4fdd\u5b58\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5e76\u4fdd\u8bc1\u6570\u636e\u662f\u540c\u6b65\u7684\u3002\u5373\u4f7f\u6709\u5176\u4e2d\u4e00\u53f0\u670d\u52a1\u5668\u5b95\u673a\uff0c\u5176\u4ed6\u670d\u52a1\u5668\u4f9d\u7136\u53ef\u4ee5\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\uff0c\u5b9e\u73b0Redis\u7684\u9ad8\u53ef\u7528\uff0c\u540c\u65f6\u5b9e\u73b0\u6570\u636e\u5197\u4f59\u5907\u4efd\u3002 \u591a\u53f0\u670d\u52a1\u5668\u8fde\u63a5\u65b9\u6848\uff1a \u63d0\u4f9b\u6570\u636e\u65b9\uff1a master \u4e3b\u670d\u52a1\u5668\uff0c\u4e3b\u8282\u70b9\uff0c\u4e3b\u5e93\u4e3b\u5ba2\u6237\u7aef \u63a5\u6536\u6570\u636e\u65b9\uff1a slave \u4ece\u670d\u52a1\u5668\uff0c\u4ece\u8282\u70b9\uff0c\u4ece\u5e93 \u4ece\u5ba2\u6237\u7aef \u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff1a \u6570\u636e\u540c\u6b65\uff08master\u7684\u6570\u636e\u590d\u5236\u5230slave\u4e2d\uff09 \u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6765\u89e3\u91ca\u4e3b\u4ece\u590d\u5236\u7684\u6982\u5ff5\uff1a \u6982\u5ff5\uff1a\u4e3b\u4ece\u590d\u5236\u5373\u5c06master\u4e2d\u7684\u6570\u636e\u5373\u65f6\u3001\u6709\u6548\u7684\u590d\u5236\u5230slave\u4e2d \u7279\u5f81 \uff1a\u4e00\u4e2amaster\u53ef\u4ee5\u62e5\u6709\u591a\u4e2aslave\uff0c\u4e00\u4e2aslave\u53ea\u5bf9\u5e94\u4e00\u4e2amaster \u804c\u8d23 \uff1amaster\u548cslave\u5404\u81ea\u7684\u804c\u8d23\u4e0d\u4e00\u6837 master: \u5199\u6570\u636e \u6267\u884c\u5199\u64cd\u4f5c\u65f6\uff0c\u5c06\u51fa\u73b0\u53d8\u5316\u7684\u6570\u636e\u81ea\u52a8\u540c\u6b65\u5230slave \u8bfb\u6570\u636e\uff08\u53ef\u5ffd\u7565\uff09 slave: \u8bfb\u6570\u636e \u5199\u6570\u636e\uff08\u7981\u6b62\uff09 2.1.3 \u4e3b\u4ece\u590d\u5236\u7684\u4f5c\u7528 \u00b6 \u8bfb\u5199\u5206\u79bb\uff1amaster\u5199\u3001slave\u8bfb\uff0c\u63d0\u9ad8\u670d\u52a1\u5668\u7684\u8bfb\u5199\u8d1f\u8f7d\u80fd\u529b \u8d1f\u8f7d\u5747\u8861\uff1a\u57fa\u4e8e\u4e3b\u4ece\u7ed3\u6784\uff0c\u914d\u5408\u8bfb\u5199\u5206\u79bb\uff0c\u7531slave\u5206\u62c5master\u8d1f\u8f7d\uff0c\u5e76\u6839\u636e\u9700\u6c42\u7684\u53d8\u5316\uff0c\u6539\u53d8slave\u7684\u6570 \u91cf\uff0c\u901a\u8fc7\u591a\u4e2a\u4ece\u8282\u70b9\u5206\u62c5\u6570\u636e\u8bfb\u53d6\u8d1f\u8f7d\uff0c\u5927\u5927\u63d0\u9ad8Redis\u670d\u52a1\u5668\u5e76\u53d1\u91cf\u4e0e\u6570\u636e\u541e\u5410\u91cf \u6545\u969c\u6062\u590d\uff1a\u5f53master\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u7531slave\u63d0\u4f9b\u670d\u52a1\uff0c\u5b9e\u73b0\u5feb\u901f\u7684\u6545\u969c\u6062\u590d \u6570\u636e\u5197\u4f59\uff1a\u5b9e\u73b0\u6570\u636e\u70ed\u5907\u4efd\uff0c\u662f\u6301\u4e45\u5316\u4e4b\u5916\u7684\u4e00\u79cd\u6570\u636e\u5197\u4f59\u65b9\u5f0f \u9ad8\u53ef\u7528\u57fa\u77f3\uff1a\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\uff0c\u6784\u5efa\u54e8\u5175\u6a21\u5f0f\u4e0e\u96c6\u7fa4\uff0c\u5b9e\u73b0Redis\u7684\u9ad8\u53ef\u7528\u65b9\u6848 2.2 \u4e3b\u4ece\u590d\u5236\u5de5\u4f5c\u6d41\u7a0b \u00b6 \u4e3b\u4ece\u590d\u5236\u8fc7\u7a0b\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a3\u4e2a\u9636\u6bb5 \u5efa\u7acb\u8fde\u63a5\u9636\u6bb5\uff08\u5373\u51c6\u5907\u9636\u6bb5\uff09 \u6570\u636e\u540c\u6b65\u9636\u6bb5 \u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\uff08\u53cd\u590d\u540c\u6b65\uff09 \u800c\u547d\u4ee4\u7684\u4f20\u64ad\u5176\u5b9e\u67094\u79cd\uff0c\u5206\u522b\u5982\u4e0b\uff1a 2.2.1 \u4e3b\u4ece\u590d\u5236\u7684\u5de5\u4f5c\u6d41\u7a0b\uff08\u4e09\u4e2a\u9636\u6bb5\uff09 \u00b6 2.2.1.1 \u9636\u6bb5\u4e00\uff1a\u5efa\u7acb\u8fde\u63a5 \u00b6 \u5efa\u7acbslave\u5230master\u7684\u8fde\u63a5\uff0c\u4f7fmaster\u80fd\u591f\u8bc6\u522bslave\uff0c\u5e76\u4fdd\u5b58slave\u7aef\u53e3\u53f7 \u6d41\u7a0b\u5982\u4e0b\uff1a \u6b65\u9aa41\uff1a\u8bbe\u7f6emaster\u7684\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4fdd\u5b58master\u4fe1\u606f \u6b65\u9aa42\uff1a\u5efa\u7acbsocket\u8fde\u63a5 \u6b65\u9aa43\uff1a\u53d1\u9001ping\u547d\u4ee4\uff08\u5b9a\u65f6\u5668\u4efb\u52a1\uff09 \u6b65\u9aa44\uff1a\u8eab\u4efd\u9a8c\u8bc1 \u6b65\u9aa45\uff1a\u53d1\u9001slave\u7aef\u53e3\u4fe1\u606f \u81f3\u6b64\uff0c\u4e3b\u4ece\u8fde\u63a5\u6210\u529f\uff01 \u5f53\u524d\u72b6\u6001\uff1a slave\uff1a\u4fdd\u5b58master\u7684\u5730\u5740\u4e0e\u7aef\u53e3 master\uff1a\u4fdd\u5b58slave\u7684\u7aef\u53e3 \u603b\u4f53\uff1a\u4e4b\u95f4\u521b\u5efa\u4e86\u8fde\u63a5\u7684socket master\u548cslave\u4e92\u8054 \u63a5\u4e0b\u6765\u5c31\u8981\u901a\u8fc7\u67d0\u79cd\u65b9\u5f0f\u5c06master\u548cslave\u8fde\u63a5\u5230\u4e00\u8d77 \u65b9\u5f0f\u4e00\uff1a\u5ba2\u6237\u7aef\u53d1\u9001\u547d\u4ee4 slaveof masterip masterport \u65b9\u5f0f\u4e8c\uff1a\u542f\u52a8\u670d\u52a1\u5668\u53c2\u6570 redis-server --slaveof masterip masterport \u65b9\u5f0f\u4e09\uff1a\u670d\u52a1\u5668\u914d\u7f6e\uff08 \u4e3b\u6d41\u65b9\u5f0f \uff09 slaveof masterip masterport slave\u7cfb\u7edf\u4fe1\u606f master_link_down_since_seconds masterhost & masterport master\u7cfb\u7edf\u4fe1\u606f uslave_listening_port(\u591a\u4e2a) \u4e3b\u4ece\u65ad\u5f00\u8fde\u63a5 \u65ad\u5f00slave\u4e0emaster\u7684\u8fde\u63a5\uff0cslave\u65ad\u5f00\u8fde\u63a5\u540e\uff0c\u4e0d\u4f1a\u5220\u9664\u5df2\u6709\u6570\u636e\uff0c\u53ea\u662f\u4e0d\u518d\u63a5\u53d7master\u53d1\u9001\u7684\u6570\u636e slaveof no one \u6388\u6743\u8bbf\u95ee master\u5ba2\u6237\u7aef\u53d1\u9001\u547d\u4ee4\u8bbe\u7f6e\u5bc6\u7801 requirepass password master\u914d\u7f6e\u6587\u4ef6\u8bbe\u7f6e\u5bc6\u7801 config set requirepass password config get requirepass slave\u5ba2\u6237\u7aef\u53d1\u9001\u547d\u4ee4\u8bbe\u7f6e\u5bc6\u7801 auth password slave\u914d\u7f6e\u6587\u4ef6\u8bbe\u7f6e\u5bc6\u7801 masterauth password slave\u542f\u52a8\u670d\u52a1\u5668\u8bbe\u7f6e\u5bc6\u7801 redis-server \u2013a password 2.2.1.2 \u9636\u6bb5\u4e8c\uff1a\u6570\u636e\u540c\u6b65 \u00b6 \u5728slave\u521d\u6b21\u8fde\u63a5master\u540e\uff0c\u590d\u5236master\u4e2d\u7684\u6240\u6709\u6570\u636e\u5230slave \u5c06slave\u7684\u6570\u636e\u5e93\u72b6\u6001\u66f4\u65b0\u6210master\u5f53\u524d\u7684\u6570\u636e\u5e93\u72b6\u6001 \u540c\u6b65\u8fc7\u7a0b\u5982\u4e0b\uff1a \u6b65\u9aa41\uff1a\u8bf7\u6c42\u540c\u6b65\u6570\u636e \u6b65\u9aa42\uff1a\u521b\u5efaRDB\u540c\u6b65\u6570\u636e \u6b65\u9aa43\uff1a\u6062\u590dRDB\u540c\u6b65\u6570\u636e \u6b65\u9aa44\uff1a\u8bf7\u6c42\u90e8\u5206\u540c\u6b65\u6570\u636e \u6b65\u9aa45\uff1a\u6062\u590d\u90e8\u5206\u540c\u6b65\u6570\u636e \u81f3\u6b64\uff0c\u6570\u636e\u540c\u6b65\u5de5\u4f5c\u5b8c\u6210\uff01 \u5f53\u524d\u72b6\u6001\uff1a slave\uff1a\u5177\u6709master\u7aef\u5168\u90e8\u6570\u636e\uff0c\u5305\u542bRDB\u8fc7\u7a0b\u63a5\u6536\u7684\u6570\u636e master\uff1a\u4fdd\u5b58slave\u5f53\u524d\u6570\u636e\u540c\u6b65\u7684\u4f4d\u7f6e \u603b\u4f53\uff1a\u4e4b\u95f4\u5b8c\u6210\u4e86\u6570\u636e\u514b\u9686 \u6570\u636e\u540c\u6b65\u9636\u6bb5master\u8bf4\u660e 1\uff1a\u5982\u679cmaster\u6570\u636e\u91cf\u5de8\u5927\uff0c\u6570\u636e\u540c\u6b65\u9636\u6bb5\u5e94\u907f\u5f00\u6d41\u91cf\u9ad8\u5cf0\u671f\uff0c\u907f\u514d\u9020\u6210master\u963b\u585e\uff0c\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u6267\u884c 2\uff1a\u590d\u5236\u7f13\u51b2\u533a\u5927\u5c0f\u8bbe\u5b9a\u4e0d\u5408\u7406\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u6ea2\u51fa\u3002\u5982\u8fdb\u884c\u5168\u91cf\u590d\u5236\u5468\u671f\u592a\u957f\uff0c\u8fdb\u884c\u90e8\u5206\u590d\u5236\u65f6\u53d1\u73b0\u6570\u636e\u5df2\u7ecf\u5b58\u5728\u4e22\u5931\u7684\u60c5\u51b5\uff0c\u5fc5\u987b\u8fdb\u884c\u7b2c\u4e8c\u6b21\u5168\u91cf\u590d\u5236\uff0c\u81f4\u4f7fslave\u9677\u5165\u6b7b\u5faa\u73af\u72b6\u6001\u3002 repl-backlog-size ?mb master\u5355\u673a\u5185\u5b58\u5360\u7528\u4e3b\u673a\u5185\u5b58\u7684\u6bd4\u4f8b\u4e0d\u5e94\u8fc7\u5927\uff0c\u5efa\u8bae\u4f7f\u752850%-70%\u7684\u5185\u5b58\uff0c\u7559\u4e0b30%-50%\u7684\u5185\u5b58\u7528\u4e8e\u6267 \u884cbgsave\u547d\u4ee4\u548c\u521b\u5efa\u590d\u5236\u7f13\u51b2\u533a \u6570\u636e\u540c\u6b65\u9636\u6bb5slave\u8bf4\u660e \u4e3a\u907f\u514dslave\u8fdb\u884c\u5168\u91cf\u590d\u5236\u3001\u90e8\u5206\u590d\u5236\u65f6\u670d\u52a1\u5668\u54cd\u5e94\u963b\u585e\u6216\u6570\u636e\u4e0d\u540c\u6b65\uff0c\u5efa\u8bae\u5173\u95ed\u6b64\u671f\u95f4\u7684\u5bf9\u5916\u670d\u52a1 slave-serve-stale-data yes|no \u6570\u636e\u540c\u6b65\u9636\u6bb5\uff0cmaster\u53d1\u9001\u7ed9slave\u4fe1\u606f\u53ef\u4ee5\u7406\u89e3master\u662fslave\u7684\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u4e3b\u52a8\u5411slave\u53d1\u9001\u547d\u4ee4 \u591a\u4e2aslave\u540c\u65f6\u5bf9master\u8bf7\u6c42\u6570\u636e\u540c\u6b65\uff0cmaster\u53d1\u9001\u7684RDB\u6587\u4ef6\u589e\u591a\uff0c\u4f1a\u5bf9\u5e26\u5bbd\u9020\u6210\u5de8\u5927\u51b2\u51fb\uff0c\u5982\u679cmaster\u5e26\u5bbd\u4e0d\u8db3\uff0c\u56e0\u6b64\u6570\u636e\u540c\u6b65\u9700\u8981\u6839\u636e\u4e1a\u52a1\u9700\u6c42\uff0c\u9002\u91cf\u9519\u5cf0 slave\u8fc7\u591a\u65f6\uff0c\u5efa\u8bae\u8c03\u6574\u62d3\u6251\u7ed3\u6784\uff0c\u7531\u4e00\u4e3b\u591a\u4ece\u7ed3\u6784\u53d8\u4e3a\u6811\u72b6\u7ed3\u6784\uff0c\u4e2d\u95f4\u7684\u8282\u70b9\u65e2\u662fmaster\uff0c\u4e5f\u662f slave\u3002\u6ce8\u610f\u4f7f\u7528\u6811\u72b6\u7ed3\u6784\u65f6\uff0c\u7531\u4e8e\u5c42\u7ea7\u6df1\u5ea6\uff0c\u5bfc\u81f4\u6df1\u5ea6\u8d8a\u9ad8\u7684slave\u4e0e\u6700\u9876\u5c42master\u95f4\u6570\u636e\u540c\u6b65\u5ef6\u8fdf \u8f83\u5927\uff0c\u6570\u636e\u4e00\u81f4\u6027\u53d8\u5dee\uff0c\u5e94\u8c28\u614e\u9009\u62e9 2.2.1.3 \u9636\u6bb5\u4e09\uff1a\u547d\u4ee4\u4f20\u64ad \u00b6 \u5f53master\u6570\u636e\u5e93\u72b6\u6001\u88ab\u4fee\u6539\u540e\uff0c\u5bfc\u81f4\u4e3b\u4ece\u670d\u52a1\u5668\u6570\u636e\u5e93\u72b6\u6001\u4e0d\u4e00\u81f4\uff0c\u6b64\u65f6\u9700\u8981\u8ba9\u4e3b\u4ece\u6570\u636e\u540c\u6b65\u5230\u4e00\u81f4\u7684\u72b6\u6001\uff0c\u540c\u6b65\u7684\u52a8\u4f5c\u79f0\u4e3a\u547d\u4ee4\u4f20\u64ad master\u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u53d8\u66f4\u547d\u4ee4\u53d1\u9001\u7ed9slave\uff0cslave\u63a5\u6536\u547d\u4ee4\u540e\u6267\u884c\u547d\u4ee4 \u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\u7684\u90e8\u5206\u590d\u5236 \u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\u51fa\u73b0\u4e86\u65ad\u7f51\u73b0\u8c61\uff1a \u7f51\u7edc\u95ea\u65ad\u95ea\u8fde\uff1a\u5ffd\u7565 \u77ed\u65f6\u95f4\u7f51\u7edc\u4e2d\u65ad\uff1a\u90e8\u5206\u590d\u5236 \u957f\u65f6\u95f4\u7f51\u7edc\u4e2d\u65ad\uff1a\u5168\u91cf\u590d\u5236 \u8fd9\u91cc\u6211\u4eec\u4e3b\u8981\u6765\u770b\u90e8\u5206\u590d\u5236\uff0c\u90e8\u5206\u590d\u5236\u7684\u4e09\u4e2a\u6838\u5fc3\u8981\u7d20 \u670d\u52a1\u5668\u7684\u8fd0\u884c id\uff08run id\uff09 \u4e3b\u670d\u52a1\u5668\u7684\u590d\u5236\u79ef\u538b\u7f13\u51b2\u533a \u4e3b\u4ece\u670d\u52a1\u5668\u7684\u590d\u5236\u504f\u79fb\u91cf \u670d\u52a1\u5668\u8fd0\u884cID\uff08runid\uff09 \u6982\u5ff5\uff1a\u670d\u52a1\u5668\u8fd0\u884cID\u662f\u6bcf\u4e00\u53f0\u670d\u52a1\u5668\u6bcf\u6b21\u8fd0\u884c\u7684\u8eab\u4efd\u8bc6\u522b\u7801\uff0c\u4e00\u53f0\u670d\u52a1\u5668\u591a\u6b21\u8fd0\u884c\u53ef\u4ee5\u751f\u6210\u591a\u4e2a\u8fd0\u884cid \u7ec4\u6210\uff1a\u8fd0\u884cid\u753140\u4f4d\u5b57\u7b26\u7ec4\u6210\uff0c\u662f\u4e00\u4e2a\u968f\u673a\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26 \u4f8b\u5982\uff1afdc9ff13b9bbaab28db42b3d50f852bb5e3fcdce \u4f5c\u7528\uff1a\u8fd0\u884cid\u88ab\u7528\u4e8e\u5728\u670d\u52a1\u5668\u95f4\u8fdb\u884c\u4f20\u8f93\uff0c\u8bc6\u522b\u8eab\u4efd \u5982\u679c\u60f3\u4e24\u6b21\u64cd\u4f5c\u5747\u5bf9\u540c\u4e00\u53f0\u670d\u52a1\u5668\u8fdb\u884c\uff0c\u5fc5\u987b\u6bcf\u6b21\u64cd\u4f5c\u643a\u5e26\u5bf9\u5e94\u7684\u8fd0\u884cid\uff0c\u7528\u4e8e\u5bf9\u65b9\u8bc6\u522b \u5b9e\u73b0\u65b9\u5f0f\uff1a\u8fd0\u884cid\u5728\u6bcf\u53f0\u670d\u52a1\u5668\u542f\u52a8\u65f6\u81ea\u52a8\u751f\u6210\u7684\uff0cmaster\u5728\u9996\u6b21\u8fde\u63a5slave\u65f6\uff0c\u4f1a\u5c06\u81ea\u5df1\u7684\u8fd0\u884cID\u53d1\u9001\u7ed9slave\uff0c slave\u4fdd\u5b58\u6b64ID\uff0c\u901a\u8fc7info Server\u547d\u4ee4\uff0c\u53ef\u4ee5\u67e5\u770b\u8282\u70b9\u7684runid \u590d\u5236\u7f13\u51b2\u533a \u6982\u5ff5\uff1a\u590d\u5236\u7f13\u51b2\u533a\uff0c\u53c8\u540d\u590d\u5236\u79ef\u538b\u7f13\u51b2\u533a\uff0c\u662f\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\uff08FIFO\uff09\u7684\u961f\u5217\uff0c\u7528\u4e8e\u5b58\u50a8\u670d\u52a1\u5668\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u6bcf\u6b21\u4f20\u64ad\u547d\u4ee4\uff0cmaster\u90fd\u4f1a\u5c06\u4f20\u64ad\u7684\u547d\u4ee4\u8bb0\u5f55\u4e0b\u6765\uff0c\u5e76\u5b58\u50a8\u5728\u590d\u5236\u7f13\u51b2\u533a \u590d\u5236\u7f13\u51b2\u533a\u9ed8\u8ba4\u6570\u636e\u5b58\u50a8\u7a7a\u95f4\u5927\u5c0f\u662f1M \u5f53\u5165\u961f\u5143\u7d20\u7684\u6570\u91cf\u5927\u4e8e\u961f\u5217\u957f\u5ea6\u65f6\uff0c\u6700\u5148\u5165\u961f\u7684\u5143\u7d20\u4f1a\u88ab\u5f39\u51fa\uff0c\u800c\u65b0\u5143\u7d20\u4f1a\u88ab\u653e\u5165\u961f\u5217 \u4f5c\u7528\uff1a\u7528\u4e8e\u4fdd\u5b58master\u6536\u5230\u7684\u6240\u6709\u6307\u4ee4\uff08\u4ec5\u5f71\u54cd\u6570\u636e\u53d8\u66f4\u7684\u6307\u4ee4\uff0c\u4f8b\u5982set\uff0cselect\uff09 \u6570\u636e\u6765\u6e90\uff1a\u5f53master\u63a5\u6536\u5230\u4e3b\u5ba2\u6237\u7aef\u7684\u6307\u4ee4\u65f6\uff0c\u9664\u4e86\u5c06\u6307\u4ee4\u6267\u884c\uff0c\u4f1a\u5c06\u8be5\u6307\u4ee4\u5b58\u50a8\u5230\u7f13\u51b2\u533a\u4e2d \u590d\u5236\u7f13\u51b2\u533a\u5185\u90e8\u5de5\u4f5c\u539f\u7406\uff1a \u7ec4\u6210 \u504f\u79fb\u91cf \u6982\u5ff5\uff1a\u4e00\u4e2a\u6570\u5b57\uff0c\u63cf\u8ff0\u590d\u5236\u7f13\u51b2\u533a\u4e2d\u7684\u6307\u4ee4\u5b57\u8282\u4f4d\u7f6e \u5206\u7c7b\uff1a master\u590d\u5236\u504f\u79fb\u91cf\uff1a\u8bb0\u5f55\u53d1\u9001\u7ed9\u6240\u6709slave\u7684\u6307\u4ee4\u5b57\u8282\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff08\u591a\u4e2a\uff09 slave\u590d\u5236\u504f\u79fb\u91cf\uff1a\u8bb0\u5f55slave\u63a5\u6536master\u53d1\u9001\u8fc7\u6765\u7684\u6307\u4ee4\u5b57\u8282\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff08\u4e00\u4e2a\uff09 \u4f5c\u7528\uff1a\u540c\u6b65\u4fe1\u606f\uff0c\u6bd4\u5bf9master\u4e0eslave\u7684\u5dee\u5f02\uff0c\u5f53slave\u65ad\u7ebf\u540e\uff0c\u6062\u590d\u6570\u636e\u4f7f\u7528 \u6570\u636e\u6765\u6e90\uff1a master\u7aef\uff1a\u53d1\u9001\u4e00\u6b21\u8bb0\u5f55\u4e00\u6b21 slave\u7aef\uff1a\u63a5\u6536\u4e00\u6b21\u8bb0\u5f55\u4e00\u6b21 \u5b57\u8282\u503c \u5de5\u4f5c\u539f\u7406 \u901a\u8fc7offset\u533a\u5206\u4e0d\u540c\u7684slave\u5f53\u524d\u6570\u636e\u4f20\u64ad\u7684\u5dee\u5f02 master\u8bb0\u5f55\u5df2\u53d1\u9001\u7684\u4fe1\u606f\u5bf9\u5e94\u7684offset slave\u8bb0\u5f55\u5df2\u63a5\u6536\u7684\u4fe1\u606f\u5bf9\u5e94\u7684offset 2.2.2 \u6d41\u7a0b\u66f4\u65b0(\u5168\u91cf\u590d\u5236/\u90e8\u5206\u590d\u5236) \u00b6 \u6211\u4eec\u518d\u6b21\u7684\u603b\u7ed3\u4e00\u4e0b\u4e3b\u4ece\u590d\u5236\u7684\u4e09\u4e2a\u9636\u6bb5\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a 2.2.3 \u5fc3\u8df3\u673a\u5236 \u00b6 \u4ec0\u4e48\u662f\u5fc3\u8df3\u673a\u5236\uff1f \u8fdb\u5165\u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\u5019\uff0cmaster\u4e0eslave\u95f4\u9700\u8981\u8fdb\u884c\u4fe1\u606f\u4ea4\u6362\uff0c\u4f7f\u7528\u5fc3\u8df3\u673a\u5236\u8fdb\u884c\u7ef4\u62a4\uff0c\u5b9e\u73b0\u53cc\u65b9\u8fde\u63a5\u4fdd\u6301\u5728\u7ebf master\u5fc3\u8df3\uff1a \u5185\u90e8\u6307\u4ee4\uff1aPING \u5468\u671f\uff1a\u7531repl-ping-slave-period\u51b3\u5b9a\uff0c\u9ed8\u8ba410\u79d2 \u4f5c\u7528\uff1a\u5224\u65adslave\u662f\u5426\u5728\u7ebf \u67e5\u8be2\uff1aINFO replication \u83b7\u53d6slave\u6700\u540e\u4e00\u6b21\u8fde\u63a5\u65f6\u95f4\u95f4\u9694\uff0clag\u9879\u7ef4\u6301\u57280\u62161\u89c6\u4e3a\u6b63\u5e38 slave\u5fc3\u8df3\u4efb\u52a1 \u5185\u90e8\u6307\u4ee4\uff1aREPLCONF ACK {offset} \u5468\u671f\uff1a1\u79d2 \u4f5c\u75281\uff1a\u6c47\u62a5slave\u81ea\u5df1\u7684\u590d\u5236\u504f\u79fb\u91cf\uff0c\u83b7\u53d6\u6700\u65b0\u7684\u6570\u636e\u53d8\u66f4\u6307\u4ee4 \u4f5c\u75282\uff1a\u5224\u65admaster\u662f\u5426\u5728\u7ebf \u5fc3\u8df3\u9636\u6bb5\u6ce8\u610f\u4e8b\u9879\uff1a \u5f53slave\u591a\u6570\u6389\u7ebf\uff0c\u6216\u5ef6\u8fdf\u8fc7\u9ad8\u65f6\uff0cmaster\u4e3a\u4fdd\u969c\u6570\u636e\u7a33\u5b9a\u6027\uff0c\u5c06\u62d2\u7edd\u6240\u6709\u4fe1\u606f\u540c\u6b65 min-slaves-to-write 2 min-slaves-max-lag 8 slave\u6570\u91cf\u5c11\u4e8e2\u4e2a\uff0c\u6216\u8005\u6240\u6709slave\u7684\u5ef6\u8fdf\u90fd\u5927\u4e8e\u7b49\u4e8e8\u79d2\u65f6\uff0c\u5f3a\u5236\u5173\u95edmaster\u5199\u529f\u80fd\uff0c\u505c\u6b62\u6570\u636e\u540c\u6b65 slave\u6570\u91cf\u7531slave\u53d1\u9001REPLCONF ACK\u547d\u4ee4\u505a\u786e\u8ba4 slave\u5ef6\u8fdf\u7531slave\u53d1\u9001REPLCONF ACK\u547d\u4ee4\u505a\u786e\u8ba4 \u81f3\u6b64\uff1a\u6211\u4eec\u53ef\u4ee5\u603b\u7ed3\u51fa\u5b8c\u6574\u7684\u4e3b\u4ece\u590d\u5236\u6d41\u7a0b\uff1a 2.3 \u4e3b\u4ece\u590d\u5236\u5e38\u89c1\u95ee\u9898 \u00b6 2.3.1 \u9891\u7e41\u7684\u5168\u91cf\u590d\u5236 \u00b6 \u4f34\u968f\u7740\u7cfb\u7edf\u7684\u8fd0\u884c\uff0cmaster\u7684\u6570\u636e\u91cf\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c\u4e00\u65e6master\u91cd\u542f\uff0crunid\u5c06\u53d1\u751f\u53d8\u5316\uff0c\u4f1a\u5bfc\u81f4\u5168\u90e8slave\u7684\u5168\u91cf\u590d\u5236\u64cd\u4f5c \u5185\u90e8\u4f18\u5316\u8c03\u6574\u65b9\u6848\uff1a 1\uff1amaster\u5185\u90e8\u521b\u5efamaster_replid\u53d8\u91cf\uff0c\u4f7f\u7528runid\u76f8\u540c\u7684\u7b56\u7565\u751f\u6210\uff0c\u957f\u5ea641\u4f4d\uff0c\u5e76\u53d1\u9001\u7ed9\u6240\u6709slave 2\uff1a\u5728master\u5173\u95ed\u65f6\u6267\u884c\u547d\u4ee4shutdown save\uff0c\u8fdb\u884cRDB\u6301\u4e45\u5316,\u5c06runid\u4e0eoffset\u4fdd\u5b58\u5230RDB\u6587\u4ef6\u4e2d repl-id repl-offset \u901a\u8fc7redis-check-rdb\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u8be5\u4fe1\u606f 3\uff1amaster\u91cd\u542f\u540e\u52a0\u8f7dRDB\u6587\u4ef6\uff0c\u6062\u590d\u6570\u636e\uff0c\u91cd\u542f\u540e\uff0c\u5c06RDB\u6587\u4ef6\u4e2d\u4fdd\u5b58\u7684repl-id\u4e0erepl-offset\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d master_repl_id=repl master_repl_offset =repl-offset \u901a\u8fc7info\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u8be5\u4fe1\u606f \u4f5c\u7528\uff1a\u672c\u673a\u4fdd\u5b58\u4e0a\u6b21runid\uff0c\u91cd\u542f\u540e\u6062\u590d\u8be5\u503c\uff0c\u4f7f\u6240\u6709slave\u8ba4\u4e3a\u8fd8\u662f\u4e4b\u524d\u7684master \u7b2c\u4e8c\u79cd\u51fa\u73b0\u9891\u7e41\u5168\u91cf\u590d\u5236\u7684\u95ee\u9898\u73b0\u8c61\uff1a\u7f51\u7edc\u73af\u5883\u4e0d\u4f73\uff0c\u51fa\u73b0\u7f51\u7edc\u4e2d\u65ad\uff0cslave\u4e0d\u63d0\u4f9b\u670d\u52a1 \u95ee\u9898\u539f\u56e0\uff1a\u590d\u5236\u7f13\u51b2\u533a\u8fc7\u5c0f\uff0c\u65ad\u7f51\u540eslave\u7684offset\u8d8a\u754c\uff0c\u89e6\u53d1\u5168\u91cf\u590d\u5236 \u6700\u7ec8\u7ed3\u679c\uff1aslave\u53cd\u590d\u8fdb\u884c\u5168\u91cf\u590d\u5236 \u89e3\u51b3\u65b9\u6848\uff1a\u4fee\u6539\u590d\u5236\u7f13\u51b2\u533a\u5927\u5c0f repl-backlog-size ?mb \u5efa\u8bae\u8bbe\u7f6e\u5982\u4e0b\uff1a 1.\u6d4b\u7b97\u4ecemaster\u5230slave\u7684\u91cd\u8fde\u5e73\u5747\u65f6\u957fsecond 2.\u83b7\u53d6master\u5e73\u5747\u6bcf\u79d2\u4ea7\u751f\u5199\u547d\u4ee4\u6570\u636e\u603b\u91cfwrite_size_per_second 3.\u6700\u4f18\u590d\u5236\u7f13\u51b2\u533a\u7a7a\u95f4 = 2 * second * write_size_per_second 2.3.2 \u9891\u7e41\u7684\u7f51\u7edc\u4e2d\u65ad \u00b6 \u95ee\u9898\u73b0\u8c61\uff1amaster\u7684CPU\u5360\u7528\u8fc7\u9ad8 \u6216 slave\u9891\u7e41\u65ad\u5f00\u8fde\u63a5 \u95ee\u9898\u539f\u56e0 slave\u6bcf1\u79d2\u53d1\u9001REPLCONFACK\u547d\u4ee4\u5230master \u5f53slave\u63a5\u5230\u4e86\u6162\u67e5\u8be2\u65f6\uff08keys * \uff0chgetall\u7b49\uff09\uff0c\u4f1a\u5927\u91cf\u5360\u7528CPU\u6027\u80fd master\u6bcf1\u79d2\u8c03\u7528\u590d\u5236\u5b9a\u65f6\u51fd\u6570replicationCron()\uff0c\u6bd4\u5bf9slave\u53d1\u73b0\u957f\u65f6\u95f4\u6ca1\u6709\u8fdb\u884c\u54cd\u5e94 \u6700\u7ec8\u7ed3\u679c\uff1amaster\u5404\u79cd\u8d44\u6e90\uff08\u8f93\u51fa\u7f13\u51b2\u533a\u3001\u5e26\u5bbd\u3001\u8fde\u63a5\u7b49\uff09\u88ab\u4e25\u91cd\u5360\u7528 \u89e3\u51b3\u65b9\u6848\uff1a\u901a\u8fc7\u8bbe\u7f6e\u5408\u7406\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u786e\u8ba4\u662f\u5426\u91ca\u653eslave repl-timeout seconds \u8be5\u53c2\u6570\u5b9a\u4e49\u4e86\u8d85\u65f6\u65f6\u95f4\u7684\u9608\u503c\uff08\u9ed8\u8ba460\u79d2\uff09\uff0c\u8d85\u8fc7\u8be5\u503c\uff0c\u91ca\u653eslave \u95ee\u9898\u73b0\u8c61\uff1aslave\u4e0emaster\u8fde\u63a5\u65ad\u5f00 \u95ee\u9898\u539f\u56e0 master\u53d1\u9001ping\u6307\u4ee4\u9891\u5ea6\u8f83\u4f4e master\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4\u8f83\u77ed ping\u6307\u4ee4\u5728\u7f51\u7edc\u4e2d\u5b58\u5728\u4e22\u5305 \u89e3\u51b3\u65b9\u6848\uff1a\u63d0\u9ad8ping\u6307\u4ee4\u53d1\u9001\u7684\u9891\u5ea6 repl-ping-slave-period seconds \u8d85\u65f6\u65f6\u95f4repl-time\u7684\u65f6\u95f4\u81f3\u5c11\u662fping\u6307\u4ee4\u9891\u5ea6\u76845\u523010\u500d\uff0c\u5426\u5219slave\u5f88\u5bb9\u6613\u5224\u5b9a\u8d85\u65f6 2.3.3 \u6570\u636e\u4e0d\u4e00\u81f4 \u00b6 \u95ee\u9898\u73b0\u8c61\uff1a\u591a\u4e2aslave\u83b7\u53d6\u76f8\u540c\u6570\u636e\u4e0d\u540c\u6b65 \u95ee\u9898\u539f\u56e0\uff1a\u7f51\u7edc\u4fe1\u606f\u4e0d\u540c\u6b65\uff0c\u6570\u636e\u53d1\u9001\u6709\u5ef6\u8fdf \u89e3\u51b3\u65b9\u6848 \u4f18\u5316\u4e3b\u4ece\u95f4\u7684\u7f51\u7edc\u73af\u5883\uff0c\u901a\u5e38\u653e\u7f6e\u5728\u540c\u4e00\u4e2a\u673a\u623f\u90e8\u7f72\uff0c\u5982\u4f7f\u7528\u963f\u91cc\u4e91\u7b49\u4e91\u670d\u52a1\u5668\u65f6\u8981\u6ce8\u610f\u6b64\u73b0\u8c61 \u76d1\u63a7\u4e3b\u4ece\u8282\u70b9\u5ef6\u8fdf\uff08\u901a\u8fc7offset\uff09\u5224\u65ad\uff0c\u5982\u679cslave\u5ef6\u8fdf\u8fc7\u5927\uff0c\u6682\u65f6\u5c4f\u853d\u7a0b\u5e8f\u5bf9\u8be5slave\u7684\u6570\u636e\u8bbf\u95ee slave-serve-stale-data yes|no \u5f00\u542f\u540e\u4ec5\u54cd\u5e94info\u3001slaveof\u7b49\u5c11\u6570\u547d\u4ee4\uff08\u614e\u7528\uff0c\u9664\u975e\u5bf9\u6570\u636e\u4e00\u81f4\u6027\u8981\u6c42\u5f88\u9ad8\uff09 3.\u54e8\u5175\u6a21\u5f0f \u00b6 3.1 \u54e8\u5175\u7b80\u4ecb \u00b6 3.1.1 \u54e8\u5175\u6982\u5ff5 \u00b6 \u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4e1a\u52a1\u573a\u666f\uff1a\u5982\u679credis\u7684master\u5b95\u673a\u4e86\uff0c\u6b64\u65f6\u5e94\u8be5\u600e\u4e48\u529e\uff1f \u90a3\u6b64\u65f6\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4ece\u4e00\u5806\u7684slave\u4e2d\u91cd\u65b0\u9009\u4e3e\u51fa\u4e00\u4e2a\u65b0\u7684master\uff0c\u90a3\u8fd9\u4e2a\u64cd\u4f5c\u8fc7\u7a0b\u662f\u4ec0\u4e48\u6837\u7684\u5462\uff1f\u8fd9\u91cc\u9762\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\u51fa\u73b0\u5462\uff1f \u8981\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\uff0c\u6211\u4eec\u5c31\u9700\u8981redis\u7684\u54e8\u5175\uff0c\u90a3\u54e8\u5175\u662f\u4ec0\u4e48\u5462\uff1f \u54e8\u5175 \u54e8\u5175(sentinel) \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u7528\u4e8e\u5bf9\u4e3b\u4ece\u7ed3\u6784\u4e2d\u7684\u6bcf\u53f0\u670d\u52a1\u5668\u8fdb\u884c \u76d1\u63a7 \uff0c\u5f53\u51fa\u73b0\u6545\u969c\u65f6\u901a\u8fc7 \u6295\u7968 \u673a\u5236 \u9009\u62e9 \u65b0\u7684master\u5e76\u5c06\u6240\u6709slave\u8fde\u63a5\u5230\u65b0\u7684master\u3002 3.1.2 \u54e8\u5175\u4f5c\u7528 \u00b6 \u54e8\u5175\u7684\u4f5c\u7528\uff1a \u76d1\u63a7\uff1a\u76d1\u63a7master\u548cslave \u4e0d\u65ad\u7684\u68c0\u67e5master\u548cslave\u662f\u5426\u6b63\u5e38\u8fd0\u884c master\u5b58\u6d3b\u68c0\u6d4b\u3001master\u4e0eslave\u8fd0\u884c\u60c5\u51b5\u68c0\u6d4b \u901a\u77e5\uff08\u63d0\u9192\uff09\uff1a\u5f53\u88ab\u76d1\u63a7\u7684\u670d\u52a1\u5668\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u5411\u5176\u4ed6\uff08\u54e8\u5175\u95f4\uff0c\u5ba2\u6237\u7aef\uff09\u53d1\u9001\u901a\u77e5 \u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff1a\u65ad\u5f00master\u4e0eslave\u8fde\u63a5\uff0c\u9009\u53d6\u4e00\u4e2aslave\u4f5c\u4e3amaster\uff0c\u5c06\u5176\u4ed6slave\u8fde\u63a5\u65b0\u7684master\uff0c\u5e76\u544a\u77e5\u5ba2\u6237\u7aef\u65b0\u7684\u670d\u52a1\u5668\u5730\u5740 \u6ce8\u610f\uff1a\u54e8\u5175\u4e5f\u662f\u4e00\u53f0redis\u670d\u52a1\u5668\uff0c\u53ea\u662f\u4e0d\u63d0\u4f9b\u6570\u636e\u76f8\u5173\u670d\u52a1\uff0c\u901a\u5e38\u54e8\u5175\u7684\u6570\u91cf\u914d\u7f6e\u4e3a\u5355\u6570 3.2 \u542f\u7528\u54e8\u5175 \u00b6 \u914d\u7f6e\u54e8\u5175 \u914d\u7f6e\u4e00\u62d6\u4e8c\u7684\u4e3b\u4ece\u7ed3\u6784\uff08\u5229\u7528\u4e4b\u524d\u7684\u65b9\u5f0f\u542f\u52a8\u5373\u53ef\uff09 \u914d\u7f6e\u4e09\u4e2a\u54e8\u5175\uff08\u914d\u7f6e\u76f8\u540c\uff0c\u7aef\u53e3\u4e0d\u540c\uff09\uff0c\u53c2\u770bsentinel.conf 1\uff1a\u8bbe\u7f6e\u54e8\u5175\u76d1\u542c\u7684\u4e3b\u670d\u52a1\u5668\u4fe1\u606f\uff0c sentinel_number\u8868\u793a\u53c2\u4e0e\u6295\u7968\u7684\u54e8\u5175\u6570\u91cf sentinel monitor master_name master_host master_port sentinel_number 2\uff1a\u8bbe\u7f6e\u5224\u5b9a\u670d\u52a1\u5668\u5b95\u673a\u65f6\u957f\uff0c\u8be5\u8bbe\u7f6e\u63a7\u5236\u662f\u5426\u8fdb\u884c\u4e3b\u4ece\u5207\u6362 sentinel down-after-milliseconds master_name million_seconds 3\uff1a\u8bbe\u7f6e\u6545\u969c\u5207\u6362\u7684\u6700\u5927\u8d85\u65f6\u65f6 sentinel failover-timeout master_name million_seconds 4\uff1a\u8bbe\u7f6e\u4e3b\u4ece\u5207\u6362\u540e\uff0c\u540c\u65f6\u8fdb\u884c\u6570\u636e\u540c\u6b65\u7684slave\u6570\u91cf\uff0c\u6570\u503c\u8d8a\u5927\uff0c\u8981\u6c42\u7f51\u7edc\u8d44\u6e90\u8d8a\u9ad8\uff0c\u6570\u503c\u8d8a\u5c0f\uff0c\u540c\u6b65\u65f6\u95f4\u8d8a\u957f sentinel parallel-syncs master_name sync_slave_number \u542f\u52a8\u54e8\u5175 redis-sentinel filename 3.3 \u54e8\u5175\u5de5\u4f5c\u539f\u7406 \u00b6 \u54e8\u5175\u5728\u8fdb\u884c\u4e3b\u4ece\u5207\u6362\u8fc7\u7a0b\u4e2d\u7ecf\u5386\u4e09\u4e2a\u9636\u6bb5 \u76d1\u63a7 \u901a\u77e5 \u6545\u969c\u8f6c\u79fb 3.3.1 \u76d1\u63a7 \u00b6 \u7528\u4e8e\u540c\u6b65\u5404\u4e2a\u8282\u70b9\u7684\u72b6\u6001\u4fe1\u606f \u83b7\u53d6\u5404\u4e2asentinel\u7684\u72b6\u6001\uff08\u662f\u5426\u5728\u7ebf\uff09 \u83b7\u53d6master\u7684\u72b6\u6001 master\u5c5e\u6027 prunid prole\uff1amaster \u5404\u4e2aslave\u7684\u8be6\u7ec6\u4fe1\u606f \u83b7\u53d6\u6240\u6709slave\u7684\u72b6\u6001\uff08\u6839\u636emaster\u4e2d\u7684slave\u4fe1\u606f\uff09 slave\u5c5e\u6027 prunid prole\uff1aslave pmaster_host\u3001master_port poffset \u5176\u5185\u90e8\u7684\u5de5\u4f5c\u539f\u7406\u5177\u4f53\u5982\u4e0b\uff1a 3.3.2 \u901a\u77e5 \u00b6 sentinel\u5728\u901a\u77e5\u9636\u6bb5\u8981\u4e0d\u65ad\u7684\u53bb\u83b7\u53d6master/slave\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5728\u5404\u4e2asentinel\u4e4b\u95f4\u8fdb\u884c\u5171\u4eab\uff0c\u5177\u4f53\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a 3.3.3 \u6545\u969c\u8f6c\u79fb \u00b6 \u5f53master\u5b95\u673a\u540esentinel\u662f\u5982\u4f55\u77e5\u6653\u5e76\u5224\u65ad\u51famaster\u662f\u771f\u7684\u5b95\u673a\u4e86\u5462\uff1f\u6211\u4eec\u6765\u770b\u5177\u4f53\u7684\u64cd\u4f5c\u6d41\u7a0b \u5f53sentinel\u8ba4\u5b9amaster\u4e0b\u7ebf\u4e4b\u540e\uff0c\u6b64\u65f6\u9700\u8981\u51b3\u5b9a\u66f4\u6362master\uff0c\u90a3\u8fd9\u4ef6\u4e8b\u7531\u54ea\u4e2asentinel\u6765\u505a\u5462\uff1f\u8fd9\u65f6\u5019sentinel\u4e4b\u95f4\u8981\u8fdb\u884c\u9009\u4e3e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5728\u9009\u4e3e\u7684\u65f6\u5019\u6bcf\u4e00\u4e2a\u4eba\u624b\u91cc\u90fd\u6709\u4e00\u7968\uff0c\u800c\u6bcf\u4e00\u4e2a\u4eba\u7684\u53c8\u90fd\u60f3\u5f53\u8fd9\u4e2a\u5904\u7406\u4e8b\u6545\u7684\u4eba\uff0c\u90a3\u600e\u4e48\u529e\uff1f\u5927\u5bb6\u5c31\u5f00\u59cb\u62a2\uff0c\u4e8e\u662f\u6bcf\u4e2a\u4eba\u90fd\u4f1a\u53d1\u51fa\u4e00\u4e2a\u6307\u4ee4\uff0c\u5728\u5185\u7f51\u91cc\u8fb9\u544a\u8bc9\u5927\u5bb6\u6211\u8981\u5f53\u9009\u4e3e\u4eba\uff0c\u6bd4\u5982\u8bf4\u73b0\u5728\u7684sentinel1\u548csentinel4\u53d1\u51fa\u8fd9\u4e2a\u9009\u4e3e\u6307\u4ee4\u4e86\uff0c\u90a3\u4e48sentinel2\u65e2\u80fd\u63a5\u5230sentinel1\u7684\u4e5f\u80fd\u63a5\u5230sentinel4\u7684\uff0c\u63a5\u5230\u4e86\u4ed6\u4eec\u7684\u7533\u8bf7\u4ee5\u540e\u5462\uff0csentinel2\u4ed6\u5c31\u4f1a\u628a\u4ed6\u7684\u4e00\u7968\u6295\u7ed9\u5176\u4e2d\u4e00\u65b9\uff0c\u6295\u7ed9\u8c01\u5462\uff1f\u8c01\u5148\u8fc7\u6765\u6211\u6295\u7ed9\u8c01\uff0c\u5047\u8bbesentinel1\u5148\u8fc7\u6765\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7968\u5c31\u7ed9\u5230\u4e86sentinel1\u3002\u90a3\u4e48\u7ed9\u8fc7\u53bb\u4ee5\u540e\u5462\uff0c\u73b0\u5728sentinel1\u5c31\u62ff\u5230\u4e86\u4e00\u7968\uff0c\u6309\u7167\u8fd9\u6837\u7684\u4e00\u79cd\u5f62\u5f0f\uff0c\u6700\u7ec8\u4f1a\u6709\u4e00\u4e2a\u9009\u4e3e\u7ed3\u679c\u3002\u5bf9\u5e94\u7684\u9009\u4e3e\u6700\u7ec8\u5f97\u7968\u591a\u7684\uff0c\u90a3\u81ea\u7136\u5c31\u6210\u4e3a\u4e86\u5904\u7406\u4e8b\u6545\u7684\u4eba\u3002\u9700\u8981\u6ce8\u610f\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6709\u53ef\u80fd\u4f1a\u5b58\u5728\u5931\u8d25\u7684\u73b0\u8c61\uff0c\u5c31\u662f\u4e00\u8f6e\u9009\u4e3e\u5b8c\u6ca1\u6709\u9009\u53d6\uff0c\u90a3\u5c31\u4f1a\u63a5\u7740\u8fdb\u884c\u7b2c\u4e8c\u8f6e\u7b2c\u4e09\u8f6e\u76f4\u5230\u5b8c\u6210\u9009\u4e3e\u3002 \u63a5\u4e0b\u6765\u5c31\u662f\u7531\u9009\u4e3e\u80dc\u51fa\u7684sentinel\u53bb\u4eceslave\u4e2d\u9009\u4e00\u4e2a\u65b0\u7684master\u51fa\u6765\u7684\u5de5\u4f5c\uff0c\u8fd9\u4e2a\u6d41\u7a0b\u662f\u4ec0\u4e48\u6837\u7684\u5462\uff1f \u9996\u5148\u5b83\u6709\u4e00\u4e2a\u5728\u670d\u52a1\u5668\u5217\u8868\u4e2d\u6311\u9009\u5907\u9009master\u7684\u539f\u5219 \u4e0d\u5728\u7ebf\u7684OUT \u54cd\u5e94\u6162\u7684OUT \u4e0e\u539fmaster\u65ad\u5f00\u65f6\u95f4\u4e45\u7684OUT \u4f18\u5148\u539f\u5219 \u4f18\u5148\u7ea7 offset runid \u9009\u51fa\u65b0\u7684master\u4e4b\u540e\uff0c\u53d1\u9001\u6307\u4ee4\uff08 sentinel \uff09\u7ed9\u5176\u4ed6\u7684slave\uff1a \u5411\u65b0\u7684master\u53d1\u9001slaveof no one \u5411\u5176\u4ed6slave\u53d1\u9001slaveof \u65b0masterIP\u7aef\u53e3 \u603b\u7ed3 \uff1a\u6545\u969c\u8f6c\u79fb\u9636\u6bb5 \u53d1\u73b0\u95ee\u9898\uff0c\u4e3b\u89c2\u4e0b\u7ebf\u4e0e\u5ba2\u89c2\u4e0b\u7ebf \u7ade\u9009\u8d1f\u8d23\u4eba \u4f18\u9009\u65b0master \u65b0master\u4e0a\u4efb\uff0c\u5176\u4ed6slave\u5207\u6362master\uff0c\u539fmaster\u4f5c\u4e3aslave\u6545\u969c\u6062\u590d\u540e\u8fde\u63a5 4.\u96c6\u7fa4cluster \u00b6 \u73b0\u72b6\u95ee\u9898\uff1a\u4e1a\u52a1\u53d1\u5c55\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u5cf0\u503c\u74f6\u9888 redis\u63d0\u4f9b\u7684\u670d\u52a1OPS\u53ef\u4ee5\u8fbe\u523010\u4e07/\u79d2\uff0c\u5f53\u524d\u4e1a\u52a1OPS\u5df2\u7ecf\u8fbe\u523010\u4e07/\u79d2 \u5185\u5b58\u5355\u673a\u5bb9\u91cf\u8fbe\u5230256G\uff0c\u5f53\u524d\u4e1a\u52a1\u9700\u6c42\u5185\u5b58\u5bb9\u91cf1T \u4f7f\u7528\u96c6\u7fa4\u7684\u65b9\u5f0f\u53ef\u4ee5\u5feb\u901f\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898 4.1 \u96c6\u7fa4\u7b80\u4ecb \u00b6 \u96c6\u7fa4\u5c31\u662f\u4f7f\u7528\u7f51\u7edc\u5c06\u82e5\u5e72\u53f0\u8ba1\u7b97\u673a\u8054\u901a\u8d77\u6765\uff0c\u5e76\u63d0\u4f9b\u7edf\u4e00\u7684\u7ba1\u7406\u65b9\u5f0f\uff0c\u4f7f\u5176\u5bf9\u5916\u5448\u73b0\u5355\u673a\u7684\u670d\u52a1\u6548\u679c \u96c6\u7fa4\u4f5c\u7528\uff1a \u5206\u6563\u5355\u53f0\u670d\u52a1\u5668\u7684\u8bbf\u95ee\u538b\u529b\uff0c\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861 \u5206\u6563\u5355\u53f0\u670d\u52a1\u5668\u7684\u5b58\u50a8\u538b\u529b\uff0c\u5b9e\u73b0\u53ef\u6269\u5c55\u6027 \u964d\u4f4e\u5355\u53f0\u670d\u52a1\u5668\u5b95\u673a\u5e26\u6765\u7684\u4e1a\u52a1\u707e\u96be 4.2 Cluster\u96c6\u7fa4\u7ed3\u6784\u8bbe\u8ba1 \u00b6 \u6570\u636e\u5b58\u50a8\u8bbe\u8ba1\uff1a \u901a\u8fc7\u7b97\u6cd5\u8bbe\u8ba1\uff0c\u8ba1\u7b97\u51fakey\u5e94\u8be5\u4fdd\u5b58\u7684\u4f4d\u7f6e \u5c06\u6240\u6709\u7684\u5b58\u50a8\u7a7a\u95f4\u8ba1\u5212\u5207\u5272\u621016384\u4efd\uff0c\u6bcf\u53f0\u4e3b\u673a\u4fdd\u5b58\u4e00\u90e8\u5206 \u6ce8\u610f\uff1a\u6bcf\u4efd\u4ee3\u8868\u7684\u662f\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\uff0c\u4e0d\u662f\u4e00\u4e2akey\u7684\u4fdd\u5b58\u7a7a\u95f4 \u5c06key\u6309\u7167\u8ba1\u7b97\u51fa\u7684\u7ed3\u679c\u653e\u5230\u5bf9\u5e94\u7684\u5b58\u50a8\u7a7a\u95f4 \u90a3redis\u7684\u96c6\u7fa4\u662f\u5982\u4f55\u589e\u5f3a\u53ef\u6269\u5c55\u6027\u7684\u5462\uff1f\u8b6c\u5982\u6211\u4eec\u8981\u589e\u52a0\u4e00\u4e2a\u96c6\u7fa4\u8282\u70b9 \u5f53\u6211\u4eec\u67e5\u627e\u6570\u636e\u65f6\uff0c\u96c6\u7fa4\u662f\u5982\u4f55\u64cd\u4f5c\u7684\u5462\uff1f \u5404\u4e2a\u6570\u636e\u5e93\u76f8\u4e92\u901a\u4fe1\uff0c\u4fdd\u5b58\u5404\u4e2a\u5e93\u4e2d\u69fd\u7684\u7f16\u53f7\u6570\u636e \u4e00\u6b21\u547d\u4e2d\uff0c\u76f4\u63a5\u8fd4\u56de \u4e00\u6b21\u672a\u547d\u4e2d\uff0c\u544a\u77e5\u5177\u4f53\u4f4d\u7f6e 4.3 Cluster\u96c6\u7fa4\u7ed3\u6784\u642d\u5efa \u00b6 \u9996\u5148\u8981\u660e\u786e\u7684\u51e0\u4e2a\u8981\u70b9\uff1a \u914d\u7f6e\u670d\u52a1\u5668\uff083\u4e3b3\u4ece\uff09 \u5efa\u7acb\u901a\u4fe1\uff08Meet\uff09 \u5206\u69fd\uff08Slot\uff09 \u642d\u5efa\u4e3b\u4ece\uff08master-slave\uff09 Cluster\u914d\u7f6e \u662f\u5426\u542f\u7528cluster\uff0c\u52a0\u5165cluster\u8282\u70b9 cluster-enabled yes|no cluster\u914d\u7f6e\u6587\u4ef6\u540d\uff0c\u8be5\u6587\u4ef6\u5c5e\u4e8e\u81ea\u52a8\u751f\u6210\uff0c\u4ec5\u7528\u4e8e\u5feb\u901f\u67e5\u627e\u6587\u4ef6\u5e76\u67e5\u8be2\u6587\u4ef6\u5185\u5bb9 cluster-config-file filename \u8282\u70b9\u670d\u52a1\u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\uff0c\u7528\u4e8e\u5224\u5b9a\u8be5\u8282\u70b9\u662f\u5426\u4e0b\u7ebf\u6216\u5207\u6362\u4e3a\u4ece\u8282\u70b9 cluster-node-timeout milliseconds master\u8fde\u63a5\u7684slave\u6700\u5c0f\u6570\u91cf cluster-migration-barrier min_slave_number Cluster\u8282\u70b9\u64cd\u4f5c\u547d\u4ee4 \u67e5\u770b\u96c6\u7fa4\u8282\u70b9\u4fe1\u606f cluster nodes \u66f4\u6539slave\u6307\u5411\u65b0\u7684master cluster replicate master-id \u53d1\u73b0\u4e00\u4e2a\u65b0\u8282\u70b9\uff0c\u65b0\u589emaster cluster meet ip : port \u5ffd\u7565\u4e00\u4e2a\u6ca1\u6709solt\u7684\u8282\u70b9 cluster forget server_id \u624b\u52a8\u6545\u969c\u8f6c\u79fb cluster failover \u96c6\u7fa4\u64cd\u4f5c\u547d\u4ee4\uff1a \u521b\u5efa\u96c6\u7fa4 redis-cli \u2013-cluster create masterhost1 : masterport1 masterhost2:masterport2 masterhost3:masterport3 [masterhostn:masterportn \u2026] slavehost1:slaveport1 slavehost2:slaveport2 slavehost3:slaveport3 -\u2013cluster-replicas n \u6ce8\u610f\uff1amaster\u4e0eslave\u7684\u6570\u91cf\u8981\u5339\u914d\uff0c\u4e00\u4e2amaster\u5bf9\u5e94n\u4e2aslave\uff0c\u7531\u6700\u540e\u7684\u53c2\u6570n\u51b3\u5b9a master\u4e0eslave\u7684\u5339\u914d\u987a\u5e8f\u4e3a\u7b2c\u4e00\u4e2amaster\u4e0e\u524dn\u4e2aslave\u5206\u4e3a\u4e00\u7ec4\uff0c\u5f62\u6210\u4e3b\u4ece\u7ed3\u6784 \u6dfb\u52a0master\u5230\u5f53\u524d\u96c6\u7fa4\u4e2d\uff0c\u8fde\u63a5\u65f6\u53ef\u4ee5\u6307\u5b9a\u4efb\u610f\u73b0\u6709\u8282\u70b9\u5730\u5740\u4e0e\u7aef\u53e3 redis-cli --cluster add-node new-master-host : new-master-port now-host:now-port \u6dfb\u52a0slave redis-cli --cluster add-node new-slave-host : new-slave-port master-host:master-port --cluster-slave --cluster-master-id masterid \u5220\u9664\u8282\u70b9\uff0c\u5982\u679c\u5220\u9664\u7684\u8282\u70b9\u662fmaster\uff0c\u5fc5\u987b\u4fdd\u969c\u5176\u4e2d\u6ca1\u6709\u69fdslot redis-cli --cluster del-node del-slave-host : del-slave-port del-slave-id \u91cd\u65b0\u5206\u69fd\uff0c\u5206\u69fd\u662f\u4ece\u5177\u6709\u69fd\u7684master\u4e2d\u5212\u5206\u4e00\u90e8\u5206\u7ed9\u5176\u4ed6master\uff0c\u8fc7\u7a0b\u4e2d\u4e0d\u521b\u5efa\u65b0\u7684\u69fd redis-cli --cluster reshard new-master-host : new-master:port --cluster-from src- master-id1, src-master-id2, src-master-idn --cluster-to target-master-id -- cluster-slots slots \u6ce8\u610f\uff1a\u5c06\u9700\u8981\u53c2\u4e0e\u5206\u69fd\u7684\u6240\u6709masterid\u4e0d\u5206\u5148\u540e\u987a\u5e8f\u6dfb\u52a0\u5230\u53c2\u6570\u4e2d\uff0c\u4f7f\u7528\uff0c\u5206\u9694 \u6307\u5b9a\u76ee\u6807\u5f97\u5230\u7684\u69fd\u7684\u6570\u91cf\uff0c\u6240\u6709\u7684\u69fd\u5c06\u5e73\u5747\u4ece\u6bcf\u4e2a\u6765\u6e90\u7684master\u5904\u83b7\u53d6 \u91cd\u65b0\u5206\u914d\u69fd\uff0c\u4ece\u5177\u6709\u69fd\u7684master\u4e2d\u5206\u914d\u6307\u5b9a\u6570\u91cf\u7684\u69fd\u5230\u53e6\u4e00\u4e2amaster\u4e2d\uff0c\u5e38\u7528\u4e8e\u6e05\u7a7a\u6307\u5b9amaster\u4e2d\u7684\u69fd redis-cli --cluster reshard src-master-host : src-master-port --cluster-from src- master-id --cluster-to target-master-id --cluster-slots slots --cluster-yes 5.\u4f01\u4e1a\u7ea7\u89e3\u51b3\u65b9\u6848 \u00b6 5.1 \u7f13\u5b58\u9884\u70ed \u00b6 \u573a\u666f \uff1a\u201c\u5b95\u673a\u201d \u670d\u52a1\u5668\u542f\u52a8\u540e\u8fc5\u901f\u5b95\u673a \u95ee\u9898\u6392\u67e5 \uff1a 1.\u8bf7\u6c42\u6570\u91cf\u8f83\u9ad8\uff0c\u5927\u91cf\u7684\u8bf7\u6c42\u8fc7\u6765\u4e4b\u540e\u90fd\u9700\u8981\u53bb\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u4f46\u662f\u7f13\u5b58\u4e2d\u53c8\u6ca1\u6709\uff0c\u6b64\u65f6\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u627e\u6570\u636e\u7136\u540e\u5c06\u6570\u636e\u518d\u5b58\u5165\u7f13\u5b58\uff0c\u9020\u6210\u4e86\u77ed\u671f\u5185\u5bf9redis\u7684\u9ad8\u5f3a\u5ea6\u64cd\u4f5c\u4ece\u800c\u5bfc\u81f4\u95ee\u9898 2.\u4e3b\u4ece\u4e4b\u95f4\u6570\u636e\u541e\u5410\u91cf\u8f83\u5927\uff0c\u6570\u636e\u540c\u6b65\u64cd\u4f5c\u9891\u5ea6\u8f83\u9ad8 \u89e3\u51b3\u65b9\u6848\uff1a \u524d\u7f6e\u51c6\u5907\u5de5\u4f5c\uff1a 1.\u65e5\u5e38\u4f8b\u884c\u7edf\u8ba1\u6570\u636e\u8bbf\u95ee\u8bb0\u5f55\uff0c\u7edf\u8ba1\u8bbf\u95ee\u9891\u5ea6\u8f83\u9ad8\u7684\u70ed\u70b9\u6570\u636e 2.\u5229\u7528LRU\u6570\u636e\u5220\u9664\u7b56\u7565\uff0c\u6784\u5efa\u6570\u636e\u7559\u5b58\u961f\u5217\u4f8b\u5982\uff1astorm\u4e0ekafka\u914d\u5408 \u51c6\u5907\u5de5\u4f5c\uff1a 1.\u5c06\u7edf\u8ba1\u7ed3\u679c\u4e2d\u7684\u6570\u636e\u5206\u7c7b\uff0c\u6839\u636e\u7ea7\u522b\uff0credis\u4f18\u5148\u52a0\u8f7d\u7ea7\u522b\u8f83\u9ad8\u7684\u70ed\u70b9\u6570\u636e 2.\u5229\u7528\u5206\u5e03\u5f0f\u591a\u670d\u52a1\u5668\u540c\u65f6\u8fdb\u884c\u6570\u636e\u8bfb\u53d6\uff0c\u63d0\u901f\u6570\u636e\u52a0\u8f7d\u8fc7\u7a0b 3.\u70ed\u70b9\u6570\u636e\u4e3b\u4ece\u540c\u65f6\u9884\u70ed \u5b9e\u65bd\uff1a 4.\u4f7f\u7528\u811a\u672c\u7a0b\u5e8f\u56fa\u5b9a\u89e6\u53d1\u6570\u636e\u9884\u70ed\u8fc7\u7a0b 5.\u5982\u679c\u6761\u4ef6\u5141\u8bb8\uff0c\u4f7f\u7528\u4e86CDN\uff08\u5185\u5bb9\u5206\u53d1\u7f51\u7edc\uff09\uff0c\u6548\u679c\u4f1a\u66f4\u597d \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u9884\u70ed\u5c31\u662f\u7cfb\u7edf\u542f\u52a8\u524d\uff0c\u63d0\u524d\u5c06\u76f8\u5173\u7684\u7f13\u5b58\u6570\u636e\u76f4\u63a5\u52a0\u8f7d\u5230\u7f13\u5b58\u7cfb\u7edf\u3002\u907f\u514d\u5728\u7528\u6237\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5148\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u7136\u540e\u518d\u5c06\u6570\u636e\u7f13\u5b58\u7684\u95ee\u9898\uff01\u7528\u6237\u76f4\u63a5\u67e5\u8be2\u4e8b\u5148\u88ab\u9884\u70ed\u7684\u7f13\u5b58\u6570\u636e\uff01 5.2 \u7f13\u5b58\u96ea\u5d29 \u00b6 \u573a\u666f \uff1a\u6570\u636e\u5e93\u670d\u52a1\u5668\u5d29\u6e83\uff0c\u4e00\u8fde\u4e32\u7684\u573a\u666f\u4f1a\u968f\u4e4b\u513f\u6765 1.\u7cfb\u7edf\u5e73\u7a33\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u5ffd\u7136\u6570\u636e\u5e93\u8fde\u63a5\u91cf\u6fc0\u589e 2.\u5e94\u7528\u670d\u52a1\u5668\u65e0\u6cd5\u53ca\u65f6\u5904\u7406\u8bf7\u6c42 3.\u5927\u91cf408\uff0c500\u9519\u8bef\u9875\u9762\u51fa\u73b0 4.\u5ba2\u6237\u53cd\u590d\u5237\u65b0\u9875\u9762\u83b7\u53d6\u6570\u636e 5.\u6570\u636e\u5e93\u5d29\u6e83 6.\u5e94\u7528\u670d\u52a1\u5668\u5d29\u6e83 7.\u91cd\u542f\u5e94\u7528\u670d\u52a1\u5668\u65e0\u6548 8.Redis\u670d\u52a1\u5668\u5d29\u6e83 9.Redis\u96c6\u7fa4\u5d29\u6e83 10.\u91cd\u542f\u6570\u636e\u5e93\u540e\u518d\u6b21\u88ab\u77ac\u95f4\u6d41\u91cf\u653e\u5012 \u95ee\u9898\u6392\u67e5 \uff1a 1.\u5728\u4e00\u4e2a\u8f83\u77ed\u7684\u65f6\u95f4\u5185\uff0c\u7f13\u5b58\u4e2d\u8f83\u591a\u7684key\u96c6\u4e2d\u8fc7\u671f 2.\u6b64\u5468\u671f\u5185\u8bf7\u6c42\u8bbf\u95ee\u8fc7\u671f\u7684\u6570\u636e\uff0credis\u672a\u547d\u4e2d\uff0credis\u5411\u6570\u636e\u5e93\u83b7\u53d6\u6570\u636e 3.\u6570\u636e\u5e93\u540c\u65f6\u63a5\u6536\u5230\u5927\u91cf\u7684\u8bf7\u6c42\u65e0\u6cd5\u53ca\u65f6\u5904\u7406 4.Redis\u5927\u91cf\u8bf7\u6c42\u88ab\u79ef\u538b\uff0c\u5f00\u59cb\u51fa\u73b0\u8d85\u65f6\u73b0\u8c61 5.\u6570\u636e\u5e93\u6d41\u91cf\u6fc0\u589e\uff0c\u6570\u636e\u5e93\u5d29\u6e83 6.\u91cd\u542f\u540e\u4ecd\u7136\u9762\u5bf9\u7f13\u5b58\u4e2d\u65e0\u6570\u636e\u53ef\u7528 7.Redis\u670d\u52a1\u5668\u8d44\u6e90\u88ab\u4e25\u91cd\u5360\u7528\uff0cRedis\u670d\u52a1\u5668\u5d29\u6e83 8.Redis\u96c6\u7fa4\u5448\u73b0\u5d29\u584c\uff0c\u96c6\u7fa4\u74e6\u89e3 9.\u5e94\u7528\u670d\u52a1\u5668\u65e0\u6cd5\u53ca\u65f6\u5f97\u5230\u6570\u636e\u54cd\u5e94\u8bf7\u6c42\uff0c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6570\u91cf\u8d8a\u6765\u8d8a\u591a\uff0c\u5e94\u7528\u670d\u52a1\u5668\u5d29\u6e83 10.\u5e94\u7528\u670d\u52a1\u5668\uff0credis\uff0c\u6570\u636e\u5e93\u5168\u90e8\u91cd\u542f\uff0c\u6548\u679c\u4e0d\u7406\u60f3 \u603b\u800c\u8a00\u4e4b\u5c31\u4e24\u70b9\uff1a\u77ed\u65f6\u95f4\u8303\u56f4\u5185\uff0c\u5927\u91cfkey\u96c6\u4e2d\u8fc7\u671f \u89e3\u51b3\u65b9\u6848 \u601d\u8def\uff1a 1.\u66f4\u591a\u7684\u9875\u9762\u9759\u6001\u5316\u5904\u7406 2.\u6784\u5efa\u591a\u7ea7\u7f13\u5b58\u67b6\u6784 Nginx\u7f13\u5b58+redis\u7f13\u5b58+ehcache\u7f13\u5b58 3.\u68c0\u6d4bMysql\u4e25\u91cd\u8017\u65f6\u4e1a\u52a1\u8fdb\u884c\u4f18\u5316 \u5bf9\u6570\u636e\u5e93\u7684\u74f6\u9888\u6392\u67e5\uff1a\u4f8b\u5982\u8d85\u65f6\u67e5\u8be2\u3001\u8017\u65f6\u8f83\u9ad8\u4e8b\u52a1\u7b49 4.\u707e\u96be\u9884\u8b66\u673a\u5236 \u76d1\u63a7redis\u670d\u52a1\u5668\u6027\u80fd\u6307\u6807 CPU\u5360\u7528\u3001CPU\u4f7f\u7528\u7387 \u5185\u5b58\u5bb9\u91cf \u67e5\u8be2\u5e73\u5747\u54cd\u5e94\u65f6\u95f4 \u7ebf\u7a0b\u6570 5.\u9650\u6d41\u3001\u964d\u7ea7 \u77ed\u65f6\u95f4\u8303\u56f4\u5185\u727a\u7272\u4e00\u4e9b\u5ba2\u6237\u4f53\u9a8c\uff0c\u9650\u5236\u4e00\u90e8\u5206\u8bf7\u6c42\u8bbf\u95ee\uff0c\u964d\u4f4e\u5e94\u7528\u670d\u52a1\u5668\u538b\u529b\uff0c\u5f85\u4e1a\u52a1\u4f4e\u901f\u8fd0\u8f6c\u540e\u518d\u9010\u6b65\u653e\u5f00\u8bbf\u95ee \u843d\u5730\u5b9e\u8df5\uff1a 1.LRU\u4e0eLFU\u5207\u6362 2.\u6570\u636e\u6709\u6548\u671f\u7b56\u7565\u8c03\u6574 \u6839\u636e\u4e1a\u52a1\u6570\u636e\u6709\u6548\u671f\u8fdb\u884c\u5206\u7c7b\u9519\u5cf0\uff0cA\u7c7b90\u5206\u949f\uff0cB\u7c7b80\u5206\u949f\uff0cC\u7c7b70\u5206\u949f \u8fc7\u671f\u65f6\u95f4\u4f7f\u7528\u56fa\u5b9a\u65f6\u95f4+\u968f\u673a\u503c\u7684\u5f62\u5f0f\uff0c\u7a00\u91ca\u96c6\u4e2d\u5230\u671f\u7684key\u7684\u6570\u91cf 3.\u8d85\u70ed\u6570\u636e\u4f7f\u7528\u6c38\u4e45key 4.\u5b9a\u671f\u7ef4\u62a4\uff08\u81ea\u52a8+\u4eba\u5de5\uff09 \u5bf9\u5373\u5c06\u8fc7\u671f\u6570\u636e\u505a\u8bbf\u95ee\u91cf\u5206\u6790\uff0c\u786e\u8ba4\u662f\u5426\u5ef6\u65f6\uff0c\u914d\u5408\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff0c\u505a\u70ed\u70b9\u6570\u636e\u7684\u5ef6\u65f6 5.\u52a0\u9501\uff1a\u614e\u7528\uff01 \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u96ea\u5d29\u5c31\u662f\u77ac\u95f4\u8fc7\u671f\u6570\u636e\u91cf\u592a\u5927\uff0c\u5bfc\u81f4\u5bf9\u6570\u636e\u5e93\u670d\u52a1\u5668\u9020\u6210\u538b\u529b\u3002\u5982\u80fd\u591f\u6709\u6548\u907f\u514d\u8fc7\u671f\u65f6\u95f4\u96c6\u4e2d\uff0c\u53ef\u4ee5\u6709\u6548\u89e3\u51b3\u96ea\u5d29\u73b0\u8c61\u7684 \u51fa\u73b0\uff08\u7ea640%\uff09\uff0c\u914d\u5408\u5176\u4ed6\u7b56\u7565\u4e00\u8d77\u4f7f\u7528\uff0c\u5e76\u76d1\u63a7\u670d\u52a1\u5668\u7684\u8fd0\u884c\u6570\u636e\uff0c\u6839\u636e\u8fd0\u884c\u8bb0\u5f55\u505a\u5feb\u901f\u8c03\u6574\u3002 5.3 \u7f13\u5b58\u51fb\u7a7f \u00b6 \u573a\u666f \uff1a\u8fd8\u662f\u6570\u636e\u5e93\u670d\u52a1\u5668\u5d29\u6e83\uff0c\u4f46\u662f\u8ddf\u4e4b\u524d\u7684\u573a\u666f\u6709\u70b9\u4e0d\u592a\u4e00\u6837 1.\u7cfb\u7edf\u5e73\u7a33\u8fd0\u884c\u8fc7\u7a0b\u4e2d 2.\u6570\u636e\u5e93\u8fde\u63a5\u91cf\u77ac\u95f4\u6fc0\u589e 3.Redis\u670d\u52a1\u5668\u65e0\u5927\u91cfkey\u8fc7\u671f 4.Redis\u5185\u5b58\u5e73\u7a33\uff0c\u65e0\u6ce2\u52a8 5.Redis\u670d\u52a1\u5668CPU\u6b63\u5e38 6.\u6570\u636e\u5e93\u5d29\u6e83 \u95ee\u9898\u6392\u67e5\uff1a 1.Redis\u4e2d\u67d0\u4e2akey\u8fc7\u671f\uff0c\u8be5key\u8bbf\u95ee\u91cf\u5de8\u5927 2.\u591a\u4e2a\u6570\u636e\u8bf7\u6c42\u4ece\u670d\u52a1\u5668\u76f4\u63a5\u538b\u5230Redis\u540e\uff0c\u5747\u672a\u547d\u4e2d 3.Redis\u5728\u77ed\u65f6\u95f4\u5185\u53d1\u8d77\u4e86\u5927\u91cf\u5bf9\u6570\u636e\u5e93\u4e2d\u540c\u4e00\u6570\u636e\u7684\u8bbf\u95ee \u603b\u800c\u8a00\u4e4b\u5c31\u4e24\u70b9\uff1a\u5355\u4e2akey\u9ad8\u70ed\u6570\u636e\uff0ckey\u8fc7\u671f \u89e3\u51b3\u65b9\u6848 \uff1a 1.\u9884\u5148\u8bbe\u5b9a \u4ee5\u7535\u5546\u4e3a\u4f8b\uff0c\u6bcf\u4e2a\u5546\u5bb6\u6839\u636e\u5e97\u94fa\u7b49\u7ea7\uff0c\u6307\u5b9a\u82e5\u5e72\u6b3e\u4e3b\u6253\u5546\u54c1\uff0c\u5728\u8d2d\u7269\u8282\u671f\u95f4\uff0c\u52a0\u5927\u6b64\u7c7b\u4fe1\u606fkey\u7684\u8fc7\u671f\u65f6\u957f \u6ce8\u610f\uff1a\u8d2d\u7269\u8282\u4e0d\u4ec5\u4ec5\u6307\u5f53\u5929\uff0c\u4ee5\u53ca\u540e\u7eed\u82e5\u5e72\u5929\uff0c\u8bbf\u95ee\u5cf0\u503c\u5448\u73b0\u9010\u6e10\u964d\u4f4e\u7684\u8d8b\u52bf 2.\u73b0\u573a\u8c03\u6574 \u76d1\u63a7\u8bbf\u95ee\u91cf\uff0c\u5bf9\u81ea\u7136\u6d41\u91cf\u6fc0\u589e\u7684\u6570\u636e\u5ef6\u957f\u8fc7\u671f\u65f6\u95f4\u6216\u8bbe\u7f6e\u4e3a\u6c38\u4e45\u6027key 3.\u540e\u53f0\u5237\u65b0\u6570\u636e \u542f\u52a8\u5b9a\u65f6\u4efb\u52a1\uff0c\u9ad8\u5cf0\u671f\u6765\u4e34\u4e4b\u524d\uff0c\u5237\u65b0\u6570\u636e\u6709\u6548\u671f\uff0c\u786e\u4fdd\u4e0d\u4e22\u5931 4.\u4e8c\u7ea7\u7f13\u5b58 \u8bbe\u7f6e\u4e0d\u540c\u7684\u5931\u6548\u65f6\u95f4\uff0c\u4fdd\u969c\u4e0d\u4f1a\u88ab\u540c\u65f6\u6dd8\u6c70\u5c31\u884c 5.\u52a0\u9501 \u5206\u5e03\u5f0f\u9501\uff0c\u9632\u6b62\u88ab\u51fb\u7a7f\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u4e5f\u662f\u6027\u80fd\u74f6\u9888\uff0c\u614e\u91cd\uff01 \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u51fb\u7a7f\u5c31\u662f\u5355\u4e2a\u9ad8\u70ed\u6570\u636e\u8fc7\u671f\u7684\u77ac\u95f4\uff0c\u6570\u636e\u8bbf\u95ee\u91cf\u8f83\u5927\uff0c\u672a\u547d\u4e2dredis\u540e\uff0c\u53d1\u8d77\u4e86\u5927\u91cf\u5bf9\u540c\u4e00\u6570\u636e\u7684\u6570\u636e\u5e93\u8bbf\u95ee\uff0c\u5bfc\u81f4\u5bf9\u6570 \u636e\u5e93\u670d\u52a1\u5668\u9020\u6210\u538b\u529b\u3002\u5e94\u5bf9\u7b56\u7565\u5e94\u8be5\u5728\u4e1a\u52a1\u6570\u636e\u5206\u6790\u4e0e\u9884\u9632\u65b9\u9762\u8fdb\u884c\uff0c\u914d\u5408\u8fd0\u884c\u76d1\u63a7\u6d4b\u8bd5\u4e0e\u5373\u65f6\u8c03\u6574\u7b56\u7565\uff0c\u6bd5\u7adf\u5355\u4e2akey\u7684\u8fc7 \u671f\u76d1\u63a7\u96be\u5ea6\u8f83\u9ad8\uff0c\u914d\u5408\u96ea\u5d29\u5904\u7406\u7b56\u7565\u5373\u53ef\u3002 5.4 \u7f13\u5b58\u7a7f\u900f \u00b6 \u573a\u666f \uff1a\u6570\u636e\u5e93\u670d\u52a1\u5668\u53c8\u5d29\u6e83\u4e86\uff0c\u8ddf\u4e4b\u524d\u7684\u4e00\u6837\u5417\uff1f 1.\u7cfb\u7edf\u5e73\u7a33\u8fd0\u884c\u8fc7\u7a0b\u4e2d 2.\u5e94\u7528\u670d\u52a1\u5668\u6d41\u91cf\u968f\u65f6\u95f4\u589e\u91cf\u8f83\u5927 3.Redis\u670d\u52a1\u5668\u547d\u4e2d\u7387\u968f\u65f6\u95f4\u9010\u6b65\u964d\u4f4e 4.Redis\u5185\u5b58\u5e73\u7a33\uff0c\u5185\u5b58\u65e0\u538b\u529b 5.Redis\u670d\u52a1\u5668CPU\u5360\u7528\u6fc0\u589e 6.\u6570\u636e\u5e93\u670d\u52a1\u5668\u538b\u529b\u6fc0\u589e 7.\u6570\u636e\u5e93\u5d29\u6e83 \u95ee\u9898\u6392\u67e5\uff1a 1.Redis\u4e2d\u5927\u9762\u79ef\u51fa\u73b0\u672a\u547d\u4e2d 2.\u51fa\u73b0\u975e\u6b63\u5e38URL\u8bbf\u95ee \u95ee\u9898\u5206\u6790 \uff1a \u83b7\u53d6\u7684\u6570\u636e\u5728\u6570\u636e\u5e93\u4e2d\u4e5f\u4e0d\u5b58\u5728\uff0c\u6570\u636e\u5e93\u67e5\u8be2\u672a\u5f97\u5230\u5bf9\u5e94\u6570\u636e Redis\u83b7\u53d6\u5230null\u6570\u636e\u672a\u8fdb\u884c\u6301\u4e45\u5316\uff0c\u76f4\u63a5\u8fd4\u56de \u4e0b\u6b21\u6b64\u7c7b\u6570\u636e\u5230\u8fbe\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b \u51fa\u73b0\u9ed1\u5ba2\u653b\u51fb\u670d\u52a1\u5668 \u89e3\u51b3\u65b9\u6848 \uff1a 1.\u7f13\u5b58null \u5bf9\u67e5\u8be2\u7ed3\u679c\u4e3anull\u7684\u6570\u636e\u8fdb\u884c\u7f13\u5b58\uff08\u957f\u671f\u4f7f\u7528\uff0c\u5b9a\u671f\u6e05\u7406\uff09\uff0c\u8bbe\u5b9a\u77ed\u65f6\u9650\uff0c\u4f8b\u598230-60\u79d2\uff0c\u6700\u9ad85\u5206\u949f 2.\u767d\u540d\u5355\u7b56\u7565 \u63d0\u524d\u9884\u70ed\u5404\u79cd\u5206\u7c7b\u6570\u636eid\u5bf9\u5e94\u7684bitmaps\uff0cid\u4f5c\u4e3abitmaps\u7684offset\uff0c\u76f8\u5f53\u4e8e\u8bbe\u7f6e\u4e86\u6570\u636e\u767d\u540d\u5355\u3002\u5f53\u52a0\u8f7d\u6b63\u5e38\u6570\u636e\u65f6\u653e\u884c\uff0c\u52a0\u8f7d\u5f02\u5e38\u6570\u636e\u65f6\u76f4\u63a5\u62e6\u622a\uff08\u6548\u7387\u504f\u4f4e\uff09 \u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff08\u6709\u5173\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u547d\u4e2d\u95ee\u9898\u5bf9\u5f53\u524d\u72b6\u51b5\u53ef\u4ee5\u5ffd\u7565\uff09 2.\u5b9e\u65bd\u76d1\u63a7 \u5b9e\u65f6\u76d1\u63a7redis\u547d\u4e2d\u7387\uff08\u4e1a\u52a1\u6b63\u5e38\u8303\u56f4\u65f6\uff0c\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u6ce2\u52a8\u503c\uff09\u4e0enull\u6570\u636e\u7684\u5360\u6bd4 \u975e\u6d3b\u52a8\u65f6\u6bb5\u6ce2\u52a8\uff1a\u901a\u5e38\u68c0\u6d4b3-5\u500d\uff0c\u8d85\u8fc75\u500d\u7eb3\u5165\u91cd\u70b9\u6392\u67e5\u5bf9\u8c61 \u6d3b\u52a8\u65f6\u6bb5\u6ce2\u52a8\uff1a\u901a\u5e38\u68c0\u6d4b10-50\u500d\uff0c\u8d85\u8fc750\u500d\u7eb3\u5165\u91cd\u70b9\u6392\u67e5\u5bf9\u8c61 \u6839\u636e\u500d\u6570\u4e0d\u540c\uff0c\u542f\u52a8\u4e0d\u540c\u7684\u6392\u67e5\u6d41\u7a0b\u3002\u7136\u540e\u4f7f\u7528\u9ed1\u540d\u5355\u8fdb\u884c\u9632\u63a7\uff08\u8fd0\u8425\uff09 4.key\u52a0\u5bc6 \u95ee\u9898\u51fa\u73b0\u540e\uff0c\u4e34\u65f6\u542f\u52a8\u9632\u707e\u4e1a\u52a1key\uff0c\u5bf9key\u8fdb\u884c\u4e1a\u52a1\u5c42\u4f20\u8f93\u52a0\u5bc6\u670d\u52a1\uff0c\u8bbe\u5b9a\u6821\u9a8c\u7a0b\u5e8f\uff0c\u8fc7\u6765\u7684key\u6821\u9a8c \u4f8b\u5982\u6bcf\u5929\u968f\u673a\u5206\u914d60\u4e2a\u52a0\u5bc6\u4e32\uff0c\u6311\u90092\u52303\u4e2a\uff0c\u6df7\u6dc6\u5230\u9875\u9762\u6570\u636eid\u4e2d\uff0c\u53d1\u73b0\u8bbf\u95eekey\u4e0d\u6ee1\u8db3\u89c4\u5219\uff0c\u9a73\u56de\u6570\u636e\u8bbf\u95ee \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u51fb\u7a7f\u662f\u6307\u8bbf\u95ee\u4e86\u4e0d\u5b58\u5728\u7684\u6570\u636e\uff0c\u8df3\u8fc7\u4e86\u5408\u6cd5\u6570\u636e\u7684redis\u6570\u636e\u7f13\u5b58\u9636\u6bb5\uff0c\u6bcf\u6b21\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u5bfc\u81f4\u5bf9\u6570\u636e\u5e93\u670d\u52a1\u5668\u9020\u6210\u538b\u529b\u3002\u901a\u5e38\u6b64\u7c7b\u6570\u636e\u7684\u51fa\u73b0\u91cf\u662f\u4e00\u4e2a\u8f83\u4f4e\u7684\u503c\uff0c\u5f53\u51fa\u73b0\u6b64\u7c7b\u60c5\u51b5\u4ee5\u6bd2\u653b\u6bd2\uff0c\u5e76\u53ca\u65f6\u62a5\u8b66\u3002\u5e94\u5bf9\u7b56\u7565\u5e94\u8be5\u5728\u4e34\u65f6\u9884\u6848\u9632\u8303\u65b9\u9762\u591a\u505a\u6587\u7ae0\u3002 \u65e0\u8bba\u662f\u9ed1\u540d\u5355\u8fd8\u662f\u767d\u540d\u5355\uff0c\u90fd\u662f\u5bf9\u6574\u4f53\u7cfb\u7edf\u7684\u538b\u529b\uff0c\u8b66\u62a5\u89e3\u9664\u540e\u5c3d\u5feb\u79fb\u9664\u3002 5.5 \u6027\u80fd\u6307\u6807\u76d1\u63a7 \u00b6 redis\u4e2d\u7684\u76d1\u63a7\u6307\u6807\u5982\u4e0b\uff1a \u6027\u80fd\u6307\u6807\uff1aPerformance \u54cd\u5e94\u8bf7\u6c42\u7684\u5e73\u5747\u65f6\u95f4: properties latency \u5e73\u5747\u6bcf\u79d2\u5904\u7406\u8bf7\u6c42\u603b\u6570 properties instantaneous_ops_per_sec \u7f13\u5b58\u67e5\u8be2\u547d\u4e2d\u7387\uff08\u901a\u8fc7\u67e5\u8be2\u603b\u6b21\u6570\u4e0e\u67e5\u8be2\u5f97\u5230\u975enil\u6570\u636e\u603b\u6b21\u6570\u8ba1\u7b97\u800c\u6765\uff09 ```properties hit_rate(calculated) ``` \u5185\u5b58\u6307\u6807\uff1aMemory \u5f53\u524d\u5185\u5b58\u4f7f\u7528\u91cf properties used_memory \u5185\u5b58\u788e\u7247\u7387\uff08\u5173\u7cfb\u5230\u662f\u5426\u8fdb\u884c\u788e\u7247\u6574\u7406\uff09 properties mem_fragmentation_ratio \u4e3a\u907f\u514d\u5185\u5b58\u6ea2\u51fa\u5220\u9664\u7684key\u7684\u603b\u6570\u91cf properties evicted_keys \u57fa\u4e8e\u963b\u585e\u64cd\u4f5c\uff08BLPOP\u7b49\uff09\u5f71\u54cd\u7684\u5ba2\u6237\u7aef\u6570\u91cf properties blocked_clients \u57fa\u672c\u6d3b\u52a8\u6307\u6807\uff1aBasic_activity \u5f53\u524d\u5ba2\u6237\u7aef\u8fde\u63a5\u603b\u6570 properties connected_clients \u5f53\u524d\u8fde\u63a5slave\u603b\u6570 properties connected_slaves \u6700\u540e\u4e00\u6b21\u4e3b\u4ece\u4fe1\u606f\u4ea4\u6362\u8ddd\u73b0\u5728\u7684\u79d2 properties master_last_io_seconds_ago key\u7684\u603b\u6570 properties keyspace \u6301\u4e45\u6027\u6307\u6807\uff1aPersistence \u5f53\u524d\u670d\u52a1\u5668\u6700\u540e\u4e00\u6b21RDB\u6301\u4e45\u5316\u7684\u65f6\u95f4 properties rdb_last_save_time \u5f53\u524d\u670d\u52a1\u5668\u6700\u540e\u4e00\u6b21RDB\u6301\u4e45\u5316\u540e\u6570\u636e\u53d8\u5316\u603b\u91cf properties rdb_changes_since_last_save \u9519\u8bef\u6307\u6807\uff1aError \u88ab\u62d2\u7edd\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u603b\u6570\uff08\u57fa\u4e8e\u8fbe\u5230\u6700\u5927\u8fde\u63a5\u503c\u7684\u56e0\u7d20\uff09 properties rejected_connections key\u672a\u547d\u4e2d\u7684\u603b\u6b21\u6570 properties keyspace_misses \u4e3b\u4ece\u65ad\u5f00\u7684\u79d2\u6570 properties master_link_down_since_seconds \u8981\u5bf9redis\u7684\u76f8\u5173\u6307\u6807\u8fdb\u884c\u76d1\u63a7\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4e00\u4e9b\u7528\u5177\uff1a CloudInsight Redis Prometheus Redis-stat Redis-faina RedisLive zabbix \u4e5f\u6709\u4e00\u4e9b\u547d\u4ee4\u5de5\u5177\uff1a benchmark \u6d4b\u8bd5\u5f53\u524d\u670d\u52a1\u5668\u7684\u5e76\u53d1\u6027\u80fd properties redis-benchmark [-h ] [-p ] [-c ] [-n <requests]> [-k ] \u8303\u4f8b1\uff1a50\u4e2a\u8fde\u63a5\uff0c10000\u6b21\u8bf7\u6c42\u5bf9\u5e94\u7684\u6027\u80fd properties redis-benchmark \u8303\u4f8b2\uff1a100\u4e2a\u8fde\u63a5\uff0c5000\u6b21\u8bf7\u6c42\u5bf9\u5e94\u7684\u6027\u80fd properties redis-benchmark -c 100 -n 5000 redis-cli monitor\uff1a\u542f\u52a8\u670d\u52a1\u5668\u8c03\u8bd5\u4fe1\u606f properties monitor slowlog\uff1a\u6162\u65e5\u5fd7 \u83b7\u53d6\u6162\u67e5\u8be2\u65e5\u5fd7 properties slowlog [operator] get \uff1a\u83b7\u53d6\u6162\u67e5\u8be2\u65e5\u5fd7\u4fe1\u606f len \uff1a\u83b7\u53d6\u6162\u67e5\u8be2\u65e5\u5fd7\u6761\u76ee\u6570 reset \uff1a\u91cd\u7f6e\u6162\u67e5\u8be2\u65e5\u5fd7 \u76f8\u5173\u914d\u7f6e properties slowlog-log-slower-than 1000 #\u8bbe\u7f6e\u6162\u67e5\u8be2\u7684\u65f6\u95f4\u4e0b\u7ebf\uff0c\u5355\u4f4d\uff1a\u5fae\u5999 slowlog-max-len 100 #\u8bbe\u7f6e\u6162\u67e5\u8be2\u547d\u4ee4\u5bf9\u5e94\u7684\u65e5\u5fd7\u663e\u793a\u957f\u5ea6\uff0c\u5355\u4f4d\uff1a\u547d\u4ee4\u6570","title":"day02"},{"location":"redis/day02/#_1","text":"\u76ee\u68071\uff1a\u80fd\u591f\u8bf4\u51faredis\u4e2d\u7684\u6570\u636e\u5220\u9664\u7b56\u4e0e\u7565\u6dd8\u6c70\u7b56\u7565 \u76ee\u68072\uff1a\u80fd\u591f\u8bf4\u51fa\u4e3b\u4ece\u590d\u5236\u7684\u6982\u5ff5\uff0c\u5de5\u4f5c\u6d41\u7a0b\u4ee5\u53ca\u573a\u666f\u95ee\u9898\u53ca\u89e3\u51b3\u65b9\u6848 \u76ee\u68073\uff1a\u80fd\u591f\u8bf4\u51fa\u54e8\u5175\u7684\u4f5c\u7528\u4ee5\u53ca\u5de5\u4f5c\u539f\u7406\uff0c\u4ee5\u53ca\u5982\u4f55\u542f\u7528\u54e8\u5175 \u76ee\u68074\uff1a\u80fd\u591f\u8bf4\u51fa\u96c6\u7fa4\u7684\u67b6\u6784\u8bbe\u8ba1\uff0c\u5b8c\u6210\u96c6\u7fa4\u7684\u642d\u5efa \u76ee\u68075\uff1a\u80fd\u591f\u8bf4\u51fa\u7f13\u5b58\u9884\u70ed\uff0c\u96ea\u5d29\uff0c\u51fb\u7a7f\uff0c\u7a7f\u900f\u7684\u6982\u5ff5\uff0c\u80fd\u8bf4\u51faredis\u7684\u76f8\u5173\u76d1\u63a7\u6307\u6807","title":"\u5b66\u4e60\u76ee\u6807"},{"location":"redis/day02/#1","text":"","title":"1.\u6570\u636e\u5220\u9664\u4e0e\u6dd8\u6c70\u7b56\u7565"},{"location":"redis/day02/#11","text":"","title":"1.1 \u8fc7\u671f\u6570\u636e"},{"location":"redis/day02/#111_redis","text":"Redis\u662f\u4e00\u79cd\u5185\u5b58\u7ea7\u6570\u636e\u5e93\uff0c\u6240\u6709\u6570\u636e\u5747\u5b58\u653e\u5728\u5185\u5b58\u4e2d\uff0c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u53ef\u4ee5\u901a\u8fc7TTL\u6307\u4ee4\u83b7\u53d6\u5176\u72b6\u6001 TTL\u8fd4\u56de\u7684\u503c\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\u6b63\u6570\uff0c-1\uff0c-2 \u6b63\u6570 \uff1a\u4ee3\u8868\u8be5\u6570\u636e\u5728\u5185\u5b58\u4e2d\u8fd8\u80fd\u5b58\u6d3b\u7684\u65f6\u95f4 -1 \uff1a\u6c38\u4e45\u6709\u6548\u7684\u6570\u636e 2 \uff1a\u5df2\u7ecf\u8fc7\u671f\u7684\u6570\u636e \u6216\u88ab\u5220\u9664\u7684\u6570\u636e \u6216 \u672a\u5b9a\u4e49\u7684\u6570\u636e \u5220\u9664\u7b56\u7565\u5c31\u662f\u9488\u5bf9\u5df2\u8fc7\u671f\u6570\u636e\u7684\u5904\u7406\u7b56\u7565 \uff0c\u5df2\u8fc7\u671f\u7684\u6570\u636e\u662f\u771f\u7684\u5c31\u7acb\u5373\u5220\u9664\u4e86\u5417\uff1f\u5176\u5b9e\u4e5f\u4e0d\u662f\uff0c\u6211\u4eec\u4f1a\u6709\u591a\u79cd\u5220\u9664\u7b56\u7565\uff0c\u662f\u5206\u60c5\u51b5\u7684\uff0c\u5728\u4e0d\u540c\u7684\u573a\u666f\u4e0b\u4f7f\u7528\u4e0d\u540c\u7684\u5220\u9664\u65b9\u5f0f\u4f1a\u6709\u4e0d\u540c\u6548\u679c\uff0c\u8fd9\u4e5f\u6b63\u662f\u6211\u4eec\u8981\u5c06\u7684\u6570\u636e\u7684\u5220\u9664\u7b56\u7565\u7684\u95ee\u9898","title":"1.1.1 Redis\u4e2d\u7684\u6570\u636e\u7279\u5f81"},{"location":"redis/day02/#112","text":"\u5728Redis\u4e2d\uff0c\u5982\u4f55\u7ed9\u6570\u636e\u8bbe\u7f6e\u5b83\u7684\u5931\u6548\u5468\u671f\u5462\uff1f\u6570\u636e\u7684\u65f6\u6548\u5728redis\u4e2d\u5982\u4f55\u5b58\u50a8\u5462\uff1f \u8fc7\u671f\u6570\u636e\u662f\u4e00\u5757\u72ec\u7acb\u7684\u5b58\u50a8\u7a7a\u95f4\uff0cHash\u7ed3\u6784\uff0cfield\u662f\u5185\u5b58\u5730\u5740\uff0cvalue\u662f\u8fc7\u671f\u65f6\u95f4\uff0c\u4fdd\u5b58\u4e86\u6240\u6709key\u7684\u8fc7\u671f\u63cf\u8ff0\uff0c\u5728\u6700\u7ec8\u8fdb\u884c\u8fc7\u671f\u5904\u7406\u7684\u65f6\u5019\uff0c\u5bf9\u8be5\u7a7a\u95f4\u7684\u6570\u636e\u8fdb\u884c\u68c0\u6d4b\uff0c \u5f53\u65f6\u95f4\u5230\u671f\u4e4b\u540e\u901a\u8fc7field\u627e\u5230\u5185\u5b58\u8be5\u5730\u5740\u5904\u7684\u6570\u636e\uff0c\u7136\u540e\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c\u3002","title":"1.1.2 \u65f6\u6548\u6027\u6570\u636e\u7684\u5b58\u50a8\u7ed3\u6784"},{"location":"redis/day02/#12","text":"","title":"1.2 \u6570\u636e\u5220\u9664\u7b56\u7565"},{"location":"redis/day02/#121","text":"\u5728\u5185\u5b58\u5360\u7528\u4e0eCPU\u5360\u7528\u4e4b\u95f4\u5bfb\u627e\u4e00\u79cd\u5e73\u8861\uff0c\u987e\u6b64\u5931\u5f7c\u90fd\u4f1a\u9020\u6210\u6574\u4f53redis\u6027\u80fd\u7684\u4e0b\u964d\uff0c\u751a\u81f3\u5f15\u53d1\u670d\u52a1\u5668\u5b95\u673a\u6216 \u5185\u5b58\u6cc4\u9732 \u9488\u5bf9\u8fc7\u671f\u6570\u636e\u8981\u8fdb\u884c\u5220\u9664\u7684\u65f6\u5019\u90fd\u6709\u54ea\u4e9b\u5220\u9664\u7b56\u7565\u5462\uff1f 1.\u5b9a\u65f6\u5220\u9664 2.\u60f0\u6027\u5220\u9664 3.\u5b9a\u671f\u5220\u9664","title":"1.2.1 \u6570\u636e\u5220\u9664\u7b56\u7565\u7684\u76ee\u6807"},{"location":"redis/day02/#122","text":"\u521b\u5efa\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5f53key\u8bbe\u7f6e\u6709\u8fc7\u671f\u65f6\u95f4\uff0c\u4e14\u8fc7\u671f\u65f6\u95f4\u5230\u8fbe\u65f6\uff0c\u7531\u5b9a\u65f6\u5668\u4efb\u52a1\u7acb\u5373\u6267\u884c\u5bf9\u952e\u7684\u5220\u9664\u64cd\u4f5c \u4f18\u70b9 \uff1a\u8282\u7ea6\u5185\u5b58\uff0c\u5230\u65f6\u5c31\u5220\u9664\uff0c\u5feb\u901f\u91ca\u653e\u6389\u4e0d\u5fc5\u8981\u7684\u5185\u5b58\u5360\u7528 \u7f3a\u70b9 \uff1aCPU\u538b\u529b\u5f88\u5927\uff0c\u65e0\u8bbaCPU\u6b64\u65f6\u8d1f\u8f7d\u91cf\u591a\u9ad8\uff0c\u5747\u5360\u7528CPU\uff0c\u4f1a\u5f71\u54cdredis\u670d\u52a1\u5668\u54cd\u5e94\u65f6\u95f4\u548c\u6307\u4ee4\u541e\u5410\u91cf \u603b\u7ed3 \uff1a\u7528\u5904\u7406\u5668\u6027\u80fd\u6362\u53d6\u5b58\u50a8\u7a7a\u95f4\uff08\u62ff\u65f6\u95f4\u6362\u7a7a\u95f4\uff09","title":"1.2.2 \u5b9a\u65f6\u5220\u9664"},{"location":"redis/day02/#123","text":"\u6570\u636e\u5230\u8fbe\u8fc7\u671f\u65f6\u95f4\uff0c\u4e0d\u505a\u5904\u7406\u3002\u7b49\u4e0b\u6b21\u8bbf\u95ee\u8be5\u6570\u636e\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5224\u65ad \u5982\u679c\u672a\u8fc7\u671f\uff0c\u8fd4\u56de\u6570\u636e \u53d1\u73b0\u5df2\u8fc7\u671f\uff0c\u5220\u9664\uff0c\u8fd4\u56de\u4e0d\u5b58\u5728 \u4f18\u70b9 \uff1a\u8282\u7ea6CPU\u6027\u80fd\uff0c\u53d1\u73b0\u5fc5\u987b\u5220\u9664\u7684\u65f6\u5019\u624d\u5220\u9664 \u7f3a\u70b9 \uff1a\u5185\u5b58\u538b\u529b\u5f88\u5927\uff0c\u51fa\u73b0\u957f\u671f\u5360\u7528\u5185\u5b58\u7684\u6570\u636e \u603b\u7ed3 \uff1a\u7528\u5b58\u50a8\u7a7a\u95f4\u6362\u53d6\u5904\u7406\u5668\u6027\u80fd\uff08\u62ff\u65f6\u95f4\u6362\u7a7a\u95f4\uff09","title":"1.2.3 \u60f0\u6027\u5220\u9664"},{"location":"redis/day02/#124","text":"\u5b9a\u65f6\u5220\u9664\u548c\u60f0\u6027\u5220\u9664\u8fd9\u4e24\u79cd\u65b9\u6848\u90fd\u662f\u8d70\u7684\u6781\u7aef\uff0c\u90a3\u6709\u6ca1\u6709\u6298\u4e2d\u65b9\u6848\uff1f \u6211\u4eec\u6765\u8bb2redis\u7684\u5b9a\u671f\u5220\u9664\u65b9\u6848\uff1a Redis\u542f\u52a8\u670d\u52a1\u5668\u521d\u59cb\u5316\u65f6\uff0c\u8bfb\u53d6\u914d\u7f6eserver.hz\u7684\u503c\uff0c\u9ed8\u8ba4\u4e3a10 \u6bcf\u79d2\u949f\u6267\u884cserver.hz\u6b21 serverCron() --------> databasesCron() ---------> activeExpireCycle() activeExpireCycle() \u5bf9\u6bcf\u4e2aexpires[*]\u9010\u4e00\u8fdb\u884c\u68c0\u6d4b\uff0c\u6bcf\u6b21\u6267\u884c\u8017\u65f6\uff1a250ms/server.hz \u5bf9\u67d0\u4e2aexpires[*]\u68c0\u6d4b\u65f6\uff0c\u968f\u673a\u6311\u9009W\u4e2akey\u68c0\u6d4b \u5982\u679ckey\u8d85\u65f6\uff0c\u5220\u9664key \u5982\u679c\u4e00\u8f6e\u4e2d\u5220\u9664\u7684key\u7684\u6570\u91cf>W*25%\uff0c\u5faa\u73af\u8be5\u8fc7\u7a0b \u5982\u679c\u4e00\u8f6e\u4e2d\u5220\u9664\u7684key\u7684\u6570\u91cf\u2264W*25%\uff0c\u68c0\u67e5\u4e0b\u4e00\u4e2aexpires[*]\uff0c0-15\u5faa\u73af W\u53d6\u503c=ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP\u5c5e\u6027\u503c \u53c2\u6570current_db\u7528\u4e8e\u8bb0\u5f55 activeExpireCycle() \u8fdb\u5165\u54ea\u4e2aexpires[*] \u6267\u884c \u5982\u679cactiveExpireCycle()\u6267\u884c\u65f6\u95f4\u5230\u671f\uff0c\u4e0b\u6b21\u4ececurrent_db\u7ee7\u7eed\u5411\u4e0b\u6267\u884c \u603b\u7684\u6765\u8bf4\uff1a\u5b9a\u671f\u5220\u9664\u5c31\u662f\u5468\u671f\u6027\u8f6e\u8be2redis\u5e93\u4e2d\u7684\u65f6\u6548\u6027\u6570\u636e\uff0c\u91c7\u7528\u968f\u673a\u62bd\u53d6\u7684\u7b56\u7565\uff0c\u5229\u7528\u8fc7\u671f\u6570\u636e\u5360\u6bd4\u7684\u65b9\u5f0f\u63a7\u5236\u5220\u9664\u9891\u5ea6 \u7279\u70b91 \uff1aCPU\u6027\u80fd\u5360\u7528\u8bbe\u7f6e\u6709\u5cf0\u503c\uff0c\u68c0\u6d4b\u9891\u5ea6\u53ef\u81ea\u5b9a\u4e49\u8bbe\u7f6e \u7279\u70b92 \uff1a\u5185\u5b58\u538b\u529b\u4e0d\u662f\u5f88\u5927\uff0c\u957f\u671f\u5360\u7528\u5185\u5b58\u7684\u51b7\u6570\u636e\u4f1a\u88ab\u6301\u7eed\u6e05\u7406 \u603b\u7ed3 \uff1a\u5468\u671f\u6027\u62bd\u67e5\u5b58\u50a8\u7a7a\u95f4\uff08\u968f\u673a\u62bd\u67e5\uff0c\u91cd\u70b9\u62bd\u67e5\uff09","title":"1.2.4 \u5b9a\u671f\u5220\u9664"},{"location":"redis/day02/#125","text":"1\uff1a\u5b9a\u65f6\u5220\u9664\uff1a \u8282\u7ea6\u5185\u5b58\uff0c\u65e0\u5360\u7528, \u4e0d\u5206\u65f6\u6bb5\u5360\u7528CPU\u8d44\u6e90\uff0c\u9891\u5ea6\u9ad8, \u62ff\u65f6\u95f4\u6362\u7a7a\u95f4 2\uff1a\u60f0\u6027\u5220\u9664\uff1a \u5185\u5b58\u5360\u7528\u4e25\u91cd \u5ef6\u65f6\u6267\u884c\uff0cCPU\u5229\u7528\u7387\u9ad8 \u62ff\u7a7a\u95f4\u6362\u65f6\u95f4 3\uff1a\u5b9a\u671f\u5220\u9664\uff1a \u5185\u5b58\u5b9a\u671f\u968f\u673a\u6e05\u7406 \u6bcf\u79d2\u82b1\u8d39\u56fa\u5b9a\u7684CPU\u8d44\u6e90\u7ef4\u62a4\u5185\u5b58 \u968f\u673a\u62bd\u67e5\uff0c\u91cd\u70b9\u62bd\u67e5","title":"1.2.5 \u5220\u9664\u7b56\u7565\u5bf9\u6bd4"},{"location":"redis/day02/#13","text":"","title":"1.3 \u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff08\u9010\u51fa\u7b97\u6cd5\uff09"},{"location":"redis/day02/#131","text":"\u4ec0\u4e48\u53eb\u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff1f\u4ec0\u4e48\u6837\u7684\u5e94\u7528\u573a\u666f\u9700\u8981\u7528\u5230\u6570\u636e\u6dd8\u6c70\u7b56\u7565\uff1f \u5f53\u65b0\u6570\u636e\u8fdb\u5165redis\u65f6\uff0c\u5982\u679c\u5185\u5b58\u4e0d\u8db3\u600e\u4e48\u529e\uff1f\u5728\u6267\u884c\u6bcf\u4e00\u4e2a\u547d\u4ee4\u524d\uff0c\u4f1a\u8c03\u7528 freeMemoryIfNeeded() \u68c0\u6d4b\u5185\u5b58\u662f\u5426\u5145\u8db3\u3002\u5982\u679c\u5185\u5b58\u4e0d\u6ee1\u8db3\u65b0 \u52a0\u5165\u6570\u636e\u7684\u6700\u4f4e\u5b58\u50a8\u8981\u6c42\uff0credis\u8981\u4e34\u65f6\u5220\u9664\u4e00\u4e9b\u6570\u636e\u4e3a\u5f53\u524d\u6307\u4ee4\u6e05\u7406\u5b58\u50a8\u7a7a\u95f4\u3002\u6e05\u7406\u6570\u636e\u7684\u7b56\u7565\u79f0\u4e3a\u9010\u51fa\u7b97\u6cd5\u3002 \u6ce8\u610f\uff1a\u9010\u51fa\u6570\u636e\u7684\u8fc7\u7a0b\u4e0d\u662f100%\u80fd\u591f\u6e05\u7406\u51fa\u8db3\u591f\u7684\u53ef\u4f7f\u7528\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5982\u679c\u4e0d\u6210\u529f\u5219\u53cd\u590d\u6267\u884c\u3002\u5f53\u5bf9\u6240\u6709\u6570\u636e\u5c1d\u8bd5\u5b8c\u6bd5\uff0c \u5982\u4e0d\u80fd\u8fbe\u5230\u5185\u5b58\u6e05\u7406\u7684\u8981\u6c42\uff0c\u5c06\u51fa\u73b0\u9519\u8bef\u4fe1\u606f\u5982\u4e0b ( error ) OOM command not allowed when used memory > 'maxmemory'","title":"1.3.1 \u6dd8\u6c70\u7b56\u7565\u6982\u8ff0"},{"location":"redis/day02/#132","text":"\u5f71\u54cd\u6570\u636e\u6dd8\u6c70\u7684\u76f8\u5173\u914d\u7f6e\u5982\u4e0b\uff1a 1\uff1a\u6700\u5927\u53ef\u4f7f\u7528\u5185\u5b58\uff0c\u5373\u5360\u7528\u7269\u7406\u5185\u5b58\u7684\u6bd4\u4f8b\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u8868\u793a\u4e0d\u9650\u5236\u3002\u751f\u4ea7\u73af\u5883\u4e2d\u6839\u636e\u9700\u6c42\u8bbe\u5b9a\uff0c\u901a\u5e38\u8bbe\u7f6e\u572850%\u4ee5\u4e0a maxmemory ?mb 2\uff1a\u6bcf\u6b21\u9009\u53d6\u5f85\u5220\u9664\u6570\u636e\u7684\u4e2a\u6570\uff0c\u91c7\u7528\u968f\u673a\u83b7\u53d6\u6570\u636e\u7684\u65b9\u5f0f\u4f5c\u4e3a\u5f85\u68c0\u6d4b\u5220\u9664\u6570\u636e maxmemory-samples count 3\uff1a\u5bf9\u6570\u636e\u8fdb\u884c\u5220\u9664\u7684\u9009\u62e9\u7b56\u7565 maxmemory-policy policy \u90a3\u6570\u636e\u5220\u9664\u7684\u7b56\u7565policy\u5230\u5e95\u6709\u51e0\u79cd\u5462\uff1f\u4e00\u5171\u662f 3\u7c7b8\u79cd \u7b2c\u4e00\u7c7b \uff1a\u68c0\u6d4b\u6613\u5931\u6570\u636e\uff08\u53ef\u80fd\u4f1a\u8fc7\u671f\u7684\u6570\u636e\u96c6server.db[i].expires \uff09 volatile-lru\uff1a\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70 volatile-lfu\uff1a\u6311\u9009\u6700\u8fd1\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\u6dd8\u6c70 volatile-ttl\uff1a\u6311\u9009\u5c06\u8981\u8fc7\u671f\u7684\u6570\u636e\u6dd8\u6c70 volatile-random\uff1a\u4efb\u610f\u9009\u62e9\u6570\u636e\u6dd8\u6c70 \u7b2c\u4e8c\u7c7b \uff1a\u68c0\u6d4b\u5168\u5e93\u6570\u636e\uff08\u6240\u6709\u6570\u636e\u96c6server.db[i].dict \uff09 allkeys-lru\uff1a\u6311\u9009\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\u6570\u636e\u6dd8\u6c70 allkeLyRs-lfu\uff1a\uff1a\u6311\u9009\u6700\u8fd1\u4f7f\u7528\u6b21\u6570\u6700\u5c11\u7684\u6570\u636e\u6dd8\u6c70 allkeys-random\uff1a\u4efb\u610f\u9009\u62e9\u6570\u636e\u6dd8\u6c70\uff0c\u76f8\u5f53\u4e8e\u968f\u673a \u7b2c\u4e09\u7c7b \uff1a\u653e\u5f03\u6570\u636e\u9a71\u9010 no-enviction\uff08\u9a71\u9010\uff09\uff1a\u7981\u6b62\u9a71\u9010\u6570\u636e(redis4.0\u4e2d\u9ed8\u8ba4\u7b56\u7565)\uff0c\u4f1a\u5f15\u53d1OOM(Out Of Memory) \u6ce8\u610f\uff1a\u8fd9\u4e9b\u7b56\u7565\u662f\u914d\u7f6e\u5230\u54ea\u4e2a\u5c5e\u6027\u4e0a\uff1f\u600e\u4e48\u914d\u7f6e\uff1f\u5982\u4e0b\u6240\u793a maxmemory-policy volatile-lru \u6570\u636e\u6dd8\u6c70\u7b56\u7565\u914d\u7f6e\u4f9d\u636e \u4f7f\u7528INFO\u547d\u4ee4\u8f93\u51fa\u76d1\u63a7\u4fe1\u606f\uff0c\u67e5\u8be2\u7f13\u5b58 hit \u548c miss \u7684\u6b21\u6570\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u8c03\u4f18Redis\u914d\u7f6e","title":"1.3.2 \u7b56\u7565\u914d\u7f6e"},{"location":"redis/day02/#2","text":"","title":"2.\u4e3b\u4ece\u590d\u5236"},{"location":"redis/day02/#21","text":"","title":"2.1 \u4e3b\u4ece\u590d\u5236\u7b80\u4ecb"},{"location":"redis/day02/#211","text":"\u9996\u5148\u6211\u4eec\u8981\u7406\u89e3\u4e92\u8054\u7f51\u5e94\u7528\u56e0\u4e3a\u5176\u72ec\u6709\u7684\u7279\u6027\u6211\u4eec\u6f14\u5316\u51fa\u7684 \u4e09\u9ad8 \u67b6\u6784 \u9ad8\u5e76\u53d1 \u5e94\u7528\u8981\u63d0\u4f9b\u67d0\u4e00\u4e1a\u52a1\u8981\u80fd\u652f\u6301\u5f88\u591a\u5ba2\u6237\u7aef\u540c\u65f6\u8bbf\u95ee\u7684\u80fd\u529b\uff0c\u6211\u4eec\u79f0\u4e3a\u5e76\u53d1\uff0c\u9ad8\u5e76\u53d1\u610f\u601d\u5c31\u5f88\u660e\u786e\u4e86 \u9ad8\u6027\u80fd \u6027\u80fd\u5e26\u7ed9\u6211\u4eec\u6700\u76f4\u89c2\u7684\u611f\u53d7\u5c31\u662f\uff1a\u901f\u5ea6\u5feb\uff0c\u65f6\u95f4\u77ed \u9ad8\u53ef\u7528 \u53ef\u7528\u6027 \uff1a\u4e00\u5e74\u4e2d\u5e94\u7528\u670d\u52a1\u6b63\u5e38\u8fd0\u884c\u7684\u65f6\u95f4\u5360\u5168\u5e74\u65f6\u95f4\u7684\u767e\u5206\u6bd4\uff0c\u5982\u4e0b\u56fe\uff1a\u8868\u793a\u4e86\u5e94\u7528\u670d\u52a1\u5728\u5168\u5e74\u5b95\u673a\u7684\u65f6\u95f4 \u6211\u4eec\u628a\u8fd9\u4e9b\u65f6\u95f4\u52a0\u5728\u4e00\u8d77\u5c31\u662f\u5168\u5e74\u5e94\u7528\u670d\u52a1\u4e0d\u53ef\u7528\u7684\u65f6\u95f4\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5e94\u7528\u670d\u52a1\u5168\u5e74\u53ef\u7528\u7684\u65f6\u95f4 4\u5c0f\u65f627\u520615\u79d2+11\u520636\u79d2+2\u520616\u79d2=4\u5c0f\u65f641\u52067\u79d2=16867\u79d2 1\u5e74=365 24 60*60=31536000\u79d2 \u53ef\u7528\u6027=\uff0831536000-16867\uff09/31536000*100%=99.9465151% \u4e1a\u754c\u53ef\u7528\u6027\u76ee\u6807 5\u4e2a9\uff0c\u537399.999% \uff0c\u5373\u670d\u52a1\u5668\u5e74\u5b95\u673a\u65f6\u957f\u4f4e\u4e8e315\u79d2\uff0c\u7ea65.25\u5206\u949f","title":"2.1.1 \u9ad8\u53ef\u7528"},{"location":"redis/day02/#212","text":"\u77e5\u9053\u4e86\u4e09\u9ad8\u7684\u6982\u5ff5\u4e4b\u540e\uff0c\u6211\u4eec\u60f3\uff1a\u4f60\u7684\u201cRedis\u201d\u662f\u5426\u9ad8\u53ef\u7528\uff1f\u90a3\u6211\u4eec\u8981\u6765\u5206\u6790\u5355\u673aredis\u7684\u98ce\u9669\u4e0e\u95ee\u9898 \u95ee\u98981.\u673a\u5668\u6545\u969c \u73b0\u8c61\uff1a\u786c\u76d8\u6545\u969c\u3001\u7cfb\u7edf\u5d29\u6e83 \u672c\u8d28\uff1a\u6570\u636e\u4e22\u5931\uff0c\u5f88\u53ef\u80fd\u5bf9\u4e1a\u52a1\u9020\u6210\u707e\u96be\u6027\u6253\u51fb \u7ed3\u8bba\uff1a\u57fa\u672c\u4e0a\u4f1a\u653e\u5f03\u4f7f\u7528redis. \u95ee\u98982.\u5bb9\u91cf\u74f6\u9888 \u73b0\u8c61\uff1a\u5185\u5b58\u4e0d\u8db3\uff0c\u4ece16G\u5347\u7ea7\u523064G\uff0c\u4ece64G\u5347\u7ea7\u5230128G\uff0c\u65e0\u9650\u5347\u7ea7\u5185\u5b58 \u672c\u8d28\uff1a\u7a77\uff0c\u786c\u4ef6\u6761\u4ef6\u8ddf\u4e0d\u4e0a \u7ed3\u8bba\uff1a\u653e\u5f03\u4f7f\u7528redis \u7ed3\u8bba\uff1a \u4e3a\u4e86\u907f\u514d\u5355\u70b9Redis\u670d\u52a1\u5668\u6545\u969c\uff0c\u51c6\u5907\u591a\u53f0\u670d\u52a1\u5668\uff0c\u4e92\u76f8\u8fde\u901a\u3002\u5c06\u6570\u636e\u590d\u5236\u591a\u4e2a\u526f\u672c\u4fdd\u5b58\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5e76\u4fdd\u8bc1\u6570\u636e\u662f\u540c\u6b65\u7684\u3002\u5373\u4f7f\u6709\u5176\u4e2d\u4e00\u53f0\u670d\u52a1\u5668\u5b95\u673a\uff0c\u5176\u4ed6\u670d\u52a1\u5668\u4f9d\u7136\u53ef\u4ee5\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\uff0c\u5b9e\u73b0Redis\u7684\u9ad8\u53ef\u7528\uff0c\u540c\u65f6\u5b9e\u73b0\u6570\u636e\u5197\u4f59\u5907\u4efd\u3002 \u591a\u53f0\u670d\u52a1\u5668\u8fde\u63a5\u65b9\u6848\uff1a \u63d0\u4f9b\u6570\u636e\u65b9\uff1a master \u4e3b\u670d\u52a1\u5668\uff0c\u4e3b\u8282\u70b9\uff0c\u4e3b\u5e93\u4e3b\u5ba2\u6237\u7aef \u63a5\u6536\u6570\u636e\u65b9\uff1a slave \u4ece\u670d\u52a1\u5668\uff0c\u4ece\u8282\u70b9\uff0c\u4ece\u5e93 \u4ece\u5ba2\u6237\u7aef \u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff1a \u6570\u636e\u540c\u6b65\uff08master\u7684\u6570\u636e\u590d\u5236\u5230slave\u4e2d\uff09 \u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6765\u89e3\u91ca\u4e3b\u4ece\u590d\u5236\u7684\u6982\u5ff5\uff1a \u6982\u5ff5\uff1a\u4e3b\u4ece\u590d\u5236\u5373\u5c06master\u4e2d\u7684\u6570\u636e\u5373\u65f6\u3001\u6709\u6548\u7684\u590d\u5236\u5230slave\u4e2d \u7279\u5f81 \uff1a\u4e00\u4e2amaster\u53ef\u4ee5\u62e5\u6709\u591a\u4e2aslave\uff0c\u4e00\u4e2aslave\u53ea\u5bf9\u5e94\u4e00\u4e2amaster \u804c\u8d23 \uff1amaster\u548cslave\u5404\u81ea\u7684\u804c\u8d23\u4e0d\u4e00\u6837 master: \u5199\u6570\u636e \u6267\u884c\u5199\u64cd\u4f5c\u65f6\uff0c\u5c06\u51fa\u73b0\u53d8\u5316\u7684\u6570\u636e\u81ea\u52a8\u540c\u6b65\u5230slave \u8bfb\u6570\u636e\uff08\u53ef\u5ffd\u7565\uff09 slave: \u8bfb\u6570\u636e \u5199\u6570\u636e\uff08\u7981\u6b62\uff09","title":"2.1.2 \u4e3b\u4ece\u590d\u5236\u6982\u5ff5"},{"location":"redis/day02/#213","text":"\u8bfb\u5199\u5206\u79bb\uff1amaster\u5199\u3001slave\u8bfb\uff0c\u63d0\u9ad8\u670d\u52a1\u5668\u7684\u8bfb\u5199\u8d1f\u8f7d\u80fd\u529b \u8d1f\u8f7d\u5747\u8861\uff1a\u57fa\u4e8e\u4e3b\u4ece\u7ed3\u6784\uff0c\u914d\u5408\u8bfb\u5199\u5206\u79bb\uff0c\u7531slave\u5206\u62c5master\u8d1f\u8f7d\uff0c\u5e76\u6839\u636e\u9700\u6c42\u7684\u53d8\u5316\uff0c\u6539\u53d8slave\u7684\u6570 \u91cf\uff0c\u901a\u8fc7\u591a\u4e2a\u4ece\u8282\u70b9\u5206\u62c5\u6570\u636e\u8bfb\u53d6\u8d1f\u8f7d\uff0c\u5927\u5927\u63d0\u9ad8Redis\u670d\u52a1\u5668\u5e76\u53d1\u91cf\u4e0e\u6570\u636e\u541e\u5410\u91cf \u6545\u969c\u6062\u590d\uff1a\u5f53master\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u7531slave\u63d0\u4f9b\u670d\u52a1\uff0c\u5b9e\u73b0\u5feb\u901f\u7684\u6545\u969c\u6062\u590d \u6570\u636e\u5197\u4f59\uff1a\u5b9e\u73b0\u6570\u636e\u70ed\u5907\u4efd\uff0c\u662f\u6301\u4e45\u5316\u4e4b\u5916\u7684\u4e00\u79cd\u6570\u636e\u5197\u4f59\u65b9\u5f0f \u9ad8\u53ef\u7528\u57fa\u77f3\uff1a\u57fa\u4e8e\u4e3b\u4ece\u590d\u5236\uff0c\u6784\u5efa\u54e8\u5175\u6a21\u5f0f\u4e0e\u96c6\u7fa4\uff0c\u5b9e\u73b0Redis\u7684\u9ad8\u53ef\u7528\u65b9\u6848","title":"2.1.3 \u4e3b\u4ece\u590d\u5236\u7684\u4f5c\u7528"},{"location":"redis/day02/#22","text":"\u4e3b\u4ece\u590d\u5236\u8fc7\u7a0b\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a3\u4e2a\u9636\u6bb5 \u5efa\u7acb\u8fde\u63a5\u9636\u6bb5\uff08\u5373\u51c6\u5907\u9636\u6bb5\uff09 \u6570\u636e\u540c\u6b65\u9636\u6bb5 \u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\uff08\u53cd\u590d\u540c\u6b65\uff09 \u800c\u547d\u4ee4\u7684\u4f20\u64ad\u5176\u5b9e\u67094\u79cd\uff0c\u5206\u522b\u5982\u4e0b\uff1a","title":"2.2 \u4e3b\u4ece\u590d\u5236\u5de5\u4f5c\u6d41\u7a0b"},{"location":"redis/day02/#221","text":"","title":"2.2.1 \u4e3b\u4ece\u590d\u5236\u7684\u5de5\u4f5c\u6d41\u7a0b\uff08\u4e09\u4e2a\u9636\u6bb5\uff09"},{"location":"redis/day02/#2211","text":"\u5efa\u7acbslave\u5230master\u7684\u8fde\u63a5\uff0c\u4f7fmaster\u80fd\u591f\u8bc6\u522bslave\uff0c\u5e76\u4fdd\u5b58slave\u7aef\u53e3\u53f7 \u6d41\u7a0b\u5982\u4e0b\uff1a \u6b65\u9aa41\uff1a\u8bbe\u7f6emaster\u7684\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4fdd\u5b58master\u4fe1\u606f \u6b65\u9aa42\uff1a\u5efa\u7acbsocket\u8fde\u63a5 \u6b65\u9aa43\uff1a\u53d1\u9001ping\u547d\u4ee4\uff08\u5b9a\u65f6\u5668\u4efb\u52a1\uff09 \u6b65\u9aa44\uff1a\u8eab\u4efd\u9a8c\u8bc1 \u6b65\u9aa45\uff1a\u53d1\u9001slave\u7aef\u53e3\u4fe1\u606f \u81f3\u6b64\uff0c\u4e3b\u4ece\u8fde\u63a5\u6210\u529f\uff01 \u5f53\u524d\u72b6\u6001\uff1a slave\uff1a\u4fdd\u5b58master\u7684\u5730\u5740\u4e0e\u7aef\u53e3 master\uff1a\u4fdd\u5b58slave\u7684\u7aef\u53e3 \u603b\u4f53\uff1a\u4e4b\u95f4\u521b\u5efa\u4e86\u8fde\u63a5\u7684socket master\u548cslave\u4e92\u8054 \u63a5\u4e0b\u6765\u5c31\u8981\u901a\u8fc7\u67d0\u79cd\u65b9\u5f0f\u5c06master\u548cslave\u8fde\u63a5\u5230\u4e00\u8d77 \u65b9\u5f0f\u4e00\uff1a\u5ba2\u6237\u7aef\u53d1\u9001\u547d\u4ee4 slaveof masterip masterport \u65b9\u5f0f\u4e8c\uff1a\u542f\u52a8\u670d\u52a1\u5668\u53c2\u6570 redis-server --slaveof masterip masterport \u65b9\u5f0f\u4e09\uff1a\u670d\u52a1\u5668\u914d\u7f6e\uff08 \u4e3b\u6d41\u65b9\u5f0f \uff09 slaveof masterip masterport slave\u7cfb\u7edf\u4fe1\u606f master_link_down_since_seconds masterhost & masterport master\u7cfb\u7edf\u4fe1\u606f uslave_listening_port(\u591a\u4e2a) \u4e3b\u4ece\u65ad\u5f00\u8fde\u63a5 \u65ad\u5f00slave\u4e0emaster\u7684\u8fde\u63a5\uff0cslave\u65ad\u5f00\u8fde\u63a5\u540e\uff0c\u4e0d\u4f1a\u5220\u9664\u5df2\u6709\u6570\u636e\uff0c\u53ea\u662f\u4e0d\u518d\u63a5\u53d7master\u53d1\u9001\u7684\u6570\u636e slaveof no one \u6388\u6743\u8bbf\u95ee master\u5ba2\u6237\u7aef\u53d1\u9001\u547d\u4ee4\u8bbe\u7f6e\u5bc6\u7801 requirepass password master\u914d\u7f6e\u6587\u4ef6\u8bbe\u7f6e\u5bc6\u7801 config set requirepass password config get requirepass slave\u5ba2\u6237\u7aef\u53d1\u9001\u547d\u4ee4\u8bbe\u7f6e\u5bc6\u7801 auth password slave\u914d\u7f6e\u6587\u4ef6\u8bbe\u7f6e\u5bc6\u7801 masterauth password slave\u542f\u52a8\u670d\u52a1\u5668\u8bbe\u7f6e\u5bc6\u7801 redis-server \u2013a password","title":"2.2.1.1 \u9636\u6bb5\u4e00\uff1a\u5efa\u7acb\u8fde\u63a5"},{"location":"redis/day02/#2212","text":"\u5728slave\u521d\u6b21\u8fde\u63a5master\u540e\uff0c\u590d\u5236master\u4e2d\u7684\u6240\u6709\u6570\u636e\u5230slave \u5c06slave\u7684\u6570\u636e\u5e93\u72b6\u6001\u66f4\u65b0\u6210master\u5f53\u524d\u7684\u6570\u636e\u5e93\u72b6\u6001 \u540c\u6b65\u8fc7\u7a0b\u5982\u4e0b\uff1a \u6b65\u9aa41\uff1a\u8bf7\u6c42\u540c\u6b65\u6570\u636e \u6b65\u9aa42\uff1a\u521b\u5efaRDB\u540c\u6b65\u6570\u636e \u6b65\u9aa43\uff1a\u6062\u590dRDB\u540c\u6b65\u6570\u636e \u6b65\u9aa44\uff1a\u8bf7\u6c42\u90e8\u5206\u540c\u6b65\u6570\u636e \u6b65\u9aa45\uff1a\u6062\u590d\u90e8\u5206\u540c\u6b65\u6570\u636e \u81f3\u6b64\uff0c\u6570\u636e\u540c\u6b65\u5de5\u4f5c\u5b8c\u6210\uff01 \u5f53\u524d\u72b6\u6001\uff1a slave\uff1a\u5177\u6709master\u7aef\u5168\u90e8\u6570\u636e\uff0c\u5305\u542bRDB\u8fc7\u7a0b\u63a5\u6536\u7684\u6570\u636e master\uff1a\u4fdd\u5b58slave\u5f53\u524d\u6570\u636e\u540c\u6b65\u7684\u4f4d\u7f6e \u603b\u4f53\uff1a\u4e4b\u95f4\u5b8c\u6210\u4e86\u6570\u636e\u514b\u9686 \u6570\u636e\u540c\u6b65\u9636\u6bb5master\u8bf4\u660e 1\uff1a\u5982\u679cmaster\u6570\u636e\u91cf\u5de8\u5927\uff0c\u6570\u636e\u540c\u6b65\u9636\u6bb5\u5e94\u907f\u5f00\u6d41\u91cf\u9ad8\u5cf0\u671f\uff0c\u907f\u514d\u9020\u6210master\u963b\u585e\uff0c\u5f71\u54cd\u4e1a\u52a1\u6b63\u5e38\u6267\u884c 2\uff1a\u590d\u5236\u7f13\u51b2\u533a\u5927\u5c0f\u8bbe\u5b9a\u4e0d\u5408\u7406\uff0c\u4f1a\u5bfc\u81f4\u6570\u636e\u6ea2\u51fa\u3002\u5982\u8fdb\u884c\u5168\u91cf\u590d\u5236\u5468\u671f\u592a\u957f\uff0c\u8fdb\u884c\u90e8\u5206\u590d\u5236\u65f6\u53d1\u73b0\u6570\u636e\u5df2\u7ecf\u5b58\u5728\u4e22\u5931\u7684\u60c5\u51b5\uff0c\u5fc5\u987b\u8fdb\u884c\u7b2c\u4e8c\u6b21\u5168\u91cf\u590d\u5236\uff0c\u81f4\u4f7fslave\u9677\u5165\u6b7b\u5faa\u73af\u72b6\u6001\u3002 repl-backlog-size ?mb master\u5355\u673a\u5185\u5b58\u5360\u7528\u4e3b\u673a\u5185\u5b58\u7684\u6bd4\u4f8b\u4e0d\u5e94\u8fc7\u5927\uff0c\u5efa\u8bae\u4f7f\u752850%-70%\u7684\u5185\u5b58\uff0c\u7559\u4e0b30%-50%\u7684\u5185\u5b58\u7528\u4e8e\u6267 \u884cbgsave\u547d\u4ee4\u548c\u521b\u5efa\u590d\u5236\u7f13\u51b2\u533a \u6570\u636e\u540c\u6b65\u9636\u6bb5slave\u8bf4\u660e \u4e3a\u907f\u514dslave\u8fdb\u884c\u5168\u91cf\u590d\u5236\u3001\u90e8\u5206\u590d\u5236\u65f6\u670d\u52a1\u5668\u54cd\u5e94\u963b\u585e\u6216\u6570\u636e\u4e0d\u540c\u6b65\uff0c\u5efa\u8bae\u5173\u95ed\u6b64\u671f\u95f4\u7684\u5bf9\u5916\u670d\u52a1 slave-serve-stale-data yes|no \u6570\u636e\u540c\u6b65\u9636\u6bb5\uff0cmaster\u53d1\u9001\u7ed9slave\u4fe1\u606f\u53ef\u4ee5\u7406\u89e3master\u662fslave\u7684\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u4e3b\u52a8\u5411slave\u53d1\u9001\u547d\u4ee4 \u591a\u4e2aslave\u540c\u65f6\u5bf9master\u8bf7\u6c42\u6570\u636e\u540c\u6b65\uff0cmaster\u53d1\u9001\u7684RDB\u6587\u4ef6\u589e\u591a\uff0c\u4f1a\u5bf9\u5e26\u5bbd\u9020\u6210\u5de8\u5927\u51b2\u51fb\uff0c\u5982\u679cmaster\u5e26\u5bbd\u4e0d\u8db3\uff0c\u56e0\u6b64\u6570\u636e\u540c\u6b65\u9700\u8981\u6839\u636e\u4e1a\u52a1\u9700\u6c42\uff0c\u9002\u91cf\u9519\u5cf0 slave\u8fc7\u591a\u65f6\uff0c\u5efa\u8bae\u8c03\u6574\u62d3\u6251\u7ed3\u6784\uff0c\u7531\u4e00\u4e3b\u591a\u4ece\u7ed3\u6784\u53d8\u4e3a\u6811\u72b6\u7ed3\u6784\uff0c\u4e2d\u95f4\u7684\u8282\u70b9\u65e2\u662fmaster\uff0c\u4e5f\u662f slave\u3002\u6ce8\u610f\u4f7f\u7528\u6811\u72b6\u7ed3\u6784\u65f6\uff0c\u7531\u4e8e\u5c42\u7ea7\u6df1\u5ea6\uff0c\u5bfc\u81f4\u6df1\u5ea6\u8d8a\u9ad8\u7684slave\u4e0e\u6700\u9876\u5c42master\u95f4\u6570\u636e\u540c\u6b65\u5ef6\u8fdf \u8f83\u5927\uff0c\u6570\u636e\u4e00\u81f4\u6027\u53d8\u5dee\uff0c\u5e94\u8c28\u614e\u9009\u62e9","title":"2.2.1.2 \u9636\u6bb5\u4e8c\uff1a\u6570\u636e\u540c\u6b65"},{"location":"redis/day02/#2213","text":"\u5f53master\u6570\u636e\u5e93\u72b6\u6001\u88ab\u4fee\u6539\u540e\uff0c\u5bfc\u81f4\u4e3b\u4ece\u670d\u52a1\u5668\u6570\u636e\u5e93\u72b6\u6001\u4e0d\u4e00\u81f4\uff0c\u6b64\u65f6\u9700\u8981\u8ba9\u4e3b\u4ece\u6570\u636e\u540c\u6b65\u5230\u4e00\u81f4\u7684\u72b6\u6001\uff0c\u540c\u6b65\u7684\u52a8\u4f5c\u79f0\u4e3a\u547d\u4ee4\u4f20\u64ad master\u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u53d8\u66f4\u547d\u4ee4\u53d1\u9001\u7ed9slave\uff0cslave\u63a5\u6536\u547d\u4ee4\u540e\u6267\u884c\u547d\u4ee4 \u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\u7684\u90e8\u5206\u590d\u5236 \u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\u51fa\u73b0\u4e86\u65ad\u7f51\u73b0\u8c61\uff1a \u7f51\u7edc\u95ea\u65ad\u95ea\u8fde\uff1a\u5ffd\u7565 \u77ed\u65f6\u95f4\u7f51\u7edc\u4e2d\u65ad\uff1a\u90e8\u5206\u590d\u5236 \u957f\u65f6\u95f4\u7f51\u7edc\u4e2d\u65ad\uff1a\u5168\u91cf\u590d\u5236 \u8fd9\u91cc\u6211\u4eec\u4e3b\u8981\u6765\u770b\u90e8\u5206\u590d\u5236\uff0c\u90e8\u5206\u590d\u5236\u7684\u4e09\u4e2a\u6838\u5fc3\u8981\u7d20 \u670d\u52a1\u5668\u7684\u8fd0\u884c id\uff08run id\uff09 \u4e3b\u670d\u52a1\u5668\u7684\u590d\u5236\u79ef\u538b\u7f13\u51b2\u533a \u4e3b\u4ece\u670d\u52a1\u5668\u7684\u590d\u5236\u504f\u79fb\u91cf \u670d\u52a1\u5668\u8fd0\u884cID\uff08runid\uff09 \u6982\u5ff5\uff1a\u670d\u52a1\u5668\u8fd0\u884cID\u662f\u6bcf\u4e00\u53f0\u670d\u52a1\u5668\u6bcf\u6b21\u8fd0\u884c\u7684\u8eab\u4efd\u8bc6\u522b\u7801\uff0c\u4e00\u53f0\u670d\u52a1\u5668\u591a\u6b21\u8fd0\u884c\u53ef\u4ee5\u751f\u6210\u591a\u4e2a\u8fd0\u884cid \u7ec4\u6210\uff1a\u8fd0\u884cid\u753140\u4f4d\u5b57\u7b26\u7ec4\u6210\uff0c\u662f\u4e00\u4e2a\u968f\u673a\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26 \u4f8b\u5982\uff1afdc9ff13b9bbaab28db42b3d50f852bb5e3fcdce \u4f5c\u7528\uff1a\u8fd0\u884cid\u88ab\u7528\u4e8e\u5728\u670d\u52a1\u5668\u95f4\u8fdb\u884c\u4f20\u8f93\uff0c\u8bc6\u522b\u8eab\u4efd \u5982\u679c\u60f3\u4e24\u6b21\u64cd\u4f5c\u5747\u5bf9\u540c\u4e00\u53f0\u670d\u52a1\u5668\u8fdb\u884c\uff0c\u5fc5\u987b\u6bcf\u6b21\u64cd\u4f5c\u643a\u5e26\u5bf9\u5e94\u7684\u8fd0\u884cid\uff0c\u7528\u4e8e\u5bf9\u65b9\u8bc6\u522b \u5b9e\u73b0\u65b9\u5f0f\uff1a\u8fd0\u884cid\u5728\u6bcf\u53f0\u670d\u52a1\u5668\u542f\u52a8\u65f6\u81ea\u52a8\u751f\u6210\u7684\uff0cmaster\u5728\u9996\u6b21\u8fde\u63a5slave\u65f6\uff0c\u4f1a\u5c06\u81ea\u5df1\u7684\u8fd0\u884cID\u53d1\u9001\u7ed9slave\uff0c slave\u4fdd\u5b58\u6b64ID\uff0c\u901a\u8fc7info Server\u547d\u4ee4\uff0c\u53ef\u4ee5\u67e5\u770b\u8282\u70b9\u7684runid \u590d\u5236\u7f13\u51b2\u533a \u6982\u5ff5\uff1a\u590d\u5236\u7f13\u51b2\u533a\uff0c\u53c8\u540d\u590d\u5236\u79ef\u538b\u7f13\u51b2\u533a\uff0c\u662f\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\uff08FIFO\uff09\u7684\u961f\u5217\uff0c\u7528\u4e8e\u5b58\u50a8\u670d\u52a1\u5668\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u6bcf\u6b21\u4f20\u64ad\u547d\u4ee4\uff0cmaster\u90fd\u4f1a\u5c06\u4f20\u64ad\u7684\u547d\u4ee4\u8bb0\u5f55\u4e0b\u6765\uff0c\u5e76\u5b58\u50a8\u5728\u590d\u5236\u7f13\u51b2\u533a \u590d\u5236\u7f13\u51b2\u533a\u9ed8\u8ba4\u6570\u636e\u5b58\u50a8\u7a7a\u95f4\u5927\u5c0f\u662f1M \u5f53\u5165\u961f\u5143\u7d20\u7684\u6570\u91cf\u5927\u4e8e\u961f\u5217\u957f\u5ea6\u65f6\uff0c\u6700\u5148\u5165\u961f\u7684\u5143\u7d20\u4f1a\u88ab\u5f39\u51fa\uff0c\u800c\u65b0\u5143\u7d20\u4f1a\u88ab\u653e\u5165\u961f\u5217 \u4f5c\u7528\uff1a\u7528\u4e8e\u4fdd\u5b58master\u6536\u5230\u7684\u6240\u6709\u6307\u4ee4\uff08\u4ec5\u5f71\u54cd\u6570\u636e\u53d8\u66f4\u7684\u6307\u4ee4\uff0c\u4f8b\u5982set\uff0cselect\uff09 \u6570\u636e\u6765\u6e90\uff1a\u5f53master\u63a5\u6536\u5230\u4e3b\u5ba2\u6237\u7aef\u7684\u6307\u4ee4\u65f6\uff0c\u9664\u4e86\u5c06\u6307\u4ee4\u6267\u884c\uff0c\u4f1a\u5c06\u8be5\u6307\u4ee4\u5b58\u50a8\u5230\u7f13\u51b2\u533a\u4e2d \u590d\u5236\u7f13\u51b2\u533a\u5185\u90e8\u5de5\u4f5c\u539f\u7406\uff1a \u7ec4\u6210 \u504f\u79fb\u91cf \u6982\u5ff5\uff1a\u4e00\u4e2a\u6570\u5b57\uff0c\u63cf\u8ff0\u590d\u5236\u7f13\u51b2\u533a\u4e2d\u7684\u6307\u4ee4\u5b57\u8282\u4f4d\u7f6e \u5206\u7c7b\uff1a master\u590d\u5236\u504f\u79fb\u91cf\uff1a\u8bb0\u5f55\u53d1\u9001\u7ed9\u6240\u6709slave\u7684\u6307\u4ee4\u5b57\u8282\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff08\u591a\u4e2a\uff09 slave\u590d\u5236\u504f\u79fb\u91cf\uff1a\u8bb0\u5f55slave\u63a5\u6536master\u53d1\u9001\u8fc7\u6765\u7684\u6307\u4ee4\u5b57\u8282\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff08\u4e00\u4e2a\uff09 \u4f5c\u7528\uff1a\u540c\u6b65\u4fe1\u606f\uff0c\u6bd4\u5bf9master\u4e0eslave\u7684\u5dee\u5f02\uff0c\u5f53slave\u65ad\u7ebf\u540e\uff0c\u6062\u590d\u6570\u636e\u4f7f\u7528 \u6570\u636e\u6765\u6e90\uff1a master\u7aef\uff1a\u53d1\u9001\u4e00\u6b21\u8bb0\u5f55\u4e00\u6b21 slave\u7aef\uff1a\u63a5\u6536\u4e00\u6b21\u8bb0\u5f55\u4e00\u6b21 \u5b57\u8282\u503c \u5de5\u4f5c\u539f\u7406 \u901a\u8fc7offset\u533a\u5206\u4e0d\u540c\u7684slave\u5f53\u524d\u6570\u636e\u4f20\u64ad\u7684\u5dee\u5f02 master\u8bb0\u5f55\u5df2\u53d1\u9001\u7684\u4fe1\u606f\u5bf9\u5e94\u7684offset slave\u8bb0\u5f55\u5df2\u63a5\u6536\u7684\u4fe1\u606f\u5bf9\u5e94\u7684offset","title":"2.2.1.3 \u9636\u6bb5\u4e09\uff1a\u547d\u4ee4\u4f20\u64ad"},{"location":"redis/day02/#222","text":"\u6211\u4eec\u518d\u6b21\u7684\u603b\u7ed3\u4e00\u4e0b\u4e3b\u4ece\u590d\u5236\u7684\u4e09\u4e2a\u9636\u6bb5\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1a","title":"2.2.2 \u6d41\u7a0b\u66f4\u65b0(\u5168\u91cf\u590d\u5236/\u90e8\u5206\u590d\u5236)"},{"location":"redis/day02/#223","text":"\u4ec0\u4e48\u662f\u5fc3\u8df3\u673a\u5236\uff1f \u8fdb\u5165\u547d\u4ee4\u4f20\u64ad\u9636\u6bb5\u5019\uff0cmaster\u4e0eslave\u95f4\u9700\u8981\u8fdb\u884c\u4fe1\u606f\u4ea4\u6362\uff0c\u4f7f\u7528\u5fc3\u8df3\u673a\u5236\u8fdb\u884c\u7ef4\u62a4\uff0c\u5b9e\u73b0\u53cc\u65b9\u8fde\u63a5\u4fdd\u6301\u5728\u7ebf master\u5fc3\u8df3\uff1a \u5185\u90e8\u6307\u4ee4\uff1aPING \u5468\u671f\uff1a\u7531repl-ping-slave-period\u51b3\u5b9a\uff0c\u9ed8\u8ba410\u79d2 \u4f5c\u7528\uff1a\u5224\u65adslave\u662f\u5426\u5728\u7ebf \u67e5\u8be2\uff1aINFO replication \u83b7\u53d6slave\u6700\u540e\u4e00\u6b21\u8fde\u63a5\u65f6\u95f4\u95f4\u9694\uff0clag\u9879\u7ef4\u6301\u57280\u62161\u89c6\u4e3a\u6b63\u5e38 slave\u5fc3\u8df3\u4efb\u52a1 \u5185\u90e8\u6307\u4ee4\uff1aREPLCONF ACK {offset} \u5468\u671f\uff1a1\u79d2 \u4f5c\u75281\uff1a\u6c47\u62a5slave\u81ea\u5df1\u7684\u590d\u5236\u504f\u79fb\u91cf\uff0c\u83b7\u53d6\u6700\u65b0\u7684\u6570\u636e\u53d8\u66f4\u6307\u4ee4 \u4f5c\u75282\uff1a\u5224\u65admaster\u662f\u5426\u5728\u7ebf \u5fc3\u8df3\u9636\u6bb5\u6ce8\u610f\u4e8b\u9879\uff1a \u5f53slave\u591a\u6570\u6389\u7ebf\uff0c\u6216\u5ef6\u8fdf\u8fc7\u9ad8\u65f6\uff0cmaster\u4e3a\u4fdd\u969c\u6570\u636e\u7a33\u5b9a\u6027\uff0c\u5c06\u62d2\u7edd\u6240\u6709\u4fe1\u606f\u540c\u6b65 min-slaves-to-write 2 min-slaves-max-lag 8 slave\u6570\u91cf\u5c11\u4e8e2\u4e2a\uff0c\u6216\u8005\u6240\u6709slave\u7684\u5ef6\u8fdf\u90fd\u5927\u4e8e\u7b49\u4e8e8\u79d2\u65f6\uff0c\u5f3a\u5236\u5173\u95edmaster\u5199\u529f\u80fd\uff0c\u505c\u6b62\u6570\u636e\u540c\u6b65 slave\u6570\u91cf\u7531slave\u53d1\u9001REPLCONF ACK\u547d\u4ee4\u505a\u786e\u8ba4 slave\u5ef6\u8fdf\u7531slave\u53d1\u9001REPLCONF ACK\u547d\u4ee4\u505a\u786e\u8ba4 \u81f3\u6b64\uff1a\u6211\u4eec\u53ef\u4ee5\u603b\u7ed3\u51fa\u5b8c\u6574\u7684\u4e3b\u4ece\u590d\u5236\u6d41\u7a0b\uff1a","title":"2.2.3 \u5fc3\u8df3\u673a\u5236"},{"location":"redis/day02/#23","text":"","title":"2.3 \u4e3b\u4ece\u590d\u5236\u5e38\u89c1\u95ee\u9898"},{"location":"redis/day02/#231","text":"\u4f34\u968f\u7740\u7cfb\u7edf\u7684\u8fd0\u884c\uff0cmaster\u7684\u6570\u636e\u91cf\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c\u4e00\u65e6master\u91cd\u542f\uff0crunid\u5c06\u53d1\u751f\u53d8\u5316\uff0c\u4f1a\u5bfc\u81f4\u5168\u90e8slave\u7684\u5168\u91cf\u590d\u5236\u64cd\u4f5c \u5185\u90e8\u4f18\u5316\u8c03\u6574\u65b9\u6848\uff1a 1\uff1amaster\u5185\u90e8\u521b\u5efamaster_replid\u53d8\u91cf\uff0c\u4f7f\u7528runid\u76f8\u540c\u7684\u7b56\u7565\u751f\u6210\uff0c\u957f\u5ea641\u4f4d\uff0c\u5e76\u53d1\u9001\u7ed9\u6240\u6709slave 2\uff1a\u5728master\u5173\u95ed\u65f6\u6267\u884c\u547d\u4ee4shutdown save\uff0c\u8fdb\u884cRDB\u6301\u4e45\u5316,\u5c06runid\u4e0eoffset\u4fdd\u5b58\u5230RDB\u6587\u4ef6\u4e2d repl-id repl-offset \u901a\u8fc7redis-check-rdb\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u8be5\u4fe1\u606f 3\uff1amaster\u91cd\u542f\u540e\u52a0\u8f7dRDB\u6587\u4ef6\uff0c\u6062\u590d\u6570\u636e\uff0c\u91cd\u542f\u540e\uff0c\u5c06RDB\u6587\u4ef6\u4e2d\u4fdd\u5b58\u7684repl-id\u4e0erepl-offset\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d master_repl_id=repl master_repl_offset =repl-offset \u901a\u8fc7info\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u8be5\u4fe1\u606f \u4f5c\u7528\uff1a\u672c\u673a\u4fdd\u5b58\u4e0a\u6b21runid\uff0c\u91cd\u542f\u540e\u6062\u590d\u8be5\u503c\uff0c\u4f7f\u6240\u6709slave\u8ba4\u4e3a\u8fd8\u662f\u4e4b\u524d\u7684master \u7b2c\u4e8c\u79cd\u51fa\u73b0\u9891\u7e41\u5168\u91cf\u590d\u5236\u7684\u95ee\u9898\u73b0\u8c61\uff1a\u7f51\u7edc\u73af\u5883\u4e0d\u4f73\uff0c\u51fa\u73b0\u7f51\u7edc\u4e2d\u65ad\uff0cslave\u4e0d\u63d0\u4f9b\u670d\u52a1 \u95ee\u9898\u539f\u56e0\uff1a\u590d\u5236\u7f13\u51b2\u533a\u8fc7\u5c0f\uff0c\u65ad\u7f51\u540eslave\u7684offset\u8d8a\u754c\uff0c\u89e6\u53d1\u5168\u91cf\u590d\u5236 \u6700\u7ec8\u7ed3\u679c\uff1aslave\u53cd\u590d\u8fdb\u884c\u5168\u91cf\u590d\u5236 \u89e3\u51b3\u65b9\u6848\uff1a\u4fee\u6539\u590d\u5236\u7f13\u51b2\u533a\u5927\u5c0f repl-backlog-size ?mb \u5efa\u8bae\u8bbe\u7f6e\u5982\u4e0b\uff1a 1.\u6d4b\u7b97\u4ecemaster\u5230slave\u7684\u91cd\u8fde\u5e73\u5747\u65f6\u957fsecond 2.\u83b7\u53d6master\u5e73\u5747\u6bcf\u79d2\u4ea7\u751f\u5199\u547d\u4ee4\u6570\u636e\u603b\u91cfwrite_size_per_second 3.\u6700\u4f18\u590d\u5236\u7f13\u51b2\u533a\u7a7a\u95f4 = 2 * second * write_size_per_second","title":"2.3.1 \u9891\u7e41\u7684\u5168\u91cf\u590d\u5236"},{"location":"redis/day02/#232","text":"\u95ee\u9898\u73b0\u8c61\uff1amaster\u7684CPU\u5360\u7528\u8fc7\u9ad8 \u6216 slave\u9891\u7e41\u65ad\u5f00\u8fde\u63a5 \u95ee\u9898\u539f\u56e0 slave\u6bcf1\u79d2\u53d1\u9001REPLCONFACK\u547d\u4ee4\u5230master \u5f53slave\u63a5\u5230\u4e86\u6162\u67e5\u8be2\u65f6\uff08keys * \uff0chgetall\u7b49\uff09\uff0c\u4f1a\u5927\u91cf\u5360\u7528CPU\u6027\u80fd master\u6bcf1\u79d2\u8c03\u7528\u590d\u5236\u5b9a\u65f6\u51fd\u6570replicationCron()\uff0c\u6bd4\u5bf9slave\u53d1\u73b0\u957f\u65f6\u95f4\u6ca1\u6709\u8fdb\u884c\u54cd\u5e94 \u6700\u7ec8\u7ed3\u679c\uff1amaster\u5404\u79cd\u8d44\u6e90\uff08\u8f93\u51fa\u7f13\u51b2\u533a\u3001\u5e26\u5bbd\u3001\u8fde\u63a5\u7b49\uff09\u88ab\u4e25\u91cd\u5360\u7528 \u89e3\u51b3\u65b9\u6848\uff1a\u901a\u8fc7\u8bbe\u7f6e\u5408\u7406\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u786e\u8ba4\u662f\u5426\u91ca\u653eslave repl-timeout seconds \u8be5\u53c2\u6570\u5b9a\u4e49\u4e86\u8d85\u65f6\u65f6\u95f4\u7684\u9608\u503c\uff08\u9ed8\u8ba460\u79d2\uff09\uff0c\u8d85\u8fc7\u8be5\u503c\uff0c\u91ca\u653eslave \u95ee\u9898\u73b0\u8c61\uff1aslave\u4e0emaster\u8fde\u63a5\u65ad\u5f00 \u95ee\u9898\u539f\u56e0 master\u53d1\u9001ping\u6307\u4ee4\u9891\u5ea6\u8f83\u4f4e master\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4\u8f83\u77ed ping\u6307\u4ee4\u5728\u7f51\u7edc\u4e2d\u5b58\u5728\u4e22\u5305 \u89e3\u51b3\u65b9\u6848\uff1a\u63d0\u9ad8ping\u6307\u4ee4\u53d1\u9001\u7684\u9891\u5ea6 repl-ping-slave-period seconds \u8d85\u65f6\u65f6\u95f4repl-time\u7684\u65f6\u95f4\u81f3\u5c11\u662fping\u6307\u4ee4\u9891\u5ea6\u76845\u523010\u500d\uff0c\u5426\u5219slave\u5f88\u5bb9\u6613\u5224\u5b9a\u8d85\u65f6","title":"2.3.2 \u9891\u7e41\u7684\u7f51\u7edc\u4e2d\u65ad"},{"location":"redis/day02/#233","text":"\u95ee\u9898\u73b0\u8c61\uff1a\u591a\u4e2aslave\u83b7\u53d6\u76f8\u540c\u6570\u636e\u4e0d\u540c\u6b65 \u95ee\u9898\u539f\u56e0\uff1a\u7f51\u7edc\u4fe1\u606f\u4e0d\u540c\u6b65\uff0c\u6570\u636e\u53d1\u9001\u6709\u5ef6\u8fdf \u89e3\u51b3\u65b9\u6848 \u4f18\u5316\u4e3b\u4ece\u95f4\u7684\u7f51\u7edc\u73af\u5883\uff0c\u901a\u5e38\u653e\u7f6e\u5728\u540c\u4e00\u4e2a\u673a\u623f\u90e8\u7f72\uff0c\u5982\u4f7f\u7528\u963f\u91cc\u4e91\u7b49\u4e91\u670d\u52a1\u5668\u65f6\u8981\u6ce8\u610f\u6b64\u73b0\u8c61 \u76d1\u63a7\u4e3b\u4ece\u8282\u70b9\u5ef6\u8fdf\uff08\u901a\u8fc7offset\uff09\u5224\u65ad\uff0c\u5982\u679cslave\u5ef6\u8fdf\u8fc7\u5927\uff0c\u6682\u65f6\u5c4f\u853d\u7a0b\u5e8f\u5bf9\u8be5slave\u7684\u6570\u636e\u8bbf\u95ee slave-serve-stale-data yes|no \u5f00\u542f\u540e\u4ec5\u54cd\u5e94info\u3001slaveof\u7b49\u5c11\u6570\u547d\u4ee4\uff08\u614e\u7528\uff0c\u9664\u975e\u5bf9\u6570\u636e\u4e00\u81f4\u6027\u8981\u6c42\u5f88\u9ad8\uff09","title":"2.3.3 \u6570\u636e\u4e0d\u4e00\u81f4"},{"location":"redis/day02/#3","text":"","title":"3.\u54e8\u5175\u6a21\u5f0f"},{"location":"redis/day02/#31","text":"","title":"3.1 \u54e8\u5175\u7b80\u4ecb"},{"location":"redis/day02/#311","text":"\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4e1a\u52a1\u573a\u666f\uff1a\u5982\u679credis\u7684master\u5b95\u673a\u4e86\uff0c\u6b64\u65f6\u5e94\u8be5\u600e\u4e48\u529e\uff1f \u90a3\u6b64\u65f6\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4ece\u4e00\u5806\u7684slave\u4e2d\u91cd\u65b0\u9009\u4e3e\u51fa\u4e00\u4e2a\u65b0\u7684master\uff0c\u90a3\u8fd9\u4e2a\u64cd\u4f5c\u8fc7\u7a0b\u662f\u4ec0\u4e48\u6837\u7684\u5462\uff1f\u8fd9\u91cc\u9762\u4f1a\u6709\u4ec0\u4e48\u95ee\u9898\u51fa\u73b0\u5462\uff1f \u8981\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\uff0c\u6211\u4eec\u5c31\u9700\u8981redis\u7684\u54e8\u5175\uff0c\u90a3\u54e8\u5175\u662f\u4ec0\u4e48\u5462\uff1f \u54e8\u5175 \u54e8\u5175(sentinel) \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u7528\u4e8e\u5bf9\u4e3b\u4ece\u7ed3\u6784\u4e2d\u7684\u6bcf\u53f0\u670d\u52a1\u5668\u8fdb\u884c \u76d1\u63a7 \uff0c\u5f53\u51fa\u73b0\u6545\u969c\u65f6\u901a\u8fc7 \u6295\u7968 \u673a\u5236 \u9009\u62e9 \u65b0\u7684master\u5e76\u5c06\u6240\u6709slave\u8fde\u63a5\u5230\u65b0\u7684master\u3002","title":"3.1.1 \u54e8\u5175\u6982\u5ff5"},{"location":"redis/day02/#312","text":"\u54e8\u5175\u7684\u4f5c\u7528\uff1a \u76d1\u63a7\uff1a\u76d1\u63a7master\u548cslave \u4e0d\u65ad\u7684\u68c0\u67e5master\u548cslave\u662f\u5426\u6b63\u5e38\u8fd0\u884c master\u5b58\u6d3b\u68c0\u6d4b\u3001master\u4e0eslave\u8fd0\u884c\u60c5\u51b5\u68c0\u6d4b \u901a\u77e5\uff08\u63d0\u9192\uff09\uff1a\u5f53\u88ab\u76d1\u63a7\u7684\u670d\u52a1\u5668\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u5411\u5176\u4ed6\uff08\u54e8\u5175\u95f4\uff0c\u5ba2\u6237\u7aef\uff09\u53d1\u9001\u901a\u77e5 \u81ea\u52a8\u6545\u969c\u8f6c\u79fb\uff1a\u65ad\u5f00master\u4e0eslave\u8fde\u63a5\uff0c\u9009\u53d6\u4e00\u4e2aslave\u4f5c\u4e3amaster\uff0c\u5c06\u5176\u4ed6slave\u8fde\u63a5\u65b0\u7684master\uff0c\u5e76\u544a\u77e5\u5ba2\u6237\u7aef\u65b0\u7684\u670d\u52a1\u5668\u5730\u5740 \u6ce8\u610f\uff1a\u54e8\u5175\u4e5f\u662f\u4e00\u53f0redis\u670d\u52a1\u5668\uff0c\u53ea\u662f\u4e0d\u63d0\u4f9b\u6570\u636e\u76f8\u5173\u670d\u52a1\uff0c\u901a\u5e38\u54e8\u5175\u7684\u6570\u91cf\u914d\u7f6e\u4e3a\u5355\u6570","title":"3.1.2 \u54e8\u5175\u4f5c\u7528"},{"location":"redis/day02/#32","text":"\u914d\u7f6e\u54e8\u5175 \u914d\u7f6e\u4e00\u62d6\u4e8c\u7684\u4e3b\u4ece\u7ed3\u6784\uff08\u5229\u7528\u4e4b\u524d\u7684\u65b9\u5f0f\u542f\u52a8\u5373\u53ef\uff09 \u914d\u7f6e\u4e09\u4e2a\u54e8\u5175\uff08\u914d\u7f6e\u76f8\u540c\uff0c\u7aef\u53e3\u4e0d\u540c\uff09\uff0c\u53c2\u770bsentinel.conf 1\uff1a\u8bbe\u7f6e\u54e8\u5175\u76d1\u542c\u7684\u4e3b\u670d\u52a1\u5668\u4fe1\u606f\uff0c sentinel_number\u8868\u793a\u53c2\u4e0e\u6295\u7968\u7684\u54e8\u5175\u6570\u91cf sentinel monitor master_name master_host master_port sentinel_number 2\uff1a\u8bbe\u7f6e\u5224\u5b9a\u670d\u52a1\u5668\u5b95\u673a\u65f6\u957f\uff0c\u8be5\u8bbe\u7f6e\u63a7\u5236\u662f\u5426\u8fdb\u884c\u4e3b\u4ece\u5207\u6362 sentinel down-after-milliseconds master_name million_seconds 3\uff1a\u8bbe\u7f6e\u6545\u969c\u5207\u6362\u7684\u6700\u5927\u8d85\u65f6\u65f6 sentinel failover-timeout master_name million_seconds 4\uff1a\u8bbe\u7f6e\u4e3b\u4ece\u5207\u6362\u540e\uff0c\u540c\u65f6\u8fdb\u884c\u6570\u636e\u540c\u6b65\u7684slave\u6570\u91cf\uff0c\u6570\u503c\u8d8a\u5927\uff0c\u8981\u6c42\u7f51\u7edc\u8d44\u6e90\u8d8a\u9ad8\uff0c\u6570\u503c\u8d8a\u5c0f\uff0c\u540c\u6b65\u65f6\u95f4\u8d8a\u957f sentinel parallel-syncs master_name sync_slave_number \u542f\u52a8\u54e8\u5175 redis-sentinel filename","title":"3.2 \u542f\u7528\u54e8\u5175"},{"location":"redis/day02/#33","text":"\u54e8\u5175\u5728\u8fdb\u884c\u4e3b\u4ece\u5207\u6362\u8fc7\u7a0b\u4e2d\u7ecf\u5386\u4e09\u4e2a\u9636\u6bb5 \u76d1\u63a7 \u901a\u77e5 \u6545\u969c\u8f6c\u79fb","title":"3.3 \u54e8\u5175\u5de5\u4f5c\u539f\u7406"},{"location":"redis/day02/#331","text":"\u7528\u4e8e\u540c\u6b65\u5404\u4e2a\u8282\u70b9\u7684\u72b6\u6001\u4fe1\u606f \u83b7\u53d6\u5404\u4e2asentinel\u7684\u72b6\u6001\uff08\u662f\u5426\u5728\u7ebf\uff09 \u83b7\u53d6master\u7684\u72b6\u6001 master\u5c5e\u6027 prunid prole\uff1amaster \u5404\u4e2aslave\u7684\u8be6\u7ec6\u4fe1\u606f \u83b7\u53d6\u6240\u6709slave\u7684\u72b6\u6001\uff08\u6839\u636emaster\u4e2d\u7684slave\u4fe1\u606f\uff09 slave\u5c5e\u6027 prunid prole\uff1aslave pmaster_host\u3001master_port poffset \u5176\u5185\u90e8\u7684\u5de5\u4f5c\u539f\u7406\u5177\u4f53\u5982\u4e0b\uff1a","title":"3.3.1 \u76d1\u63a7"},{"location":"redis/day02/#332","text":"sentinel\u5728\u901a\u77e5\u9636\u6bb5\u8981\u4e0d\u65ad\u7684\u53bb\u83b7\u53d6master/slave\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5728\u5404\u4e2asentinel\u4e4b\u95f4\u8fdb\u884c\u5171\u4eab\uff0c\u5177\u4f53\u7684\u6d41\u7a0b\u5982\u4e0b\uff1a","title":"3.3.2 \u901a\u77e5"},{"location":"redis/day02/#333","text":"\u5f53master\u5b95\u673a\u540esentinel\u662f\u5982\u4f55\u77e5\u6653\u5e76\u5224\u65ad\u51famaster\u662f\u771f\u7684\u5b95\u673a\u4e86\u5462\uff1f\u6211\u4eec\u6765\u770b\u5177\u4f53\u7684\u64cd\u4f5c\u6d41\u7a0b \u5f53sentinel\u8ba4\u5b9amaster\u4e0b\u7ebf\u4e4b\u540e\uff0c\u6b64\u65f6\u9700\u8981\u51b3\u5b9a\u66f4\u6362master\uff0c\u90a3\u8fd9\u4ef6\u4e8b\u7531\u54ea\u4e2asentinel\u6765\u505a\u5462\uff1f\u8fd9\u65f6\u5019sentinel\u4e4b\u95f4\u8981\u8fdb\u884c\u9009\u4e3e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5728\u9009\u4e3e\u7684\u65f6\u5019\u6bcf\u4e00\u4e2a\u4eba\u624b\u91cc\u90fd\u6709\u4e00\u7968\uff0c\u800c\u6bcf\u4e00\u4e2a\u4eba\u7684\u53c8\u90fd\u60f3\u5f53\u8fd9\u4e2a\u5904\u7406\u4e8b\u6545\u7684\u4eba\uff0c\u90a3\u600e\u4e48\u529e\uff1f\u5927\u5bb6\u5c31\u5f00\u59cb\u62a2\uff0c\u4e8e\u662f\u6bcf\u4e2a\u4eba\u90fd\u4f1a\u53d1\u51fa\u4e00\u4e2a\u6307\u4ee4\uff0c\u5728\u5185\u7f51\u91cc\u8fb9\u544a\u8bc9\u5927\u5bb6\u6211\u8981\u5f53\u9009\u4e3e\u4eba\uff0c\u6bd4\u5982\u8bf4\u73b0\u5728\u7684sentinel1\u548csentinel4\u53d1\u51fa\u8fd9\u4e2a\u9009\u4e3e\u6307\u4ee4\u4e86\uff0c\u90a3\u4e48sentinel2\u65e2\u80fd\u63a5\u5230sentinel1\u7684\u4e5f\u80fd\u63a5\u5230sentinel4\u7684\uff0c\u63a5\u5230\u4e86\u4ed6\u4eec\u7684\u7533\u8bf7\u4ee5\u540e\u5462\uff0csentinel2\u4ed6\u5c31\u4f1a\u628a\u4ed6\u7684\u4e00\u7968\u6295\u7ed9\u5176\u4e2d\u4e00\u65b9\uff0c\u6295\u7ed9\u8c01\u5462\uff1f\u8c01\u5148\u8fc7\u6765\u6211\u6295\u7ed9\u8c01\uff0c\u5047\u8bbesentinel1\u5148\u8fc7\u6765\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7968\u5c31\u7ed9\u5230\u4e86sentinel1\u3002\u90a3\u4e48\u7ed9\u8fc7\u53bb\u4ee5\u540e\u5462\uff0c\u73b0\u5728sentinel1\u5c31\u62ff\u5230\u4e86\u4e00\u7968\uff0c\u6309\u7167\u8fd9\u6837\u7684\u4e00\u79cd\u5f62\u5f0f\uff0c\u6700\u7ec8\u4f1a\u6709\u4e00\u4e2a\u9009\u4e3e\u7ed3\u679c\u3002\u5bf9\u5e94\u7684\u9009\u4e3e\u6700\u7ec8\u5f97\u7968\u591a\u7684\uff0c\u90a3\u81ea\u7136\u5c31\u6210\u4e3a\u4e86\u5904\u7406\u4e8b\u6545\u7684\u4eba\u3002\u9700\u8981\u6ce8\u610f\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6709\u53ef\u80fd\u4f1a\u5b58\u5728\u5931\u8d25\u7684\u73b0\u8c61\uff0c\u5c31\u662f\u4e00\u8f6e\u9009\u4e3e\u5b8c\u6ca1\u6709\u9009\u53d6\uff0c\u90a3\u5c31\u4f1a\u63a5\u7740\u8fdb\u884c\u7b2c\u4e8c\u8f6e\u7b2c\u4e09\u8f6e\u76f4\u5230\u5b8c\u6210\u9009\u4e3e\u3002 \u63a5\u4e0b\u6765\u5c31\u662f\u7531\u9009\u4e3e\u80dc\u51fa\u7684sentinel\u53bb\u4eceslave\u4e2d\u9009\u4e00\u4e2a\u65b0\u7684master\u51fa\u6765\u7684\u5de5\u4f5c\uff0c\u8fd9\u4e2a\u6d41\u7a0b\u662f\u4ec0\u4e48\u6837\u7684\u5462\uff1f \u9996\u5148\u5b83\u6709\u4e00\u4e2a\u5728\u670d\u52a1\u5668\u5217\u8868\u4e2d\u6311\u9009\u5907\u9009master\u7684\u539f\u5219 \u4e0d\u5728\u7ebf\u7684OUT \u54cd\u5e94\u6162\u7684OUT \u4e0e\u539fmaster\u65ad\u5f00\u65f6\u95f4\u4e45\u7684OUT \u4f18\u5148\u539f\u5219 \u4f18\u5148\u7ea7 offset runid \u9009\u51fa\u65b0\u7684master\u4e4b\u540e\uff0c\u53d1\u9001\u6307\u4ee4\uff08 sentinel \uff09\u7ed9\u5176\u4ed6\u7684slave\uff1a \u5411\u65b0\u7684master\u53d1\u9001slaveof no one \u5411\u5176\u4ed6slave\u53d1\u9001slaveof \u65b0masterIP\u7aef\u53e3 \u603b\u7ed3 \uff1a\u6545\u969c\u8f6c\u79fb\u9636\u6bb5 \u53d1\u73b0\u95ee\u9898\uff0c\u4e3b\u89c2\u4e0b\u7ebf\u4e0e\u5ba2\u89c2\u4e0b\u7ebf \u7ade\u9009\u8d1f\u8d23\u4eba \u4f18\u9009\u65b0master \u65b0master\u4e0a\u4efb\uff0c\u5176\u4ed6slave\u5207\u6362master\uff0c\u539fmaster\u4f5c\u4e3aslave\u6545\u969c\u6062\u590d\u540e\u8fde\u63a5","title":"3.3.3 \u6545\u969c\u8f6c\u79fb"},{"location":"redis/day02/#4cluster","text":"\u73b0\u72b6\u95ee\u9898\uff1a\u4e1a\u52a1\u53d1\u5c55\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u5cf0\u503c\u74f6\u9888 redis\u63d0\u4f9b\u7684\u670d\u52a1OPS\u53ef\u4ee5\u8fbe\u523010\u4e07/\u79d2\uff0c\u5f53\u524d\u4e1a\u52a1OPS\u5df2\u7ecf\u8fbe\u523010\u4e07/\u79d2 \u5185\u5b58\u5355\u673a\u5bb9\u91cf\u8fbe\u5230256G\uff0c\u5f53\u524d\u4e1a\u52a1\u9700\u6c42\u5185\u5b58\u5bb9\u91cf1T \u4f7f\u7528\u96c6\u7fa4\u7684\u65b9\u5f0f\u53ef\u4ee5\u5feb\u901f\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898","title":"4.\u96c6\u7fa4cluster"},{"location":"redis/day02/#41","text":"\u96c6\u7fa4\u5c31\u662f\u4f7f\u7528\u7f51\u7edc\u5c06\u82e5\u5e72\u53f0\u8ba1\u7b97\u673a\u8054\u901a\u8d77\u6765\uff0c\u5e76\u63d0\u4f9b\u7edf\u4e00\u7684\u7ba1\u7406\u65b9\u5f0f\uff0c\u4f7f\u5176\u5bf9\u5916\u5448\u73b0\u5355\u673a\u7684\u670d\u52a1\u6548\u679c \u96c6\u7fa4\u4f5c\u7528\uff1a \u5206\u6563\u5355\u53f0\u670d\u52a1\u5668\u7684\u8bbf\u95ee\u538b\u529b\uff0c\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861 \u5206\u6563\u5355\u53f0\u670d\u52a1\u5668\u7684\u5b58\u50a8\u538b\u529b\uff0c\u5b9e\u73b0\u53ef\u6269\u5c55\u6027 \u964d\u4f4e\u5355\u53f0\u670d\u52a1\u5668\u5b95\u673a\u5e26\u6765\u7684\u4e1a\u52a1\u707e\u96be","title":"4.1 \u96c6\u7fa4\u7b80\u4ecb"},{"location":"redis/day02/#42_cluster","text":"\u6570\u636e\u5b58\u50a8\u8bbe\u8ba1\uff1a \u901a\u8fc7\u7b97\u6cd5\u8bbe\u8ba1\uff0c\u8ba1\u7b97\u51fakey\u5e94\u8be5\u4fdd\u5b58\u7684\u4f4d\u7f6e \u5c06\u6240\u6709\u7684\u5b58\u50a8\u7a7a\u95f4\u8ba1\u5212\u5207\u5272\u621016384\u4efd\uff0c\u6bcf\u53f0\u4e3b\u673a\u4fdd\u5b58\u4e00\u90e8\u5206 \u6ce8\u610f\uff1a\u6bcf\u4efd\u4ee3\u8868\u7684\u662f\u4e00\u4e2a\u5b58\u50a8\u7a7a\u95f4\uff0c\u4e0d\u662f\u4e00\u4e2akey\u7684\u4fdd\u5b58\u7a7a\u95f4 \u5c06key\u6309\u7167\u8ba1\u7b97\u51fa\u7684\u7ed3\u679c\u653e\u5230\u5bf9\u5e94\u7684\u5b58\u50a8\u7a7a\u95f4 \u90a3redis\u7684\u96c6\u7fa4\u662f\u5982\u4f55\u589e\u5f3a\u53ef\u6269\u5c55\u6027\u7684\u5462\uff1f\u8b6c\u5982\u6211\u4eec\u8981\u589e\u52a0\u4e00\u4e2a\u96c6\u7fa4\u8282\u70b9 \u5f53\u6211\u4eec\u67e5\u627e\u6570\u636e\u65f6\uff0c\u96c6\u7fa4\u662f\u5982\u4f55\u64cd\u4f5c\u7684\u5462\uff1f \u5404\u4e2a\u6570\u636e\u5e93\u76f8\u4e92\u901a\u4fe1\uff0c\u4fdd\u5b58\u5404\u4e2a\u5e93\u4e2d\u69fd\u7684\u7f16\u53f7\u6570\u636e \u4e00\u6b21\u547d\u4e2d\uff0c\u76f4\u63a5\u8fd4\u56de \u4e00\u6b21\u672a\u547d\u4e2d\uff0c\u544a\u77e5\u5177\u4f53\u4f4d\u7f6e","title":"4.2 Cluster\u96c6\u7fa4\u7ed3\u6784\u8bbe\u8ba1"},{"location":"redis/day02/#43_cluster","text":"\u9996\u5148\u8981\u660e\u786e\u7684\u51e0\u4e2a\u8981\u70b9\uff1a \u914d\u7f6e\u670d\u52a1\u5668\uff083\u4e3b3\u4ece\uff09 \u5efa\u7acb\u901a\u4fe1\uff08Meet\uff09 \u5206\u69fd\uff08Slot\uff09 \u642d\u5efa\u4e3b\u4ece\uff08master-slave\uff09 Cluster\u914d\u7f6e \u662f\u5426\u542f\u7528cluster\uff0c\u52a0\u5165cluster\u8282\u70b9 cluster-enabled yes|no cluster\u914d\u7f6e\u6587\u4ef6\u540d\uff0c\u8be5\u6587\u4ef6\u5c5e\u4e8e\u81ea\u52a8\u751f\u6210\uff0c\u4ec5\u7528\u4e8e\u5feb\u901f\u67e5\u627e\u6587\u4ef6\u5e76\u67e5\u8be2\u6587\u4ef6\u5185\u5bb9 cluster-config-file filename \u8282\u70b9\u670d\u52a1\u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\uff0c\u7528\u4e8e\u5224\u5b9a\u8be5\u8282\u70b9\u662f\u5426\u4e0b\u7ebf\u6216\u5207\u6362\u4e3a\u4ece\u8282\u70b9 cluster-node-timeout milliseconds master\u8fde\u63a5\u7684slave\u6700\u5c0f\u6570\u91cf cluster-migration-barrier min_slave_number Cluster\u8282\u70b9\u64cd\u4f5c\u547d\u4ee4 \u67e5\u770b\u96c6\u7fa4\u8282\u70b9\u4fe1\u606f cluster nodes \u66f4\u6539slave\u6307\u5411\u65b0\u7684master cluster replicate master-id \u53d1\u73b0\u4e00\u4e2a\u65b0\u8282\u70b9\uff0c\u65b0\u589emaster cluster meet ip : port \u5ffd\u7565\u4e00\u4e2a\u6ca1\u6709solt\u7684\u8282\u70b9 cluster forget server_id \u624b\u52a8\u6545\u969c\u8f6c\u79fb cluster failover \u96c6\u7fa4\u64cd\u4f5c\u547d\u4ee4\uff1a \u521b\u5efa\u96c6\u7fa4 redis-cli \u2013-cluster create masterhost1 : masterport1 masterhost2:masterport2 masterhost3:masterport3 [masterhostn:masterportn \u2026] slavehost1:slaveport1 slavehost2:slaveport2 slavehost3:slaveport3 -\u2013cluster-replicas n \u6ce8\u610f\uff1amaster\u4e0eslave\u7684\u6570\u91cf\u8981\u5339\u914d\uff0c\u4e00\u4e2amaster\u5bf9\u5e94n\u4e2aslave\uff0c\u7531\u6700\u540e\u7684\u53c2\u6570n\u51b3\u5b9a master\u4e0eslave\u7684\u5339\u914d\u987a\u5e8f\u4e3a\u7b2c\u4e00\u4e2amaster\u4e0e\u524dn\u4e2aslave\u5206\u4e3a\u4e00\u7ec4\uff0c\u5f62\u6210\u4e3b\u4ece\u7ed3\u6784 \u6dfb\u52a0master\u5230\u5f53\u524d\u96c6\u7fa4\u4e2d\uff0c\u8fde\u63a5\u65f6\u53ef\u4ee5\u6307\u5b9a\u4efb\u610f\u73b0\u6709\u8282\u70b9\u5730\u5740\u4e0e\u7aef\u53e3 redis-cli --cluster add-node new-master-host : new-master-port now-host:now-port \u6dfb\u52a0slave redis-cli --cluster add-node new-slave-host : new-slave-port master-host:master-port --cluster-slave --cluster-master-id masterid \u5220\u9664\u8282\u70b9\uff0c\u5982\u679c\u5220\u9664\u7684\u8282\u70b9\u662fmaster\uff0c\u5fc5\u987b\u4fdd\u969c\u5176\u4e2d\u6ca1\u6709\u69fdslot redis-cli --cluster del-node del-slave-host : del-slave-port del-slave-id \u91cd\u65b0\u5206\u69fd\uff0c\u5206\u69fd\u662f\u4ece\u5177\u6709\u69fd\u7684master\u4e2d\u5212\u5206\u4e00\u90e8\u5206\u7ed9\u5176\u4ed6master\uff0c\u8fc7\u7a0b\u4e2d\u4e0d\u521b\u5efa\u65b0\u7684\u69fd redis-cli --cluster reshard new-master-host : new-master:port --cluster-from src- master-id1, src-master-id2, src-master-idn --cluster-to target-master-id -- cluster-slots slots \u6ce8\u610f\uff1a\u5c06\u9700\u8981\u53c2\u4e0e\u5206\u69fd\u7684\u6240\u6709masterid\u4e0d\u5206\u5148\u540e\u987a\u5e8f\u6dfb\u52a0\u5230\u53c2\u6570\u4e2d\uff0c\u4f7f\u7528\uff0c\u5206\u9694 \u6307\u5b9a\u76ee\u6807\u5f97\u5230\u7684\u69fd\u7684\u6570\u91cf\uff0c\u6240\u6709\u7684\u69fd\u5c06\u5e73\u5747\u4ece\u6bcf\u4e2a\u6765\u6e90\u7684master\u5904\u83b7\u53d6 \u91cd\u65b0\u5206\u914d\u69fd\uff0c\u4ece\u5177\u6709\u69fd\u7684master\u4e2d\u5206\u914d\u6307\u5b9a\u6570\u91cf\u7684\u69fd\u5230\u53e6\u4e00\u4e2amaster\u4e2d\uff0c\u5e38\u7528\u4e8e\u6e05\u7a7a\u6307\u5b9amaster\u4e2d\u7684\u69fd redis-cli --cluster reshard src-master-host : src-master-port --cluster-from src- master-id --cluster-to target-master-id --cluster-slots slots --cluster-yes","title":"4.3 Cluster\u96c6\u7fa4\u7ed3\u6784\u642d\u5efa"},{"location":"redis/day02/#5","text":"","title":"5.\u4f01\u4e1a\u7ea7\u89e3\u51b3\u65b9\u6848"},{"location":"redis/day02/#51","text":"\u573a\u666f \uff1a\u201c\u5b95\u673a\u201d \u670d\u52a1\u5668\u542f\u52a8\u540e\u8fc5\u901f\u5b95\u673a \u95ee\u9898\u6392\u67e5 \uff1a 1.\u8bf7\u6c42\u6570\u91cf\u8f83\u9ad8\uff0c\u5927\u91cf\u7684\u8bf7\u6c42\u8fc7\u6765\u4e4b\u540e\u90fd\u9700\u8981\u53bb\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u4f46\u662f\u7f13\u5b58\u4e2d\u53c8\u6ca1\u6709\uff0c\u6b64\u65f6\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u627e\u6570\u636e\u7136\u540e\u5c06\u6570\u636e\u518d\u5b58\u5165\u7f13\u5b58\uff0c\u9020\u6210\u4e86\u77ed\u671f\u5185\u5bf9redis\u7684\u9ad8\u5f3a\u5ea6\u64cd\u4f5c\u4ece\u800c\u5bfc\u81f4\u95ee\u9898 2.\u4e3b\u4ece\u4e4b\u95f4\u6570\u636e\u541e\u5410\u91cf\u8f83\u5927\uff0c\u6570\u636e\u540c\u6b65\u64cd\u4f5c\u9891\u5ea6\u8f83\u9ad8 \u89e3\u51b3\u65b9\u6848\uff1a \u524d\u7f6e\u51c6\u5907\u5de5\u4f5c\uff1a 1.\u65e5\u5e38\u4f8b\u884c\u7edf\u8ba1\u6570\u636e\u8bbf\u95ee\u8bb0\u5f55\uff0c\u7edf\u8ba1\u8bbf\u95ee\u9891\u5ea6\u8f83\u9ad8\u7684\u70ed\u70b9\u6570\u636e 2.\u5229\u7528LRU\u6570\u636e\u5220\u9664\u7b56\u7565\uff0c\u6784\u5efa\u6570\u636e\u7559\u5b58\u961f\u5217\u4f8b\u5982\uff1astorm\u4e0ekafka\u914d\u5408 \u51c6\u5907\u5de5\u4f5c\uff1a 1.\u5c06\u7edf\u8ba1\u7ed3\u679c\u4e2d\u7684\u6570\u636e\u5206\u7c7b\uff0c\u6839\u636e\u7ea7\u522b\uff0credis\u4f18\u5148\u52a0\u8f7d\u7ea7\u522b\u8f83\u9ad8\u7684\u70ed\u70b9\u6570\u636e 2.\u5229\u7528\u5206\u5e03\u5f0f\u591a\u670d\u52a1\u5668\u540c\u65f6\u8fdb\u884c\u6570\u636e\u8bfb\u53d6\uff0c\u63d0\u901f\u6570\u636e\u52a0\u8f7d\u8fc7\u7a0b 3.\u70ed\u70b9\u6570\u636e\u4e3b\u4ece\u540c\u65f6\u9884\u70ed \u5b9e\u65bd\uff1a 4.\u4f7f\u7528\u811a\u672c\u7a0b\u5e8f\u56fa\u5b9a\u89e6\u53d1\u6570\u636e\u9884\u70ed\u8fc7\u7a0b 5.\u5982\u679c\u6761\u4ef6\u5141\u8bb8\uff0c\u4f7f\u7528\u4e86CDN\uff08\u5185\u5bb9\u5206\u53d1\u7f51\u7edc\uff09\uff0c\u6548\u679c\u4f1a\u66f4\u597d \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u9884\u70ed\u5c31\u662f\u7cfb\u7edf\u542f\u52a8\u524d\uff0c\u63d0\u524d\u5c06\u76f8\u5173\u7684\u7f13\u5b58\u6570\u636e\u76f4\u63a5\u52a0\u8f7d\u5230\u7f13\u5b58\u7cfb\u7edf\u3002\u907f\u514d\u5728\u7528\u6237\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u5148\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u7136\u540e\u518d\u5c06\u6570\u636e\u7f13\u5b58\u7684\u95ee\u9898\uff01\u7528\u6237\u76f4\u63a5\u67e5\u8be2\u4e8b\u5148\u88ab\u9884\u70ed\u7684\u7f13\u5b58\u6570\u636e\uff01","title":"5.1 \u7f13\u5b58\u9884\u70ed"},{"location":"redis/day02/#52","text":"\u573a\u666f \uff1a\u6570\u636e\u5e93\u670d\u52a1\u5668\u5d29\u6e83\uff0c\u4e00\u8fde\u4e32\u7684\u573a\u666f\u4f1a\u968f\u4e4b\u513f\u6765 1.\u7cfb\u7edf\u5e73\u7a33\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u5ffd\u7136\u6570\u636e\u5e93\u8fde\u63a5\u91cf\u6fc0\u589e 2.\u5e94\u7528\u670d\u52a1\u5668\u65e0\u6cd5\u53ca\u65f6\u5904\u7406\u8bf7\u6c42 3.\u5927\u91cf408\uff0c500\u9519\u8bef\u9875\u9762\u51fa\u73b0 4.\u5ba2\u6237\u53cd\u590d\u5237\u65b0\u9875\u9762\u83b7\u53d6\u6570\u636e 5.\u6570\u636e\u5e93\u5d29\u6e83 6.\u5e94\u7528\u670d\u52a1\u5668\u5d29\u6e83 7.\u91cd\u542f\u5e94\u7528\u670d\u52a1\u5668\u65e0\u6548 8.Redis\u670d\u52a1\u5668\u5d29\u6e83 9.Redis\u96c6\u7fa4\u5d29\u6e83 10.\u91cd\u542f\u6570\u636e\u5e93\u540e\u518d\u6b21\u88ab\u77ac\u95f4\u6d41\u91cf\u653e\u5012 \u95ee\u9898\u6392\u67e5 \uff1a 1.\u5728\u4e00\u4e2a\u8f83\u77ed\u7684\u65f6\u95f4\u5185\uff0c\u7f13\u5b58\u4e2d\u8f83\u591a\u7684key\u96c6\u4e2d\u8fc7\u671f 2.\u6b64\u5468\u671f\u5185\u8bf7\u6c42\u8bbf\u95ee\u8fc7\u671f\u7684\u6570\u636e\uff0credis\u672a\u547d\u4e2d\uff0credis\u5411\u6570\u636e\u5e93\u83b7\u53d6\u6570\u636e 3.\u6570\u636e\u5e93\u540c\u65f6\u63a5\u6536\u5230\u5927\u91cf\u7684\u8bf7\u6c42\u65e0\u6cd5\u53ca\u65f6\u5904\u7406 4.Redis\u5927\u91cf\u8bf7\u6c42\u88ab\u79ef\u538b\uff0c\u5f00\u59cb\u51fa\u73b0\u8d85\u65f6\u73b0\u8c61 5.\u6570\u636e\u5e93\u6d41\u91cf\u6fc0\u589e\uff0c\u6570\u636e\u5e93\u5d29\u6e83 6.\u91cd\u542f\u540e\u4ecd\u7136\u9762\u5bf9\u7f13\u5b58\u4e2d\u65e0\u6570\u636e\u53ef\u7528 7.Redis\u670d\u52a1\u5668\u8d44\u6e90\u88ab\u4e25\u91cd\u5360\u7528\uff0cRedis\u670d\u52a1\u5668\u5d29\u6e83 8.Redis\u96c6\u7fa4\u5448\u73b0\u5d29\u584c\uff0c\u96c6\u7fa4\u74e6\u89e3 9.\u5e94\u7528\u670d\u52a1\u5668\u65e0\u6cd5\u53ca\u65f6\u5f97\u5230\u6570\u636e\u54cd\u5e94\u8bf7\u6c42\uff0c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6570\u91cf\u8d8a\u6765\u8d8a\u591a\uff0c\u5e94\u7528\u670d\u52a1\u5668\u5d29\u6e83 10.\u5e94\u7528\u670d\u52a1\u5668\uff0credis\uff0c\u6570\u636e\u5e93\u5168\u90e8\u91cd\u542f\uff0c\u6548\u679c\u4e0d\u7406\u60f3 \u603b\u800c\u8a00\u4e4b\u5c31\u4e24\u70b9\uff1a\u77ed\u65f6\u95f4\u8303\u56f4\u5185\uff0c\u5927\u91cfkey\u96c6\u4e2d\u8fc7\u671f \u89e3\u51b3\u65b9\u6848 \u601d\u8def\uff1a 1.\u66f4\u591a\u7684\u9875\u9762\u9759\u6001\u5316\u5904\u7406 2.\u6784\u5efa\u591a\u7ea7\u7f13\u5b58\u67b6\u6784 Nginx\u7f13\u5b58+redis\u7f13\u5b58+ehcache\u7f13\u5b58 3.\u68c0\u6d4bMysql\u4e25\u91cd\u8017\u65f6\u4e1a\u52a1\u8fdb\u884c\u4f18\u5316 \u5bf9\u6570\u636e\u5e93\u7684\u74f6\u9888\u6392\u67e5\uff1a\u4f8b\u5982\u8d85\u65f6\u67e5\u8be2\u3001\u8017\u65f6\u8f83\u9ad8\u4e8b\u52a1\u7b49 4.\u707e\u96be\u9884\u8b66\u673a\u5236 \u76d1\u63a7redis\u670d\u52a1\u5668\u6027\u80fd\u6307\u6807 CPU\u5360\u7528\u3001CPU\u4f7f\u7528\u7387 \u5185\u5b58\u5bb9\u91cf \u67e5\u8be2\u5e73\u5747\u54cd\u5e94\u65f6\u95f4 \u7ebf\u7a0b\u6570 5.\u9650\u6d41\u3001\u964d\u7ea7 \u77ed\u65f6\u95f4\u8303\u56f4\u5185\u727a\u7272\u4e00\u4e9b\u5ba2\u6237\u4f53\u9a8c\uff0c\u9650\u5236\u4e00\u90e8\u5206\u8bf7\u6c42\u8bbf\u95ee\uff0c\u964d\u4f4e\u5e94\u7528\u670d\u52a1\u5668\u538b\u529b\uff0c\u5f85\u4e1a\u52a1\u4f4e\u901f\u8fd0\u8f6c\u540e\u518d\u9010\u6b65\u653e\u5f00\u8bbf\u95ee \u843d\u5730\u5b9e\u8df5\uff1a 1.LRU\u4e0eLFU\u5207\u6362 2.\u6570\u636e\u6709\u6548\u671f\u7b56\u7565\u8c03\u6574 \u6839\u636e\u4e1a\u52a1\u6570\u636e\u6709\u6548\u671f\u8fdb\u884c\u5206\u7c7b\u9519\u5cf0\uff0cA\u7c7b90\u5206\u949f\uff0cB\u7c7b80\u5206\u949f\uff0cC\u7c7b70\u5206\u949f \u8fc7\u671f\u65f6\u95f4\u4f7f\u7528\u56fa\u5b9a\u65f6\u95f4+\u968f\u673a\u503c\u7684\u5f62\u5f0f\uff0c\u7a00\u91ca\u96c6\u4e2d\u5230\u671f\u7684key\u7684\u6570\u91cf 3.\u8d85\u70ed\u6570\u636e\u4f7f\u7528\u6c38\u4e45key 4.\u5b9a\u671f\u7ef4\u62a4\uff08\u81ea\u52a8+\u4eba\u5de5\uff09 \u5bf9\u5373\u5c06\u8fc7\u671f\u6570\u636e\u505a\u8bbf\u95ee\u91cf\u5206\u6790\uff0c\u786e\u8ba4\u662f\u5426\u5ef6\u65f6\uff0c\u914d\u5408\u8bbf\u95ee\u91cf\u7edf\u8ba1\uff0c\u505a\u70ed\u70b9\u6570\u636e\u7684\u5ef6\u65f6 5.\u52a0\u9501\uff1a\u614e\u7528\uff01 \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u96ea\u5d29\u5c31\u662f\u77ac\u95f4\u8fc7\u671f\u6570\u636e\u91cf\u592a\u5927\uff0c\u5bfc\u81f4\u5bf9\u6570\u636e\u5e93\u670d\u52a1\u5668\u9020\u6210\u538b\u529b\u3002\u5982\u80fd\u591f\u6709\u6548\u907f\u514d\u8fc7\u671f\u65f6\u95f4\u96c6\u4e2d\uff0c\u53ef\u4ee5\u6709\u6548\u89e3\u51b3\u96ea\u5d29\u73b0\u8c61\u7684 \u51fa\u73b0\uff08\u7ea640%\uff09\uff0c\u914d\u5408\u5176\u4ed6\u7b56\u7565\u4e00\u8d77\u4f7f\u7528\uff0c\u5e76\u76d1\u63a7\u670d\u52a1\u5668\u7684\u8fd0\u884c\u6570\u636e\uff0c\u6839\u636e\u8fd0\u884c\u8bb0\u5f55\u505a\u5feb\u901f\u8c03\u6574\u3002","title":"5.2 \u7f13\u5b58\u96ea\u5d29"},{"location":"redis/day02/#53","text":"\u573a\u666f \uff1a\u8fd8\u662f\u6570\u636e\u5e93\u670d\u52a1\u5668\u5d29\u6e83\uff0c\u4f46\u662f\u8ddf\u4e4b\u524d\u7684\u573a\u666f\u6709\u70b9\u4e0d\u592a\u4e00\u6837 1.\u7cfb\u7edf\u5e73\u7a33\u8fd0\u884c\u8fc7\u7a0b\u4e2d 2.\u6570\u636e\u5e93\u8fde\u63a5\u91cf\u77ac\u95f4\u6fc0\u589e 3.Redis\u670d\u52a1\u5668\u65e0\u5927\u91cfkey\u8fc7\u671f 4.Redis\u5185\u5b58\u5e73\u7a33\uff0c\u65e0\u6ce2\u52a8 5.Redis\u670d\u52a1\u5668CPU\u6b63\u5e38 6.\u6570\u636e\u5e93\u5d29\u6e83 \u95ee\u9898\u6392\u67e5\uff1a 1.Redis\u4e2d\u67d0\u4e2akey\u8fc7\u671f\uff0c\u8be5key\u8bbf\u95ee\u91cf\u5de8\u5927 2.\u591a\u4e2a\u6570\u636e\u8bf7\u6c42\u4ece\u670d\u52a1\u5668\u76f4\u63a5\u538b\u5230Redis\u540e\uff0c\u5747\u672a\u547d\u4e2d 3.Redis\u5728\u77ed\u65f6\u95f4\u5185\u53d1\u8d77\u4e86\u5927\u91cf\u5bf9\u6570\u636e\u5e93\u4e2d\u540c\u4e00\u6570\u636e\u7684\u8bbf\u95ee \u603b\u800c\u8a00\u4e4b\u5c31\u4e24\u70b9\uff1a\u5355\u4e2akey\u9ad8\u70ed\u6570\u636e\uff0ckey\u8fc7\u671f \u89e3\u51b3\u65b9\u6848 \uff1a 1.\u9884\u5148\u8bbe\u5b9a \u4ee5\u7535\u5546\u4e3a\u4f8b\uff0c\u6bcf\u4e2a\u5546\u5bb6\u6839\u636e\u5e97\u94fa\u7b49\u7ea7\uff0c\u6307\u5b9a\u82e5\u5e72\u6b3e\u4e3b\u6253\u5546\u54c1\uff0c\u5728\u8d2d\u7269\u8282\u671f\u95f4\uff0c\u52a0\u5927\u6b64\u7c7b\u4fe1\u606fkey\u7684\u8fc7\u671f\u65f6\u957f \u6ce8\u610f\uff1a\u8d2d\u7269\u8282\u4e0d\u4ec5\u4ec5\u6307\u5f53\u5929\uff0c\u4ee5\u53ca\u540e\u7eed\u82e5\u5e72\u5929\uff0c\u8bbf\u95ee\u5cf0\u503c\u5448\u73b0\u9010\u6e10\u964d\u4f4e\u7684\u8d8b\u52bf 2.\u73b0\u573a\u8c03\u6574 \u76d1\u63a7\u8bbf\u95ee\u91cf\uff0c\u5bf9\u81ea\u7136\u6d41\u91cf\u6fc0\u589e\u7684\u6570\u636e\u5ef6\u957f\u8fc7\u671f\u65f6\u95f4\u6216\u8bbe\u7f6e\u4e3a\u6c38\u4e45\u6027key 3.\u540e\u53f0\u5237\u65b0\u6570\u636e \u542f\u52a8\u5b9a\u65f6\u4efb\u52a1\uff0c\u9ad8\u5cf0\u671f\u6765\u4e34\u4e4b\u524d\uff0c\u5237\u65b0\u6570\u636e\u6709\u6548\u671f\uff0c\u786e\u4fdd\u4e0d\u4e22\u5931 4.\u4e8c\u7ea7\u7f13\u5b58 \u8bbe\u7f6e\u4e0d\u540c\u7684\u5931\u6548\u65f6\u95f4\uff0c\u4fdd\u969c\u4e0d\u4f1a\u88ab\u540c\u65f6\u6dd8\u6c70\u5c31\u884c 5.\u52a0\u9501 \u5206\u5e03\u5f0f\u9501\uff0c\u9632\u6b62\u88ab\u51fb\u7a7f\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u4e5f\u662f\u6027\u80fd\u74f6\u9888\uff0c\u614e\u91cd\uff01 \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u51fb\u7a7f\u5c31\u662f\u5355\u4e2a\u9ad8\u70ed\u6570\u636e\u8fc7\u671f\u7684\u77ac\u95f4\uff0c\u6570\u636e\u8bbf\u95ee\u91cf\u8f83\u5927\uff0c\u672a\u547d\u4e2dredis\u540e\uff0c\u53d1\u8d77\u4e86\u5927\u91cf\u5bf9\u540c\u4e00\u6570\u636e\u7684\u6570\u636e\u5e93\u8bbf\u95ee\uff0c\u5bfc\u81f4\u5bf9\u6570 \u636e\u5e93\u670d\u52a1\u5668\u9020\u6210\u538b\u529b\u3002\u5e94\u5bf9\u7b56\u7565\u5e94\u8be5\u5728\u4e1a\u52a1\u6570\u636e\u5206\u6790\u4e0e\u9884\u9632\u65b9\u9762\u8fdb\u884c\uff0c\u914d\u5408\u8fd0\u884c\u76d1\u63a7\u6d4b\u8bd5\u4e0e\u5373\u65f6\u8c03\u6574\u7b56\u7565\uff0c\u6bd5\u7adf\u5355\u4e2akey\u7684\u8fc7 \u671f\u76d1\u63a7\u96be\u5ea6\u8f83\u9ad8\uff0c\u914d\u5408\u96ea\u5d29\u5904\u7406\u7b56\u7565\u5373\u53ef\u3002","title":"5.3 \u7f13\u5b58\u51fb\u7a7f"},{"location":"redis/day02/#54","text":"\u573a\u666f \uff1a\u6570\u636e\u5e93\u670d\u52a1\u5668\u53c8\u5d29\u6e83\u4e86\uff0c\u8ddf\u4e4b\u524d\u7684\u4e00\u6837\u5417\uff1f 1.\u7cfb\u7edf\u5e73\u7a33\u8fd0\u884c\u8fc7\u7a0b\u4e2d 2.\u5e94\u7528\u670d\u52a1\u5668\u6d41\u91cf\u968f\u65f6\u95f4\u589e\u91cf\u8f83\u5927 3.Redis\u670d\u52a1\u5668\u547d\u4e2d\u7387\u968f\u65f6\u95f4\u9010\u6b65\u964d\u4f4e 4.Redis\u5185\u5b58\u5e73\u7a33\uff0c\u5185\u5b58\u65e0\u538b\u529b 5.Redis\u670d\u52a1\u5668CPU\u5360\u7528\u6fc0\u589e 6.\u6570\u636e\u5e93\u670d\u52a1\u5668\u538b\u529b\u6fc0\u589e 7.\u6570\u636e\u5e93\u5d29\u6e83 \u95ee\u9898\u6392\u67e5\uff1a 1.Redis\u4e2d\u5927\u9762\u79ef\u51fa\u73b0\u672a\u547d\u4e2d 2.\u51fa\u73b0\u975e\u6b63\u5e38URL\u8bbf\u95ee \u95ee\u9898\u5206\u6790 \uff1a \u83b7\u53d6\u7684\u6570\u636e\u5728\u6570\u636e\u5e93\u4e2d\u4e5f\u4e0d\u5b58\u5728\uff0c\u6570\u636e\u5e93\u67e5\u8be2\u672a\u5f97\u5230\u5bf9\u5e94\u6570\u636e Redis\u83b7\u53d6\u5230null\u6570\u636e\u672a\u8fdb\u884c\u6301\u4e45\u5316\uff0c\u76f4\u63a5\u8fd4\u56de \u4e0b\u6b21\u6b64\u7c7b\u6570\u636e\u5230\u8fbe\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b \u51fa\u73b0\u9ed1\u5ba2\u653b\u51fb\u670d\u52a1\u5668 \u89e3\u51b3\u65b9\u6848 \uff1a 1.\u7f13\u5b58null \u5bf9\u67e5\u8be2\u7ed3\u679c\u4e3anull\u7684\u6570\u636e\u8fdb\u884c\u7f13\u5b58\uff08\u957f\u671f\u4f7f\u7528\uff0c\u5b9a\u671f\u6e05\u7406\uff09\uff0c\u8bbe\u5b9a\u77ed\u65f6\u9650\uff0c\u4f8b\u598230-60\u79d2\uff0c\u6700\u9ad85\u5206\u949f 2.\u767d\u540d\u5355\u7b56\u7565 \u63d0\u524d\u9884\u70ed\u5404\u79cd\u5206\u7c7b\u6570\u636eid\u5bf9\u5e94\u7684bitmaps\uff0cid\u4f5c\u4e3abitmaps\u7684offset\uff0c\u76f8\u5f53\u4e8e\u8bbe\u7f6e\u4e86\u6570\u636e\u767d\u540d\u5355\u3002\u5f53\u52a0\u8f7d\u6b63\u5e38\u6570\u636e\u65f6\u653e\u884c\uff0c\u52a0\u8f7d\u5f02\u5e38\u6570\u636e\u65f6\u76f4\u63a5\u62e6\u622a\uff08\u6548\u7387\u504f\u4f4e\uff09 \u4f7f\u7528\u5e03\u9686\u8fc7\u6ee4\u5668\uff08\u6709\u5173\u5e03\u9686\u8fc7\u6ee4\u5668\u7684\u547d\u4e2d\u95ee\u9898\u5bf9\u5f53\u524d\u72b6\u51b5\u53ef\u4ee5\u5ffd\u7565\uff09 2.\u5b9e\u65bd\u76d1\u63a7 \u5b9e\u65f6\u76d1\u63a7redis\u547d\u4e2d\u7387\uff08\u4e1a\u52a1\u6b63\u5e38\u8303\u56f4\u65f6\uff0c\u901a\u5e38\u4f1a\u6709\u4e00\u4e2a\u6ce2\u52a8\u503c\uff09\u4e0enull\u6570\u636e\u7684\u5360\u6bd4 \u975e\u6d3b\u52a8\u65f6\u6bb5\u6ce2\u52a8\uff1a\u901a\u5e38\u68c0\u6d4b3-5\u500d\uff0c\u8d85\u8fc75\u500d\u7eb3\u5165\u91cd\u70b9\u6392\u67e5\u5bf9\u8c61 \u6d3b\u52a8\u65f6\u6bb5\u6ce2\u52a8\uff1a\u901a\u5e38\u68c0\u6d4b10-50\u500d\uff0c\u8d85\u8fc750\u500d\u7eb3\u5165\u91cd\u70b9\u6392\u67e5\u5bf9\u8c61 \u6839\u636e\u500d\u6570\u4e0d\u540c\uff0c\u542f\u52a8\u4e0d\u540c\u7684\u6392\u67e5\u6d41\u7a0b\u3002\u7136\u540e\u4f7f\u7528\u9ed1\u540d\u5355\u8fdb\u884c\u9632\u63a7\uff08\u8fd0\u8425\uff09 4.key\u52a0\u5bc6 \u95ee\u9898\u51fa\u73b0\u540e\uff0c\u4e34\u65f6\u542f\u52a8\u9632\u707e\u4e1a\u52a1key\uff0c\u5bf9key\u8fdb\u884c\u4e1a\u52a1\u5c42\u4f20\u8f93\u52a0\u5bc6\u670d\u52a1\uff0c\u8bbe\u5b9a\u6821\u9a8c\u7a0b\u5e8f\uff0c\u8fc7\u6765\u7684key\u6821\u9a8c \u4f8b\u5982\u6bcf\u5929\u968f\u673a\u5206\u914d60\u4e2a\u52a0\u5bc6\u4e32\uff0c\u6311\u90092\u52303\u4e2a\uff0c\u6df7\u6dc6\u5230\u9875\u9762\u6570\u636eid\u4e2d\uff0c\u53d1\u73b0\u8bbf\u95eekey\u4e0d\u6ee1\u8db3\u89c4\u5219\uff0c\u9a73\u56de\u6570\u636e\u8bbf\u95ee \u603b\u7684\u6765\u8bf4 \uff1a\u7f13\u5b58\u51fb\u7a7f\u662f\u6307\u8bbf\u95ee\u4e86\u4e0d\u5b58\u5728\u7684\u6570\u636e\uff0c\u8df3\u8fc7\u4e86\u5408\u6cd5\u6570\u636e\u7684redis\u6570\u636e\u7f13\u5b58\u9636\u6bb5\uff0c\u6bcf\u6b21\u8bbf\u95ee\u6570\u636e\u5e93\uff0c\u5bfc\u81f4\u5bf9\u6570\u636e\u5e93\u670d\u52a1\u5668\u9020\u6210\u538b\u529b\u3002\u901a\u5e38\u6b64\u7c7b\u6570\u636e\u7684\u51fa\u73b0\u91cf\u662f\u4e00\u4e2a\u8f83\u4f4e\u7684\u503c\uff0c\u5f53\u51fa\u73b0\u6b64\u7c7b\u60c5\u51b5\u4ee5\u6bd2\u653b\u6bd2\uff0c\u5e76\u53ca\u65f6\u62a5\u8b66\u3002\u5e94\u5bf9\u7b56\u7565\u5e94\u8be5\u5728\u4e34\u65f6\u9884\u6848\u9632\u8303\u65b9\u9762\u591a\u505a\u6587\u7ae0\u3002 \u65e0\u8bba\u662f\u9ed1\u540d\u5355\u8fd8\u662f\u767d\u540d\u5355\uff0c\u90fd\u662f\u5bf9\u6574\u4f53\u7cfb\u7edf\u7684\u538b\u529b\uff0c\u8b66\u62a5\u89e3\u9664\u540e\u5c3d\u5feb\u79fb\u9664\u3002","title":"5.4 \u7f13\u5b58\u7a7f\u900f"},{"location":"redis/day02/#55","text":"redis\u4e2d\u7684\u76d1\u63a7\u6307\u6807\u5982\u4e0b\uff1a \u6027\u80fd\u6307\u6807\uff1aPerformance \u54cd\u5e94\u8bf7\u6c42\u7684\u5e73\u5747\u65f6\u95f4: properties latency \u5e73\u5747\u6bcf\u79d2\u5904\u7406\u8bf7\u6c42\u603b\u6570 properties instantaneous_ops_per_sec \u7f13\u5b58\u67e5\u8be2\u547d\u4e2d\u7387\uff08\u901a\u8fc7\u67e5\u8be2\u603b\u6b21\u6570\u4e0e\u67e5\u8be2\u5f97\u5230\u975enil\u6570\u636e\u603b\u6b21\u6570\u8ba1\u7b97\u800c\u6765\uff09 ```properties hit_rate(calculated) ``` \u5185\u5b58\u6307\u6807\uff1aMemory \u5f53\u524d\u5185\u5b58\u4f7f\u7528\u91cf properties used_memory \u5185\u5b58\u788e\u7247\u7387\uff08\u5173\u7cfb\u5230\u662f\u5426\u8fdb\u884c\u788e\u7247\u6574\u7406\uff09 properties mem_fragmentation_ratio \u4e3a\u907f\u514d\u5185\u5b58\u6ea2\u51fa\u5220\u9664\u7684key\u7684\u603b\u6570\u91cf properties evicted_keys \u57fa\u4e8e\u963b\u585e\u64cd\u4f5c\uff08BLPOP\u7b49\uff09\u5f71\u54cd\u7684\u5ba2\u6237\u7aef\u6570\u91cf properties blocked_clients \u57fa\u672c\u6d3b\u52a8\u6307\u6807\uff1aBasic_activity \u5f53\u524d\u5ba2\u6237\u7aef\u8fde\u63a5\u603b\u6570 properties connected_clients \u5f53\u524d\u8fde\u63a5slave\u603b\u6570 properties connected_slaves \u6700\u540e\u4e00\u6b21\u4e3b\u4ece\u4fe1\u606f\u4ea4\u6362\u8ddd\u73b0\u5728\u7684\u79d2 properties master_last_io_seconds_ago key\u7684\u603b\u6570 properties keyspace \u6301\u4e45\u6027\u6307\u6807\uff1aPersistence \u5f53\u524d\u670d\u52a1\u5668\u6700\u540e\u4e00\u6b21RDB\u6301\u4e45\u5316\u7684\u65f6\u95f4 properties rdb_last_save_time \u5f53\u524d\u670d\u52a1\u5668\u6700\u540e\u4e00\u6b21RDB\u6301\u4e45\u5316\u540e\u6570\u636e\u53d8\u5316\u603b\u91cf properties rdb_changes_since_last_save \u9519\u8bef\u6307\u6807\uff1aError \u88ab\u62d2\u7edd\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u603b\u6570\uff08\u57fa\u4e8e\u8fbe\u5230\u6700\u5927\u8fde\u63a5\u503c\u7684\u56e0\u7d20\uff09 properties rejected_connections key\u672a\u547d\u4e2d\u7684\u603b\u6b21\u6570 properties keyspace_misses \u4e3b\u4ece\u65ad\u5f00\u7684\u79d2\u6570 properties master_link_down_since_seconds \u8981\u5bf9redis\u7684\u76f8\u5173\u6307\u6807\u8fdb\u884c\u76d1\u63a7\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4e00\u4e9b\u7528\u5177\uff1a CloudInsight Redis Prometheus Redis-stat Redis-faina RedisLive zabbix \u4e5f\u6709\u4e00\u4e9b\u547d\u4ee4\u5de5\u5177\uff1a benchmark \u6d4b\u8bd5\u5f53\u524d\u670d\u52a1\u5668\u7684\u5e76\u53d1\u6027\u80fd properties redis-benchmark [-h ] [-p ] [-c ] [-n <requests]> [-k ] \u8303\u4f8b1\uff1a50\u4e2a\u8fde\u63a5\uff0c10000\u6b21\u8bf7\u6c42\u5bf9\u5e94\u7684\u6027\u80fd properties redis-benchmark \u8303\u4f8b2\uff1a100\u4e2a\u8fde\u63a5\uff0c5000\u6b21\u8bf7\u6c42\u5bf9\u5e94\u7684\u6027\u80fd properties redis-benchmark -c 100 -n 5000 redis-cli monitor\uff1a\u542f\u52a8\u670d\u52a1\u5668\u8c03\u8bd5\u4fe1\u606f properties monitor slowlog\uff1a\u6162\u65e5\u5fd7 \u83b7\u53d6\u6162\u67e5\u8be2\u65e5\u5fd7 properties slowlog [operator] get \uff1a\u83b7\u53d6\u6162\u67e5\u8be2\u65e5\u5fd7\u4fe1\u606f len \uff1a\u83b7\u53d6\u6162\u67e5\u8be2\u65e5\u5fd7\u6761\u76ee\u6570 reset \uff1a\u91cd\u7f6e\u6162\u67e5\u8be2\u65e5\u5fd7 \u76f8\u5173\u914d\u7f6e properties slowlog-log-slower-than 1000 #\u8bbe\u7f6e\u6162\u67e5\u8be2\u7684\u65f6\u95f4\u4e0b\u7ebf\uff0c\u5355\u4f4d\uff1a\u5fae\u5999 slowlog-max-len 100 #\u8bbe\u7f6e\u6162\u67e5\u8be2\u547d\u4ee4\u5bf9\u5e94\u7684\u65e5\u5fd7\u663e\u793a\u957f\u5ea6\uff0c\u5355\u4f4d\uff1a\u547d\u4ee4\u6570","title":"5.5 \u6027\u80fd\u6307\u6807\u76d1\u63a7"}]}